/*! For license information please see driver.min.js.LICENSE.txt */
(()=>{var __webpack_modules__={3023:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.driver=void 0;const n=s(6708),a=(Object.defineProperty(t,"driver",{enumerable:!0,get:function(){return n.driver}}),s(1761)),o=s(2230);n.driver.extend(a.HLSLoader,o.HLSSWClientOwner)},5694:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DriverConfigurator=void 0;const n=s(1744),a=s(5419);class DriverConfigurator{constructor(e){this._options=e}config(){this._configKernel()}_configKernel(){GlobalConfigurator.process(),a.KernelValidator.verify(this._options),a.KernelConfigurator.config(this._options)}static config(e){new DriverConfigurator(e).config()}}t.DriverConfigurator=DriverConfigurator;class GlobalConfigurator{process(){this._shouldUpdateGlobal&&(this._updateGeneral(),this._updatePlatform(),this._updateSettings())}get _shouldUpdateGlobal(){return!n.kernelSettings.global}_updateGeneral(){var e=self.mlysdk.config.data;n.kernelSettings.global={mode:e.mode,accountID:e.org_id,streamID:e.stream_id,streamType:e.stream_type,clientID:e.client_id,clientKey:e.client_key,muxEnvKey:e.mux_env_key,platform:void 0,assets:e.assets}}_updatePlatform(){var e=self.mlysdk.config.data.platform;e&&(n.kernelSettings.global.platform={details:e.platforms.map((e=>({id:e.id,providerID:e.provider_id,type:e.platform_type,name:e.name,host:e.host,score:e.score,isEnabled:e.enable}))),algorithmID:e.algorithm_id,algorithmVersion:e.algorithm_ver})}_updateSettings(){var e=n.kernelSettings.global;n.kernelSettings.client.id=e.clientID,n.kernelSettings.client.key=e.clientKey,n.kernelSettings.client.accountID=e.accountID,n.kernelSettings.system.mode=e.mode,n.kernelSettings.stream.streamID=e.streamID,n.kernelSettings.stream.streamType=e.streamType,n.kernelSettings.monitor.muxEnvKey=e.muxEnvKey}static process(){(new GlobalConfigurator).process()}}},6708:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.driver=void 0;const a=n(s(6486)),o=s(9770),c=s(2559),u=s(1744),l=s(1032),d=s(8055),h=s(5694),_=s(5911);const p=new class Driver{get state(){return f.state}get export(){return f.export}get gettings(){return f.gettings}get settings(){return f.settings}get extensions(){return f.extensions}get isSupported(){return f.isSupported}set isSupported(e){f.isSupported=e}get isInitialized(){return f.isInitialized}get isDeinitialized(){return f.isDeinitialized}initialize(e){return f.initialize(e),this}config(e){return f.config(e),this}extend(...e){return f.extend(...e),this}},f=(t.driver=p,new class DriverManager{constructor(){this._supervisor=new _.DriverSupervisor,this._extensions={},this._isSupported=null!=o.RTCPeerConnection,this._isInitialized=!1}get state(){return d.SystemBooterHolder.state}get export(){return l.MetricsExporterHolder.instance}get gettings(){return c.kernelGettings}get settings(){return a.default.cloneDeep(u.kernelSettings)}get extensions(){return this._extensions}get isSupported(){return this._isSupported}set isSupported(e){this._isSupported=this._isSupported&&e}get isInitialized(){return this._isInitialized}get isDeinitialized(){return d.SystemBooterHolder.state.isCeased&&!c.kernelGettings.isSystemP2SMode}initialize(e){this._isInitialized||(this._setupSettings(e),this._startSupervisor(),this._isInitialized=!0)}config(e){this._setupSettings(e)}_setupSettings(e){h.DriverConfigurator.config(e)}_startSupervisor(){this._supervisor.initialize()}extend(...e){for(const t of e)t._driver=p,t._isPublic&&(this._extensions[t._publicName]=t)}})},6102:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DriverExtensionMixin=t.DriverExtensionMixer=void 0;const s=e=>{class r extends e{get _driver(){return this.constructor._driver}}return r._isPublic=!1,r};class DriverExtensionMixin extends((t.DriverExtensionMixer=s)(Object)){}t.DriverExtensionMixin=DriverExtensionMixin},5911:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DriverSupervisor=void 0;const n=s(93),a=s(1135),o=s(5507),c=s(2559),u=s(8055);class DriverDaemon{async activate(){this._processor=new o.Processor(DriverDaemon.DEFAULT_PROCESSOR_OPTIONS),await this._processor.register(new SystemProcess),await this._processor.activate(),await this._processor.throwIfError()}async deactivate(){var e;await(null==(e=this._processor)?void 0:e.deactivate()),this._processor=null}}DriverDaemon.DEFAULT_PROCESSOR_OPTIONS={gracefulTimeout:10,heartbeatInterval:300};class SystemProcess{async initialize(){this._booter=u.SystemBooterHolder.instance}async startDaemon(e){try{for(await this._booter.activate();e.isRunning;)await n.TimeTool.sleep(1)}finally{await this._booter.deactivate()}}}t.DriverSupervisor=class DriverSupervisor{constructor(){this._daemon=new DriverDaemon,this._backoff=new a.RetryBackoff({delayerClass:a.ExponentialDelayer,delayerOptions:{maxInterval:60,maxAttempts:-1}})}async initialize(){this._shouldRetry?await this._backoff.apply((async()=>{await this._daemon.activate()})):await this._daemon.activate()}get _shouldRetry(){return c.kernelGettings.isSystemP2SMode}}},3107:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SWProxyActionName=void 0;class SWProxyActionName{}(t.SWProxyActionName=SWProxyActionName).REQUEST_BYPASS_FETCH="request: bypass fetch",SWProxyActionName.RESPOND_BYPASS_FETCH="respond: bypass fetch",SWProxyActionName.MESSAGE_NOTIFY_EXCEPTION="message: notify exception"},5202:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SWProxyErrorMessageCreator=void 0;const n=s(2016),a=s(7464),o=s(3107);class SWProxyErrorMessageCreator{constructor(e,t,s){this._id=e,this._cause=t,this._clientID=s,this._initialize()}get id(){return this._id}get cause(){return this._cause}get clientID(){return this._clientID}get code(){return this._code}get error(){return this._error}get payload(){return this._payload}_initialize(){this._setCode(),this._setError(),this._setMessage()}_setCode(){this._code=SWProxyErrorMessageCreator.DEFAULT_MESSAGE_CODE,this._cause instanceof n.InternalError&&(this._code=this._cause.code)}_setError(){this._cause instanceof n.InternalError?this._error=this._cause:this._error=new n.InternalError(this._code,this._cause)}_setMessage(){this._payload={action:o.SWProxyActionName.MESSAGE_NOTIFY_EXCEPTION,header:{correlation_id:this._id,source_client_id:this._clientID,response_code:this._code.metaCode,response_status:this._code.metaStatus,response_message:this._code.metaContent}}}}(t.SWProxyErrorMessageCreator=SWProxyErrorMessageCreator).DEFAULT_MESSAGE_CODE=a.MessageCode.ESV002},1761:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HLSLoader=void 0;const n=s(2016),a=s(287),o=s(9283),c=s(3050),u=s(7464),l=s(4916),d=s(8055),h=s(6102),_=s(5155);class HLSLoader extends h.DriverExtensionMixin{constructor(){super(),this._timeouter=new o.Timeouter,this._isDestroyed=!1,this._proxy=new _.HLSLoaderProxy,this._stats=this._makeStats()}get stats(){return this._stats}get context(){return this._context}async load(e,t,s){this._context=e,this._config=t,this._callbacks=s,await this._load().catch((async e=>{await a.Logger.debug("HLS loader load failed.",void 0,{error:e}),this._isDestroyed||(e=this._makeException(e),this._callbacks.onError(e,this._context,void 0))}))}async _load(){await this._setupStates(),await this._applySystem(),await this._applySource()}async _setupStates(){await this._setQualityLevel()}async _setQualityLevel(){var e,t=this._context;this._qualityLevel=null!=(e=null==(e=t.frag)?void 0:e.level)?e:t.level}async _applySystem(){await d.SystemBooterHolder.available()}async _applySource(){null==this._qualityLevel||this._qualityLevel===HLSLoader.MIN_QUALITY_LEVEL?await this._fetchContent():(await this._timeouter.setup((async()=>{await this._abort(),this._callbacks.onTimeout&&this._callbacks.onTimeout(this._stats,this._context,void 0)}),this._config.timeout/1e3),await this._timeouter.apply((async()=>{await this._fetchContent()})))}async _fetchContent(){await this._fetchResource(),await this._updateStats(),await this._replyResource()}async _fetchResource(){switch(this._context.responseType){case ResponseType.TEXT:case ResponseType.ARRAY_BUFFER:this._resource=await this._proxy.fetch(this._context.url);break;default:throw new n.ValidationError(u.MessageCode.WSV050,void 0,{responseType:this._context.responseType})}}_updateStats(){var e=c.performance.now(),t=this._resource,s=t.ptime.elapsedTimeMs,n=(this._stats.total=t.size,this._stats.loaded=t.size,this._stats.loading.start=e-s,this._stats.loading.first=e,this._stats.loading.end=e,this._context).part;n&&(t=Math.max(null!=(n=t.total)?n:10,10),n=Math.log10(s/16/(t/1e3)*10+1),t=l.MathFunction.convexHyperbolicTangentCurve(n,2),this._stats.loading.start=e-s*t)}_replyResource(){var e=this._makeResponse();this._callbacks.onProgress&&this._callbacks.onProgress(this._stats,this._context,this._resource.content,void 0),this._callbacks.onSuccess(e,this._stats,this._context,void 0)}_makeStats(){return{aborted:!1,loaded:0,retry:0,total:0,chunkCount:0,bwEstimate:0,loading:{start:0,end:0,first:0},parsing:{start:0,end:0},buffering:{start:0,end:0,first:0}}}_makeResponse(){var e=this._resource,t={url:this._context.url,data:e.content};return this._context.responseType===ResponseType.TEXT&&(t.data=(new TextDecoder).decode(e.content)),t}_makeException(e){return{code:500,text:e.message}}async abort(){await this._abort(),this._callbacks.onAbort&&this._callbacks.onAbort(this._stats,this._context,void 0)}async destroy(){await this._abort()}async _abort(){this._isDestroyed||(null==this._resource&&(this._stats.aborted=!0),this._timeouter.reset(),await this._proxy.abort(),this._isDestroyed=!0)}}(t.HLSLoader=HLSLoader).MIN_QUALITY_LEVEL=0,HLSLoader._isPublic=!0,HLSLoader._publicName="HLSLoader";class ResponseType{}ResponseType.TEXT="text",ResponseType.ARRAY_BUFFER="arraybuffer"},5155:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HLSLoaderProxy=t.HLSProxy=void 0;const n=s(9714),a=s(93),o=s(2016),c=s(9283),u=s(9706),l=s(3267),d=s(2559),h=s(1744),_=s(7464),p=s(3897),f=s(6903),m=s(545),y=s(4916),w=s(937),g=s(413),v=s(8144),E=s(9124),T=s(7097),b=s(9771);t.HLSProxy=class HLSProxy{static async clear(e){await S.deregister(m.Resource.makeID(e))}};t.HLSLoaderProxy=class HLSLoaderProxy{async fetch(e){return await this._setupResource(e),await this._setupController(),await this._fetchResource(),this._resource}async _setupResource(e){this._resource=await b.FileSeekerHolder.cache(new m.Resource(e))}async _setupController(){await this._fetchController(),this._controller||await this._buildController()}async _fetchController(){for(const e of S.values)if(e.info.isManaged(this._resource))return void(this._controller=e)}async _buildController(){this._controller=new HLSController({episode:new HLSArchive({id:this._resource.id,uri:this._resource.uri})}),await S.register(this._resource.id,this._controller)}async _fetchResource(){await this._controller.fetch(this._resource)}async abort(){await this._abortResource()}async _abortResource(){await this._controller.abort(this._resource)}};class HLSController{constructor(e){this._options=e,this._initialize()}get info(){return this._info}_initialize(){this._info=new HLSControllerInfo(this._options)}async fetch(e){await this._injectInfo(e),this._shouldBufferPlay(e)&&await this._bufferPlay(e),await this._fetchResource(e),this._shouldUpdateInfo(e)&&await this._updateInfo(e),this._shouldManageSwarm&&await this._manageSwarm()}async _injectInfo(e){await InjectInfoHandler.process({info:this._info,resource:e})}_shouldBufferPlay(e){return this._info.isSegment(e)}async _bufferPlay(e){await BufferPlayHandler.process({info:this._info,resource:e})}_shouldUpdateInfo(e){return this._info.isPlaylist(e)}async _updateInfo(e){await UpdateInfoHandler.process({info:this._info,resource:e})}get _shouldManageSwarm(){return d.kernelGettings.isSystemP2PMode&&[...this._info.details.values()].some((e=>null!=e.playManifest))}async _manageSwarm(){await ManageSwarmHandler.process({info:this._info})}async _fetchResource(e){await b.FileSeekerHolder.fetch(e)}async abort(e){await this._abortResource(e)}async _abortResource(e){await b.FileSeekerHolder.abort(e)}async close(){await this._deleteSource()}async _deleteSource(){await DeleteSwarmHandler.process({info:this._info})}}class HLSControllerInfo{constructor(e){this._details=new Map,this._episode=e.episode}get episode(){return this._episode}get details(){return this._details}isManaged(e){return this.isSwarmed(e)||this.isEpisode(e)}isPlaylist(e){return this.isManifest(e)||this.isEpisode(e)}isSwarmed(e){return[...this._details.values()].some((t=>t.isSwarmed(e)))}isEpisode(e){return this._episode.id===e.id}isManifest(e){return[...this._details.values()].some((t=>t.isManifest(e)))}isSegment(e){return[...this._details.values()].some((t=>t.isSegment(e)))}findDetail(e){return this._details.get(e)}}class HLSControllerInfoDetail{constructor(){this._manifests=new Map,this._playSegments=new Map,this._playStableTime=new c.Timer}get manifests(){return this._manifests}set manifests(e){this._manifests=e}get lastManifest(){return this._lastManifest}set lastManifest(e){this._lastManifest=e}get lastSegment(){return this._lastSegment}set lastSegment(e){this._lastSegment=e}get playManifest(){return this._playManifest}set playManifest(e){this._playManifest=e}get playSegment(){return this._playSegment}set playSegment(e){this._playSegment=e}get playSegments(){return this._playSegments}set playSegments(e){this._playSegments=e}get playStableTime(){return this._playStableTime}isSwarmed(e){return this.isManifest(e)||this.isSegment(e)}isManifest(e){return this._manifests.has(e.id)}isSegment(e){return[...this._manifests.values()].some((t=>t.isSegment(e)))}}class HLSControllerInfoDetailName{}HLSControllerInfoDetailName.VIDEO="video",HLSControllerInfoDetailName.AUDIO="audio",HLSControllerInfoDetailName.SUBTITLE="subtitle",HLSControllerInfoDetailName.UNKNOWN="unknown";class HLSArchive{constructor(e){this._id=e.id,this._uri=e.uri}get id(){return this._id}set id(e){this._id=e}get uri(){return this._uri}set uri(e){this._uri=e}}class HLSManifest extends HLSArchive{constructor(e){super(e),this._segments=new Map,this._segments=e.segments}get segments(){return this._segments}set segments(e){this._segments=e}isSegment(e){return this._segments.has(e.id)}}class HLSSegment extends HLSArchive{constructor(e){super(e),this._duration=e.duration,this._hasParts=e.hasParts}get duration(){return this._duration}set duration(e){this._duration=e}get hasParts(){return this._hasParts}set hasParts(e){this._hasParts=e}}class HLSMeasure extends HLSSegment{constructor(e){super(e),this._priority=e.priority,this._cumulativeDuration=e.cumulativeDuration}get priority(){return this._priority}set priority(e){this._priority=e}get cumulativeDuration(){return this._cumulativeDuration}set cumulativeDuration(e){this._cumulativeDuration=e}}class HLSControllerManager extends f.BasePool{async register(e,t){await super.register(e,t)}async deregister(e){var t=this.retrieve(e);await(null==t?void 0:t.close()),await super.deregister(e)}}const S=new HLSControllerManager;class InjectInfoHandler extends l.AbstractFlow{constructor(e){super(e),this._info=e.content.info,this._resource=e.content.resource}async process(){await this._injectSource(),await this._injectSwarm()}_injectSource(){this._resource.sourceURI=this._info.episode.uri}_injectSwarm(){for(const e of[...this._info.details.values()].flatMap((e=>[...e.manifests.values()])))if(e.isSegment(this._resource)){this._resource.swarmID=e.id,this._resource.swarmURI=e.uri,this._resource.isShareable=!0;break}}static async process(e){await new InjectInfoHandler({content:e}).process()}}class BufferPlayHandler extends l.AbstractFlow{constructor(e){super(e),this._info=e.content.info,this._resource=e.content.resource}async process(){await this._intakeDetail(),await this._updatePlayStates(),await this._delayBufferPlay(),await this._intakeSegments(),await this._intakeMeasures(),await this._intakePlaySegments(),await this._abortPlaySegments(),await this._updatePlaySegments()}_intakeDetail(){var e=[...this._info.details.values()].find((e=>e.isSegment(this._resource)));this._expose(p.FlowKey.DETAIL,e)}_updatePlayStates(){var e=this._require(p.FlowKey.DETAIL);e.lastManifest=e.playManifest,e.lastSegment=e.playSegment,e.playManifest=e.manifests.get(this._resource.swarmID),e.playSegment=this._resource,e.lastManifest&&e.lastManifest===e.playManifest&&e.lastSegment&&e.lastSegment.isComplete?e.playStableTime.stamp():e.playStableTime.reset()}async _delayBufferPlay(){var e=this._require(p.FlowKey.DETAIL),t=e.playSegment;if(null!=e.lastSegment&&(await a.TimeTool.sleepRandomly(.1*(1-this._playStability)),e.playSegment!==t))throw new o.InternalError(_.MessageCode.ESV051,void 0,{resource:this._resource})}get _playStability(){var e=this._require(p.FlowKey.DETAIL);e=Math.min(e.playStableTime.elapsedTimeS,BufferPlayHandler.MIN_STABLE_TIME);return Math.pow(e/BufferPlayHandler.MIN_STABLE_TIME,2)}_intakeSegments(){var e=this._require(p.FlowKey.DETAIL);let t=new Array;var s=[...e.playManifest.segments.values()].filter((e=>!e.hasParts));for(let e=0;e<s.length;e++)if(s[e].uri===this._resource.uri){t=s.slice(e,e+h.kernelSettings.stream.maxBufferSize);break}this._expose(p.FlowKey.SEGMENTS,t)}_intakeMeasures(){var e=this._require(p.FlowKey.SEGMENTS),t=new Array;let s=0;var n=Math.max(h.kernelSettings.stream.maxBufferTime*Math.max(this._playStability,.1),h.kernelSettings.stream.minBufferTime);for(let l=0;l<e.length;l++){var{id:a,uri:o,duration:c,hasParts:u}=e[l];if(t.push(new HLSMeasure({id:a,uri:o,duration:c,hasParts:u,priority:l,cumulativeDuration:s})),(s+=c)>n)break}this._expose(p.FlowKey.MEASURES,t)}async _intakePlaySegments(){var e=this._require(p.FlowKey.MEASURES),t=new Map;for(const s of e){let n=new m.Resource(s.uri);n.priority=s.priority,n.startDelay=s.cumulativeDuration*y.MathFunction.upwardSigmoidCurve(s.priority,e.length),n=await b.FileSeekerHolder.prefetch(n),await t.set(n.id,n),await InjectInfoHandler.process({info:this._info,resource:n})}await this._expose(p.FlowKey.SEGMENTS,t)}async _abortPlaySegments(){var e=this._require(p.FlowKey.DETAIL).playSegments,t=this._require(p.FlowKey.SEGMENTS);for(const s of e.values())t.has(s.id)||await b.FileSeekerHolder.abort(s)}_updatePlaySegments(){var e=this._require(p.FlowKey.DETAIL),t=this._require(p.FlowKey.SEGMENTS);e.playSegments=t}static async process(e){await new BufferPlayHandler({content:e}).process()}}BufferPlayHandler.MIN_STABLE_TIME=10;class UpdateInfoHandler extends l.AbstractFlow{constructor(e){super(e),this._info=e.content.info,this._resource=e.content.resource}async process(){await this._intakePlaylist(),this._isEpisodePlaylist?(await this._updateVideo(),await this._updateAudio()):this._isManifestPlaylist&&(await this._ensureDetail(),await this._updateManifest(),await this._updateSegments())}_intakePlaylist(){var e=w.M3U8Tool.parse(this._resource.content);this._expose(p.FlowKey.PLAYLIST,e)}get _isEpisodePlaylist(){var e=this._require(p.FlowKey.PLAYLIST);return null!=e.playlists&&0<e.playlists.length}_updateVideo(){var e=this._require(p.FlowKey.PLAYLIST);e=this._createDetail(e.playlists);this._info.details.set(HLSControllerInfoDetailName.VIDEO,e)}_updateAudio(){var e,t=this._require(p.FlowKey.PLAYLIST);null!=(null==(e=t.mediaGroups)?void 0:e.AUDIO)&&(e=this._createDetail(n.ListTool.flatObject(t.mediaGroups.AUDIO,2)),this._info.details.set(HLSControllerInfoDetailName.AUDIO,e))}_createDetail(e){var t=new HLSControllerInfoDetail,s=new Map;for(const t of e){var n=u.path.dirname(this._info.episode.uri);n=new m.Resource(new URL(t.uri,n+"/").href),n=new HLSManifest({id:n.id,uri:n.uri,segments:new Map});s.set(n.id,n)}return t.manifests=s,t}get _isManifestPlaylist(){return 0<this._require(p.FlowKey.PLAYLIST).segments.length}_ensureDetail(){let e=[...this._info.details.values()].find((e=>e.isManifest(this._resource)));e||(e=this._createDetail([{uri:this._resource.uri}]),this._info.details.set(HLSControllerInfoDetailName.UNKNOWN,e)),this._expose(p.FlowKey.DETAIL,e)}_updateManifest(){var e=this._require(p.FlowKey.DETAIL),t=null!=(t=e.manifests.get(this._resource.id))?t:new HLSManifest({id:this._resource.id,uri:this._resource.uri,segments:new Map});e.manifests.set(t.id,t)}_updateSegments(){var e=this._require(p.FlowKey.PLAYLIST),t=this._require(p.FlowKey.DETAIL).manifests.get(this._resource.id);const s=u.path.dirname(t.uri),n=new Map;e.segments.forEach((e=>{var t=null!=e.parts;t&&e.parts.forEach((e=>{this._injectHLSSegment(n,s,e,!1)})),this._injectHLSSegment(n,s,e,t)})),e.preloadSegment&&null!=(e=e.preloadSegment.parts)&&e.forEach((e=>{this._injectHLSSegment(n,s,e,!1)})),t.segments=n}_injectHLSSegment(e,t,s,n){t=new m.Resource(new URL(s.uri,t+"/").href),t=new HLSSegment({id:t.id,uri:t.uri,duration:s.duration,hasParts:n}),e.set(t.id,t)}static async process(e){await new UpdateInfoHandler({content:e}).process()}}class ManageSwarmHandler extends l.AbstractFlow{constructor(e){super(e),this._info=e.content.info}async process(){await this._iterateDetails((async()=>{await this._intakeSegmentIDs(),this._shouldCreateSwarmLauncher&&await this._createSwarmLauncher(),await this._updateSwarmDaemonInfo()}))}async _iterateDetails(e){for(const t of[...this._info.details.values()].filter((e=>null!=e.playManifest)))await this._expose(p.FlowKey.DETAIL,t),await e();await this._remove(p.FlowKey.DETAIL)}_intakeSegmentIDs(){var e=[...this._require(p.FlowKey.DETAIL).playManifest.segments.values()].map((e=>e.id));this._expose(p.FlowKey.SEGMENT_IDS,new Set(e))}get _shouldCreateSwarmLauncher(){var e=this._require(p.FlowKey.DETAIL);return!T.SwarmManagerHolder.isRegistered(e.playManifest.id)}async _createSwarmLauncher(){var e=this._require(p.FlowKey.DETAIL),t=this._require(p.FlowKey.SEGMENT_IDS);await T.SwarmManagerHolder.register(e.playManifest.id,new E.SwarmLauncher({info:new g.SwarmInfo({swarmID:e.playManifest.id,swarmURI:e.playManifest.uri,segmentIDs:t})}))}_updateSwarmDaemonInfo(){var e=this._require(p.FlowKey.DETAIL),t=(e=v.swarmDaemonPool.retrieve(e.playManifest.id),this._require(p.FlowKey.SEGMENT_IDS));e&&(e.info.segmentIDs=t)}static async process(e){await new ManageSwarmHandler({content:e}).process()}}class DeleteSwarmHandler extends l.AbstractFlow{constructor(e){super(e),this._info=e.content.info}async process(){await this._intakeDetails(),await this._abortPlaySegments(),await this._deleteSwarmLauncher(),await this._deleteSwarmLaunchers()}_intakeDetails(){var e=[...this._info.details.values()];this._expose(p.FlowKey.DETAILS,e)}async _abortPlaySegments(){var e=this._require(p.FlowKey.DETAILS).flatMap((e=>[...e.playSegments.values()]));await Promise.all(e.map((e=>b.FileSeekerHolder.abort(e))))}async _deleteSwarmLauncher(){var e=this._require(p.FlowKey.DETAILS).filter((e=>null!=e.playManifest)).map((e=>e.playManifest.id));await Promise.all(e.map((e=>T.SwarmManagerHolder.deregister(e))))}async _deleteSwarmLaunchers(){var e=this._require(p.FlowKey.DETAILS).flatMap((e=>[...e.manifests.keys()]));await Promise.all(e.map((e=>T.SwarmManagerHolder.deregister(e))))}static async process(e){await new DeleteSwarmHandler({content:e}).process()}}},2230:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HLSSWClientOwner=t.HLSSWClient=void 0;const n=s(2016),a=s(287),o=s(7464),c=s(922),u=s(545),l=s(4417),d=s(8055),h=s(6102),_=s(3107),p=s(5202),f=s(5155);class HLSSWClient extends h.DriverExtensionMixin{constructor(){super(...arguments),this._isActive=!1}start(){this._isActive||(null==this._scriptPath?console.warn("[MLYSDK]","SWClient:","Script path is not set."):(this._start(),this._isActive=!0))}_start(){this._setupWorker(),this._bindEvents()}get _scriptPath(){return this._driver.settings.swproxy.scriptPath}get _scriptScope(){return this._driver.settings.swproxy.scriptScope}_setupWorker(){self.navigator.serviceWorker.register(this._scriptPath,{scope:this._scriptScope}).catch((async e=>{console.warn("[MLYSDK]","SWClient:","Register swproxy failed.",e)}))}_bindEvents(){self.navigator.serviceWorker.addEventListener("message",(async e=>{await this._onMessage(e)})),self.navigator.serviceWorker.addEventListener("messageerror",(async e=>{await this._onMessageError(e)}))}async _onMessage(e){await new HLSSWURLRetriever(e).fetch()}async _onMessageError(e){a.Logger.debug("SWClient message error event.",{event:e})}}t.HLSSWClient=HLSSWClient;class HLSSWURLRetriever extends h.DriverExtensionMixin{constructor(e){super(),this._proxy=new f.HLSLoaderProxy,this._event=e}async fetch(){try{await this._recordEvent(),await this._intakeRequest(),await this._bypassFetch(),await this._intakeResponse(),await this._forwardResponse()}catch(e){await this._recordError(e),await this._intakeError(e),await this._forwardError()}}async _recordEvent(){var e=this._event.data;a.Logger.track("SWClient bypass fetch.",{payload:e})}async _intakeRequest(){var e=this._event.data;if(e.action!==_.SWProxyActionName.REQUEST_BYPASS_FETCH)throw new n.InternalError(o.MessageCode.WSV001,void 0,{payload:e});this._request=e}async _bypassFetch(){if(this._driver.isDeinitialized)await this._nativeFetch();else try{await this._applySystem(),await this._proxyFetch()}catch(e){await this._nativeFetch()}}async _applySystem(){await d.SystemBooterHolder.available()}async _proxyFetch(){this._resource=await this._proxy.fetch(this._request.content.uri)}async _nativeFetch(){var e=new u.Resource(this._request.content.uri);await new HLSSWURLDownloaderProxy(e).fetch(),this._resource=e}async _intakeResponse(){var e=this._request,t=this._resource;this._response={action:_.SWProxyActionName.RESPOND_BYPASS_FETCH,header:{...e.header,response_code:1200,response_status:!0,response_message:"success"},content:{uri:e.content.uri,type:t.type,buffer:t.content}}}async _forwardResponse(){this._event.ports[0].postMessage(this._response)}async _recordError(e){var t=this._event.data;a.Logger.debug("SWClient bypass failed.",{payload:t},{error:e})}async _intakeError(e){var t=this._event.data,[t,s]=[t.header.correlation_id,t.header.source_client_id];this._exception=new p.SWProxyErrorMessageCreator(t,e,s).payload}async _forwardError(){this._event.ports[0].postMessage(this._exception)}}class HLSSWURLDownloaderProxy extends l.AbstractHttpDownloaderProxy{constructor(e){super(e),this._resource=e}async _setup(){await this._buildRequestURI()}async _buildRequestURI(){var e=new URL(this._resource.uri);e.searchParams.set(c.QueryStringKey.VIA_MLYSDK,"1"),this._requestURI=e.href}}class HLSSWClientOwner extends h.DriverExtensionMixin{static create(){return this._driver.extend(HLSSWClient,HLSSWURLRetriever),null==this._client&&(this._client=new HLSSWClient,this._client.start()),this._client}}(t.HLSSWClientOwner=HLSSWClientOwner)._isPublic=!0,HLSSWClientOwner._publicName="HLSSWClientOwner"},9612:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MeteringRequester=t.CDNScoreRequester=t.TokenRequester=t.HostRequester=t.API=void 0;const a=n(s(6486)),o=s(2065),c=s(964),u=s(1744);t.API=class API{static get host(){return this._host}static set host(e){this._host=e}static get token(){return this._token}static set token(e){this._token=e}static get cdnScore(){return this._cdnScore}static set cdnScore(e){this._cdnScore=e}static get metering(){return this._metering}static set metering(e){this._metering=e}};class HostRequester extends c.Requester{constructor(e){super(a.default.merge({},e,{defaults:{host:u.kernelSettings.server.host.fqdn,backoffOptions:{delayerOptions:{baseInterval:.1,multiplier:1.5,maxInterval:1,maxAttempts:3}}}}))}async readHosts(){return this.get("/host.json")}}t.HostRequester=HostRequester;class TokenRequester extends c.Requester{constructor(e){super(a.default.merge({},e,{defaults:{host:u.kernelSettings.server.token.fqdn,backoffOptions:{delayerOptions:{baseInterval:.1,multiplier:1.5,maxInterval:1,maxAttempts:3}}}}))}async readToken(e){return this.get("/token/jwt/",{headers:{origin:e.origin,nonce:e.nonce,signature:e.signature},queries:{client_id:e.clientID}})}async renewToken(e){return this.get("/token/jwt/renew/",{headers:{origin:e.origin,nonce:e.nonce,signature:e.signature,authorization:"token "+e.token},queries:{client_id:e.clientID}})}}t.TokenRequester=TokenRequester;class CDNScoreRequester extends c.Requester{constructor(e){super(a.default.merge({},e,{defaults:{host:u.kernelSettings.server.cdnScore.fqdn,backoffOptions:{delayerOptions:{baseInterval:.1,multiplier:1.5,maxInterval:1,maxAttempts:3}}}}))}async readPlatformScores(e){return this.get(`/scorer/algorithms/${e.algorithmID}/scores/`,{queries:{"platforms[]":e.platformIDs,stream_id:u.kernelSettings.stream.streamID}})}}t.CDNScoreRequester=CDNScoreRequester;class MeteringRequester extends c.Requester{constructor(e){super(a.default.merge({},e,{defaults:{host:u.kernelSettings.server.metering.fqdn}}))}async createCDNDownloadAggregation(e){await this.get("/client-metering/",{queries:{data:o.JSONTool.dumps(e.data)}})}async createP2PDownloadAggregation(e){await this.get("/client-p2p-metering/",{queries:{data:o.JSONTool.dumps(e.data)}})}}t.MeteringRequester=MeteringRequester},9991:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),a(s(6575),t)},6575:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MeteringAPICreateP2PDownloadAggregationHandler=t.MeteringAPICreateCDNDownloadAggregationHandler=t.CDNScoreAPIReadPlatformScoresHandler=t.TokenAPIRenewTokenHandler=t.TokenAPIReadTokenHandler=t.HostAPIReadHostsHandler=void 0;const n=s(2064),a=s(3267),o=s(1744),c=s(3897),u=s(9612);class HostAPIReadHostsHandler extends a.AbstractFlow{async process(){return await this._intakeResult(),await this._intakeOutcome(),this._outcome}async _intakeResult(){var e=await u.API.host.readHosts();await this._expose(c.FlowKey.RESULT,e.result)}async _intakeOutcome(){var e=this._require(c.FlowKey.RESULT);this._outcome={token:e.token,cdnScore:e.score,metering:e.metering,tracker:e.websocket}}static async process(){return(new HostAPIReadHostsHandler).process()}}t.HostAPIReadHostsHandler=HostAPIReadHostsHandler;class TokenAPIReadTokenHandler extends a.AbstractFlow{async process(){return await this._intakeNonce(),await this._intakeSignature(),await this._intakeResult(),await this._intakeOutcome(),this._outcome}async _intakeNonce(){var e=Math.floor(Date.now()/1e3);await this._expose(c.FlowKey.NONCE,e)}async _intakeSignature(){var e=o.kernelSettings.client.id,t=o.kernelSettings.client.key,s=o.kernelSettings.client.origin,n=this._require(c.FlowKey.NONCE);n=this._makeBase16Hash(""+n),s=this._makeBase16Hash(""+s+e+n),e=this._makeBase64URLHash(""+t+s);await this._expose(c.FlowKey.SIGNATURE,e)}_makeBase16Hash(e){return n.HashTool.makeSHA256Base16String(e).toLowerCase()}_makeBase64URLHash(e){return n.HashTool.makeSHA256Base64URLString(e)}async _intakeResult(){var e=o.kernelSettings.client.id,t=o.kernelSettings.client.origin,s=this._require(c.FlowKey.NONCE),n=this._require(c.FlowKey.SIGNATURE);e=await u.API.token.readToken({clientID:e,origin:t,nonce:s,signature:n});await this._expose(c.FlowKey.RESULT,e.result)}async _intakeOutcome(){var e=this._require(c.FlowKey.RESULT);this._outcome={token:e.data.token,peerID:e.data.peer_id}}static async process(){return(new TokenAPIReadTokenHandler).process()}}class TokenAPIRenewTokenHandler extends(t.TokenAPIReadTokenHandler=TokenAPIReadTokenHandler){async _intakeResult(){var e=o.kernelSettings.client.id,t=o.kernelSettings.client.origin,s=this._require(c.FlowKey.NONCE),n=this._require(c.FlowKey.SIGNATURE),a=o.kernelSettings.client.token;e=await u.API.token.renewToken({clientID:e,origin:t,nonce:s,signature:n,token:a});await this._expose(c.FlowKey.RESULT,e.result)}static async process(){return(new TokenAPIRenewTokenHandler).process()}}t.TokenAPIRenewTokenHandler=TokenAPIRenewTokenHandler;class CDNScoreAPIReadPlatformScoresHandler extends a.AbstractFlow{async process(){return await this._intakeResult(),await this._intakeOutcome(),this._outcome}async _intakeResult(){var e=this._content.algorithmID,t=this._content.platformIDs;e=await u.API.cdnScore.readPlatformScores({algorithmID:e,platformIDs:t});await this._expose(c.FlowKey.RESULT,e.result)}async _intakeOutcome(){var e=this._require(c.FlowKey.RESULT);this._outcome={platforms:e.data.scores.map((e=>({id:e.platform_id,score:e.score})))}}static async process(e){return new CDNScoreAPIReadPlatformScoresHandler({content:e}).process()}}t.CDNScoreAPIReadPlatformScoresHandler=CDNScoreAPIReadPlatformScoresHandler;class MeteringAPICreateCDNDownloadAggregationHandler extends a.AbstractFlow{async process(){await this._intakeData(),await this._forwardData()}async _intakeData(){var e={data:this._content.reports.map((e=>({time:e.time/1e3,orgID:o.kernelSettings.client.accountID,streamID:o.kernelSettings.stream.streamID,platformID:e.platformID,platformType:e.platformType,transferSize:e.transferSize,successCount:e.successCount,failureCount:e.failureCount})))};await this._expose(c.FlowKey.DATA,e)}async _forwardData(){var e=this._require(c.FlowKey.DATA);await u.API.metering.createCDNDownloadAggregation({data:e})}static async process(e){await new MeteringAPICreateCDNDownloadAggregationHandler({content:e}).process()}}t.MeteringAPICreateCDNDownloadAggregationHandler=MeteringAPICreateCDNDownloadAggregationHandler;class MeteringAPICreateP2PDownloadAggregationHandler extends a.AbstractFlow{async process(){await this._intakeData(),await this._forwardData()}async _intakeData(){var e={data:this._content.reports.map((e=>({time:e.time/1e3,orgID:o.kernelSettings.client.accountID,streamID:o.kernelSettings.stream.streamID,targetPeerID:e.targetPeerID,targetPeerType:e.targetPeerType,transferSize:e.transferSize,successCount:e.successCount,failureCount:e.failureCount})))};await this._expose(c.FlowKey.DATA,e)}async _forwardData(){var e=this._require(c.FlowKey.DATA);await u.API.metering.createP2PDownloadAggregation({data:e})}static async process(e){await new MeteringAPICreateP2PDownloadAggregationHandler({content:e}).process()}}t.MeteringAPICreateP2PDownloadAggregationHandler=MeteringAPICreateP2PDownloadAggregationHandler},2559:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kernelGettings=t.KernelGettings=void 0;const n=s(5309),a=s(1744);const o=new(t.KernelGettings=class KernelGettings{get isSystemP2PMode(){return n.systemP2PModes.has(a.kernelSettings.system.mode)}get isSystemP2SMode(){return n.systemP2SModes.has(a.kernelSettings.system.mode)}});t.kernelGettings=o},1744:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kernelSettings=void 0;const n={logger:{level:s(287).LogLevelName.ERROR},webrtc:{options:{iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun.1und1.de:3478"]}]}},client:{id:void 0,key:void 0,token:void 0,origin:void 0,peerID:void 0,accountID:void 0,sessionID:void 0},server:{host:{fqdn:"vsp.mlytics.com",version:"v1"},token:{fqdn:void 0,version:"v1"},cdnScore:{fqdn:void 0,version:"v1"},metering:{fqdn:void 0,version:"v1"},tracker:{fqdns:void 0,version:"v1"}},system:{mode:void 0,isP2PAllowed:!0},stream:{streamID:void 0,streamType:void 0,maxBufferSize:20,minBufferTime:3,maxBufferTime:30},swproxy:{scriptPath:void 0,scriptScope:"./"},monitor:{muxEnvKey:void 0,muxSampleRate:1,isMuxEnabled:!0},download:{maxCacheItems:200,maxP2PPossibility:.9,httpResponseTimeout:3}};t.kernelSettings=n},7464:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageCodeObject=t.MessageCode=t.StatusCodes=void 0;const n=s(4239);Object.defineProperty(t,"MessageCodeObject",{enumerable:!0,get:function(){return n.MessageCodeObject}}),Object.defineProperty(t,"StatusCodes",{enumerable:!0,get:function(){return n.StatusCodes}});class MessageCode extends n.MessageCode{}(t.MessageCode=MessageCode).ESC000=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESC000","550","Kernel core: Internal error.","File request has been aborted."),MessageCode.ESC001=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESC001","550","Kernel core: Internal error.","File downloader has been aborted."),MessageCode.ESC010=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESC010","550","Kernel core: Internal error.","HTTP downloader proxy request failed."),MessageCode.ESC011=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESC011","550","Kernel core: Internal error.","HTTP downloader proxy cannot handle the response."),MessageCode.ESC012=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESC012","550","Kernel core: Internal error.","MCDN downloader proxy is not available within start delay."),MessageCode.ESC020=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESC020","550","Kernel core: Internal error.","Node downloader proxy cannot fetch available node daemon."),MessageCode.ESC021=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESC021","550","Kernel core: Internal error.","Node downloader proxy is detected with no progress."),MessageCode.ESC030=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESC030","550","Kernel core: Internal error.","User downloader proxy cannot handle the unshareable resource."),MessageCode.ESC031=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESC031","550","Kernel core: Internal error.","User downloader proxy cannot handle the urgent resource."),MessageCode.ESC032=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESC032","550","Kernel core: Internal error.","User downloader proxy is not chosen this time."),MessageCode.ESC033=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESC033","550","Kernel core: Internal error.","User downloader proxy cannot fetch available user daemon."),MessageCode.ESC034=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESC034","550","Kernel core: Internal error.","User downloader proxy is detected with no progress."),MessageCode.ISP200=new n.MessageCodeObject(n.StatusCodes.OK,"ISP200","200","Kernel protocol: OK.","OK."),MessageCode.ESP000=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESP000","560","Kernel protocol: External API error.","An error response is received."),MessageCode.ESP001=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESP001","562","Kernel protocol: Internal error.","An error occurrs while processing a request."),MessageCode.ESP010=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESP010","560","Kernel protocol: Internal error.","Peer broker cannot be found."),MessageCode.ESP011=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESP011","560","Kernel protocol: Internal error.","Node broker cannot be found."),MessageCode.ESP012=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESP012","560","Kernel protocol: Internal error.","Tracker broker cannot be found."),MessageCode.WSP020=new n.MessageCodeObject(n.StatusCodes.BAD_REQUEST,"WSP020","561","Kernel protocol: Invalid parameter.","Resource cache cannot be found."),MessageCode.ESS000=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESS000","570","Kernel service: Internal error.","Peer broker has been closed."),MessageCode.ESS001=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESS001","570","Kernel service: Internal error.","Peer daemon has exited."),MessageCode.WSS002=new n.MessageCodeObject(n.StatusCodes.BAD_REQUEST,"WSS002","571","Kernel service: Invalid parameter.","Peer daemon cannot handle the action."),MessageCode.ESS003=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESS003","570","Kernel service: Internal error.","Peer daemon cannot handle the command."),MessageCode.ESS005=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESS005","572","Kernel service: Internal error.","User manager has reached max peer connections."),MessageCode.ESS006=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESS006","572","Kernel service: Internal error.","User manager rejects a peer which has failed."),MessageCode.ESS007=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESS007","572","Kernel service: Internal error.","User manager rejects a peer which is in use."),MessageCode.ESS010=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESS010","570","Kernel service: Internal error.","Swarm daemon cannot be found."),MessageCode.ESS011=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESS011","570","Kernel service: Internal error.","Swarm daemon cannot handle the command."),MessageCode.ESS020=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESS020","570","Kernel service: Internal error.","Tracker broker has been closed."),MessageCode.ESS021=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESS021","570","Kernel service: Internal error.","Tracker daemon has exited."),MessageCode.ESS022=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESS022","570","Kernel service: Internal error.","Tracker launcher cannot handle the feedback."),MessageCode.ESB000=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESB000","450","System booter: Internal error.","System component activate failed."),MessageCode.WSB010=new n.MessageCodeObject(n.StatusCodes.BAD_REQUEST,"WSB010","451","System booter: Invalid parameter.","Kernel parameters cannot be validated successfully."),MessageCode.ESV000=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESV000","621","Driver integration: External API error.","SW proxy receives an error response."),MessageCode.WSV001=new n.MessageCodeObject(n.StatusCodes.BAD_REQUEST,"WSV001","620","Driver integration: Invalid parameter.","SW proxy cannot handle the action."),MessageCode.ESV002=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESV002","621","Driver integration: Internal error.","SW proxy encounters an error while processing a request."),MessageCode.WSV010=new n.MessageCodeObject(n.StatusCodes.BAD_REQUEST,"WSV010","620","Driver integration: Invalid parameter.","SW server cannot proxy a client which has gone offline."),MessageCode.ESV011=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESV011","621","Driver integration: Internal error.","SW server bypass fetch timeout exceeded."),MessageCode.ESV012=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESV012","621","Driver integration: Internal error.","SW server receives a message error event."),MessageCode.WSV050=new n.MessageCodeObject(n.StatusCodes.BAD_REQUEST,"WSV050","620","Driver integration: Invalid parameter.","HLS loader cannot handle the response type."),MessageCode.ESV051=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESV051","621","Driver integration: Internal error.","HLS controller cannot buffer a play segment which is aborted."),MessageCode.ESV100=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESV100","650","Driver peripheral: Internal error.","Player plugin method has never been implemented."),MessageCode.ESV110=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESV110","650","Driver peripheral: Internal error.","Video.js source plugin method has never been implemented."),MessageCode.ESV111=new n.MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"ESV111","650","Driver peripheral: Internal error.","Video.js source handler method has never been implemented.")},3897:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlowKey=void 0;class FlowKey{}(t.FlowKey=FlowKey).META="meta",FlowKey.DATA="data",FlowKey.CONFIG="config",FlowKey.RESULT="result",FlowKey.DETAIL="detail",FlowKey.DETAILS="details",FlowKey.STAT="stat",FlowKey.STATS="stats",FlowKey.RECORD="record",FlowKey.METRICS="metrics",FlowKey.ID="id",FlowKey.INDEX="index",FlowKey.NONCE="nonce",FlowKey.THRESHOLD="threshold",FlowKey.SIGNATURE="signature",FlowKey.DAEMON="daemon",FlowKey.MANAGER="manager",FlowKey.MESSAGE="message",FlowKey.PAYLOAD="payload",FlowKey.REQUEST="request",FlowKey.RESPONSE="response",FlowKey.CREATOR="creator",FlowKey.OFFER="offer",FlowKey.ANSWER="answer",FlowKey.CANDIDATE="candidate",FlowKey.PEER_ID="peer_id",FlowKey.NODE_ID="node_id",FlowKey.RESOURCE="resource",FlowKey.FRAGMENT="fragment",FlowKey.PLAYLIST="playlist",FlowKey.SEGMENTS="segments",FlowKey.SEGMENT_IDS="segment_ids",FlowKey.MEASURES="measures"},7926:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DaemonID=t.BrokerID=void 0;class BrokerID{}(t.BrokerID=BrokerID).NODE="node",BrokerID.TRACKER="tracker";(t.DaemonID=class DaemonID{}).NODE="node"},922:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryStringKey=t.DomainType=t.DomainKind=void 0;class DomainKind{}(t.DomainKind=DomainKind).CDN="cdn",DomainKind.ORIGIN="origin";class DomainType{}(t.DomainType=DomainType).MANAGED="MAN",DomainType.CUSTOM="BYO",DomainType.ORIGIN="ORIGIN",DomainType.FALLBACK="FALLBACK";(t.QueryStringKey=class QueryStringKey{}).VIA_MLYSDK="via_mlysdk"},9282:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PeerType=void 0;class PeerType{}(t.PeerType=PeerType).USER="user",PeerType.NODE="node"},2060:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceConstant=t.WebRTCConstant=void 0;(t.WebRTCConstant=class WebRTCConstant{}).DATACHANNEL_CHUNK_SIZE=122880;(t.ResourceConstant=class ResourceConstant{}).URGENT_THRESHOLD_PRIORITY=1},5309:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.systemP2PFallbackModes=t.systemP2SModes=t.systemP2PModes=t.SystemModeName=void 0;class SystemModeName{}(t.SystemModeName=SystemModeName).MCDN_ONLY="mcdn_only",SystemModeName.P2P_MCDN="p2p_mcdn",SystemModeName.P2P_P2S="p2p_p2s",SystemModeName.P2S_ONLY="p2s_only";const s=new Set([SystemModeName.P2P_MCDN,SystemModeName.P2P_P2S]),n=(t.systemP2PModes=s,new Set([SystemModeName.P2P_P2S,SystemModeName.P2S_ONLY])),a=(t.systemP2SModes=n,new Map([[SystemModeName.P2P_MCDN,SystemModeName.MCDN_ONLY],[SystemModeName.P2P_P2S,SystemModeName.P2S_ONLY]]));t.systemP2PFallbackModes=a},5227:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsCollectorHolder=t.MetricsCollectorEvent=t.MetricsCollector=void 0;const a=n(s(148)),o=s(4944),c=s(3267),u=s(3897),l=s(4770),d=s(4916),h=s(1032),_=s(6123),p=s(5471);class MetricsCollector extends a.default{constructor(){super(...arguments),this._taskManager=new o.TaskManager}async activate(){await this._taskManager.activate(),await this._bindEvents(),await this._buildTasks()}async deactivate(){await this._taskManager.deactivate(),await this.clearListeners()}async _bindEvents(){await this.on(MetricsCollectorEvent.HTTP_DOWNLOAD_RECORD,(async e=>{await HTTPDownloadRecordHandler.process(e)})),await this.on(MetricsCollectorEvent.CDN_CONFIG_RECORDS,(async e=>{await CDNConfigRecordsHandler.process(e)})),await this.on(MetricsCollectorEvent.CDN_DOWNLOAD_RECORD,(async e=>{await CDNDownloadRecordHandler.process(e)})),await this.on(MetricsCollectorEvent.P2P_DOWNLOAD_RECORD,(async e=>{await P2PDownloadRecordHandler.process(e)})),await this.on(MetricsCollectorEvent.TRACKER_STATE_RECORD,(async e=>{await TrackerStateRecordHandler.process(e)})),await this.on(MetricsCollectorEvent.NODE_STATE_RECORD,(async e=>{await NodeStateRecordHandler.process(e)})),await this.on(MetricsCollectorEvent.SWARM_STATE_RECORD,(async e=>{await SwarmStateRecordHandler.process(e)})),await this.on(MetricsCollectorEvent.USER_STATE_RECORD,(async e=>{await UserStateRecordHandler.process(e)})),await this.on(MetricsCollectorEvent.PURGE_CDN_RECORDS,(async e=>{await PurgeCDNRecordsHandler.process(e)}))}async _buildTasks(){await this._buildHandleHTTPDownloadPulseTrafficTask(),await this._buildHandleHTTPDownloadCumulativeTrafficTask(),await this._buildHandleHTTPDownloadWMABandwidthTask(),await this._buildHandleHTTPDownloadUsagePulseCountTask(),await this._buildHandleHTTPDownloadUsageCumulativeCountTask(),await this._buildHandleHTTPDownloadSuccessPulseCountTask(),await this._buildHandleHTTPDownloadSuccessCumulativeCountTask(),await this._buildHandleHTTPDownloadFailurePulseCountTask(),await this._buildHandleHTTPDownloadFailureCumulativeCountTask(),await this._buildHandleCDNDownloadLastMeanBandwidthTask(),await this._buildHandleCDNDownloadLastMeanAvailabilityTask(),await this._buildHandleCDNDownloadLastCurrentScoreTask(),await this._buildHandleP2PDownloadPulseTrafficTask(),await this._buildHandleP2PDownloadCumulativeTrafficTask(),await this._buildHandleP2PDownloadWMABandwidthTask(),await this._buildHandleP2PDownloadUsagePulseCountTask(),await this._buildHandleP2PDownloadUsageCumulativeCountTask(),await this._buildHandlePruneMetricsStatsTask()}async _buildHandleHTTPDownloadPulseTrafficTask(){await this._taskManager.createCyclicTask(new HTTPDownloadPulseTrafficDuty({name:MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_PULSE_TRAFFIC,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleHTTPDownloadCumulativeTrafficTask(){await this._taskManager.createCyclicTask(new HTTPDownloadCumulativeTrafficDuty({name:MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_CUMULATIVE_TRAFFIC,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleHTTPDownloadWMABandwidthTask(){await this._taskManager.createCyclicTask(new HTTPDownloadWMABandwidthDuty({name:MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_WMA_BANDWIDTH,sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleHTTPDownloadUsagePulseCountTask(){await this._taskManager.createCyclicTask(new HTTPDownloadUsagePulseCountDuty({name:MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_USAGE_PULSE_COUNT,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleHTTPDownloadUsageCumulativeCountTask(){await this._taskManager.createCyclicTask(new HTTPDownloadUsageCumulativeCountDuty({name:MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_USAGE_CUMULATIVE_COUNT,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleHTTPDownloadSuccessPulseCountTask(){await this._taskManager.createCyclicTask(new HTTPDownloadSuccessPulseCountDuty({name:MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_SUCCESS_PULSE_COUNT,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleHTTPDownloadSuccessCumulativeCountTask(){await this._taskManager.createCyclicTask(new HTTPDownloadSuccessCumulativeCountDuty({name:MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_SUCCESS_CUMULATIVE_COUNT,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleHTTPDownloadFailurePulseCountTask(){await this._taskManager.createCyclicTask(new HTTPDownloadFailurePulseCountDuty({name:MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_FAILURE_PULSE_COUNT,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleHTTPDownloadFailureCumulativeCountTask(){await this._taskManager.createCyclicTask(new HTTPDownloadFailureCumulativeCountDuty({name:MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_FAILURE_CUMULATIVE_COUNT,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleCDNDownloadLastMeanBandwidthTask(){await this._taskManager.createCyclicTask(new CDNDownloadLastMeanBandwidthDuty({name:MetricsCollectorTaskName.HANDLE_CDN_DOWNLOAD_LAST_MEAN_BANDWIDTH,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleCDNDownloadLastMeanAvailabilityTask(){await this._taskManager.createCyclicTask(new CDNDownloadLastMeanAvailabilityDuty({name:MetricsCollectorTaskName.HANDLE_CDN_DOWNLOAD_LAST_MEAN_AVAILABILITY,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleCDNDownloadLastCurrentScoreTask(){await this._taskManager.createCyclicTask(new CDNDownloadLastCurrentScoreDuty({name:MetricsCollectorTaskName.HANDLE_CDN_DOWNLOAD_LAST_CURRENT_SCORE,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleP2PDownloadPulseTrafficTask(){await this._taskManager.createCyclicTask(new P2PDownloadPulseTrafficDuty({name:MetricsCollectorTaskName.HANDLE_P2P_DOWNLOAD_PULSE_TRAFFIC,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleP2PDownloadCumulativeTrafficTask(){await this._taskManager.createCyclicTask(new P2PDownloadCumulativeTrafficDuty({name:MetricsCollectorTaskName.HANDLE_P2P_DOWNLOAD_CUMULATIVE_TRAFFIC,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleP2PDownloadWMABandwidthTask(){await this._taskManager.createCyclicTask(new P2PDownloadWMABandwidthDuty({name:MetricsCollectorTaskName.HANDLE_P2P_DOWNLOAD_WMA_BANDWIDTH,sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleP2PDownloadUsagePulseCountTask(){await this._taskManager.createCyclicTask(new P2PDownloadUsagePulseCountDuty({name:MetricsCollectorTaskName.HANDLE_P2P_DOWNLOAD_USAGE_PULSE_COUNT,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleP2PDownloadUsageCumulativeCountTask(){await this._taskManager.createCyclicTask(new P2PDownloadUsageCumulativeCountDuty({name:MetricsCollectorTaskName.HANDLE_P2P_DOWNLOAD_USAGE_CUMULATIVE_COUNT,content:{cursors:new Map},sleepFirst:!0,sleepSeconds:3,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandlePruneMetricsStatsTask(){await this._taskManager.createCyclicTask(new PruneMetricsStatsDuty({name:MetricsCollectorTaskName.HANDLE_PRUNE_METRICS_STATS,sleepFirst:!0,sleepSeconds:10,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}}t.MetricsCollector=MetricsCollector;class MetricsCollectorEvent{}(t.MetricsCollectorEvent=MetricsCollectorEvent).HTTP_DOWNLOAD_RECORD="http_download_record",MetricsCollectorEvent.CDN_CONFIG_RECORDS="cdn_config_records",MetricsCollectorEvent.CDN_DOWNLOAD_RECORD="cdn_download_record",MetricsCollectorEvent.P2P_DOWNLOAD_RECORD="p2p_download_record",MetricsCollectorEvent.TRACKER_STATE_RECORD="tracker_state_record",MetricsCollectorEvent.NODE_STATE_RECORD="node_state_record",MetricsCollectorEvent.SWARM_STATE_RECORD="swarm_state_record",MetricsCollectorEvent.USER_STATE_RECORD="user_state_record",MetricsCollectorEvent.PURGE_CDN_RECORDS="purge_cdn_records";class MetricsCollectorTaskName{}MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_PULSE_TRAFFIC="metrics collector: handle http download pulse traffic",MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_CUMULATIVE_TRAFFIC="metrics collector: handle http download cumulative traffic",MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_WMA_BANDWIDTH="metrics collector: handle http download wma bandwidth",MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_USAGE_PULSE_COUNT="metrics collector: handle http download usage pulse count",MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_USAGE_CUMULATIVE_COUNT="metrics collector: handle http download usage cumulative count",MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_SUCCESS_PULSE_COUNT="metrics collector: handle http download success pulse count",MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_SUCCESS_CUMULATIVE_COUNT="metrics collector: handle http download success cumulative count",MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_FAILURE_PULSE_COUNT="metrics collector: handle http download failure pulse count",MetricsCollectorTaskName.HANDLE_HTTP_DOWNLOAD_FAILURE_CUMULATIVE_COUNT="metrics collector: handle http download failure cumulative count",MetricsCollectorTaskName.HANDLE_CDN_DOWNLOAD_LAST_MEAN_BANDWIDTH="metrics collector: handle cdn download last mean bandwidth",MetricsCollectorTaskName.HANDLE_CDN_DOWNLOAD_LAST_MEAN_AVAILABILITY="metrics collector: handle cdn download last mean availability",MetricsCollectorTaskName.HANDLE_CDN_DOWNLOAD_LAST_CURRENT_SCORE="metrics collector: handle cdn download last current score",MetricsCollectorTaskName.HANDLE_P2P_DOWNLOAD_PULSE_TRAFFIC="metrics collector: handle p2p download pulse traffic",MetricsCollectorTaskName.HANDLE_P2P_DOWNLOAD_CUMULATIVE_TRAFFIC="metrics collector: handle p2p download cumulative traffic",MetricsCollectorTaskName.HANDLE_P2P_DOWNLOAD_WMA_BANDWIDTH="metrics collector: handle p2p download wma bandwidth",MetricsCollectorTaskName.HANDLE_P2P_DOWNLOAD_USAGE_PULSE_COUNT="metrics collector: handle p2p download usage pulse count",MetricsCollectorTaskName.HANDLE_P2P_DOWNLOAD_USAGE_CUMULATIVE_COUNT="metrics collector: handle p2p download usage cumulative count",MetricsCollectorTaskName.HANDLE_PRUNE_METRICS_STATS="metrics collector: handle prune metrics stats";class HTTPDownloadPulseTrafficDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await HTTPDownloadPulseTrafficHandler.process(this._options.content)}}class HTTPDownloadCumulativeTrafficDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await HTTPDownloadCumulativeTrafficHandler.process(this._options.content)}}class HTTPDownloadWMABandwidthDuty extends o.CyclicDuty{async callee(){await HTTPDownloadWMABandwidthHandler.process()}}class HTTPDownloadUsagePulseCountDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await HTTPDownloadUsagePulseCountHandler.process(this._options.content)}}class HTTPDownloadUsageCumulativeCountDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await HTTPDownloadUsageCumulativeCountHandler.process(this._options.content)}}class HTTPDownloadSuccessPulseCountDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await HTTPDownloadSuccessPulseCountHandler.process(this._options.content)}}class HTTPDownloadSuccessCumulativeCountDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await HTTPDownloadSuccessCumulativeCountHandler.process(this._options.content)}}class HTTPDownloadFailurePulseCountDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await HTTPDownloadFailurePulseCountHandler.process(this._options.content)}}class HTTPDownloadFailureCumulativeCountDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await HTTPDownloadFailureCumulativeCountHandler.process(this._options.content)}}class CDNDownloadLastMeanBandwidthDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await CDNDownloadLastMeanBandwidthHandler.process(this._options.content)}}class CDNDownloadLastMeanAvailabilityDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await CDNDownloadLastMeanAvailabilityHandler.process(this._options.content)}}class CDNDownloadLastCurrentScoreDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await CDNDownloadLastCurrentScoreHandler.process(this._options.content)}}class P2PDownloadPulseTrafficDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await P2PDownloadPulseTrafficHandler.process(this._options.content)}}class P2PDownloadCumulativeTrafficDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await P2PDownloadCumulativeTrafficHandler.process(this._options.content)}}class P2PDownloadWMABandwidthDuty extends o.CyclicDuty{async callee(){await P2PDownloadWMABandwidthHandler.process()}}class P2PDownloadUsagePulseCountDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await P2PDownloadUsagePulseCountHandler.process(this._options.content)}}class P2PDownloadUsageCumulativeCountDuty extends o.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await P2PDownloadUsageCumulativeCountHandler.process(this._options.content)}}class PruneMetricsStatsDuty extends o.CyclicDuty{async callee(){await PruneMetricsStatsHandler.process()}}class HTTPDownloadRecordHandler extends c.AbstractFlow{async process(){await this._intakeMetrics(),await this._updateMetrics(),await this._exportMetrics()}async _intakeMetrics(){var e=this._content;let t;t=e.id?p.MetricsStatsHolder.cdns[e.id]:p.MetricsStatsHolder.origin,await this._expose(u.FlowKey.METRICS,t)}async _updateMetrics(){var e=this._content,t=this._require(u.FlowKey.METRICS);await t.download.count.usage.dataset.push({ctime:e.ctime,value:1}),e.isSuccess?await t.download.count.success.dataset.push({ctime:e.ctime,value:1}):await t.download.count.failure.dataset.push({ctime:e.ctime,value:1}),await t.download.outcome.dataset.push({ctime:e.ctime,value:e.isSuccess?1:0}),await t.download.traffic.dataset.push({ctime:e.ctime,value:e.contentSize}),e.bandwidth&&await t.download.bandwidth.dataset.push({ctime:e.ctime,value:e.bandwidth}),await p.MetricsStatsHolder.source.http.download.records.push(e)}async _exportMetrics(){var e=this._content;await h.ExportHTTPDownloadRecordHandler.process(e)}static async process(e){await new HTTPDownloadRecordHandler({content:e}).process()}}class HTTPDownloadPulseTrafficHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeIndex(),await this._intakeData(),await this._updateMetrics()})),await this._exportMetrics()}async _iterateMetrics(e){for(const t of[...Object.values(p.MetricsStatsHolder.cdns),p.MetricsStatsHolder.origin])await this._expose(u.FlowKey.METRICS,t),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.METRICS);this._content.cursors.get(e.id)||this._content.cursors.set(e.id,{data:void 0})}async _intakeIndex(){var e=this._require(u.FlowKey.METRICS),t=this._content.cursors.get(e.id),s=e.download.traffic.dataset;let n=s.length;for(let e=s.length-1;0<=e&&s[e]!==t.data;e--)n=e;await this._expose(u.FlowKey.INDEX,n)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.INDEX),s=e.download.traffic.dataset;let n=0;for(let e=t;e<s.length;e++)n+=s[e].value;e={ctime:Date.now(),value:n},await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.DATA),s=e.download.traffic.dataset;await e.download.traffic.pulse.dataset.push(t),await this._content.cursors.set(e.id,{data:s[s.length-1]})}async _exportMetrics(){await h.ExportHTTPDownloadPulseTrafficHandler.process()}static async process(e){await new HTTPDownloadPulseTrafficHandler({content:e}).process()}}class HTTPDownloadCumulativeTrafficHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeIndex(),await this._intakeData(),await this._updateMetrics()})),await this._exportMetrics()}async _iterateMetrics(e){for(const t of[...Object.values(p.MetricsStatsHolder.cdns),p.MetricsStatsHolder.origin])await this._expose(u.FlowKey.METRICS,t),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.METRICS);this._content.cursors.get(e.id)||this._content.cursors.set(e.id,{data:void 0,value:0})}async _intakeIndex(){var e=this._require(u.FlowKey.METRICS),t=this._content.cursors.get(e.id),s=e.download.traffic.dataset;let n=s.length;for(let e=s.length-1;0<=e&&s[e]!==t.data;e--)n=e;await this._expose(u.FlowKey.INDEX,n)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.INDEX),s=this._content.cursors.get(e.id),n=e.download.traffic.dataset;let a=s.value;for(let e=t;e<n.length;e++)a+=n[e].value;e={ctime:Date.now(),value:a},await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.DATA),s=e.download.traffic.dataset;await e.download.traffic.cumulation.dataset.push(t),await this._content.cursors.set(e.id,{data:s[s.length-1],value:t.value})}async _exportMetrics(){await h.ExportHTTPDownloadCumulativeTrafficHandler.process()}static async process(e){await new HTTPDownloadCumulativeTrafficHandler({content:e}).process()}}class HTTPDownloadWMABandwidthHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._intakeData(),await this._updateMetrics()})),await this._exportMetrics()}async _iterateMetrics(e){for(const t of[...Object.values(p.MetricsStatsHolder.cdns),p.MetricsStatsHolder.origin])await this._expose(u.FlowKey.METRICS,t),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.DATA)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=Date.now();const s=t-1e3*_.MetricsConstant.DURATION_OF_WMA_DATA;e=e.download.bandwidth.dataset.filter((e=>e.ctime>=s)),await e.push({ctime:t,value:0}),t={ctime:t,value:e=d.MathCalculator.weightedAverage(e.map((e=>({offset:e.ctime-s,value:e.value}))))},await this._expose(u.FlowKey.DATA,t)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.DATA);await e.download.bandwidth.wma.dataset.push(t)}async _exportMetrics(){await h.ExportHTTPDownloadWMABandwidthHandler.process()}static async process(){await(new HTTPDownloadWMABandwidthHandler).process()}}class HTTPDownloadUsagePulseCountHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeIndex(),await this._intakeData(),await this._updateMetrics()})),await this._exportMetrics()}async _iterateMetrics(e){for(const t of[...Object.values(p.MetricsStatsHolder.cdns),p.MetricsStatsHolder.origin])await this._expose(u.FlowKey.METRICS,t),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.METRICS);this._content.cursors.get(e.id)||this._content.cursors.set(e.id,{data:void 0})}async _intakeIndex(){var e=this._require(u.FlowKey.METRICS),t=this._content.cursors.get(e.id),s=e.download.count.usage.dataset;let n=s.length;for(let e=s.length-1;0<=e&&s[e]!==t.data;e--)n=e;await this._expose(u.FlowKey.INDEX,n)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.INDEX),s=e.download.count.usage.dataset;let n=0;for(let e=t;e<s.length;e++)n+=s[e].value;e={ctime:Date.now(),value:n},await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.DATA),s=e.download.count.usage.dataset;await e.download.count.usage.pulse.dataset.push(t),await this._content.cursors.set(e.id,{data:s[s.length-1]})}async _exportMetrics(){await h.ExportHTTPDownloadUsagePulseCountHandler.process()}static async process(e){await new HTTPDownloadUsagePulseCountHandler({content:e}).process()}}class HTTPDownloadUsageCumulativeCountHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeIndex(),await this._intakeData(),await this._updateMetrics()})),await this._exportMetrics()}async _iterateMetrics(e){for(const t of[...Object.values(p.MetricsStatsHolder.cdns),p.MetricsStatsHolder.origin])await this._expose(u.FlowKey.METRICS,t),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.METRICS);this._content.cursors.get(e.id)||this._content.cursors.set(e.id,{data:void 0,value:0})}async _intakeIndex(){var e=this._require(u.FlowKey.METRICS),t=this._content.cursors.get(e.id),s=e.download.count.usage.dataset;let n=s.length;for(let e=s.length-1;0<=e&&s[e]!==t.data;e--)n=e;await this._expose(u.FlowKey.INDEX,n)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.INDEX),s=this._content.cursors.get(e.id),n=e.download.count.usage.dataset;let a=s.value;for(let e=t;e<n.length;e++)a+=n[e].value;e={ctime:Date.now(),value:a},await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.DATA),s=e.download.count.usage.dataset;await e.download.count.usage.cumulation.dataset.push(t),await this._content.cursors.set(e.id,{data:s[s.length-1],value:t.value})}async _exportMetrics(){await h.ExportHTTPDownloadUsageCumulativeCountHandler.process()}static async process(e){await new HTTPDownloadUsageCumulativeCountHandler({content:e}).process()}}class HTTPDownloadSuccessPulseCountHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeIndex(),await this._intakeData(),await this._updateMetrics()})),await this._exportMetrics()}async _iterateMetrics(e){for(const t of[...Object.values(p.MetricsStatsHolder.cdns),p.MetricsStatsHolder.origin])await this._expose(u.FlowKey.METRICS,t),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.METRICS);this._content.cursors.get(e.id)||this._content.cursors.set(e.id,{data:void 0})}async _intakeIndex(){var e=this._require(u.FlowKey.METRICS),t=this._content.cursors.get(e.id),s=e.download.count.success.dataset;let n=s.length;for(let e=s.length-1;0<=e&&s[e]!==t.data;e--)n=e;await this._expose(u.FlowKey.INDEX,n)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.INDEX),s=e.download.count.success.dataset;let n=0;for(let e=t;e<s.length;e++)n+=s[e].value;e={ctime:Date.now(),value:n},await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.DATA),s=e.download.count.success.dataset;await e.download.count.success.pulse.dataset.push(t),await this._content.cursors.set(e.id,{data:s[s.length-1]})}async _exportMetrics(){await h.ExportHTTPDownloadSuccessPulseCountHandler.process()}static async process(e){await new HTTPDownloadSuccessPulseCountHandler({content:e}).process()}}class HTTPDownloadSuccessCumulativeCountHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeIndex(),await this._intakeData(),await this._updateMetrics()})),await this._exportMetrics()}async _iterateMetrics(e){for(const t of[...Object.values(p.MetricsStatsHolder.cdns),p.MetricsStatsHolder.origin])await this._expose(u.FlowKey.METRICS,t),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.METRICS);this._content.cursors.get(e.id)||this._content.cursors.set(e.id,{data:void 0,value:0})}async _intakeIndex(){var e=this._require(u.FlowKey.METRICS),t=this._content.cursors.get(e.id),s=e.download.count.success.dataset;let n=s.length;for(let e=s.length-1;0<=e&&s[e]!==t.data;e--)n=e;await this._expose(u.FlowKey.INDEX,n)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.INDEX),s=this._content.cursors.get(e.id),n=e.download.count.success.dataset;let a=s.value;for(let e=t;e<n.length;e++)a+=n[e].value;e={ctime:Date.now(),value:a},await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.DATA),s=e.download.count.success.dataset;await e.download.count.success.cumulation.dataset.push(t),await this._content.cursors.set(e.id,{data:s[s.length-1],value:t.value})}async _exportMetrics(){await h.ExportHTTPDownloadSuccessCumulativeCountHandler.process()}static async process(e){await new HTTPDownloadSuccessCumulativeCountHandler({content:e}).process()}}class HTTPDownloadFailurePulseCountHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeIndex(),await this._intakeData(),await this._updateMetrics()})),await this._exportMetrics()}async _iterateMetrics(e){for(const t of[...Object.values(p.MetricsStatsHolder.cdns),p.MetricsStatsHolder.origin])await this._expose(u.FlowKey.METRICS,t),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.METRICS);this._content.cursors.get(e.id)||this._content.cursors.set(e.id,{data:void 0})}async _intakeIndex(){var e=this._require(u.FlowKey.METRICS),t=this._content.cursors.get(e.id),s=e.download.count.failure.dataset;let n=s.length;for(let e=s.length-1;0<=e&&s[e]!==t.data;e--)n=e;await this._expose(u.FlowKey.INDEX,n)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.INDEX),s=e.download.count.failure.dataset;let n=0;for(let e=t;e<s.length;e++)n+=s[e].value;e={ctime:Date.now(),value:n},await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.DATA),s=e.download.count.failure.dataset;await e.download.count.failure.pulse.dataset.push(t),await this._content.cursors.set(e.id,{data:s[s.length-1]})}async _exportMetrics(){await h.ExportHTTPDownloadFailurePulseCountHandler.process()}static async process(e){await new HTTPDownloadFailurePulseCountHandler({content:e}).process()}}class HTTPDownloadFailureCumulativeCountHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeIndex(),await this._intakeData(),await this._updateMetrics()})),await this._exportMetrics()}async _iterateMetrics(e){for(const t of[...Object.values(p.MetricsStatsHolder.cdns),p.MetricsStatsHolder.origin])await this._expose(u.FlowKey.METRICS,t),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.METRICS);this._content.cursors.get(e.id)||this._content.cursors.set(e.id,{data:void 0,value:0})}async _intakeIndex(){var e=this._require(u.FlowKey.METRICS),t=this._content.cursors.get(e.id),s=e.download.count.failure.dataset;let n=s.length;for(let e=s.length-1;0<=e&&s[e]!==t.data;e--)n=e;await this._expose(u.FlowKey.INDEX,n)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.INDEX),s=this._content.cursors.get(e.id),n=e.download.count.failure.dataset;let a=s.value;for(let e=t;e<n.length;e++)a+=n[e].value;e={ctime:Date.now(),value:a},await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.DATA),s=e.download.count.failure.dataset;await e.download.count.failure.cumulation.dataset.push(t),await this._content.cursors.set(e.id,{data:s[s.length-1],value:t.value})}async _exportMetrics(){await h.ExportHTTPDownloadFailureCumulativeCountHandler.process()}static async process(e){await new HTTPDownloadFailureCumulativeCountHandler({content:e}).process()}}class CDNConfigRecordsHandler extends c.AbstractFlow{async process(){await this._iterateRecords((async()=>{await this._updateMetrics()}))}async _iterateRecords(e){for(const t of this._content)await this._expose(u.FlowKey.RECORD,t),await e();await this._remove(u.FlowKey.RECORD)}async _updateMetrics(){var e=this._require(u.FlowKey.RECORD);await p.MetricsStatsHolder.setupCDN(e)}static async process(e){await new CDNConfigRecordsHandler({content:e}).process()}}class CDNDownloadRecordHandler extends c.AbstractFlow{async process(){await this._updateMetrics()}async _updateMetrics(){var e=this._content,t=p.MetricsStatsHolder.cdns[e.id];await t.download.meanBandwidth.dataset.push({ctime:e.ctime,value:e.meanBandwidth}),await t.download.meanAvailability.dataset.push({ctime:e.ctime,value:e.meanAvailability}),await t.download.currentScore.dataset.push({ctime:e.ctime,value:e.currentScore})}static async process(e){await new CDNDownloadRecordHandler({content:e}).process()}}class CDNDownloadLastMeanBandwidthHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeData(),await this._updateMetrics()})),await this._exportMetrics()}async _iterateMetrics(e){for(const t of Object.values(p.MetricsStatsHolder.cdns))await this._expose(u.FlowKey.METRICS,t),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.METRICS);this._content.cursors.get(e.id)||this._content.cursors.set(e.id,{data:void 0,value:0})}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._content.cursors.get(e.id);e=e.download.meanBandwidth.dataset,e={ctime:Date.now(),value:null!=(e=null==(e=e[e.length-1])?void 0:e.value)?e:t.value};await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.DATA),s=e.download.meanBandwidth.dataset;await e.download.meanBandwidth.last.dataset.push(t),await this._content.cursors.set(e.id,{data:s[s.length-1],value:t.value})}async _exportMetrics(){await h.ExportCDNDownloadLastMeanBandwidthHandler.process()}static async process(e){await new CDNDownloadLastMeanBandwidthHandler({content:e}).process()}}class CDNDownloadLastMeanAvailabilityHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeData(),await this._updateMetrics()})),await this._exportMetrics()}async _iterateMetrics(e){for(const t of Object.values(p.MetricsStatsHolder.cdns))await this._expose(u.FlowKey.METRICS,t),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.METRICS);this._content.cursors.get(e.id)||this._content.cursors.set(e.id,{data:void 0,value:1})}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._content.cursors.get(e.id);e=e.download.meanAvailability.dataset,e={ctime:Date.now(),value:null!=(e=null==(e=e[e.length-1])?void 0:e.value)?e:t.value};await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.DATA),s=e.download.meanAvailability.dataset;await e.download.meanAvailability.last.dataset.push(t),await this._content.cursors.set(e.id,{data:s[s.length-1],value:t.value})}async _exportMetrics(){await h.ExportCDNDownloadLastMeanAvailabilityHandler.process()}static async process(e){await new CDNDownloadLastMeanAvailabilityHandler({content:e}).process()}}class CDNDownloadLastCurrentScoreHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeData(),await this._updateMetrics()})),await this._exportMetrics()}async _iterateMetrics(e){for(const t of Object.values(p.MetricsStatsHolder.cdns))await this._expose(u.FlowKey.METRICS,t),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.METRICS);this._content.cursors.get(e.id)||this._content.cursors.set(e.id,{data:void 0,value:1})}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._content.cursors.get(e.id);e=e.download.currentScore.dataset,e={ctime:Date.now(),value:null!=(e=null==(e=e[e.length-1])?void 0:e.value)?e:t.value};await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.DATA),s=e.download.currentScore.dataset;await e.download.currentScore.last.dataset.push(t),await this._content.cursors.set(e.id,{data:s[s.length-1],value:t.value})}async _exportMetrics(){await h.ExportCDNDownloadLastCurrentScoreHandler.process()}static async process(e){await new CDNDownloadLastCurrentScoreHandler({content:e}).process()}}class P2PDownloadRecordHandler extends c.AbstractFlow{async process(){await this._updateMetrics(),await this._exportMetrics()}async _updateMetrics(){var e=this._content,t=p.MetricsStatsHolder.swarms[e.swarmID].users[e.peerID];await t.download.count.usage.dataset.push({ctime:e.ctime,value:1}),await t.download.traffic.dataset.push({ctime:e.ctime,value:e.contentSize}),e.bandwidth&&await t.download.bandwidth.dataset.push({ctime:e.ctime,value:e.bandwidth}),await p.MetricsStatsHolder.source.p2p.download.records.push(e)}async _exportMetrics(){var e=this._content;await h.ExportP2PDownloadRecordHandler.process(e)}static async process(e){await new P2PDownloadRecordHandler({content:e}).process()}}class P2PDownloadPulseTrafficHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeIndex(),await this._intakeData(),await this._updateMetrics()})),await this._cleanCursors(),await this._exportMetrics()}async _iterateMetrics(e){for(const t of Object.values(p.MetricsStatsHolder.swarms))for(const s of Object.values(t.users))await this._expose(u.FlowKey.ID,t.swarmID+"::"+s.peerID),await this._expose(u.FlowKey.METRICS,s),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.ID,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.ID);this._content.cursors.get(e)||this._content.cursors.set(e,{data:void 0})}async _intakeIndex(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.ID),s=this._content.cursors.get(t),n=e.download.traffic.dataset;let a=n.length;for(let e=n.length-1;0<=e&&n[e]!==s.data;e--)a=e;await this._expose(u.FlowKey.INDEX,a)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.INDEX),s=e.download.traffic.dataset;let n=0;for(let e=t;e<s.length;e++)n+=s[e].value;e={ctime:Date.now(),value:n},await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.ID),s=this._require(u.FlowKey.DATA),n=e.download.traffic.dataset;await e.download.traffic.pulse.dataset.push(s),await this._content.cursors.set(t,{data:n[n.length-1]})}async _cleanCursors(){for(const s of this._content.cursors.keys()){var[e,t]=s.split("::");null==(null==(e=p.MetricsStatsHolder.swarms[e])?void 0:e.users[t])&&this._content.cursors.delete(s)}}async _exportMetrics(){await h.ExportP2PDownloadPulseTrafficHandler.process()}static async process(e){await new P2PDownloadPulseTrafficHandler({content:e}).process()}}class P2PDownloadCumulativeTrafficHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeIndex(),await this._intakeData(),await this._updateMetrics()})),await this._cleanCursors(),await this._exportMetrics()}async _iterateMetrics(e){for(const t of Object.values(p.MetricsStatsHolder.swarms))for(const s of Object.values(t.users))await this._expose(u.FlowKey.ID,t.swarmID+"::"+s.peerID),await this._expose(u.FlowKey.METRICS,s),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.ID,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.ID);this._content.cursors.get(e)||this._content.cursors.set(e,{data:void 0,value:0})}async _intakeIndex(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.ID),s=this._content.cursors.get(t),n=e.download.traffic.dataset;let a=n.length;for(let e=n.length-1;0<=e&&n[e]!==s.data;e--)a=e;await this._expose(u.FlowKey.INDEX,a)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.ID),s=this._require(u.FlowKey.INDEX),n=(t=this._content.cursors.get(t),e.download.traffic.dataset);let a=t.value;for(let e=s;e<n.length;e++)a+=n[e].value;e={ctime:Date.now(),value:a},await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.ID),s=this._require(u.FlowKey.DATA),n=e.download.traffic.dataset;await e.download.traffic.cumulation.dataset.push(s),await this._content.cursors.set(t,{data:n[n.length-1],value:s.value})}async _cleanCursors(){for(const s of this._content.cursors.keys()){var[e,t]=s.split("::");null==(null==(e=p.MetricsStatsHolder.swarms[e])?void 0:e.users[t])&&this._content.cursors.delete(s)}}async _exportMetrics(){await h.ExportP2PDownloadCumulativeTrafficHandler.process()}static async process(e){await new P2PDownloadCumulativeTrafficHandler({content:e}).process()}}class P2PDownloadWMABandwidthHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._intakeData(),await this._updateMetrics()})),await this._exportMetrics()}async _iterateMetrics(e){for(const t of Object.values(p.MetricsStatsHolder.swarms))for(const s of Object.values(t.users))await this._expose(u.FlowKey.METRICS,s),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.DATA)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=Date.now();const s=t-1e3*_.MetricsConstant.DURATION_OF_WMA_DATA;e=e.download.bandwidth.dataset.filter((e=>e.ctime>=s)),await e.push({ctime:t,value:0}),t={ctime:t,value:e=d.MathCalculator.weightedAverage(e.map((e=>({offset:e.ctime-s,value:e.value}))))},await this._expose(u.FlowKey.DATA,t)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.DATA);await e.download.bandwidth.wma.dataset.push(t)}async _exportMetrics(){await h.ExportP2PDownloadWMABandwidthHandler.process()}static async process(){await(new P2PDownloadWMABandwidthHandler).process()}}class P2PDownloadUsagePulseCountHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeIndex(),await this._intakeData(),await this._updateMetrics()})),await this._cleanCursors(),await this._exportMetrics()}async _iterateMetrics(e){for(const t of Object.values(p.MetricsStatsHolder.swarms))for(const s of Object.values(t.users))await this._expose(u.FlowKey.ID,t.swarmID+"::"+s.peerID),await this._expose(u.FlowKey.METRICS,s),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.ID,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.ID);this._content.cursors.get(e)||this._content.cursors.set(e,{data:void 0})}async _intakeIndex(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.ID),s=this._content.cursors.get(t),n=e.download.count.usage.dataset;let a=n.length;for(let e=n.length-1;0<=e&&n[e]!==s.data;e--)a=e;await this._expose(u.FlowKey.INDEX,a)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.INDEX),s=e.download.count.usage.dataset;let n=0;for(let e=t;e<s.length;e++)n+=s[e].value;e={ctime:Date.now(),value:n},await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.ID),s=this._require(u.FlowKey.DATA),n=e.download.count.usage.dataset;await e.download.count.usage.pulse.dataset.push(s),await this._content.cursors.set(t,{data:n[n.length-1]})}async _cleanCursors(){for(const s of this._content.cursors.keys()){var[e,t]=s.split("::");null==(null==(e=p.MetricsStatsHolder.swarms[e])?void 0:e.users[t])&&this._content.cursors.delete(s)}}async _exportMetrics(){await h.ExportP2PDownloadUsagePulseCountHandler.process()}static async process(e){await new P2PDownloadUsagePulseCountHandler({content:e}).process()}}class P2PDownloadUsageCumulativeCountHandler extends c.AbstractFlow{async process(){await this._iterateMetrics((async()=>{await this._ensureCursor(),await this._intakeIndex(),await this._intakeData(),await this._updateMetrics()})),await this._cleanCursors(),await this._exportMetrics()}async _iterateMetrics(e){for(const t of Object.values(p.MetricsStatsHolder.swarms))for(const s of Object.values(t.users))await this._expose(u.FlowKey.ID,t.swarmID+"::"+s.peerID),await this._expose(u.FlowKey.METRICS,s),await e();await this._remove(u.FlowKey.METRICS,u.FlowKey.ID,u.FlowKey.INDEX,u.FlowKey.DATA)}async _ensureCursor(){var e=this._require(u.FlowKey.ID);this._content.cursors.get(e)||this._content.cursors.set(e,{data:void 0,value:0})}async _intakeIndex(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.ID),s=this._content.cursors.get(t),n=e.download.count.usage.dataset;let a=n.length;for(let e=n.length-1;0<=e&&n[e]!==s.data;e--)a=e;await this._expose(u.FlowKey.INDEX,a)}async _intakeData(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.ID),s=this._require(u.FlowKey.INDEX),n=(t=this._content.cursors.get(t),e.download.count.usage.dataset);let a=t.value;for(let e=s;e<n.length;e++)a+=n[e].value;e={ctime:Date.now(),value:a},await this._expose(u.FlowKey.DATA,e)}async _updateMetrics(){var e=this._require(u.FlowKey.METRICS),t=this._require(u.FlowKey.ID),s=this._require(u.FlowKey.DATA),n=e.download.count.usage.dataset;await e.download.count.usage.cumulation.dataset.push(s),await this._content.cursors.set(t,{data:n[n.length-1],value:s.value})}async _cleanCursors(){for(const s of this._content.cursors.keys()){var[e,t]=s.split("::");null==(null==(e=p.MetricsStatsHolder.swarms[e])?void 0:e.users[t])&&this._content.cursors.delete(s)}}async _exportMetrics(){await h.ExportP2PDownloadUsageCumulativeCountHandler.process()}static async process(e){await new P2PDownloadUsageCumulativeCountHandler({content:e}).process()}}class TrackerStateRecordHandler extends c.AbstractFlow{async process(){await this._updateMetrics(),await this._exportMetrics()}async _updateMetrics(){var e=this._content,t=p.MetricsStatsHolder.tracker;t.peerID=e.peerID,t.isAvailable=e.isAvailable}async _exportMetrics(){await h.ExportP2SPSystemStateHandler.process()}static async process(e){await new TrackerStateRecordHandler({content:e}).process()}}class NodeStateRecordHandler extends c.AbstractFlow{async process(){await this._updateMetrics(),await this._exportMetrics()}async _updateMetrics(){var e=this._content,t=p.MetricsStatsHolder.node;t.peerID=e.peerID,t.isAvailable=e.isAvailable}async _exportMetrics(){await h.ExportP2SPSystemStateHandler.process()}static async process(e){await new NodeStateRecordHandler({content:e}).process()}}class SwarmStateRecordHandler extends c.AbstractFlow{async process(){await this._updateMetrics(),await this._exportMetrics()}async _updateMetrics(){var e=this._content,t=p.MetricsStatsHolder.swarms[e.swarmID];t?t.isAvailable=e.isAvailable:p.MetricsStatsHolder.setupSwarm(e)}async _exportMetrics(){await h.ExportP2SPSystemStateHandler.process()}static async process(e){await new SwarmStateRecordHandler({content:e}).process()}}class UserStateRecordHandler extends c.AbstractFlow{async process(){await this._updateMetrics(),await this._exportMetrics()}async _updateMetrics(){var e=this._content,t=p.MetricsStatsHolder.swarms[e.swarmID];t&&(e.isAvailable?t.users[e.peerID]||p.MetricsStatsHolder.setupUser(e):delete t.users[e.peerID])}async _exportMetrics(){await h.ExportP2SPSystemStateHandler.process()}static async process(e){await new UserStateRecordHandler({content:e}).process()}}class PurgeCDNRecordsHandler extends c.AbstractFlow{async process(){await this._resetStats()}async _resetStats(){await p.MetricsStatsHolder.resetMCDN()}static async process(e){await new PurgeCDNRecordsHandler({content:e}).process()}}class PruneMetricsStatsHandler extends c.AbstractFlow{constructor(){super(...arguments),this._pruneTime=Date.now()-1e3*_.MetricsConstant.DURATION_OF_RETAINED_DATA}async process(){await this._updateCDNs(),await this._updateOrigin(),await this._updateSwarms(),await this._updateSource()}async _updateCDNs(){for(const e of[...Object.values(p.MetricsStatsHolder.cdns)])await this._pruneCDN(e),await this._pruneDomain(e)}async _updateOrigin(){var e=p.MetricsStatsHolder.origin;await this._pruneDomain(e)}async _updateSwarms(){for(const e of Object.values(p.MetricsStatsHolder.swarms))for(const t of Object.values(e.users))await this._pruneUser(t)}async _updateSource(){var e=p.MetricsStatsHolder.source;await this._pruneSource(e)}async _pruneCDN(e){await this._pruneDataset(e.download.meanBandwidth),await this._pruneDataset(e.download.meanBandwidth.last),await this._pruneDataset(e.download.meanAvailability),await this._pruneDataset(e.download.meanAvailability.last),await this._pruneDataset(e.download.currentScore),await this._pruneDataset(e.download.currentScore.last)}async _pruneDomain(e){await this._pruneDataset(e.download.traffic),await this._pruneDataset(e.download.traffic.pulse),await this._pruneDataset(e.download.traffic.cumulation),await this._pruneDataset(e.download.bandwidth),await this._pruneDataset(e.download.bandwidth.wma),await this._pruneDataset(e.download.count.usage),await this._pruneDataset(e.download.count.usage.pulse),await this._pruneDataset(e.download.count.usage.cumulation),await this._pruneDataset(e.download.count.success),await this._pruneDataset(e.download.count.success.pulse),await this._pruneDataset(e.download.count.success.cumulation),await this._pruneDataset(e.download.count.failure),await this._pruneDataset(e.download.count.failure.pulse),await this._pruneDataset(e.download.count.failure.cumulation)}async _pruneUser(e){await this._pruneDataset(e.download.traffic),await this._pruneDataset(e.download.traffic.pulse),await this._pruneDataset(e.download.traffic.cumulation),await this._pruneDataset(e.download.bandwidth),await this._pruneDataset(e.download.bandwidth.wma),await this._pruneDataset(e.download.count.usage),await this._pruneDataset(e.download.count.usage.pulse),await this._pruneDataset(e.download.count.usage.cumulation)}async _pruneSource(e){await this._pruneRecords(e.http.download),await this._pruneRecords(e.p2p.download)}async _pruneRecords(e){e.records=l.DataTool.prune(e.records,this._pruneTime)}async _pruneDataset(e){e.dataset=l.DataTool.prune(e.dataset,this._pruneTime)}static async process(){await(new PruneMetricsStatsHandler).process()}}t.MetricsCollectorHolder=class MetricsCollectorHolder{static get instance(){return this._instance}static set instance(e){this._instance=e}static async emit(e,t){await this._instance.emit(e,t)}}},1032:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ExportP2SPSystemStateHandler=t.ExportP2PDownloadUsageCumulativeCountHandler=t.ExportP2PDownloadUsagePulseCountHandler=t.ExportP2PDownloadWMABandwidthHandler=t.ExportP2PDownloadCumulativeTrafficHandler=t.ExportP2PDownloadPulseTrafficHandler=t.ExportP2PDownloadRecordHandler=t.ExportCDNDownloadLastCurrentScoreHandler=t.ExportCDNDownloadLastMeanAvailabilityHandler=t.ExportCDNDownloadLastMeanBandwidthHandler=t.ExportHTTPDownloadFailureCumulativeCountHandler=t.ExportHTTPDownloadFailurePulseCountHandler=t.ExportHTTPDownloadSuccessCumulativeCountHandler=t.ExportHTTPDownloadSuccessPulseCountHandler=t.ExportHTTPDownloadUsageCumulativeCountHandler=t.ExportHTTPDownloadUsagePulseCountHandler=t.ExportHTTPDownloadWMABandwidthHandler=t.ExportHTTPDownloadCumulativeTrafficHandler=t.ExportHTTPDownloadPulseTrafficHandler=t.ExportHTTPDownloadRecordHandler=t.MetricsExporterHolder=t.MetricsExporterEvent=t.MetricsExporter=void 0;const a=n(s(6486)),o=n(s(148)),c=s(287),u=s(3267),l=s(3897),d=s(5471);class MetricsExporter extends o.default{async emit(e,t){super.emit(e,a.default.cloneDeep(t)).catch((async s=>{await c.Logger.warn("Export emit failed.",{eventName:e,eventData:t},{error:s})}))}}t.MetricsExporter=MetricsExporter;class MetricsExporterEvent{}(t.MetricsExporterEvent=MetricsExporterEvent).HTTP_DOWNLOAD_RECORD="http_download_record",MetricsExporterEvent.HTTP_DOWNLOAD_PULSE_TRAFFIC="http_download_pulse_traffic",MetricsExporterEvent.HTTP_DOWNLOAD_CUMULATIVE_TRAFFIC="http_download_cumulative_traffic",MetricsExporterEvent.HTTP_DOWNLOAD_WMA_BANDWIDTH="http_download_wma_bandwidth",MetricsExporterEvent.HTTP_DOWNLOAD_USAGE_PULSE_COUNT="http_download_usage_pulse_count",MetricsExporterEvent.HTTP_DOWNLOAD_USAGE_CUMULATIVE_COUNT="http_download_usage_cumulative_count",MetricsExporterEvent.HTTP_DOWNLOAD_SUCCESS_PULSE_COUNT="http_download_success_pulse_count",MetricsExporterEvent.HTTP_DOWNLOAD_SUCCESS_CUMULATIVE_COUNT="http_download_success_cumulative_count",MetricsExporterEvent.HTTP_DOWNLOAD_FAILURE_PULSE_COUNT="http_download_failure_pulse_count",MetricsExporterEvent.HTTP_DOWNLOAD_FAILURE_CUMULATIVE_COUNT="http_download_failure_cumulative_count",MetricsExporterEvent.CDN_DOWNLOAD_LAST_MEAN_BANDWIDTH="cdn_download_last_mean_bandwidth",MetricsExporterEvent.CDN_DOWNLOAD_LAST_MEAN_AVAILABILITY="cdn_download_last_mean_availability",MetricsExporterEvent.CDN_DOWNLOAD_LAST_CURRENT_SCORE="cdn_download_last_current_score",MetricsExporterEvent.P2P_DOWNLOAD_RECORD="p2p_download_record",MetricsExporterEvent.P2P_DOWNLOAD_PULSE_TRAFFIC="p2p_download_pulse_traffic",MetricsExporterEvent.P2P_DOWNLOAD_CUMULATIVE_TRAFFIC="p2p_download_cumulative_traffic",MetricsExporterEvent.P2P_DOWNLOAD_WMA_BANDWIDTH="p2p_download_wma_bandwidth",MetricsExporterEvent.P2P_DOWNLOAD_USAGE_PULSE_COUNT="p2p_download_usage_pulse_count",MetricsExporterEvent.P2P_DOWNLOAD_USAGE_CUMULATIVE_COUNT="p2p_download_usage_cumulative_count",MetricsExporterEvent.P2SP_SYSTEM_STATE="p2sp_system_state",MetricsExporterEvent.SOURCE_PULSE_TRAFFIC="source_pulse_traffic",MetricsExporterEvent.SOURCE_CUMULATIVE_TRAFFIC="source_cumulative_traffic";class MetricsExporterHolder{static get instance(){return this._instance}static isListened(e){return 0<this._instance.listenerCount(e)}static async emit(e,t){await this._instance.emit(e,t)}}(t.MetricsExporterHolder=MetricsExporterHolder)._instance=new MetricsExporter;class ExportHTTPDownloadRecordHandler extends u.AbstractFlow{async process(){this._shouldExport&&await this._exportResult()}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.HTTP_DOWNLOAD_RECORD)}async _exportResult(){var e=this._content;await MetricsExporterHolder.emit(MetricsExporterEvent.HTTP_DOWNLOAD_RECORD,e)}static async process(e){await new ExportHTTPDownloadRecordHandler({content:e}).process()}}t.ExportHTTPDownloadRecordHandler=ExportHTTPDownloadRecordHandler;class ExportHTTPDownloadPulseTrafficHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._injectOrigin(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.HTTP_DOWNLOAD_PULSE_TRAFFIC)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.cdns).map((e=>({id:e.id,name:e.name,type:e.type,domain:e.domain,isEnabled:e.isEnabled,dataset:e.download.traffic.pulse.dataset})));await this._expose(l.FlowKey.RESULT,e)}async _injectOrigin(){var e=this._require(l.FlowKey.RESULT),t=d.MetricsStatsHolder.origin;await e.push({type:t.type,dataset:t.download.traffic.pulse.dataset})}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.HTTP_DOWNLOAD_PULSE_TRAFFIC,e)}static async process(){await(new ExportHTTPDownloadPulseTrafficHandler).process()}}t.ExportHTTPDownloadPulseTrafficHandler=ExportHTTPDownloadPulseTrafficHandler;class ExportHTTPDownloadCumulativeTrafficHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._injectOrigin(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.HTTP_DOWNLOAD_CUMULATIVE_TRAFFIC)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.cdns).map((e=>({id:e.id,name:e.name,type:e.type,domain:e.domain,isEnabled:e.isEnabled,dataset:e.download.traffic.cumulation.dataset})));await this._expose(l.FlowKey.RESULT,e)}async _injectOrigin(){var e=this._require(l.FlowKey.RESULT),t=d.MetricsStatsHolder.origin;await e.push({type:t.type,dataset:t.download.traffic.cumulation.dataset})}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.HTTP_DOWNLOAD_CUMULATIVE_TRAFFIC,e)}static async process(){await(new ExportHTTPDownloadCumulativeTrafficHandler).process()}}t.ExportHTTPDownloadCumulativeTrafficHandler=ExportHTTPDownloadCumulativeTrafficHandler;class ExportHTTPDownloadWMABandwidthHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._injectOrigin(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.HTTP_DOWNLOAD_WMA_BANDWIDTH)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.cdns).map((e=>({id:e.id,name:e.name,type:e.type,domain:e.domain,isEnabled:e.isEnabled,dataset:e.download.bandwidth.wma.dataset})));await this._expose(l.FlowKey.RESULT,e)}async _injectOrigin(){var e=this._require(l.FlowKey.RESULT),t=d.MetricsStatsHolder.origin;await e.push({type:t.type,dataset:t.download.bandwidth.wma.dataset})}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.HTTP_DOWNLOAD_WMA_BANDWIDTH,e)}static async process(){await(new ExportHTTPDownloadWMABandwidthHandler).process()}}t.ExportHTTPDownloadWMABandwidthHandler=ExportHTTPDownloadWMABandwidthHandler;class ExportHTTPDownloadUsagePulseCountHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._injectOrigin(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.HTTP_DOWNLOAD_USAGE_PULSE_COUNT)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.cdns).map((e=>({id:e.id,name:e.name,type:e.type,domain:e.domain,isEnabled:e.isEnabled,dataset:e.download.count.usage.pulse.dataset})));await this._expose(l.FlowKey.RESULT,e)}async _injectOrigin(){var e=this._require(l.FlowKey.RESULT),t=d.MetricsStatsHolder.origin;await e.push({type:t.type,dataset:t.download.count.usage.pulse.dataset})}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.HTTP_DOWNLOAD_USAGE_PULSE_COUNT,e)}static async process(){await(new ExportHTTPDownloadUsagePulseCountHandler).process()}}t.ExportHTTPDownloadUsagePulseCountHandler=ExportHTTPDownloadUsagePulseCountHandler;class ExportHTTPDownloadUsageCumulativeCountHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._injectOrigin(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.HTTP_DOWNLOAD_USAGE_CUMULATIVE_COUNT)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.cdns).map((e=>({id:e.id,name:e.name,type:e.type,domain:e.domain,isEnabled:e.isEnabled,dataset:e.download.count.usage.cumulation.dataset})));await this._expose(l.FlowKey.RESULT,e)}async _injectOrigin(){var e=this._require(l.FlowKey.RESULT),t=d.MetricsStatsHolder.origin;await e.push({type:t.type,dataset:t.download.count.usage.cumulation.dataset})}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.HTTP_DOWNLOAD_USAGE_CUMULATIVE_COUNT,e)}static async process(){await(new ExportHTTPDownloadUsageCumulativeCountHandler).process()}}t.ExportHTTPDownloadUsageCumulativeCountHandler=ExportHTTPDownloadUsageCumulativeCountHandler;class ExportHTTPDownloadSuccessPulseCountHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._injectOrigin(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.HTTP_DOWNLOAD_SUCCESS_PULSE_COUNT)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.cdns).map((e=>({id:e.id,name:e.name,type:e.type,domain:e.domain,isEnabled:e.isEnabled,dataset:e.download.count.success.pulse.dataset})));await this._expose(l.FlowKey.RESULT,e)}async _injectOrigin(){var e=this._require(l.FlowKey.RESULT),t=d.MetricsStatsHolder.origin;await e.push({type:t.type,dataset:t.download.count.success.pulse.dataset})}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.HTTP_DOWNLOAD_SUCCESS_PULSE_COUNT,e)}static async process(){await(new ExportHTTPDownloadSuccessPulseCountHandler).process()}}t.ExportHTTPDownloadSuccessPulseCountHandler=ExportHTTPDownloadSuccessPulseCountHandler;class ExportHTTPDownloadSuccessCumulativeCountHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._injectOrigin(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.HTTP_DOWNLOAD_SUCCESS_CUMULATIVE_COUNT)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.cdns).map((e=>({id:e.id,name:e.name,type:e.type,domain:e.domain,isEnabled:e.isEnabled,dataset:e.download.count.success.cumulation.dataset})));await this._expose(l.FlowKey.RESULT,e)}async _injectOrigin(){var e=this._require(l.FlowKey.RESULT),t=d.MetricsStatsHolder.origin;await e.push({type:t.type,dataset:t.download.count.success.cumulation.dataset})}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.HTTP_DOWNLOAD_SUCCESS_CUMULATIVE_COUNT,e)}static async process(){await(new ExportHTTPDownloadSuccessCumulativeCountHandler).process()}}t.ExportHTTPDownloadSuccessCumulativeCountHandler=ExportHTTPDownloadSuccessCumulativeCountHandler;class ExportHTTPDownloadFailurePulseCountHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._injectOrigin(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.HTTP_DOWNLOAD_FAILURE_PULSE_COUNT)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.cdns).map((e=>({id:e.id,name:e.name,type:e.type,domain:e.domain,isEnabled:e.isEnabled,dataset:e.download.count.failure.pulse.dataset})));await this._expose(l.FlowKey.RESULT,e)}async _injectOrigin(){var e=this._require(l.FlowKey.RESULT),t=d.MetricsStatsHolder.origin;await e.push({type:t.type,dataset:t.download.count.failure.pulse.dataset})}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.HTTP_DOWNLOAD_FAILURE_PULSE_COUNT,e)}static async process(){await(new ExportHTTPDownloadFailurePulseCountHandler).process()}}t.ExportHTTPDownloadFailurePulseCountHandler=ExportHTTPDownloadFailurePulseCountHandler;class ExportHTTPDownloadFailureCumulativeCountHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._injectOrigin(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.HTTP_DOWNLOAD_FAILURE_CUMULATIVE_COUNT)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.cdns).map((e=>({id:e.id,name:e.name,type:e.type,domain:e.domain,isEnabled:e.isEnabled,dataset:e.download.count.failure.cumulation.dataset})));await this._expose(l.FlowKey.RESULT,e)}async _injectOrigin(){var e=this._require(l.FlowKey.RESULT),t=d.MetricsStatsHolder.origin;await e.push({type:t.type,dataset:t.download.count.failure.cumulation.dataset})}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.HTTP_DOWNLOAD_FAILURE_CUMULATIVE_COUNT,e)}static async process(){await(new ExportHTTPDownloadFailureCumulativeCountHandler).process()}}t.ExportHTTPDownloadFailureCumulativeCountHandler=ExportHTTPDownloadFailureCumulativeCountHandler;class ExportCDNDownloadLastMeanBandwidthHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.CDN_DOWNLOAD_LAST_MEAN_BANDWIDTH)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.cdns).map((e=>({id:e.id,name:e.name,type:e.type,domain:e.domain,isEnabled:e.isEnabled,dataset:e.download.meanBandwidth.last.dataset})));await this._expose(l.FlowKey.RESULT,e)}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.CDN_DOWNLOAD_LAST_MEAN_BANDWIDTH,e)}static async process(){await(new ExportCDNDownloadLastMeanBandwidthHandler).process()}}t.ExportCDNDownloadLastMeanBandwidthHandler=ExportCDNDownloadLastMeanBandwidthHandler;class ExportCDNDownloadLastMeanAvailabilityHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.CDN_DOWNLOAD_LAST_MEAN_AVAILABILITY)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.cdns).map((e=>({id:e.id,name:e.name,type:e.type,domain:e.domain,isEnabled:e.isEnabled,dataset:e.download.meanAvailability.last.dataset})));await this._expose(l.FlowKey.RESULT,e)}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.CDN_DOWNLOAD_LAST_MEAN_AVAILABILITY,e)}static async process(){await(new ExportCDNDownloadLastMeanAvailabilityHandler).process()}}t.ExportCDNDownloadLastMeanAvailabilityHandler=ExportCDNDownloadLastMeanAvailabilityHandler;class ExportCDNDownloadLastCurrentScoreHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.CDN_DOWNLOAD_LAST_CURRENT_SCORE)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.cdns).map((e=>({id:e.id,name:e.name,type:e.type,domain:e.domain,isEnabled:e.isEnabled,dataset:e.download.currentScore.last.dataset})));await this._expose(l.FlowKey.RESULT,e)}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.CDN_DOWNLOAD_LAST_CURRENT_SCORE,e)}static async process(){await(new ExportCDNDownloadLastCurrentScoreHandler).process()}}t.ExportCDNDownloadLastCurrentScoreHandler=ExportCDNDownloadLastCurrentScoreHandler;class ExportP2PDownloadRecordHandler extends u.AbstractFlow{async process(){this._shouldExport&&await this._exportResult()}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.P2P_DOWNLOAD_RECORD)}async _exportResult(){var e=this._content;await MetricsExporterHolder.emit(MetricsExporterEvent.P2P_DOWNLOAD_RECORD,e)}static async process(e){await new ExportP2PDownloadRecordHandler({content:e}).process()}}t.ExportP2PDownloadRecordHandler=ExportP2PDownloadRecordHandler;class ExportP2PDownloadPulseTrafficHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.P2P_DOWNLOAD_PULSE_TRAFFIC)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.swarms).map((e=>({swarmID:e.swarmID,users:Object.values(e.users).map((e=>({peerID:e.peerID,dataset:e.download.traffic.pulse.dataset})))})));await this._expose(l.FlowKey.RESULT,e)}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.P2P_DOWNLOAD_PULSE_TRAFFIC,e)}static async process(){await(new ExportP2PDownloadPulseTrafficHandler).process()}}t.ExportP2PDownloadPulseTrafficHandler=ExportP2PDownloadPulseTrafficHandler;class ExportP2PDownloadCumulativeTrafficHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.P2P_DOWNLOAD_CUMULATIVE_TRAFFIC)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.swarms).map((e=>({swarmID:e.swarmID,users:Object.values(e.users).map((e=>({peerID:e.peerID,dataset:e.download.traffic.cumulation.dataset})))})));await this._expose(l.FlowKey.RESULT,e)}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.P2P_DOWNLOAD_CUMULATIVE_TRAFFIC,e)}static async process(){await(new ExportP2PDownloadCumulativeTrafficHandler).process()}}t.ExportP2PDownloadCumulativeTrafficHandler=ExportP2PDownloadCumulativeTrafficHandler;class ExportP2PDownloadWMABandwidthHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.P2P_DOWNLOAD_WMA_BANDWIDTH)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.swarms).map((e=>({swarmID:e.swarmID,users:Object.values(e.users).map((e=>({peerID:e.peerID,dataset:e.download.bandwidth.wma.dataset})))})));await this._expose(l.FlowKey.RESULT,e)}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.P2P_DOWNLOAD_WMA_BANDWIDTH,e)}static async process(){await(new ExportP2PDownloadWMABandwidthHandler).process()}}t.ExportP2PDownloadWMABandwidthHandler=ExportP2PDownloadWMABandwidthHandler;class ExportP2PDownloadUsagePulseCountHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.P2P_DOWNLOAD_USAGE_PULSE_COUNT)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.swarms).map((e=>({swarmID:e.swarmID,users:Object.values(e.users).map((e=>({peerID:e.peerID,dataset:e.download.count.usage.pulse.dataset})))})));await this._expose(l.FlowKey.RESULT,e)}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.P2P_DOWNLOAD_USAGE_PULSE_COUNT,e)}static async process(){await(new ExportP2PDownloadUsagePulseCountHandler).process()}}t.ExportP2PDownloadUsagePulseCountHandler=ExportP2PDownloadUsagePulseCountHandler;class ExportP2PDownloadUsageCumulativeCountHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.P2P_DOWNLOAD_USAGE_CUMULATIVE_COUNT)}async _intakeResult(){var e=Object.values(d.MetricsStatsHolder.swarms).map((e=>({swarmID:e.swarmID,users:Object.values(e.users).map((e=>({peerID:e.peerID,dataset:e.download.count.usage.cumulation.dataset})))})));await this._expose(l.FlowKey.RESULT,e)}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.P2P_DOWNLOAD_USAGE_CUMULATIVE_COUNT,e)}static async process(){await(new ExportP2PDownloadUsageCumulativeCountHandler).process()}}t.ExportP2PDownloadUsageCumulativeCountHandler=ExportP2PDownloadUsageCumulativeCountHandler;class ExportP2SPSystemStateHandler extends u.AbstractFlow{async process(){this._shouldExport&&(await this._intakeResult(),await this._exportResult())}get _shouldExport(){return MetricsExporterHolder.isListened(MetricsExporterEvent.P2SP_SYSTEM_STATE)}async _intakeResult(){var e=d.MetricsStatsHolder.tracker,t=d.MetricsStatsHolder.node,s=d.MetricsStatsHolder.swarms;e={tracker:{peerID:e.peerID,isAvailable:e.isAvailable},node:{peerID:t.peerID,isAvailable:t.isAvailable},swarms:Object.fromEntries(Object.values(s).map((e=>[e.swarmID,{swarmID:e.swarmID,swarmURI:e.swarmURI,isAvailable:e.isAvailable,users:Object.fromEntries(Object.values(e.users).map((e=>[e.peerID,{peerID:e.peerID,isAvailable:e.isAvailable}])))}])))};await this._expose(l.FlowKey.RESULT,e)}async _exportResult(){var e=this._require(l.FlowKey.RESULT);await MetricsExporterHolder.emit(MetricsExporterEvent.P2SP_SYSTEM_STATE,e)}static async process(){await(new ExportP2SPSystemStateHandler).process()}}t.ExportP2SPSystemStateHandler=ExportP2SPSystemStateHandler},6123:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsConstant=void 0;class MetricsConstant{}(t.MetricsConstant=MetricsConstant).DURATION_OF_RETAINED_DATA=300,MetricsConstant.DURATION_OF_WMA_DATA=20},7237:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsProvider=void 0;const n=s(5227),a=s(5471);t.MetricsProvider=class MetricsProvider{async activate(){await this._loadMetricsStats(),await this._loadMetricsCollector()}async _loadMetricsStats(){a.MetricsStatsHolder.instance=new a.MetricsStats}async _loadMetricsCollector(){var e=new n.MetricsCollector;await e.activate(),n.MetricsCollectorHolder.instance=e}async deactivate(){await this._unloadMetricsCollector(),await this._unloadMetricsStats()}async _unloadMetricsCollector(){var e=n.MetricsCollectorHolder.instance;await(null==e?void 0:e.deactivate()),n.MetricsCollectorHolder.instance=null}async _unloadMetricsStats(){var e=a.MetricsStatsHolder.instance;await(null==e?void 0:e.reset()),a.MetricsStatsHolder.instance=null}}},5471:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsStatsHolder=t.MetricsStats=void 0;const n=s(922);t.MetricsStats=class MetricsStats{constructor(){this.reset()}get cdns(){return this._cdns}get origin(){return this._origin}get tracker(){return this._tracker}get node(){return this._node}get swarms(){return this._swarms}get source(){return this._source}get report(){return this._report}reset(){this._resetMCDN(),this._resetP2SP(),this._resetSource(),this._resetReport()}resetMCDN(){this._resetMCDN()}_resetMCDN(){this._setupCDNs(),this._setupOrigin()}_resetP2SP(){this._setupTracker(),this._setupNode(),this._setupSwarms()}_resetSource(){this._setupSource()}_resetReport(){this._setupReport()}setupCDN(e){this._setupCDN(e)}setupSwarm(e){this._setupSwarm(e)}setupUser(e){this._setupUser(e)}_setupCDNs(){this._cdns={}}_setupCDN(e){this._cdns[e.id]={id:e.id,name:e.name,kind:n.DomainKind.CDN,type:e.type,domain:e.domain,isEnabled:e.isEnabled,download:{count:{usage:{dataset:[],pulse:{dataset:[]},cumulation:{dataset:[]}},success:{dataset:[],pulse:{dataset:[]},cumulation:{dataset:[]}},failure:{dataset:[],pulse:{dataset:[]},cumulation:{dataset:[]}}},outcome:{dataset:[]},traffic:{dataset:[],pulse:{dataset:[]},cumulation:{dataset:[]}},bandwidth:{dataset:[],wma:{dataset:[]}},meanBandwidth:{dataset:[{ctime:Date.now(),value:e.meanBandwidth}],last:{dataset:[]}},meanAvailability:{dataset:[{ctime:Date.now(),value:e.meanAvailability}],last:{dataset:[]}},currentScore:{dataset:[{ctime:Date.now(),value:e.currentScore}],last:{dataset:[]}}}}}_setupOrigin(){this._origin={kind:n.DomainKind.ORIGIN,type:n.DomainType.FALLBACK,download:{count:{usage:{dataset:[],pulse:{dataset:[]},cumulation:{dataset:[]}},success:{dataset:[],pulse:{dataset:[]},cumulation:{dataset:[]}},failure:{dataset:[],pulse:{dataset:[]},cumulation:{dataset:[]}}},outcome:{dataset:[]},traffic:{dataset:[],pulse:{dataset:[]},cumulation:{dataset:[]}},bandwidth:{dataset:[],wma:{dataset:[]}}}}}_setupTracker(){this._tracker={peerID:null,isAvailable:!1}}_setupNode(){this._node={peerID:null,isAvailable:!1}}_setupSwarms(){this._swarms={}}_setupSwarm(e){this._swarms[e.swarmID]={swarmID:e.swarmID,swarmURI:e.swarmURI,isAvailable:e.isAvailable,users:{}}}_setupUser(e){this._swarms[e.swarmID].users[e.peerID]={peerID:e.peerID,isAvailable:e.isAvailable,download:{count:{usage:{dataset:[],pulse:{dataset:[]},cumulation:{dataset:[]}}},traffic:{dataset:[],pulse:{dataset:[]},cumulation:{dataset:[]}},bandwidth:{dataset:[],wma:{dataset:[]}}}}}_setupSource(){this._source={http:{download:{records:[]}},p2p:{download:{records:[]}}}}_setupReport(){this._report={http:{download:{aggregation:{reports:[]}}},p2p:{download:{aggregation:{reports:[]}}}}}};t.MetricsStatsHolder=class MetricsStatsHolder{static get instance(){return this._instance}static set instance(e){this._instance=e}static get cdns(){return this._instance.cdns}static get origin(){return this._instance.origin}static get tracker(){return this._instance.tracker}static get node(){return this._instance.node}static get swarms(){return this._instance.swarms}static get source(){return this._instance.source}static get report(){return this._instance.report}static resetMCDN(){this._instance.resetMCDN()}static setupCDN(e){this._instance.setupCDN(e)}static setupSwarm(e){this._instance.setupSwarm(e)}static setupUser(e){this._instance.setupUser(e)}}},4714:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReportConstant=void 0;class ReportConstant{}(t.ReportConstant=ReportConstant).FALLBACK_PLATFORM_ID="0",ReportConstant.HTTP_DOWNLOAD_REPORT_BATCH_SIZE=20,ReportConstant.P2P_DOWNLOAD_REPORT_BATCH_SIZE=20},3337:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReportProvider=void 0;const n=s(7427);t.ReportProvider=class ReportProvider{async activate(){await this._loadReportSubmitter()}async _loadReportSubmitter(){var e=new n.ReportSubmitter;await e.activate(),n.ReportSubmitterHolder.instance=e}async deactivate(){await this._unloadReportSubmitter()}async _unloadReportSubmitter(){var e=n.ReportSubmitterHolder.instance;await(null==e?void 0:e.deactivate()),n.ReportSubmitterHolder.instance=null}}},7427:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReportSubmitterHolder=t.ReportSubmitter=void 0;const c=s(4944),u=s(287),l=s(3267),d=o(s(9991)),h=s(3897),_=s(5471),p=s(4714);t.ReportSubmitter=class ReportSubmitter{constructor(){this._taskManager=new c.TaskManager}async activate(){await this._taskManager.activate(),await this._buildTasks()}async deactivate(){await this._taskManager.deactivate()}async _buildTasks(){await this._buildHandleHTTPDownloadAggregationTask(),await this._buildHandleP2PDownloadAggregationTask(),await this._buildHandleHTTPDownloadAggregationReportTask(),await this._buildHandleP2PDownloadAggregationReportTask()}async _buildHandleHTTPDownloadAggregationTask(){await this._taskManager.createCyclicTask(new HTTPDownloadAggregationDuty({name:ReportSubmitterTaskName.HANDLE_HTTP_DOWNLOAD_AGGREGATION,content:{cursor:{data:void 0}},sleepFirst:!0,sleepSeconds:60,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleP2PDownloadAggregationTask(){await this._taskManager.createCyclicTask(new P2PDownloadAggregationDuty({name:ReportSubmitterTaskName.HANDLE_P2P_DOWNLOAD_AGGREGATION,content:{cursor:{data:void 0}},sleepFirst:!0,sleepSeconds:60,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleHTTPDownloadAggregationReportTask(){await this._taskManager.createCyclicTask(new HTTPDownloadAggregationReportDuty({name:ReportSubmitterTaskName.HANDLE_HTTP_DOWNLOAD_AGGREGATION_REPORT,content:{cursor:{data:void 0}},loopPretasks:[this._taskManager.cueCyclicTask(ReportSubmitterTaskName.HANDLE_HTTP_DOWNLOAD_AGGREGATION)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1}))}async _buildHandleP2PDownloadAggregationReportTask(){await this._taskManager.createCyclicTask(new P2PDownloadAggregationReportDuty({name:ReportSubmitterTaskName.HANDLE_P2P_DOWNLOAD_AGGREGATION_REPORT,content:{cursor:{data:void 0}},loopPretasks:[this._taskManager.cueCyclicTask(ReportSubmitterTaskName.HANDLE_P2P_DOWNLOAD_AGGREGATION)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1}))}};class ReportSubmitterTaskName{}ReportSubmitterTaskName.HANDLE_HTTP_DOWNLOAD_AGGREGATION="report submitter: handle http download aggregation",ReportSubmitterTaskName.HANDLE_P2P_DOWNLOAD_AGGREGATION="report submitter: handle p2p download aggregation",ReportSubmitterTaskName.HANDLE_HTTP_DOWNLOAD_AGGREGATION_REPORT="report submitter: handle http download aggregation report",ReportSubmitterTaskName.HANDLE_P2P_DOWNLOAD_AGGREGATION_REPORT="report submitter: handle p2p download aggregation report";class HTTPDownloadAggregationDuty extends c.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await HTTPDownloadAggregationHandler.process(this._options.content)}}class P2PDownloadAggregationDuty extends c.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await P2PDownloadAggregationHandler.process(this._options.content)}}class HTTPDownloadAggregationReportDuty extends c.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await this._report()}async onCancel(){await this._report()}async _report(){await HTTPDownloadAggregationReportHandler.process(this._options.content)}}class P2PDownloadAggregationReportDuty extends c.CyclicDuty{constructor(e){super(e),this._options=e}async callee(){await this._report()}async onCancel(){await this._report()}async _report(){await P2PDownloadAggregationReportHandler.process(this._options.content)}}class HTTPDownloadAggregationHandler extends l.AbstractFlow{constructor(){super(...arguments),this._ctime=Date.now(),this._reports=new Map}async process(){await this._intakeIndex(),await this._iterateRecords((async()=>{await this._ensureReport(),await this._updateReport()})),await this._updateReports()}async _intakeIndex(){var e=_.MetricsStatsHolder.source.http.download.records;let t=e.length;for(let s=e.length-1;0<=s&&e[s]!==this._content.cursor.data;s--)t=s;await this._expose(h.FlowKey.INDEX,t)}async _iterateRecords(e){var t=_.MetricsStatsHolder.source.http.download.records;for(let s=this._require(h.FlowKey.INDEX);s<t.length;s++)await this._expose(h.FlowKey.RECORD,t[s]),await e();await this._remove(h.FlowKey.RECORD)}async _ensureReport(){var e,t=this._require(h.FlowKey.RECORD);this._reports.has(t.id)||this._reports.set(t.id,{ctime:this._ctime,platformID:null!=(e=t.id)?e:p.ReportConstant.FALLBACK_PLATFORM_ID,platformType:t.type,transferSize:0,successCount:0,failureCount:0})}async _updateReport(){var e=this._require(h.FlowKey.RECORD),t=this._reports.get(e.id);t.transferSize+=e.contentSize,t.successCount+=e.isSuccess?1:0,t.failureCount+=e.isSuccess?0:1}async _updateReports(){var e=_.MetricsStatsHolder.source.http.download.records;_.MetricsStatsHolder.report.http.download.aggregation.reports.push(...this._reports.values()),this._content.cursor.data=e[e.length-1]}static async process(e){await new HTTPDownloadAggregationHandler({content:e}).process()}}class P2PDownloadAggregationHandler extends l.AbstractFlow{constructor(){super(...arguments),this._ctime=Date.now(),this._reports=new Map}async process(){await this._intakeIndex(),await this._iterateRecords((async()=>{await this._ensureReport(),await this._updateReport()})),await this._updateReports()}async _intakeIndex(){var e=_.MetricsStatsHolder.source.p2p.download.records;let t=e.length;for(let s=e.length-1;0<=s&&e[s]!==this._content.cursor.data;s--)t=s;await this._expose(h.FlowKey.INDEX,t)}async _iterateRecords(e){var t=_.MetricsStatsHolder.source.p2p.download.records;for(let s=this._require(h.FlowKey.INDEX);s<t.length;s++)await this._expose(h.FlowKey.RECORD,t[s]),await e();await this._remove(h.FlowKey.RECORD)}async _ensureReport(){var e=this._require(h.FlowKey.RECORD);this._reports.has(e.peerID)||this._reports.set(e.peerID,{ctime:this._ctime,targetPeerID:e.peerID,targetPeerType:e.peerType,transferSize:0,successCount:0,failureCount:0})}async _updateReport(){var e=this._require(h.FlowKey.RECORD),t=this._reports.get(e.peerID);e=e.contentSize;t.transferSize+=e,t.successCount+=0<e?1:0,t.failureCount+=0<e?0:1}async _updateReports(){var e=_.MetricsStatsHolder.source.p2p.download.records;_.MetricsStatsHolder.report.p2p.download.aggregation.reports.push(...this._reports.values()),this._content.cursor.data=e[e.length-1]}static async process(e){await new P2PDownloadAggregationHandler({content:e}).process()}}class HTTPDownloadAggregationReportHandler extends l.AbstractFlow{constructor(){super(...arguments),this._reports=new Array}async process(){for(await this._intakeIndex(),await this._injectReports();this._shouldSubmit;)await this._submitReports()}async _intakeIndex(){var e=_.MetricsStatsHolder.report.http.download.aggregation.reports;let t=e.length;for(let s=e.length-1;0<=s&&e[s]!==this._content.cursor.data;s--)t=s;await this._expose(h.FlowKey.INDEX,t)}async _injectReports(){var e=_.MetricsStatsHolder.report.http.download.aggregation.reports,t=this._require(h.FlowKey.INDEX);this._reports.push(...e.slice(t)),this._content.cursor.data=e[e.length-1]}get _shouldSubmit(){return 0<this._reports.length}async _submitReports(){const e=this._reports.slice(0,p.ReportConstant.HTTP_DOWNLOAD_REPORT_BATCH_SIZE);await d.MeteringAPICreateCDNDownloadAggregationHandler.process({reports:e.map((e=>({time:e.ctime,platformID:e.platformID,platformType:e.platformType,transferSize:e.transferSize,successCount:e.successCount,failureCount:e.failureCount})))}).catch((async t=>{await u.Logger.debug("Submit reports failed.",{reports:e},{error:t})})).finally((async()=>{this._reports=this._reports.slice(p.ReportConstant.HTTP_DOWNLOAD_REPORT_BATCH_SIZE)}))}static async process(e){await new HTTPDownloadAggregationReportHandler({content:e}).process()}}class P2PDownloadAggregationReportHandler extends l.AbstractFlow{constructor(){super(...arguments),this._reports=new Array}async process(){for(await this._intakeIndex(),await this._injectReports();this._shouldSubmit;)await this._submitReports()}async _intakeIndex(){var e=_.MetricsStatsHolder.report.p2p.download.aggregation.reports;let t=e.length;for(let s=e.length-1;0<=s&&e[s]!==this._content.cursor.data;s--)t=s;await this._expose(h.FlowKey.INDEX,t)}async _injectReports(){var e=_.MetricsStatsHolder.report.p2p.download.aggregation.reports,t=this._require(h.FlowKey.INDEX);this._reports.push(...e.slice(t)),this._content.cursor.data=e[e.length-1]}get _shouldSubmit(){return 0<this._reports.length}async _submitReports(){const e=this._reports.slice(0,p.ReportConstant.P2P_DOWNLOAD_REPORT_BATCH_SIZE);await d.MeteringAPICreateP2PDownloadAggregationHandler.process({reports:e.map((e=>({time:e.ctime,targetPeerID:e.targetPeerID,targetPeerType:e.targetPeerType,transferSize:e.transferSize,successCount:e.successCount,failureCount:e.failureCount})))}).catch((async t=>{await u.Logger.debug("Submit reports failed.",{reports:e},{error:t})})).finally((async()=>{this._reports=this._reports.slice(p.ReportConstant.P2P_DOWNLOAD_REPORT_BATCH_SIZE)}))}static async process(e){await new P2PDownloadAggregationReportHandler({content:e}).process()}}t.ReportSubmitterHolder=class ReportSubmitterHolder{static get instance(){return this._instance}static set instance(e){this._instance=e}}},6903:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BasePool=void 0;t.BasePool=class BasePool{constructor(){this._pool=new Map}get size(){return this._pool.size}get keys(){return this._pool.keys()}get values(){return this._pool.values()}isRegistered(e){return this._pool.has(e)}retrieve(e){return this._pool.get(e)}register(e,t){this._pool.set(e,t)}deregister(e){this._pool.delete(e)}discharge(){this._pool.clear()}}},545:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Resource=void 0;const n=s(2064),a=s(9283),o=s(8925),c=s(2060);class Resource{constructor(e){this._ctime=new a.Timer,this._mtime=new a.Timer,this._ptime=new a.Timer,this._content=o.Buffer.from([]),this._priority=0,this._startDelay=0,this._isShareable=!1,this._id=Resource.makeID(e),this._uri=e}get id(){return this._id}get swarmID(){return this._swarmID}set swarmID(e){this._swarmID=e}get swarmURI(){return this._swarmURI}set swarmURI(e){this._swarmURI=e}get sourceURI(){return this._sourceURI}set sourceURI(e){this._sourceURI=e}get uri(){return this._uri}get type(){return this._type}set type(e){this._type=e}get total(){return this._total}set total(e){this._total=e}get ctime(){return this._ctime}get mtime(){return this._mtime}get ptime(){return this._ptime}set ptime(e){this._ptime=e}get size(){return this._content.length}get content(){return this._content}get priority(){return this._priority}set priority(e){this._priority=e}get startDelay(){return this._startDelay}set startDelay(e){this._startDelay=e}get isShareable(){return this._isShareable}set isShareable(e){this._isShareable=e}get completion(){return null==this.total?0:0===this.total?1:this.size/this.total}get isComplete(){return this._total===this._content.length}concat(e){var t=e.range;t.start>this._content.length||t.end<=this._content.length||(e=o.Buffer.from(e.chunk),t=this._content.length-t.start,this._mtime.stamp(),this._content=o.Buffer.concat([this._content,e.slice(t)]))}nextRange(){var e={start:this._content.length,end:this._content.length+c.WebRTCConstant.DATACHANNEL_CHUNK_SIZE};return null!=this._total&&(e.end=Math.min(e.end,this._total)),e}toJSON(){const{_content:e,...t}=this;return t}toString(){var e=new Array;return e.push("id: "+this.id),e.push("uri: "+this.uri),e.push("type: "+this.type),e.push("total: "+this.total),e.push("size: "+this.size),`<${this.constructor.name}| ${e.join(", ")}>`}static makeID(e){return(e=new URL(e)).hash="",e.search="",n.HashTool.makeSHA256Base64URLString(e.href)}}t.Resource=Resource},9500:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.MCDNInitializer=void 0;const c=s(3267),u=o(s(9991)),l=s(1744),d=s(3897),h=s(922),_=s(5227),p=s(2461),f=s(7195);class MCDNInitializer extends c.AbstractFlow{async process(){await this._initializeMCDNStats(),await this._initializeMCDNScores(),await this._forwardCDNConfigRecords()}async _initializeMCDNStats(){await InitializeMCDNStatsHandler.process()}async _initializeMCDNScores(){await InitializeMCDNScoresHandler.process()}async _forwardCDNConfigRecords(){var e=[...f.MCDNStatsHolder.cdns.values()].map((e=>({id:e.id,name:e.name,type:e.type,domain:e.domain,isEnabled:e.isEnabled,meanBandwidth:e.meanBandwidth,meanAvailability:e.meanAvailability,currentScore:e.currentScore})));await _.MetricsCollectorHolder.emit(_.MetricsCollectorEvent.CDN_CONFIG_RECORDS,e)}static async process(){await(new MCDNInitializer).process()}}t.MCDNInitializer=MCDNInitializer;class InitializeMCDNStatsHandler extends c.AbstractFlow{async process(){await this._intakeConfig(),await this._updateStats()}async _intakeConfig(){var e=l.kernelSettings.global.platform;await this._expose(d.FlowKey.CONFIG,e)}async _updateStats(){var e=this._require(d.FlowKey.CONFIG);await e.details.forEach((e=>f.MCDNStatsHolder.cdns.set(e.id,new p.CDN({id:e.id,name:e.name,domain:e.host,kind:h.DomainKind.CDN,type:e.type,isEnabled:e.isEnabled,businessScore:e.score})))),f.MCDNStatsHolder.algorithmID=e.algorithmID,f.MCDNStatsHolder.algorithmVersion=e.algorithmVersion}static async process(){await(new InitializeMCDNStatsHandler).process()}}class InitializeMCDNScoresHandler extends c.AbstractFlow{async process(){await this._intakeConfig(),await this._updateStats()}async _intakeConfig(){var e=[...f.MCDNStatsHolder.cdns.keys()];e=await u.CDNScoreAPIReadPlatformScoresHandler.process({algorithmID:f.MCDNStatsHolder.algorithmID,platformIDs:e});await this._expose(d.FlowKey.CONFIG,e)}async _updateStats(){await this._require(d.FlowKey.CONFIG).platforms.forEach((e=>{f.MCDNStatsHolder.cdns.get(e.id).currentScore=e.score}))}static async process(){await(new InitializeMCDNScoresHandler).process()}}},787:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MCDNConstant=void 0;class MCDNConstant{}(t.MCDNConstant=MCDNConstant).QUALIFIED_DOWNLOAD_BANDWIDTH=1048576,MCDNConstant.MIN_SIZE_FOR_BANDWIDTH_MEASUREMENT=8192,MCDNConstant.PENALTY_POWER_OF_AVAILABILITY=3,MCDNConstant.MAX_ACCEPTABLE_SCORE_DIFFERENCE=.25},2461:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CDN=void 0;t.CDN=class CDN{constructor(e){this._id=e.id,this._name=e.name,this._kind=e.kind,this._type=e.type,this._domain=e.domain,this._isEnabled=e.isEnabled,this._meanBandwidth=0,this._meanAvailability=1,this._overallScore=e.businessScore,this._currentScore=1,this._businessScore=e.businessScore}get id(){return this._id}get name(){return this._name}get kind(){return this._kind}get type(){return this._type}get domain(){return this._domain}get isEnabled(){return this._isEnabled}get meanBandwidth(){return this._meanBandwidth}set meanBandwidth(e){this._meanBandwidth=e}get meanAvailability(){return this._meanAvailability}set meanAvailability(e){this._meanAvailability=e}get overallScore(){return this._overallScore}get currentScore(){return this._currentScore}set currentScore(e){this._currentScore=e,this._overallScore=this._currentScore*this._businessScore}get businessScore(){return this._businessScore}}},7937:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MCDNProvider=void 0;const n=s(5227),a=s(9500),o=s(7195);t.MCDNProvider=class MCDNProvider{async activate(){await this._loadMCDNStats(),await this._initializeMCDN()}async _loadMCDNStats(){o.MCDNStatsHolder.instance=new o.MCDNStats}async _initializeMCDN(){await a.MCDNInitializer.process()}async deactivate(){await this._unloadMCDNStats(),await this._purgeMCDNMetrics()}async _unloadMCDNStats(){var e=o.MCDNStatsHolder.instance;await(null==e?void 0:e.reset()),o.MCDNStatsHolder.instance=null}async _purgeMCDNMetrics(){await n.MetricsCollectorHolder.emit(n.MetricsCollectorEvent.PURGE_CDN_RECORDS,void 0)}}},9877:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MCDNDownloadRecorder=void 0;const n=s(3267),a=s(3897),o=s(922),c=s(5227),u=s(6123),l=s(5471),d=s(4916),h=s(787),_=s(7195);class MCDNDownloadRecorder extends n.AbstractFlow{async process(){await this._intakeHTTPDownloadRecord(),await this._forwardHTTPDownloadRecord(),this._shouldUpdateCDNStats&&(await this._intakeCDNStats(),await this._updateCDNBandwidth(),await this._updateCDNMeanBandwidth(),await this._updateCDNMeanAvailability(),await this._updateCDNCurrentScore(),await this._forwardCDNDownloadRecord())}async _intakeHTTPDownloadRecord(){var e=new HTTPDownloadRecordBuilder(this._content).build();await this._expose(a.FlowKey.RECORD,e)}async _forwardHTTPDownloadRecord(){var e=this._require(a.FlowKey.RECORD);await c.MetricsCollectorHolder.emit(c.MetricsCollectorEvent.HTTP_DOWNLOAD_RECORD,e)}get _shouldUpdateCDNStats(){return this._require(a.FlowKey.RECORD).kind===o.DomainKind.CDN}async _intakeCDNStats(){var e=this._require(a.FlowKey.RECORD);this._cdn=_.MCDNStatsHolder.cdns.get(e.id)}async _updateCDNBandwidth(){var e=this._require(a.FlowKey.RECORD);e.bandwidth&&(_.MCDNStatsHolder.networkBandwidth=Math.max(h.MCDNConstant.QUALIFIED_DOWNLOAD_BANDWIDTH,(_.MCDNStatsHolder.networkBandwidth+e.bandwidth)/2))}async _updateCDNMeanBandwidth(){this._require(a.FlowKey.RECORD).bandwidth&&await MeanBandwidthCalculator.process({cdn:this._cdn})}async _updateCDNMeanAvailability(){await MeanAvailabilityCalculator.process({cdn:this._cdn})}async _updateCDNCurrentScore(){await CurrentScoreCalculator.process({cdn:this._cdn})}async _forwardCDNDownloadRecord(){await c.MetricsCollectorHolder.emit(c.MetricsCollectorEvent.CDN_DOWNLOAD_RECORD,{id:this._cdn.id,name:this._cdn.name,kind:this._cdn.kind,type:this._cdn.type,domain:this._cdn.domain,ctime:Date.now(),meanBandwidth:this._cdn.meanBandwidth,meanAvailability:this._cdn.meanAvailability,currentScore:this._cdn.currentScore})}static async process(e){await new MCDNDownloadRecorder({content:e}).process()}}t.MCDNDownloadRecorder=MCDNDownloadRecorder;class HTTPDownloadRecordBuilder{constructor(e){this._options=e,this._initialize()}build(){return this._content}_initialize(){this._setContent(),this._setContentSize(),this._setElapsedTime(),this._setIsOutlier(),this._setBandwidth()}_setContent(){var e,t=this._options;this._content={id:t.source.id,name:t.source.name,kind:t.source.kind,type:t.source.type,domain:t.source.domain,ctime:Date.now(),totalSize:t.resource.total,contentType:t.resource.type,startTime:t.startTime,isAborted:t.aborter.signal.aborted,isSuccess:null==t.error,isComplete:t.resource.isComplete,swarmID:t.resource.swarmID,swarmURI:t.resource.swarmURI,sourceURI:t.resource.sourceURI,requestURI:t.requestURI,responseCode:null==(e=t.payload)?void 0:e.status,errorMessage:null==(e=t.error)?void 0:e.message,algorithmID:_.MCDNStatsHolder.algorithmID,algorithmVersion:_.MCDNStatsHolder.algorithmVersion}}_setContentSize(){var e=this._options;this._content.contentSize=e.resource.size-e.startSize}_setElapsedTime(){var e,t=this._options.measurement;this._content.isSuccess&&(e=t.responseEnd,t=0!==t.requestStart?t.requestStart:t.startTime,this._content.elapsedTime=e-t)}_setIsOutlier(){this._content.isOutlier=this._content.contentSize<h.MCDNConstant.MIN_SIZE_FOR_BANDWIDTH_MEASUREMENT}_setBandwidth(){this._content.isSuccess&&!this._content.isOutlier&&(this._content.bandwidth=this._content.contentSize/(this._content.elapsedTime/1e3))}}class MeanBandwidthCalculator extends n.AbstractFlow{constructor(e){super(e),this._cdn=e.content.cdn}async process(){await this._intakeResult(),await this._updateCDN()}async _intakeResult(){var e=l.MetricsStatsHolder.cdns[this._cdn.id].download.bandwidth.dataset;let t=Date.now()-1e3*u.MetricsConstant.DURATION_OF_RETAINED_DATA;0<e.length&&(t=Math.min(e[0].ctime,t)),e=d.MathCalculator.weightedAverage(e.map((e=>({offset:e.ctime-t,value:e.value})))),await this._expose(a.FlowKey.RESULT,e)}async _updateCDN(){var e=this._require(a.FlowKey.RESULT);this._cdn.meanBandwidth=e}static async process(e){await new MeanBandwidthCalculator({content:e}).process()}}class MeanAvailabilityCalculator extends n.AbstractFlow{constructor(e){super(e),this._cdn=e.content.cdn}async process(){await this._intakeResult(),await this._updateCDN()}async _intakeResult(){var e=l.MetricsStatsHolder.cdns[this._cdn.id].download.outcome.dataset;let t=Date.now()-1e3*u.MetricsConstant.DURATION_OF_RETAINED_DATA;0<e.length&&(t=Math.min(e[0].ctime,t)),e=d.MathCalculator.weightedAverage(e.map((e=>({offset:e.ctime-t,value:e.value})))),await this._expose(a.FlowKey.RESULT,e)}async _updateCDN(){var e=this._require(a.FlowKey.RESULT);this._cdn.meanAvailability=e}static async process(e){await new MeanAvailabilityCalculator({content:e}).process()}}class CurrentScoreCalculator extends n.AbstractFlow{constructor(e){super(e),this._cdn=e.content.cdn,this._scoreParts={}}async process(){await this._scoreBandwidth(),await this._scoreAvailability(),await this._updateCDN()}async _scoreBandwidth(){let e=1;0<l.MetricsStatsHolder.cdns[this._cdn.id].download.bandwidth.dataset.length&&(e=Math.min(this._cdn.meanBandwidth/_.MCDNStatsHolder.networkBandwidth,1)),this._scoreParts.bandwidth=e}async _scoreAvailability(){var e=Math.pow(this._cdn.meanAvailability,h.MCDNConstant.PENALTY_POWER_OF_AVAILABILITY);this._scoreParts.availability=e}async _updateCDN(){var e=this._cdn.currentScore,t=this._scoreParts.bandwidth*this._scoreParts.availability;this._cdn.currentScore=(e+t)/2}static async process(e){await new CurrentScoreCalculator({content:e}).process()}}},3722:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MCDNSelector=void 0;const n=s(8240),a=s(1139),o=s(3267),c=s(3897),u=s(922),l=s(2060),d=s(787),h=s(7195);class MCDNSelector extends o.AbstractFlow{async process(){return await this._intakeResult(),await this._injectOrigin(),await this._intakeOutcome(),this._outcome}async _intakeResult(){let e;e=this._isUrgentResource?await CDNsBasedOnHighScoreGroupHandler.process():await CDNsBasedOnOverallScoresHandler.process(),await this._expose(c.FlowKey.RESULT,e)}get _isUrgentResource(){return this._content.resource.priority<l.ResourceConstant.URGENT_THRESHOLD_PRIORITY}async _injectOrigin(){var e=this._require(c.FlowKey.RESULT),t=this._content.resource,s=new URL(t.uri).host;for(const t of e)if(t.domain===s)return;await e.push({kind:u.DomainKind.ORIGIN,type:u.DomainType.FALLBACK,domain:s})}async _intakeOutcome(){this._outcome=this._require(c.FlowKey.RESULT)}static async process(e){return new MCDNSelector({content:e}).process()}}t.MCDNSelector=MCDNSelector;class CDNsBasedOnHighScoreGroupHandler extends o.AbstractFlow{async process(){return await this._intakeThreshold(),await this._intakeCDNs(),await this._intakeResult(),await this._injectOthers(),await this._intakeOutcome(),this._outcome}async _intakeThreshold(){let e=0;await[...h.MCDNStatsHolder.cdns.values()].forEach((t=>{t.currentScore>=e&&(e=t.currentScore)}));var t=e-d.MCDNConstant.MAX_ACCEPTABLE_SCORE_DIFFERENCE;await this._expose(c.FlowKey.THRESHOLD,t)}async _intakeCDNs(){var e=[...h.MCDNStatsHolder.cdns.values()],t=this._require(c.FlowKey.THRESHOLD);this._primeCDNs=new Array,this._otherCDNs=new Array;for(const s of e)s.isEnabled&&(s.currentScore>=t?this._primeCDNs:this._otherCDNs).push(s)}async _intakeResult(){var e=await RandomlySelectCDNsHandler.process({cdns:[...this._primeCDNs],cdnScoreGetter:e=>e.overallScore});await this._expose(c.FlowKey.RESULT,e)}async _injectOthers(){var e=await this._require(c.FlowKey.RESULT),t=await RandomlySelectCDNsHandler.process({cdns:[...this._otherCDNs],cdnScoreGetter:e=>e.overallScore});await e.push(...t)}async _intakeOutcome(){this._outcome=this._require(c.FlowKey.RESULT)}static async process(){return(new CDNsBasedOnHighScoreGroupHandler).process()}}class CDNsBasedOnOverallScoresHandler extends o.AbstractFlow{async process(){return await this._intakeCDNs(),await this._intakeResult(),await this._intakeOutcome(),this._outcome}async _intakeCDNs(){this._cdns=[...h.MCDNStatsHolder.cdns.values()].filter((e=>e.isEnabled))}async _intakeResult(){var e=await RandomlySelectCDNsHandler.process({cdns:[...this._cdns],cdnScoreGetter:e=>e.overallScore});await this._expose(c.FlowKey.RESULT,e)}async _intakeOutcome(){this._outcome=this._require(c.FlowKey.RESULT)}static async process(){return(new CDNsBasedOnOverallScoresHandler).process()}}class RandomlySelectCDNsHandler extends o.AbstractFlow{constructor(e){super(e),this._cdns=n.RandomTool.shuffle(e.content.cdns),this._cdnScoreGetter=e.content.cdnScoreGetter}async process(){return await this._intakeCDNs(),await this._intakeResult(),await this._repeatRandomSelection((async()=>{await this._intakeThresholdScore(),await this._injectSelectedCDN()})),await this._injectRemainedCDNs(),await this._intakeOutcome(),this._outcome}async _intakeCDNs(){this._primeCDNs=a.Deque.make(),this._otherCDNs=a.Deque.make();for(const e of this._cdns)(0<this._cdnScoreGetter(e)?this._primeCDNs:this._otherCDNs).push(e)}async _intakeResult(){var e=new Array;await this._expose(c.FlowKey.RESULT,e)}async _repeatRandomSelection(e){for(;0<this._primeCDNs.size;)await e();await this._remove(c.FlowKey.THRESHOLD)}async _intakeThresholdScore(){let e=0;for(const t of this._primeCDNs)e+=this._cdnScoreGetter(t);var t=e*Math.random();await this._expose(c.FlowKey.THRESHOLD,t)}async _injectSelectedCDN(){var e=this._require(c.FlowKey.RESULT);let t=this._require(c.FlowKey.THRESHOLD);for(const s of this._primeCDNs.iterator())if((t-=this._cdnScoreGetter(s.value))<0){e.push(s.value),s.drop();break}}async _injectRemainedCDNs(){await this._require(c.FlowKey.RESULT).push(...this._otherCDNs)}async _intakeOutcome(){this._outcome=this._require(c.FlowKey.RESULT)}static async process(e){return new RandomlySelectCDNsHandler({content:e}).process()}}},7195:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MCDNStatsHolder=t.MCDNStats=void 0;const n=s(787);t.MCDNStats=class MCDNStats{constructor(){this.reset()}get cdns(){return this._cdns}set cdns(e){this._cdns=e}get algorithmID(){return this._algorithmID}set algorithmID(e){this._algorithmID=e}get algorithmVersion(){return this._algorithmVersion}set algorithmVersion(e){this._algorithmVersion=e}get networkBandwidth(){return this._networkBandwidth}set networkBandwidth(e){this._networkBandwidth=e}reset(){this._cdns=new Map,this._algorithmID=null,this._algorithmVersion=null,this._networkBandwidth=n.MCDNConstant.QUALIFIED_DOWNLOAD_BANDWIDTH}};t.MCDNStatsHolder=class MCDNStatsHolder{static get instance(){return this._instance}static set instance(e){this._instance=e}static get cdns(){return this._instance.cdns}static get algorithmID(){return this._instance.algorithmID}static set algorithmID(e){this._instance.algorithmID=e}static get algorithmVersion(){return this._instance.algorithmVersion}static set algorithmVersion(e){this._instance.algorithmVersion=e}static get networkBandwidth(){return this._instance.networkBandwidth}static set networkBandwidth(e){this._instance.networkBandwidth=e}}},9560:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.P2PDownloadRecorder=void 0;const n=s(3267),a=s(3897),o=s(5227),c=s(7195);class P2PDownloadRecorder extends n.AbstractFlow{async process(){await this._intakeRecord(),await this._forwardRecord()}async _intakeRecord(){var e=new P2PDownloadRecordBuilder(this._content).build();await this._expose(a.FlowKey.RECORD,e)}async _forwardRecord(){var e=this._require(a.FlowKey.RECORD);await o.MetricsCollectorHolder.emit(o.MetricsCollectorEvent.P2P_DOWNLOAD_RECORD,e)}static async process(e){await new P2PDownloadRecorder({content:e}).process()}}t.P2PDownloadRecorder=P2PDownloadRecorder;class P2PDownloadRecordBuilder{constructor(e){this._options=e,this._initialize()}build(){return this._content}_initialize(){this._setContent(),this._setContentSize(),this._setElapsedTime(),this._setIsOutlier(),this._setBandwidth()}_setContent(){var e=this._options;this._content={peerID:e.peerID,peerType:e.peerType,ctime:Date.now(),totalSize:e.resource.total,contentType:e.resource.type,startTime:e.startTime,isComplete:e.resource.isComplete,swarmID:e.resource.swarmID,swarmURI:e.resource.swarmURI,sourceURI:e.resource.sourceURI,requestURI:e.resource.uri,algorithmID:c.MCDNStatsHolder.algorithmID,algorithmVersion:c.MCDNStatsHolder.algorithmVersion}}_setContentSize(){var e=this._options;this._content.contentSize=e.resource.size-e.startSize}_setElapsedTime(){var e=this._options;this._content.elapsedTime=e.endPerfTime-e.startPerfTime}_setIsOutlier(){this._content.isOutlier=0===this._content.contentSize}_setBandwidth(){this._content.isOutlier||(this._content.bandwidth=this._content.contentSize/(this._content.elapsedTime/1e3))}}},5821:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resourceTTLPool=t.ResourceTTL=void 0;const n=s(6796);class ResourceTTL{}(t.ResourceTTL=ResourceTTL).NEVER=-1,ResourceTTL.ETERNAL=0,ResourceTTL.TWO_HOUR=7200;const a=new Map([[n.ContentType.HLS_M3U,ResourceTTL.NEVER],[n.ContentType.HLS_M3U_2,ResourceTTL.NEVER],[n.ContentType.HLS_M3U8,ResourceTTL.NEVER],[n.ContentType.HLS_M3U8_2,ResourceTTL.NEVER]]);t.resourceTTLPool=a},6016:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Request=void 0;t.Request=class Request{constructor(e){this._task=e.task,this._resource=e.resource}get task(){return this._task}get resource(){return this._resource}get isAborted(){return!this._resource.isComplete&&this._task.state.isTerminated}async exit(){await this._task.exit()}async done(){await this._task.done()}async abort(e){await this._task.abort(e)}}},837:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceTTLSuggester=t.ResourceCache=void 0;const n=s(533),a=s(1744),o=s(5821);t.ResourceCache=class ResourceCache{constructor(e){this._lruCache=new n.LRUCache(e,{max:a.kernelSettings.download.maxCacheItems})}set(e,t,s){this._lruCache.set([e],t,1e3*s)}get(e){return this._lruCache.get([e])}peek(e){return this._lruCache.peek([e])}has(e){return this._lruCache.has([e])}delete(e){this._lruCache.delete([e])}keys(){return this._lruCache.keys()}values(){return this._lruCache.values()}prune(){this._lruCache.prune()}clear(){this._lruCache.clear()}};t.ResourceTTLSuggester=class ResourceTTLSuggester{static give(e){return e.isComplete?null!=(e=o.resourceTTLPool.get(e.type))?e:o.ResourceTTL.TWO_HOUR:o.ResourceTTL.ETERNAL}}},1615:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractFilerProvider=void 0;t.AbstractFilerProvider=class AbstractFilerProvider{async activate(){await this._activate()}async deactivate(){await this._deactivate()}}},8751:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractDownloader=void 0;const n=s(2016),a=s(7464);t.AbstractDownloader=class AbstractDownloader{constructor(e){this._resource=e,this._isAborted=!1}get _isComplete(){return this._resource.isComplete}async fetch(){await this._beforeFetch(),await this._fetching(),await this._afterFetch(),await this._throwIfAborted()}async _beforeFetch(){}async _afterFetch(){}async abort(){this._isAborted=!0,await this._abort()}async _throwIfAborted(){if(this._isAborted)throw new n.InternalError(a.MessageCode.ESC001,void 0,{resource:this._resource})}}},5610:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractFileDownloader=void 0;const n=s(1135),a=s(287),o=s(1139),c=s(8751);class AbstractFileDownloader extends c.AbstractDownloader{constructor(){super(...arguments),this._backoff=new n.DelayBackoff({delayerClass:n.ExponentialDelayer,delayerOptions:{baseInterval:.3,multiplier:2,magnification:.3,maxInterval:5,maxAttempts:-1}})}async _fetching(){for(;this._shouldFetch;)await this._ensureQueue(),await this._electProxy(),await this._proxyFetch()}get _shouldFetch(){return!this._isAborted&&!this._isComplete}async _ensureQueue(){this._proxyClasses&&(0!==this._proxyClasses.size||null!==this._proxy)||(this._proxyClasses=o.Queue.from(this._proxyAgent.makeProxyClasses()))}async _electProxy(){var e;this._proxy||(e=this._proxyClasses.pull(),this._proxy=new e(this._resource))}async _proxyFetch(){await this._proxy.fetch().catch((async e=>{var t=this._resource;if(await a.Logger.debug("File downloader fetch failed.",{resource:t},{error:e}),await this._proxy.abort(),this._proxy=null,this._isAborted)throw e;this._isQueueEmpty&&await this._backoff.delay()}))}get _isQueueEmpty(){return 0===this._proxyClasses.size}async _abort(){var e;await(null==(e=this._proxy)?void 0:e.abort())}}t.AbstractFileDownloader=AbstractFileDownloader},4417:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MCDNDownloaderProxy=t.AbstractHttpDownloaderProxy=t.AbstractDownloaderProxy=t.AbstractDownloaderAgent=t.BaseDownloaderProxyName=void 0;const n=s(6796),a=s(2016),o=s(287),c=s(1139),u=s(27),l=s(3050),d=s(964),h=s(1744),_=s(7464),p=s(922),f=s(9877),m=s(3722),y=s(8751);(t.BaseDownloaderProxyName=class BaseDownloaderProxyName{}).HTTP="http";t.AbstractDownloaderAgent=class AbstractDownloaderAgent{makeProxyClasses(){var e=this._proxyNames,t=new Array;for(const n of e){var s=this._proxyClasses.get(n);s&&t.push(s)}return t}};class AbstractDownloaderProxy extends y.AbstractDownloader{async fetch(){await this._setup(),await super.fetch()}async _beforeFetch(){this._resource.ptime.reset()}async _afterFetch(){this._isComplete&&this._resource.ptime.stamp()}}class AbstractHttpDownloaderProxy extends(t.AbstractDownloaderProxy=AbstractDownloaderProxy){constructor(e){super(e),this._resource=e,this._aborter=new u.AbortController,this._requestURI=this._resource.uri}async _fetching(){switch(await this._buildAborter(),await this._buildPayload(),this._responseStatus){case 200:await this._handleEntireContent();break;case 206:await this._handlePartialContent();break;default:await this._handleInvalidContent()}}get _responseStatus(){return this._payload.status}async _buildAborter(){this._aborter=new u.AbortController}async _buildPayload(){this._payload=await d.Requester.get(this._requestURI,{headers:{[n.HTTPHeader.RANGE]:`bytes=${this._resource.size}-`},aborter:this._aborter,timeout:h.kernelSettings.download.httpResponseTimeout}).catch((async e=>{throw new a.InternalError(_.MessageCode.ESC010,e)}))}async _handleEntireContent(){await this._concatResourceChunk(!1),await this._updateResourceType(),await this._updateResourceTotal()}async _handlePartialContent(){await this._concatResourceChunk(!0),await this._updateResourceType(),await this._updateResourceTotal()}async _handleInvalidContent(){throw new a.InternalError(_.MessageCode.ESC011,void 0,{payload:this._payload})}async _concatResourceChunk(e){let t=0;e&&(t=this._resource.size);for await(const e of this._payload.response.body)this._resource.concat({chunk:e,range:{start:t,end:t+e.length}}),t+=e.length}async _updateResourceType(){this._resource.type=this._payload.response.headers.get(n.HTTPHeader.CONTENT_TYPE).split(";")[0].toLowerCase()}async _updateResourceTotal(){this._resource.total=this._resource.size}async _abort(){await this._aborter.abort()}}class MCDNDownloaderProxy extends(t.AbstractHttpDownloaderProxy=AbstractHttpDownloaderProxy){constructor(e){super(e),this._resource=e}async _setup(){await this._resetStates(),await this._checkStates(),await this._ensureSources(),await this._fetchSource(),await this._buildRequestURI()}async _resetStates(){this._error=null,this._startSize=this._resource.size,this._startTime=Date.now()}async _checkStates(){if(this._resource.isShareable&&this._isWithinStartDelay)throw new a.InternalError(_.MessageCode.ESC012)}get _isWithinStartDelay(){var e=this._resource.startDelay;return!this._resource.ctime.stamp().hasElapsedTimeS(e)}async _ensureSources(){var e;this._sources&&0!==this._sources.size||(e=await m.MCDNSelector.process({resource:this._resource}),this._sources=c.Queue.from(e))}async _fetchSource(){this._source=this._sources.pull()}async _buildRequestURI(){var e=new URL(this._resource.uri);e.host=this._source.domain,e.searchParams.set(p.QueryStringKey.VIA_MLYSDK,"1"),this._requestURI=e.href}async _fetching(){await super._fetching().catch((async e=>{var t=this._resource;if(await o.Logger.debug("MCDN downloader proxy fetch failed.",{resource:t},{error:e}),this._error=e,!this._shouldRetry)throw e})).finally((async()=>{await this._buildMeasurement(),await this._recordDownload(),await this._clearPerformance()}))}get _shouldRetry(){return!this._resource.isComplete&&0<this._sources.size}async _buildMeasurement(){var e=l.performance.getEntriesByName(this._requestURI).pop();this._measurement=e}async _recordDownload(){await f.MCDNDownloadRecorder.process({source:this._source,resource:this._resource,payload:this._payload,error:this._error,aborter:this._aborter,requestURI:this._requestURI,startSize:this._startSize,startTime:this._startTime,measurement:this._measurement})}async _clearPerformance(){await l.performance.clearResourceTimings()}}t.MCDNDownloaderProxy=MCDNDownloaderProxy},3977:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractObtainResourceDuty=t.FileRequesterTaskName=t.AbstractFileRequester=t.AbstractFileSeeker=void 0;const n=s(2016),a=s(4944),o=s(7464),c=s(6016),u=s(837);t.AbstractFileSeeker=class AbstractFileSeeker{async activate(){await this._activate()}async deactivate(){await this._deactivate()}async fetch(e){return this._fetch(e,!0)}async prefetch(e){return this._fetch(e,!1)}async _fetch(e,t){return(e=await this._cache(e)).isComplete||await this._request(e,t),e}async _request(e,t){const s=await this._requester.fetch(e);t?(await s.done(),await this._storeCache(s.resource),await this._requester.clear(s.resource)):s.exit().then((async()=>{e.isComplete&&(await this._storeCache(s.resource),await this._requester.clear(s.resource))}))}async cache(e){return this._cache(e)}async _cache(e){return this._hasCached(e)||this._storeCache(e),this._fetchCache(e)}async abort(e){await this._requester.abort(e)}_hasCached(e){return this._resourceCache.has(e.id)}_fetchCache(e){return this._resourceCache.get(e.id)}_storeCache(e){var t=u.ResourceTTLSuggester.give(e);this._resourceCache.set(e.id,e,t)}};class AbstractFileRequester{constructor(){this._taskManager=new a.TaskManager,this._requestPool=new Map}async activate(){await this._activate()}async deactivate(){await this._deactivate()}async fetch(e){let t=await this._fetchRequest(e);return t||await this._buildRequest(e)}async abort(e){var t=this._fetchRequest(e);t&&(await this._abortRequest(t),await this._clearRequest(e))}async clear(e){await this._clearRequest(e)}async _abortRequest(e){await e.abort(FileRequesterError.REQUEST_ABORTED)}async _buildRequest(e){var t=await this._buildObtainResourceTask(e);t=new c.Request({task:t,resource:e});return await this._storeRequest(e,t),t}_fetchRequest(e){return this._requestPool.get(e.id)}_storeRequest(e,t){this._requestPool.set(e.id,t)}_clearRequest(e){this._requestPool.delete(e.id)}async _buildClearRequestTask(){await this._taskManager.createCyclicTask({name:FileRequesterTaskName.CLEAR_REQUEST,callee:async()=>{await this._execClearRequestTaskCallee()},sleepFirst:!0,sleepSeconds:20,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execClearRequestTaskCallee(){for(const e of this._requestPool.values())e.isAborted&&e.resource.mtime.hasElapsedTimeS(AbstractFileRequester.ABORTED_REQUEST_EXPIRY_TIME)&&await this._clearRequest(e.resource)}}(t.AbstractFileRequester=AbstractFileRequester).ABORTED_REQUEST_EXPIRY_TIME=600;class FileRequesterTaskName{}(t.FileRequesterTaskName=FileRequesterTaskName).CLEAR_REQUEST="file requester: clear request",FileRequesterTaskName.OBTAIN_RESOURCE="file requester: obtain resource";class FileRequesterError{}FileRequesterError.REQUEST_ABORTED=new n.InternalError(o.MessageCode.ESC000);class AbstractObtainResourceDuty extends a.CommonDuty{constructor(e){super(e),this._options=e}async callee(){await this._downloader.fetch()}async onFail(){await this._downloader.abort()}async onCancel(){await this._downloader.abort()}}t.AbstractObtainResourceDuty=AbstractObtainResourceDuty},1442:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resourceCache=void 0;const n=new(s(837).ResourceCache)("Resource");t.resourceCache=n},1050:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlobTool=void 0;const n=s(8925);t.BlobTool=class BlobTool{static async toBuffer(e){let t;return t=e instanceof ArrayBuffer?e:await e.arrayBuffer(),n.Buffer.from(t)}}},4770:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataTool=void 0;t.DataTool=class DataTool{static prune(e,t){if(0===e.length||e[e.length-1].ctime<t)return[];for(let s=0;s<e.length;s++)if(e[s].ctime>=t)return e.slice(s);return e}}},4916:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MathCalculator=t.MathFunction=void 0;t.MathFunction=class MathFunction{static upwardExponentialCurve(e,t){return 1-Math.pow(Math.E,-t*e)}static downwardExponentialCurve(e,t){return(-Math.tan(1/t*e*(Math.PI/2))+t)/t}static upwardSigmoidCurve(e,t){return 1-Math.pow(Math.E,-Math.pow(e/t,2))}static convexHyperbolicTangentCurve(e,t){return 1/Math.pow(Math.tanh(e)+1/Math.cosh(e),t)}};t.MathCalculator=class MathCalculator{static weightedAverage(e){var t;if(e.length<=1)return null!=(t=null==(t=e.pop())?void 0:t.value)?t:0;let s=0;for(let t=0;t<e.length;t++){var n=e[t],a=null!=(a=null==(a=e[t-1])?void 0:a.offset)?a:0;s+=n.value*(Math.pow(n.offset,2)-Math.pow(a,2))}return s/Math.pow(e[e.length-1].offset,2)}}},937:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.M3U8Tool=void 0;const n=s(1682),a=s(8925);t.M3U8Tool=class M3U8Tool{static parse(e){var t=new n.Parser;return t.push(a.Buffer.from(e).toString()),t.end(),t.manifest}}},1693:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerActionName=t.UserActionName=t.NodeActionName=t.BaseTrackerActionName=t.BasePeerActionName=t.BaseActionName=void 0;class BaseActionName{}(t.BaseActionName=BaseActionName).MESSAGE_REPORT_HEALTH="message: report health",BaseActionName.MESSAGE_NOTIFY_EXCEPTION="message: notify exception";class BasePeerActionName extends BaseActionName{}(t.BasePeerActionName=BasePeerActionName).REQUEST_OBTAIN_RESOURCE="request: obtain resource",BasePeerActionName.RESPOND_OBTAIN_RESOURCE="respond: obtain resource";class BaseTrackerActionName extends BaseActionName{}(t.BaseTrackerActionName=BaseTrackerActionName).MESSAGE_CONFIRM_RECEIPT="message: confirm receipt",BaseTrackerActionName.MESSAGE_DELIVER_EXCEPTION="message: deliver exception",BaseTrackerActionName.MESSAGE_DELIVER_ICE_CANDIDATE="message: deliver ice candidate";t.NodeActionName=class NodeActionName extends BasePeerActionName{};class UserActionName extends BasePeerActionName{}(t.UserActionName=UserActionName).MESSAGE_REPORT_RESOURCE_STAT="message: report resource stat",UserActionName.MESSAGE_REPORT_RESOURCE_STATS="message: report resource stats";class TrackerActionName extends BaseTrackerActionName{}(t.TrackerActionName=TrackerActionName).REQUEST_ENABLE_USER="request: enable user",TrackerActionName.RESPOND_ENABLE_USER="respond: enable user",TrackerActionName.REQUEST_CONNECT_NODE="request: connect node",TrackerActionName.RESPOND_CONNECT_NODE="respond: connect node",TrackerActionName.REQUEST_CONNECT_USER="request: connect user",TrackerActionName.RESPOND_CONNECT_USER="respond: connect user",TrackerActionName.REQUEST_JOIN_SWARM="request: join swarm",TrackerActionName.RESPOND_JOIN_SWARM="respond: join swarm",TrackerActionName.MESSAGE_REPORT_SWARM_STATS="message: report swarm stats",TrackerActionName.REQUEST_OBTAIN_SWARM_USERS="request: obtain swarm users",TrackerActionName.RESPOND_OBTAIN_SWARM_USERS="respond: obtain swarm users",TrackerActionName.MESSAGE_LEAVE_SWARM="message: leave swarm"},4553:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceStat=t.ResourceRange=void 0;const a=n(s(3720)),o=n(s(2100));t.ResourceRange={encode:(e,t=o.default.Writer.create())=>(0!==e.start&&t.uint32(8).int64(e.start),0!==e.end&&t.uint32(16).int64(e.end),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={start:0,end:0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(8!=c)break;a.start=u(s.int64());continue;case 2:if(16==c){a.end=u(s.int64());continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.ResourceStat={encode:(e,t=o.default.Writer.create())=>(""!==e.id&&t.uint32(10).string(e.id),0!==e.completion&&t.uint32(17).double(e.completion),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={id:"",completion:0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.id=s.string();continue;case 2:if(17==c){a.completion=s.double();continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}};var c=(()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==s.g)return s.g;throw"Unable to locate global object"})();function u(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new c.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}o.default.util.Long!==a.default&&(o.default.util.Long=a.default,o.default.configure())},6682:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRTCICE=void 0;const a=n(s(3720)),o=n(s(2100));t.WebRTCICE={encode:(e,t=o.default.Writer.create())=>(void 0!==e.candidate&&t.uint32(10).string(e.candidate),void 0!==e.sdpMid&&t.uint32(18).string(e.sdpMid),void 0!==e.sdpMLineIndex&&t.uint32(24).int64(e.sdpMLineIndex),void 0!==e.usernameFragment&&t.uint32(34).string(e.usernameFragment),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={candidate:void 0,sdpMid:void 0,sdpMLineIndex:void 0,usernameFragment:void 0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.candidate=s.string();continue;case 2:if(18!=c)break;a.sdpMid=s.string();continue;case 3:if(24!=c)break;a.sdpMLineIndex=u(s.int64());continue;case 4:if(34==c){a.usernameFragment=s.string();continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}};var c=(()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==s.g)return s.g;throw"Unable to locate global object"})();function u(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new c.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}o.default.util.Long!==a.default&&(o.default.util.Long=a.default,o.default.configure())},7950:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseHeader=t.ResponsePayload=t.RequestHeader=t.RequestPayload=t.MessageHeader=t.MessagePayload=void 0;const a=n(s(3720)),o=n(s(2100));t.MessagePayload={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&t.MessageHeader.encode(e.header,s.uint32(18).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18==u){c.header=t.MessageHeader.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.MessageHeader={encode:(e,t=o.default.Writer.create())=>(void 0!==e.correlation_id&&t.uint32(10).string(e.correlation_id),void 0!==e.source_peer_id&&t.uint32(50).string(e.source_peer_id),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={correlation_id:void 0,source_peer_id:void 0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.correlation_id=s.string();continue;case 6:if(50==c){a.source_peer_id=s.string();continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.RequestPayload={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&t.RequestHeader.encode(e.header,s.uint32(18).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18==u){c.header=t.RequestHeader.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.RequestHeader={encode:(e,t=o.default.Writer.create())=>(""!==e.correlation_id&&t.uint32(10).string(e.correlation_id),""!==e.source_peer_id&&t.uint32(50).string(e.source_peer_id),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={correlation_id:"",source_peer_id:""};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.correlation_id=s.string();continue;case 6:if(50==c){a.source_peer_id=s.string();continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.ResponsePayload={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&t.ResponseHeader.encode(e.header,s.uint32(18).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18==u){c.header=t.ResponseHeader.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.ResponseHeader={encode:(e,t=o.default.Writer.create())=>(""!==e.correlation_id&&t.uint32(10).string(e.correlation_id),0!==e.response_code&&t.uint32(88).int64(e.response_code),!0===e.response_status&&t.uint32(96).bool(e.response_status),""!==e.response_message&&t.uint32(106).string(e.response_message),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={correlation_id:"",response_code:0,response_status:!1,response_message:""};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.correlation_id=s.string();continue;case 11:if(88!=c)break;a.response_code=u(s.int64());continue;case 12:if(96!=c)break;a.response_status=s.bool();continue;case 13:if(106==c){a.response_message=s.string();continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}};var c=(()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==s.g)return s.g;throw"Unable to locate global object"})();function u(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new c.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}o.default.util.Long!==a.default&&(o.default.util.Long=a.default,o.default.configure())},2890:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PeerNotifyExceptionMessage=t.PeerReportHealthMessage=t.PeerReportResourceStatsMessage_MessageContent=t.PeerReportResourceStatsMessage=t.PeerReportResourceStatMessage_MessageContent=t.PeerReportResourceStatMessage=t.PeerObtainResourceResponse_ResponseContent=t.PeerObtainResourceResponse=t.PeerObtainResourceRequest_RequestContent=t.PeerObtainResourceRequest=void 0;const a=n(s(3720)),o=n(s(2100)),c=s(4553),u=s(7950);t.PeerObtainResourceRequest={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&u.RequestHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.PeerObtainResourceRequest_RequestContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var l=n.uint32();switch(l>>>3){case 1:if(10!=l)break;c.action=n.string();continue;case 2:if(18!=l)break;c.header=u.RequestHeader.decode(n,n.uint32());continue;case 3:if(26==l){c.content=t.PeerObtainResourceRequest_RequestContent.decode(n,n.uint32());continue}}if(4==(7&l)||0==l)break;n.skipType(7&l)}return c}},t.PeerObtainResourceRequest_RequestContent={encode:(e,t=o.default.Writer.create())=>(""!==e.id&&t.uint32(10).string(e.id),""!==e.uri&&t.uint32(18).string(e.uri),void 0!==e.range&&c.ResourceRange.encode(e.range,t.uint32(26).fork()).ldelim(),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={id:"",uri:"",range:void 0};s.pos<n;){var u=s.uint32();switch(u>>>3){case 1:if(10!=u)break;a.id=s.string();continue;case 2:if(18!=u)break;a.uri=s.string();continue;case 3:if(26==u){a.range=c.ResourceRange.decode(s,s.uint32());continue}}if(4==(7&u)||0==u)break;s.skipType(7&u)}return a}},t.PeerObtainResourceResponse={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&u.ResponseHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.PeerObtainResourceResponse_ResponseContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var l=n.uint32();switch(l>>>3){case 1:if(10!=l)break;c.action=n.string();continue;case 2:if(18!=l)break;c.header=u.ResponseHeader.decode(n,n.uint32());continue;case 3:if(26==l){c.content=t.PeerObtainResourceResponse_ResponseContent.decode(n,n.uint32());continue}}if(4==(7&l)||0==l)break;n.skipType(7&l)}return c}},t.PeerObtainResourceResponse_ResponseContent={encode:(e,t=o.default.Writer.create())=>(""!==e.id&&t.uint32(10).string(e.id),""!==e.uri&&t.uint32(18).string(e.uri),void 0!==e.type&&t.uint32(26).string(e.type),void 0!==e.total&&t.uint32(32).int64(e.total),void 0!==e.range&&c.ResourceRange.encode(e.range,t.uint32(42).fork()).ldelim(),0!==e.pieces.length&&t.uint32(50).bytes(e.pieces),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={id:"",uri:"",type:void 0,total:void 0,range:void 0,pieces:new Uint8Array};s.pos<n;){var u=s.uint32();switch(u>>>3){case 1:if(10!=u)break;a.id=s.string();continue;case 2:if(18!=u)break;a.uri=s.string();continue;case 3:if(26!=u)break;a.type=s.string();continue;case 4:if(32!=u)break;a.total=d(s.int64());continue;case 5:if(42!=u)break;a.range=c.ResourceRange.decode(s,s.uint32());continue;case 6:if(50==u){a.pieces=s.bytes();continue}}if(4==(7&u)||0==u)break;s.skipType(7&u)}return a}},t.PeerReportResourceStatMessage={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&u.MessageHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.PeerReportResourceStatMessage_MessageContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var l=n.uint32();switch(l>>>3){case 1:if(10!=l)break;c.action=n.string();continue;case 2:if(18!=l)break;c.header=u.MessageHeader.decode(n,n.uint32());continue;case 3:if(26==l){c.content=t.PeerReportResourceStatMessage_MessageContent.decode(n,n.uint32());continue}}if(4==(7&l)||0==l)break;n.skipType(7&l)}return c}},t.PeerReportResourceStatMessage_MessageContent={encode:(e,t=o.default.Writer.create())=>(void 0!==e.stat&&c.ResourceStat.encode(e.stat,t.uint32(10).fork()).ldelim(),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={stat:void 0};s.pos<n;){var u=s.uint32();if(u>>>3!=1||10!=u){if(4==(7&u)||0==u)break;s.skipType(7&u)}else a.stat=c.ResourceStat.decode(s,s.uint32())}return a}},t.PeerReportResourceStatsMessage={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&u.MessageHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.PeerReportResourceStatsMessage_MessageContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var l=n.uint32();switch(l>>>3){case 1:if(10!=l)break;c.action=n.string();continue;case 2:if(18!=l)break;c.header=u.MessageHeader.decode(n,n.uint32());continue;case 3:if(26==l){c.content=t.PeerReportResourceStatsMessage_MessageContent.decode(n,n.uint32());continue}}if(4==(7&l)||0==l)break;n.skipType(7&l)}return c}},t.PeerReportResourceStatsMessage_MessageContent={encode(e,t=o.default.Writer.create()){for(const s of e.stats)c.ResourceStat.encode(s,t.uint32(10).fork()).ldelim();return t},decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={stats:[]};s.pos<n;){var u=s.uint32();if(u>>>3!=1||10!=u){if(4==(7&u)||0==u)break;s.skipType(7&u)}else a.stats.push(c.ResourceStat.decode(s,s.uint32()))}return a}},t.PeerReportHealthMessage={encode:(e,t=o.default.Writer.create())=>(""!==e.action&&t.uint32(10).string(e.action),void 0!==e.header&&u.MessageHeader.encode(e.header,t.uint32(18).fork()).ldelim(),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={action:"",header:void 0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.action=s.string();continue;case 2:if(18==c){a.header=u.MessageHeader.decode(s,s.uint32());continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.PeerNotifyExceptionMessage={encode:(e,t=o.default.Writer.create())=>(""!==e.action&&t.uint32(10).string(e.action),void 0!==e.header&&u.ResponseHeader.encode(e.header,t.uint32(18).fork()).ldelim(),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={action:"",header:void 0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.action=s.string();continue;case 2:if(18==c){a.header=u.ResponseHeader.decode(s,s.uint32());continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}};var l=(()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==s.g)return s.g;throw"Unable to locate global object"})();function d(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new l.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}o.default.util.Long!==a.default&&(o.default.util.Long=a.default,o.default.configure())},1716:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerDeliverIceCandidateMessage_RequestContent=t.TrackerDeliverIceCandidateMessage=t.TrackerDeliverExceptionMessage_RequestContent=t.TrackerDeliverExceptionMessage=t.TrackerConfirmReceiptMessage=t.TrackerNotifyExceptionMessage=t.TrackerReportHealthMessage=t.TrackerLeaveSwarmMessage_MessageContent=t.TrackerLeaveSwarmMessage=t.TrackerObtainSwarmUsersResponse_ResponseContent=t.TrackerObtainSwarmUsersResponse=t.TrackerObtainSwarmUsersRequest_RequestContent=t.TrackerObtainSwarmUsersRequest=t.TrackerReportSwarmStatsMessage_MessageContent=t.TrackerReportSwarmStatsMessage=t.TrackerJoinSwarmResponse=t.TrackerJoinSwarmRequest_RequestContent=t.TrackerJoinSwarmRequest=t.TrackerConnectUserResponse_ResponseContent=t.TrackerConnectUserResponse=t.TrackerConnectUserRequest_RequestContent=t.TrackerConnectUserRequest=t.TrackerConnectNodeResponse_ResponseContent=t.TrackerConnectNodeResponse=t.TrackerConnectNodeRequest_RequestContent=t.TrackerConnectNodeRequest=t.TrackerEnableUserResponse=t.TrackerEnableUserRequest=void 0;const a=n(s(3720)),o=n(s(2100)),c=s(6118),u=s(6682),l=s(7950);t.TrackerEnableUserRequest={encode:(e,t=o.default.Writer.create())=>(""!==e.action&&t.uint32(10).string(e.action),void 0!==e.header&&l.RequestHeader.encode(e.header,t.uint32(18).fork()).ldelim(),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={action:"",header:void 0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.action=s.string();continue;case 2:if(18==c){a.header=l.RequestHeader.decode(s,s.uint32());continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.TrackerEnableUserResponse={encode:(e,t=o.default.Writer.create())=>(""!==e.action&&t.uint32(10).string(e.action),void 0!==e.header&&l.ResponseHeader.encode(e.header,t.uint32(18).fork()).ldelim(),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={action:"",header:void 0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.action=s.string();continue;case 2:if(18==c){a.header=l.ResponseHeader.decode(s,s.uint32());continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.TrackerConnectNodeRequest={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&l.RequestHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.TrackerConnectNodeRequest_RequestContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18!=u)break;c.header=l.RequestHeader.decode(n,n.uint32());continue;case 3:if(26==u){c.content=t.TrackerConnectNodeRequest_RequestContent.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.TrackerConnectNodeRequest_RequestContent={encode:(e,t=o.default.Writer.create())=>(""!==e.sdp&&t.uint32(10).string(e.sdp),""!==e.type&&t.uint32(18).string(e.type),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={sdp:"",type:""};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.sdp=s.string();continue;case 2:if(18==c){a.type=s.string();continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.TrackerConnectNodeResponse={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&l.ResponseHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.TrackerConnectNodeResponse_ResponseContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18!=u)break;c.header=l.ResponseHeader.decode(n,n.uint32());continue;case 3:if(26==u){c.content=t.TrackerConnectNodeResponse_ResponseContent.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.TrackerConnectNodeResponse_ResponseContent={encode:(e,t=o.default.Writer.create())=>(""!==e.peer_id&&t.uint32(10).string(e.peer_id),""!==e.sdp&&t.uint32(18).string(e.sdp),""!==e.type&&t.uint32(26).string(e.type),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={peer_id:"",sdp:"",type:""};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.peer_id=s.string();continue;case 2:if(18!=c)break;a.sdp=s.string();continue;case 3:if(26==c){a.type=s.string();continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.TrackerConnectUserRequest={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&l.RequestHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.TrackerConnectUserRequest_RequestContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18!=u)break;c.header=l.RequestHeader.decode(n,n.uint32());continue;case 3:if(26==u){c.content=t.TrackerConnectUserRequest_RequestContent.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.TrackerConnectUserRequest_RequestContent={encode:(e,t=o.default.Writer.create())=>(""!==e.peer_id&&t.uint32(10).string(e.peer_id),""!==e.swarm_id&&t.uint32(18).string(e.swarm_id),""!==e.sdp&&t.uint32(26).string(e.sdp),""!==e.type&&t.uint32(34).string(e.type),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={peer_id:"",swarm_id:"",sdp:"",type:""};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.peer_id=s.string();continue;case 2:if(18!=c)break;a.swarm_id=s.string();continue;case 3:if(26!=c)break;a.sdp=s.string();continue;case 4:if(34==c){a.type=s.string();continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.TrackerConnectUserResponse={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&l.ResponseHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.TrackerConnectUserResponse_ResponseContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18!=u)break;c.header=l.ResponseHeader.decode(n,n.uint32());continue;case 3:if(26==u){c.content=t.TrackerConnectUserResponse_ResponseContent.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.TrackerConnectUserResponse_ResponseContent={encode:(e,t=o.default.Writer.create())=>(""!==e.peer_id&&t.uint32(10).string(e.peer_id),""!==e.swarm_id&&t.uint32(18).string(e.swarm_id),""!==e.sdp&&t.uint32(26).string(e.sdp),""!==e.type&&t.uint32(34).string(e.type),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={peer_id:"",swarm_id:"",sdp:"",type:""};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.peer_id=s.string();continue;case 2:if(18!=c)break;a.swarm_id=s.string();continue;case 3:if(26!=c)break;a.sdp=s.string();continue;case 4:if(34==c){a.type=s.string();continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.TrackerJoinSwarmRequest={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&l.RequestHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.TrackerJoinSwarmRequest_RequestContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18!=u)break;c.header=l.RequestHeader.decode(n,n.uint32());continue;case 3:if(26==u){c.content=t.TrackerJoinSwarmRequest_RequestContent.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.TrackerJoinSwarmRequest_RequestContent={encode:(e,t=o.default.Writer.create())=>(""!==e.swarm_id&&t.uint32(10).string(e.swarm_id),0!==e.swarm_score&&t.uint32(17).double(e.swarm_score),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={swarm_id:"",swarm_score:0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.swarm_id=s.string();continue;case 2:if(17==c){a.swarm_score=s.double();continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.TrackerJoinSwarmResponse={encode:(e,t=o.default.Writer.create())=>(""!==e.action&&t.uint32(10).string(e.action),void 0!==e.header&&l.ResponseHeader.encode(e.header,t.uint32(18).fork()).ldelim(),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={action:"",header:void 0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.action=s.string();continue;case 2:if(18==c){a.header=l.ResponseHeader.decode(s,s.uint32());continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.TrackerReportSwarmStatsMessage={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&l.MessageHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.TrackerReportSwarmStatsMessage_MessageContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18!=u)break;c.header=l.MessageHeader.decode(n,n.uint32());continue;case 3:if(26==u){c.content=t.TrackerReportSwarmStatsMessage_MessageContent.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.TrackerReportSwarmStatsMessage_MessageContent={encode:(e,t=o.default.Writer.create())=>(""!==e.swarm_id&&t.uint32(10).string(e.swarm_id),0!==e.swarm_score&&t.uint32(17).double(e.swarm_score),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={swarm_id:"",swarm_score:0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.swarm_id=s.string();continue;case 2:if(17==c){a.swarm_score=s.double();continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.TrackerObtainSwarmUsersRequest={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&l.RequestHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.TrackerObtainSwarmUsersRequest_RequestContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18!=u)break;c.header=l.RequestHeader.decode(n,n.uint32());continue;case 3:if(26==u){c.content=t.TrackerObtainSwarmUsersRequest_RequestContent.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.TrackerObtainSwarmUsersRequest_RequestContent={encode:(e,t=o.default.Writer.create())=>(""!==e.swarm_id&&t.uint32(10).string(e.swarm_id),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={swarm_id:""};s.pos<n;){var c=s.uint32();if(c>>>3!=1||10!=c){if(4==(7&c)||0==c)break;s.skipType(7&c)}else a.swarm_id=s.string()}return a}},t.TrackerObtainSwarmUsersResponse={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&l.ResponseHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.TrackerObtainSwarmUsersResponse_ResponseContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18!=u)break;c.header=l.ResponseHeader.decode(n,n.uint32());continue;case 3:if(26==u){c.content=t.TrackerObtainSwarmUsersResponse_ResponseContent.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.TrackerObtainSwarmUsersResponse_ResponseContent={encode(e,t=o.default.Writer.create()){for(const s of e.swarm_users)c.ListValue.encode(c.ListValue.wrap(s),t.uint32(10).fork()).ldelim();return t},decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={swarm_users:[]};s.pos<n;){var u=s.uint32();if(u>>>3!=1||10!=u){if(4==(7&u)||0==u)break;s.skipType(7&u)}else a.swarm_users.push(c.ListValue.unwrap(c.ListValue.decode(s,s.uint32())))}return a}},t.TrackerLeaveSwarmMessage={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&l.MessageHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.TrackerLeaveSwarmMessage_MessageContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18!=u)break;c.header=l.MessageHeader.decode(n,n.uint32());continue;case 3:if(26==u){c.content=t.TrackerLeaveSwarmMessage_MessageContent.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.TrackerLeaveSwarmMessage_MessageContent={encode:(e,t=o.default.Writer.create())=>(""!==e.swarm_id&&t.uint32(10).string(e.swarm_id),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={swarm_id:""};s.pos<n;){var c=s.uint32();if(c>>>3!=1||10!=c){if(4==(7&c)||0==c)break;s.skipType(7&c)}else a.swarm_id=s.string()}return a}},t.TrackerReportHealthMessage={encode:(e,t=o.default.Writer.create())=>(""!==e.action&&t.uint32(10).string(e.action),void 0!==e.header&&l.MessageHeader.encode(e.header,t.uint32(18).fork()).ldelim(),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={action:"",header:void 0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.action=s.string();continue;case 2:if(18==c){a.header=l.MessageHeader.decode(s,s.uint32());continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.TrackerNotifyExceptionMessage={encode:(e,t=o.default.Writer.create())=>(""!==e.action&&t.uint32(10).string(e.action),void 0!==e.header&&l.ResponseHeader.encode(e.header,t.uint32(18).fork()).ldelim(),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={action:"",header:void 0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.action=s.string();continue;case 2:if(18==c){a.header=l.ResponseHeader.decode(s,s.uint32());continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.TrackerConfirmReceiptMessage={encode:(e,t=o.default.Writer.create())=>(""!==e.action&&t.uint32(10).string(e.action),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={action:""};s.pos<n;){var c=s.uint32();if(c>>>3!=1||10!=c){if(4==(7&c)||0==c)break;s.skipType(7&c)}else a.action=s.string()}return a}},t.TrackerDeliverExceptionMessage={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&l.RequestHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.TrackerDeliverExceptionMessage_RequestContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18!=u)break;c.header=l.RequestHeader.decode(n,n.uint32());continue;case 3:if(26==u){c.content=t.TrackerDeliverExceptionMessage_RequestContent.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.TrackerDeliverExceptionMessage_RequestContent={encode:(e,t=o.default.Writer.create())=>(""!==e.peer_id&&t.uint32(10).string(e.peer_id),0!==e.code&&t.uint32(16).int64(e.code),!0===e.status&&t.uint32(24).bool(e.status),""!==e.message&&t.uint32(34).string(e.message),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={peer_id:"",code:0,status:!1,message:""};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.peer_id=s.string();continue;case 2:if(16!=c)break;a.code=h(s.int64());continue;case 3:if(24!=c)break;a.status=s.bool();continue;case 4:if(34==c){a.message=s.string();continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}},t.TrackerDeliverIceCandidateMessage={encode:(e,s=o.default.Writer.create())=>(""!==e.action&&s.uint32(10).string(e.action),void 0!==e.header&&l.RequestHeader.encode(e.header,s.uint32(18).fork()).ldelim(),void 0!==e.content&&t.TrackerDeliverIceCandidateMessage_RequestContent.encode(e.content,s.uint32(26).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={action:"",header:void 0,content:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.action=n.string();continue;case 2:if(18!=u)break;c.header=l.RequestHeader.decode(n,n.uint32());continue;case 3:if(26==u){c.content=t.TrackerDeliverIceCandidateMessage_RequestContent.decode(n,n.uint32());continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.TrackerDeliverIceCandidateMessage_RequestContent={encode:(e,t=o.default.Writer.create())=>(""!==e.peer_id&&t.uint32(10).string(e.peer_id),void 0!==e.swarm_id&&t.uint32(18).string(e.swarm_id),void 0!==e.ice&&u.WebRTCICE.encode(e.ice,t.uint32(26).fork()).ldelim(),t),decode(e,t){for(var s=e instanceof o.default.Reader?e:o.default.Reader.create(e),n=void 0===t?s.len:s.pos+t,a={peer_id:"",swarm_id:void 0,ice:void 0};s.pos<n;){var c=s.uint32();switch(c>>>3){case 1:if(10!=c)break;a.peer_id=s.string();continue;case 2:if(18!=c)break;a.swarm_id=s.string();continue;case 3:if(26==c){a.ice=u.WebRTCICE.decode(s,s.uint32());continue}}if(4==(7&c)||0==c)break;s.skipType(7&c)}return a}};var d=(()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==s.g)return s.g;throw"Unable to locate global object"})();function h(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new d.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}o.default.util.Long!==a.default&&(o.default.util.Long=a.default,o.default.configure())},2841:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerErrorMessageCreator=t.PeerErrorMessageCreator=void 0;const n=s(2016),a=s(1744),o=s(7464),c=s(1693),u=s(2890),l=s(1716);class AbstractErrorMessageCreator{constructor(e,t){this._id=e,this._cause=t}get id(){return this._id}get cause(){return this._cause}get code(){return this._code}get error(){return this._error}get buffer(){return this._buffer}_setCode(){this._code=AbstractErrorMessageCreator.DEFAULT_MESSAGE_CODE,this._cause instanceof n.InternalError&&(this._code=this._cause.code)}_setError(){this._cause instanceof n.InternalError?this._error=this._cause:this._error=new n.InternalError(this._code,this._cause)}}AbstractErrorMessageCreator.DEFAULT_MESSAGE_CODE=o.MessageCode.ESP001;t.PeerErrorMessageCreator=class PeerErrorMessageCreator extends AbstractErrorMessageCreator{constructor(e,t){super(e,t),this._id=e,this._cause=t,this._initialize()}_initialize(){this._setCode(),this._setError(),this._setBuffer()}_setBuffer(){this._buffer=u.PeerNotifyExceptionMessage.encode({action:c.BaseActionName.MESSAGE_NOTIFY_EXCEPTION,header:{correlation_id:this._id,response_code:this._code.metaCode,response_status:this._code.metaStatus,response_message:this._code.metaContent}}).finish()}};t.TrackerErrorMessageCreator=class TrackerErrorMessageCreator extends AbstractErrorMessageCreator{constructor(e,t,s){super(e,t),this._id=e,this._cause=t,this._peerID=s,this._initialize()}_initialize(){this._setCode(),this._setError(),this._setBuffer()}_setBuffer(){this._buffer=l.TrackerDeliverExceptionMessage.encode({action:c.BaseTrackerActionName.MESSAGE_DELIVER_EXCEPTION,header:{correlation_id:this._id,source_peer_id:a.kernelSettings.client.peerID},content:{peer_id:this._peerID,code:this._code.metaCode,status:this._code.metaStatus,message:this._code.metaContent}}).finish()}}},6897:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorMessageDetector=void 0;const n=s(2016),a=s(7464),o=s(1693),c=s(7950);class ErrorMessageDetector{constructor(e){this._buffer=e,this._initialize()}get error(){return this._error}get buffer(){return this._buffer}_initialize(){this._setError()}_setError(){var e=c.ResponsePayload.decode(this._buffer);e.action===o.BaseActionName.MESSAGE_NOTIFY_EXCEPTION&&(this._error=new n.InternalError(a.MessageCode.ESP000,void 0,{payload:e}))}throwIfError(){if(this._error)throw this._error}static throwIfError(e){new ErrorMessageDetector(e).throwIfError()}}t.ErrorMessageDetector=ErrorMessageDetector},9007:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolMessage=void 0;const n=s(7950);t.ProtocolMessage=class ProtocolMessage{constructor(e){this._buffer=e,this._payload=n.MessagePayload.decode(e)}get buffer(){return this._buffer}get payload(){return this._payload}}},6118:function(e,t,s){"use strict";var n,a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ListValue=t.Value=t.Struct_FieldsEntry=t.Struct=t.NullValue=void 0;const o=a(s(2100));var c;(c=n=t.NullValue||(t.NullValue={}))[c.NULL_VALUE=0]="NULL_VALUE",c[c.UNRECOGNIZED=-1]="UNRECOGNIZED",t.Struct={encode:(e,s=o.default.Writer.create())=>(Object.entries(e.fields).forEach((([e,n])=>{void 0!==n&&t.Struct_FieldsEntry.encode({key:e,value:n},s.uint32(10).fork()).ldelim()})),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={fields:{}};n.pos<a;){var u=n.uint32();if(u>>>3!=1||10!=u){if(4==(7&u)||0==u)break;n.skipType(7&u)}else{var l=t.Struct_FieldsEntry.decode(n,n.uint32());void 0!==l.value&&(c.fields[l.key]=l.value)}}return c},wrap(e){const t={fields:{}};return void 0!==e&&Object.keys(e).forEach((s=>{t.fields[s]=e[s]})),t},unwrap(e){const t={};return e.fields&&Object.keys(e.fields).forEach((s=>{t[s]=e.fields[s]})),t}},t.Struct_FieldsEntry={encode:(e,s=o.default.Writer.create())=>(""!==e.key&&s.uint32(10).string(e.key),void 0!==e.value&&t.Value.encode(t.Value.wrap(e.value),s.uint32(18).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={key:"",value:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(10!=u)break;c.key=n.string();continue;case 2:if(18==u){c.value=t.Value.unwrap(t.Value.decode(n,n.uint32()));continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c}},t.Value={encode:(e,s=o.default.Writer.create())=>(void 0!==e.null_value&&s.uint32(8).int32(e.null_value),void 0!==e.number_value&&s.uint32(17).double(e.number_value),void 0!==e.string_value&&s.uint32(26).string(e.string_value),void 0!==e.bool_value&&s.uint32(32).bool(e.bool_value),void 0!==e.struct_value&&t.Struct.encode(t.Struct.wrap(e.struct_value),s.uint32(42).fork()).ldelim(),void 0!==e.list_value&&t.ListValue.encode(t.ListValue.wrap(e.list_value),s.uint32(50).fork()).ldelim(),s),decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={null_value:void 0,number_value:void 0,string_value:void 0,bool_value:void 0,struct_value:void 0,list_value:void 0};n.pos<a;){var u=n.uint32();switch(u>>>3){case 1:if(8!=u)break;c.null_value=n.int32();continue;case 2:if(17!=u)break;c.number_value=n.double();continue;case 3:if(26!=u)break;c.string_value=n.string();continue;case 4:if(32!=u)break;c.bool_value=n.bool();continue;case 5:if(42!=u)break;c.struct_value=t.Struct.unwrap(t.Struct.decode(n,n.uint32()));continue;case 6:if(50==u){c.list_value=t.ListValue.unwrap(t.ListValue.decode(n,n.uint32()));continue}}if(4==(7&u)||0==u)break;n.skipType(7&u)}return c},wrap(e){var t={null_value:void 0,number_value:void 0,string_value:void 0,bool_value:void 0,struct_value:void 0,list_value:void 0};if(null===e)t.null_value=n.NULL_VALUE;else if("boolean"==typeof e)t.bool_value=e;else if("number"==typeof e)t.number_value=e;else if("string"==typeof e)t.string_value=e;else if(Array.isArray(e))t.list_value=e;else if("object"==typeof e)t.struct_value=e;else if(void 0!==e)throw new Error("Unsupported any value type: "+typeof e);return t},unwrap:e=>void 0!==e.string_value?e.string_value:void 0!==(null==e?void 0:e.number_value)?e.number_value:void 0!==(null==e?void 0:e.bool_value)?e.bool_value:void 0!==(null==e?void 0:e.struct_value)?e.struct_value:void 0!==(null==e?void 0:e.list_value)?e.list_value:void 0!==(null==e?void 0:e.null_value)?null:void 0},t.ListValue={encode(e,s=o.default.Writer.create()){for(const n of e.values)t.Value.encode(t.Value.wrap(n),s.uint32(10).fork()).ldelim();return s},decode(e,s){for(var n=e instanceof o.default.Reader?e:o.default.Reader.create(e),a=void 0===s?n.len:n.pos+s,c={values:[]};n.pos<a;){var u=n.uint32();if(u>>>3!=1||10!=u){if(4==(7&u)||0==u)break;n.skipType(7&u)}else c.values.push(t.Value.unwrap(t.Value.decode(n,n.uint32())))}return c},wrap(e){var t={values:[]};return t.values=null!=e?e:[],t},unwrap:e=>null!=e&&e.hasOwnProperty("values")&&Array.isArray(e.values)?e.values:e}},9131:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrokerPool=t.AbstractBrokerInfo=void 0;const n=s(9282),a=s(6903);t.AbstractBrokerInfo=class AbstractBrokerInfo{constructor(){this._peerType=n.PeerType.USER}get peerID(){return this._peerID}set peerID(e){this._peerID=e}get peerType(){return this._peerType}set peerType(e){this._peerType=e}};class BrokerPool extends a.BasePool{async available(e){await this._pool.get(e).condition.done()}}t.BrokerPool=BrokerPool},7835:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractDaemon=void 0;const a=n(s(148)),o=s(4944);class AbstractDaemon extends a.default{constructor(){super(...arguments),this._taskManager=new o.TaskManager}async activate(){await this._activate()}async deactivate(){await this._deactivate()}}t.AbstractDaemon=AbstractDaemon},1438:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractProcessAgent=void 0;t.AbstractProcessAgent=class AbstractProcessAgent{async operate(e){return new(this._pipeClasses.get(e.name))(null!=(e=e.data)?e:{}).process()}findPipeName(e){return this._pipeNames.get(e)}}},5493:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractProcessFlow=void 0;const n=s(2016),a=s(3267),o=s(7464),c=s(7926),u=s(1598),l=s(4865);class AbstractProcessFlow extends a.AbstractFlow{constructor(e){super(e),this._brokerID=null==e?void 0:e.brokerID}_obtainPeerBroker(){var e=this._brokerID;if(e){var t=u.peerBrokerPool.retrieve(e);if(t)return t}throw new n.InternalError(o.MessageCode.ESP010,void 0,{id:e})}_obtainNodeBroker(){var e=u.peerBrokerPool.retrieve(c.BrokerID.NODE);if(e)return e;throw new n.InternalError(o.MessageCode.ESP011)}_obtainTrackerBroker(){var e=l.trackerBrokerPool.retrieve(c.BrokerID.TRACKER);if(e)return e;throw new n.InternalError(o.MessageCode.ESP012)}}t.AbstractProcessFlow=AbstractProcessFlow},8024:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractProcessPipe=void 0;const n=s(5493);class AbstractProcessPipe extends n.AbstractProcessFlow{constructor(e){super(e)}}t.AbstractProcessPipe=AbstractProcessPipe},8979:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseTrackerPipeName=t.BasePeerPipeName=t.BasePipeName=void 0;class BasePipeName{}(t.BasePipeName=BasePipeName).HANDLE_NOTIFY_EXCEPTION="handle notify exception";class BasePeerPipeName extends BasePipeName{}(t.BasePeerPipeName=BasePeerPipeName).LAUNCH_NOTIFY_EXCEPTION="launch notify exception",BasePeerPipeName.LAUNCH_DELIVER_ICE_CANDIDATE="launch deliver ice candidate";class BaseTrackerPipeName extends BasePipeName{}(t.BaseTrackerPipeName=BaseTrackerPipeName).LAUNCH_REPORT_HEALTH="launch report health",BaseTrackerPipeName.HANDLE_CONFIRM_RECEIPT="handle confirm receipt",BaseTrackerPipeName.HANDLE_DELIVER_ICE_CANDIDATE="handle deliver ice candidate"},49:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractLauncher=void 0;const a=n(s(148)),o=s(1135),c=s(4944);class AbstractLauncher extends a.default{constructor(){super(...arguments),this._taskManager=new c.TaskManager,this._backoff=new o.DelayBackoff({delayerClass:o.ExponentialDelayer,delayerOptions:{maxInterval:10,maxAttempts:-1}})}async activate(){await this._activate()}async deactivate(){await this._terminate(),await this._deactivate()}async reactivate(){await this._reactivate()}async _terminate(){await this._backoff.reset()}}t.AbstractLauncher=AbstractLauncher},9729:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClientConstant=void 0;class ClientConstant{}(t.ClientConstant=ClientConstant).MAX_USER_CONNECTIONS=10,ClientConstant.UNAVAILABLE_USER_TTL=60,ClientConstant.UNAVAILABLE_USER_SIZE=100},2733:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PeerEvent=t.PeerBrokerID=t.PeerBrokerInfo=t.PeerBroker=void 0;const a=n(s(148)),o=s(4944),c=s(8925),u=s(9770),l=s(1744),d=s(9131);t.PeerBroker=class PeerBroker{constructor(){this._condition=new o.Condition,this._eventHub=new o.ChannelHub,this._messageHub=new o.ChannelHub,this._deliverChannel=new o.Channel,this._receiveChannel=new o.Channel,this._info=new PeerBrokerInfo}get info(){return this._info}get condition(){return this._condition}get eventHub(){return this._eventHub}get messageHub(){return this._messageHub}get deliverChannel(){return this._deliverChannel}get receiveChannel(){return this._receiveChannel}get isActivated(){return!this._client.state.isDestroyed}get isConnected(){return this._client.state.isConnected}get isSendable(){return 0===this._client.bufferedAmount}get isAvailable(){return this._client.state.isConnected&&this._condition.isDone}async activate(){this._client=new PeerClient(l.kernelSettings.webrtc.options),await this._bindEvents(),await this._openEventHub()}async deactivate(){await this._client.close(),await this._client.clearListeners(),await this._eventHub.close(),await this._messageHub.close(),await this._deliverChannel.close(),await this._receiveChannel.close()}async sendMessage(e){await this._client.send(e)}async commitMessage(e){await this._deliverChannel.deliver(e)}async createOffer(){return this._client.createOffer()}async createAnswer(){return this._client.createAnswer()}async commitOffer(e){await this._client.commitOffer(e)}async commitAnswer(e){await this._client.commitAnswer(e)}async addIceCandidate(e){await this._client.addIceCandidate(e)}async _bindEvents(){this._client.on(PeerEvent.ICE_NEGOTIATION,(async()=>{await this._eventHub.deliver(PeerEvent.ICE_NEGOTIATION,void 0)})),this._client.on(PeerEvent.ICE_CANDIDATE,(async e=>{await this._eventHub.deliver(PeerEvent.ICE_CANDIDATE,e.candidate)})),this._client.on(PeerEvent.ICE_SIGNALING,(async e=>{await this._eventHub.deliver(PeerEvent.ICE_SIGNALING,e)})),this._client.on(PeerEvent.ICE_GATHERING,(async e=>{await this._eventHub.deliver(PeerEvent.ICE_GATHERING,e)})),this._client.on(PeerEvent.ICE_CONNECTION,(async e=>{await this._eventHub.deliver(PeerEvent.ICE_CONNECTION,e)})),this._client.on(PeerEvent.DATACHANNEL_OPEN,(async()=>{await this._eventHub.deliver(PeerEvent.DATACHANNEL_OPEN,void 0)})),this._client.on(PeerEvent.DATACHANNEL_DATA,(async e=>{await this._eventHub.deliver(PeerEvent.DATACHANNEL_DATA,e.data)})),this._client.on(PeerEvent.DATACHANNEL_ERROR,(async()=>{await this._eventHub.deliver(PeerEvent.DATACHANNEL_ERROR,void 0)})),this._client.on(PeerEvent.DATACHANNEL_CLOSE,(async()=>{await this._eventHub.deliver(PeerEvent.DATACHANNEL_CLOSE,void 0)})),this._client.on(PeerEvent.CONNECTION_CLOSED,(async()=>{await this._eventHub.deliver(PeerEvent.CONNECTION_CLOSED,void 0)}))}async _openEventHub(){await this._eventHub.connect(PeerEvent.ICE_NEGOTIATION),await this._eventHub.connect(PeerEvent.ICE_CANDIDATE),await this._eventHub.connect(PeerEvent.ICE_SIGNALING),await this._eventHub.connect(PeerEvent.ICE_GATHERING),await this._eventHub.connect(PeerEvent.ICE_CONNECTION),await this._eventHub.connect(PeerEvent.DATACHANNEL_OPEN),await this._eventHub.connect(PeerEvent.DATACHANNEL_DATA),await this._eventHub.connect(PeerEvent.DATACHANNEL_ERROR),await this._eventHub.connect(PeerEvent.DATACHANNEL_CLOSE),await this._eventHub.connect(PeerEvent.CONNECTION_CLOSED)}};class PeerBrokerInfo extends d.AbstractBrokerInfo{constructor(){super(...arguments),this._resourceStats=new Map}get id(){return this._peerID?PeerBrokerID.make(this._peerID,this._swarmID):null}get swarmID(){return this._swarmID}set swarmID(e){this._swarmID=e}get resourceStats(){return this._resourceStats}set resourceStats(e){this._resourceStats=e}}t.PeerBrokerInfo=PeerBrokerInfo;class PeerBrokerID{static make(e,t){return e=[e],t&&e.unshift(t),e.join("::")}}t.PeerBrokerID=PeerBrokerID;class PeerClient extends a.default{constructor(e){super(),this._options=e,this._state=new PeerState,this._connection=new u.RTCPeerConnection(e),this._bindConnection()}get state(){return this._state}get bufferedAmount(){return this._dataChannel.bufferedAmount}async send(e){await this._dataChannel.send(c.Buffer.from(e))}async close(){var e;await this._connection.close(),await(null==(e=this._dataChannel)?void 0:e.close())}async createOffer(){await this._buildDataChannel();var e=await this._connection.createOffer();return await this._connection.setLocalDescription(e),e}async createAnswer(){var e=await this._connection.createAnswer();return await this._connection.setLocalDescription(e),e}async commitOffer(e){await this._connection.setRemoteDescription(e)}async commitAnswer(e){await this._connection.setRemoteDescription(e)}async addIceCandidate(e){await this._connection.addIceCandidate(e)}_bindConnection(){this._connection.onnegotiationneeded=async()=>{await this._onNegotiationNeeded()},this._connection.onicecandidate=async e=>{await this._onIceCandidate(e)},this._connection.onsignalingstatechange=async()=>{await this._onSignalingStateChange()},this._connection.onicegatheringstatechange=async()=>{await this._onIceGatheringStateChange()},this._connection.oniceconnectionstatechange=async()=>{await this._onIceConnectionStateChange()},this._connection.ondatachannel=async e=>{await this._onDataChannel(e)}}_bindDataChannel(){this._dataChannel.onopen=async()=>{await this._onDataChannelOpen()},this._dataChannel.onmessage=async e=>{await this._onDataChannelData(e)},this._dataChannel.onerror=async()=>{await this._onDataChannelError()},this._dataChannel.onclose=async()=>{await this._onDataChannelClose()}}async _buildDataChannel(){this._dataChannel=await this._connection.createDataChannel(PeerClient.DEFAULT_DATACHANNEL_NAME),await this._bindDataChannel()}async _onNegotiationNeeded(){await this.emit(PeerEvent.ICE_NEGOTIATION)}async _onIceCandidate(e){e.candidate&&await this.emit(PeerEvent.ICE_CANDIDATE,e)}async _onSignalingStateChange(){var e=this._connection.signalingState;await this.emit(PeerEvent.ICE_SIGNALING,e)}async _onIceGatheringStateChange(){var e=this._connection.iceGatheringState;await this.emit(PeerEvent.ICE_GATHERING,e)}async _onIceConnectionStateChange(){var e=this._connection.iceConnectionState;switch(await this.emit(PeerEvent.ICE_CONNECTION,e),e){case ICEConnectionState.DISCONNECTED:case ICEConnectionState.FAILED:await this.emit(PeerEvent.CONNECTION_CLOSED);break;case ICEConnectionState.CLOSED:await this._state.toDestroyed()}}async _onDataChannel(e){this._dataChannel=e.channel,await this._bindDataChannel()}async _onDataChannelOpen(){await this._state.toConnected(),await this.emit(PeerEvent.DATACHANNEL_OPEN)}async _onDataChannelData(e){await this.emit(PeerEvent.DATACHANNEL_DATA,e)}async _onDataChannelError(){await this.emit(PeerEvent.DATACHANNEL_ERROR)}async _onDataChannelClose(){await this.emit(PeerEvent.DATACHANNEL_CLOSE)}}PeerClient.DEFAULT_DATACHANNEL_NAME="datachannel";class WebRTCEvent{}WebRTCEvent.ICE_NEGOTIATION="ice_negotiation",WebRTCEvent.ICE_CANDIDATE="ice_candidate",WebRTCEvent.ICE_SIGNALING="ice_signaling",WebRTCEvent.ICE_GATHERING="ice_gathering",WebRTCEvent.ICE_CONNECTION="ice_connection",WebRTCEvent.DATACHANNEL_OPEN="datachannel_open",WebRTCEvent.DATACHANNEL_DATA="datachannel_data",WebRTCEvent.DATACHANNEL_ERROR="datachannel_error",WebRTCEvent.DATACHANNEL_CLOSE="datachannel_close";class PeerEvent extends WebRTCEvent{}(t.PeerEvent=PeerEvent).CONNECTION_CLOSED="connection_closed";class ICEConnectionState{}ICEConnectionState.NEW="new",ICEConnectionState.CHECKING="checking",ICEConnectionState.CONNECTED="connected",ICEConnectionState.COMPLETED="completed",ICEConnectionState.DISCONNECTED="disconnected",ICEConnectionState.FAILED="failed",ICEConnectionState.CLOSED="closed";class PeerState{constructor(){this._name=PeerStateName.INITIAL}get isInitial(){return this._name===PeerStateName.INITIAL}get isConnected(){return this._name===PeerStateName.CONNECTED}get isDestroyed(){return this._name===PeerStateName.DESTROYED}toInitial(){this._name=PeerStateName.INITIAL}toConnected(){this._name=PeerStateName.CONNECTED}toDestroyed(){this._name=PeerStateName.DESTROYED}}class PeerStateName{}PeerStateName.INITIAL="initial",PeerStateName.CONNECTED="connected",PeerStateName.DESTROYED="destroyed"},1598:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.peerBrokerPool=void 0;const n=new(s(9131).BrokerPool);t.peerBrokerPool=n},4153:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PeerDaemonTaskName=t.PeerDaemonEvent=t.AbstractPeerDaemon=void 0;const n=s(93),a=s(2016),o=s(4944),c=s(287),u=s(7464),l=s(7926),d=s(1050),h=s(9007),_=s(7835),p=s(8979),f=s(4865),m=s(2733);class AbstractPeerDaemon extends _.AbstractDaemon{constructor(){super(...arguments),this._commands=new o.Channel,this._submissions=new o.ChannelHub}get broker(){return this._broker}async command(e){return await this._commands.deliver(e),this._submissions.extract(e.id,!0)}async _buildWaitToStartTask(){await this._taskManager.createCommonTask({name:PeerDaemonTaskName.WAIT_TO_START,callee:async()=>{await this._execWaitToStartTaskCallee()}})}async _execWaitToStartTaskCallee(){await f.trackerBrokerPool.available(l.BrokerID.TRACKER)}async _buildListenIceNegotiationEventTask(){await this._taskManager.createCyclicTask({name:PeerDaemonTaskName.LISTEN_ICE_NEGOTIATION_EVENT,callee:async()=>{await this._execListenIceNegotiationEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenIceNegotiationEventTaskCallee(){await this._broker.eventHub.extract(m.PeerEvent.ICE_NEGOTIATION);var e=this._broker.info.id;await c.Logger.track("Peer ice negotiation event.",{brokerID:e})}async _buildListenIceCandidateEventTask(){await this._taskManager.createCyclicTask({name:PeerDaemonTaskName.LISTEN_ICE_CANDIDATE_EVENT,callee:async()=>{await this._execListenIceCandidateEventTaskCallee()},pretasks:[this._taskManager.cueTask(PeerDaemonTaskName.CONNECT_PEER)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenIceCandidateEventTaskCallee(){var e=await this._broker.eventHub.extract(m.PeerEvent.ICE_CANDIDATE),t=this._broker.info.peerID,s=this._broker.info.swarmID,n=this._broker.info.id;await c.Logger.track("Peer ice candidate event.",{brokerID:n,ice:e}),await this._agent.operate({name:p.BasePeerPipeName.LAUNCH_DELIVER_ICE_CANDIDATE,data:{brokerID:this._broker.info.id,content:{peerID:t,swarmID:s,ice:e}}})}async _buildListenIceSignalingEventTask(){await this._taskManager.createCyclicTask({name:PeerDaemonTaskName.LISTEN_ICE_SIGNALING_EVENT,callee:async()=>{await this._execListenIceSignalingEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenIceSignalingEventTaskCallee(){var e=await this._broker.eventHub.extract(m.PeerEvent.ICE_SIGNALING),t=this._broker.info.id;await c.Logger.track("Peer ice signaling event.",{brokerID:t,state:e})}async _buildListenIceGatheringEventTask(){await this._taskManager.createCyclicTask({name:PeerDaemonTaskName.LISTEN_ICE_GATHERING_EVENT,callee:async()=>{await this._execListenIceGatheringEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenIceGatheringEventTaskCallee(){var e=await this._broker.eventHub.extract(m.PeerEvent.ICE_GATHERING),t=this._broker.info.id;await c.Logger.track("Peer ice gathering event.",{brokerID:t,state:e})}async _buildListenIceConnectionEventTask(){await this._taskManager.createCyclicTask({name:PeerDaemonTaskName.LISTEN_ICE_CONNECTION_EVENT,callee:async()=>{await this._execListenIceConnectionEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenIceConnectionEventTaskCallee(){var e=await this._broker.eventHub.extract(m.PeerEvent.ICE_CONNECTION),t=this._broker.info.id;await c.Logger.track("Peer ice connection event.",{brokerID:t,state:e})}async _buildListenDataChannelOpenEventTask(){await this._taskManager.createCommonTask({name:PeerDaemonTaskName.LISTEN_DATACHANNEL_OPEN_EVENT,callee:async()=>{await this._execListenDataChannelOpenEventTaskCallee()},pretasks:[this._taskManager.cueTask(PeerDaemonTaskName.CONNECT_PEER)],runningTimeout:10})}async _execListenDataChannelOpenEventTaskCallee(){await this._broker.eventHub.extract(m.PeerEvent.DATACHANNEL_OPEN),await this._broker.condition.pass();var e=this._broker.info.id;await c.Logger.track("Peer data channel open event.",{brokerID:e}),await this._recordEnabled(),await this.emit(PeerDaemonEvent.CONNECTED)}async _buildListenDataChannelDataEventTask(){await this._taskManager.createCyclicTask({name:PeerDaemonTaskName.LISTEN_DATACHANNEL_DATA_EVENT,callee:async()=>{await this._execListenDataChannelDataEventTaskCallee()},pretasks:[this._taskManager.cueTask(PeerDaemonTaskName.LISTEN_DATACHANNEL_OPEN_EVENT)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenDataChannelDataEventTaskCallee(){var e=await this._broker.eventHub.extract(m.PeerEvent.DATACHANNEL_DATA),t=(e=new h.ProtocolMessage(await d.BlobTool.toBuffer(e))).payload,s=this._broker.info.id,n=null==(n=t.header)?void 0:n.correlation_id;await c.Logger.info("Peer payload received.",{brokerID:s,payload:t}),n?await this._broker.messageHub.deliver(n,e):await this._broker.receiveChannel.deliver(e)}async _buildListenDataChannelErrorEventTask(){await this._taskManager.createCyclicTask({name:PeerDaemonTaskName.LISTEN_DATACHANNEL_ERROR_EVENT,callee:async()=>{await this._execListenDataChannelErrorEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenDataChannelErrorEventTaskCallee(){await this._broker.eventHub.extract(m.PeerEvent.DATACHANNEL_ERROR);var e=this._broker.info.id;await c.Logger.warn("Peer data channel error event.",{brokerID:e})}async _buildListenDataChannelCloseEventTask(){await this._taskManager.createCommonTask({name:PeerDaemonTaskName.LISTEN_DATACHANNEL_CLOSE_EVENT,callee:async()=>{await this._execListenDataChannelCloseEventTaskCallee()}})}async _execListenDataChannelCloseEventTaskCallee(){await this._broker.eventHub.extract(m.PeerEvent.DATACHANNEL_CLOSE);var e=this._broker.info.id;await c.Logger.track("Peer data channel close event.",{brokerID:e})}async _buildListenConnectionClosedEventTask(){await this._taskManager.createCommonTask({name:PeerDaemonTaskName.LISTEN_CONNECTION_CLOSED_EVENT,callee:async()=>{await this._execListenConnectionClosedEventTaskCallee()}})}async _execListenConnectionClosedEventTaskCallee(){await this._broker.eventHub.extract(m.PeerEvent.CONNECTION_CLOSED);var e=this._broker.info.id;throw await c.Logger.track("Peer connection closed event.",{brokerID:e}),PeerDaemonError.BROKER_CLOSED}async _buildDeliverMessageTask(){await this._taskManager.createCyclicTask({name:PeerDaemonTaskName.DELIVER_MESSAGE,callee:async()=>{await this._execDeliverMessageTaskCallee()},pretasks:[this._taskManager.cueTask(PeerDaemonTaskName.LISTEN_DATACHANNEL_OPEN_EVENT)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execDeliverMessageTaskCallee(){for(var e=await this._broker.deliverChannel.extract();this._broker.isActivated;){if(this._broker.isConnected&&this._broker.isSendable)return void await this._broker.sendMessage(e);await n.TimeTool.sleepRandomly(.01)}}async _buildReceiveMessageTask(){await this._taskManager.createCyclicTask({name:PeerDaemonTaskName.RECEIVE_MESSAGE,callee:async()=>{await this._execReceiveMessageTaskCallee()},pretasks:[this._taskManager.cueTask(PeerDaemonTaskName.LISTEN_DATACHANNEL_OPEN_EVENT)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execReceiveMessageTaskCallee(){var e=await this._broker.messageHub.lostCenter.extract();await this._broker.receiveChannel.deliver(e)}async _buildProcessMessageTask(){await this._taskManager.createCyclicTask({name:PeerDaemonTaskName.PROCESS_MESSAGE,callee:async()=>{await this._execProcessMessageTaskCallee()},pretasks:[this._taskManager.cueTask(PeerDaemonTaskName.LISTEN_DATACHANNEL_OPEN_EVENT)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execProcessMessageTaskCallee(){var e=await this._broker.receiveChannel.extract(),t=e.payload,s=this._agent.findPipeName(t.action),n={id:null==(n=t.header)?void 0:n.correlation_id,brokerID:this._broker.info.id};if(s)try{await this._agent.operate({name:s,data:{...n,content:e}})}catch(e){await this._agent.operate({name:p.BasePeerPipeName.LAUNCH_NOTIFY_EXCEPTION,data:{...n,content:{error:e}}})}else s=new a.ValidationError(u.MessageCode.WSS002,void 0,{action:t.action}),await this._agent.operate({name:p.BasePeerPipeName.LAUNCH_NOTIFY_EXCEPTION,data:{...n,content:{error:s}}})}async _buildProcessCommandTask(){await this._taskManager.createCyclicTask({name:PeerDaemonTaskName.PROCESS_COMMAND,callee:async()=>{await this._execProcessCommandTaskCallee()},pretasks:[this._taskManager.cueTask(PeerDaemonTaskName.LISTEN_DATACHANNEL_OPEN_EVENT)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execProcessCommandTaskCallee(){var e=await this._commands.extract(),t=e.name,s=this._broker.info.id;if(await c.Logger.track("Peer command received.",{brokerID:s,command:e}),t)try{var n=await this._agent.operate({name:t,data:{id:e.id,brokerID:s,content:e.content}});await this._submissions.deliver(e.id,n)}catch(t){await this._submissions.caution(e.id,t)}else t=new a.InternalError(u.MessageCode.ESS003,void 0,{command:e}),await this._submissions.caution(e.id,t)}async _buildExitProcessTask(){await this._taskManager.createCommonTask({name:PeerDaemonTaskName.EXIT_PROCESS,onClose:async()=>{await this._execExitProcessTaskOnClose()},pretasks:[...this._taskManager.cueAllTasks()],callbackTimeout:15})}async _execExitProcessTaskOnClose(){await this._broker.condition.deny(PeerDaemonError.DAEMON_EXITED),await this._recordDisabled(),await this.emit(PeerDaemonEvent.DISCONNECTED)}}t.AbstractPeerDaemon=AbstractPeerDaemon;class PeerDaemonEvent{}(t.PeerDaemonEvent=PeerDaemonEvent).CONNECTED="connected",PeerDaemonEvent.DISCONNECTED="disconnected";class PeerDaemonTaskName{}(t.PeerDaemonTaskName=PeerDaemonTaskName).WAIT_TO_START="peer daemon: wait to start",PeerDaemonTaskName.CONNECT_PEER="peer daemon: connect peer",PeerDaemonTaskName.LISTEN_ICE_NEGOTIATION_EVENT="peer daemon: listen ice negotiation event",PeerDaemonTaskName.LISTEN_ICE_CANDIDATE_EVENT="peer daemon: listen ice candidate event",PeerDaemonTaskName.LISTEN_ICE_SIGNALING_EVENT="peer daemon: listen ice signaling event",PeerDaemonTaskName.LISTEN_ICE_GATHERING_EVENT="peer daemon: listen ice gathering event",PeerDaemonTaskName.LISTEN_ICE_CONNECTION_EVENT="peer daemon: listen ice connection event",PeerDaemonTaskName.LISTEN_DATACHANNEL_OPEN_EVENT="peer daemon: listen datachannel open event",PeerDaemonTaskName.LISTEN_DATACHANNEL_DATA_EVENT="peer daemon: listen datachannel data event",PeerDaemonTaskName.LISTEN_DATACHANNEL_ERROR_EVENT="peer daemon: listen datachannel error event",PeerDaemonTaskName.LISTEN_DATACHANNEL_CLOSE_EVENT="peer daemon: listen datachannel close event",PeerDaemonTaskName.LISTEN_CONNECTION_CLOSED_EVENT="peer daemon: listen connection closed event",PeerDaemonTaskName.DELIVER_MESSAGE="peer daemon: deliver message",PeerDaemonTaskName.RECEIVE_MESSAGE="peer daemon: receive message",PeerDaemonTaskName.PROCESS_MESSAGE="peer daemon: process message",PeerDaemonTaskName.PROCESS_COMMAND="peer daemon: process command",PeerDaemonTaskName.EXIT_PROCESS="peer daemon: exit process";class PeerDaemonError{}PeerDaemonError.BROKER_CLOSED=new a.InternalError(u.MessageCode.ESS000),PeerDaemonError.DAEMON_EXITED=new a.InternalError(u.MessageCode.ESS001)},2914:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.UserAgent=t.NodeAgent=void 0;const c=s(1693),u=s(1438),l=s(3726),d=o(s(6059));class NodeAgent extends u.AbstractProcessAgent{get _pipeNames(){return NodeAgent.PIPE_NAMES}get _pipeClasses(){return NodeAgent.PIPE_CLASSES}}(t.NodeAgent=NodeAgent).PIPE_NAMES=new Map([[c.NodeActionName.MESSAGE_NOTIFY_EXCEPTION,l.NodePipeName.HANDLE_NOTIFY_EXCEPTION]]),NodeAgent.PIPE_CLASSES=new Map([[l.NodePipeName.LAUNCH_CONNECT_NODE,d.LaunchConnectNodePipe],[l.NodePipeName.LAUNCH_OBTAIN_RESOURCE,d.LaunchObtainResourcePipe],[l.NodePipeName.LAUNCH_REPORT_HEALTH,d.LaunchReportHealthPipe],[l.NodePipeName.LAUNCH_NOTIFY_EXCEPTION,d.LaunchNotifyExceptionPipe],[l.NodePipeName.HANDLE_NOTIFY_EXCEPTION,d.HandleNotifyExceptionPipe],[l.NodePipeName.LAUNCH_DELIVER_ICE_CANDIDATE,d.LaunchDeliverIceCandidatePipe]]);class UserAgent extends u.AbstractProcessAgent{get _pipeNames(){return UserAgent.PIPE_NAMES}get _pipeClasses(){return UserAgent.PIPE_CLASSES}}(t.UserAgent=UserAgent).PIPE_NAMES=new Map([[c.UserActionName.REQUEST_OBTAIN_RESOURCE,l.UserPipeName.HANDLE_OBTAIN_RESOURCE],[c.UserActionName.MESSAGE_REPORT_RESOURCE_STAT,l.UserPipeName.HANDLE_REPORT_RESOURCE_STAT],[c.UserActionName.MESSAGE_REPORT_RESOURCE_STATS,l.UserPipeName.HANDLE_REPORT_RESOURCE_STATS],[c.UserActionName.MESSAGE_NOTIFY_EXCEPTION,l.UserPipeName.HANDLE_NOTIFY_EXCEPTION]]),UserAgent.PIPE_CLASSES=new Map([[l.UserPipeName.LAUNCH_CONNECT_USER,d.LaunchConnectUserPipe],[l.UserPipeName.HANDLE_CONNECT_USER,d.HandleConnectUserPipe],[l.UserPipeName.LAUNCH_OBTAIN_RESOURCE,d.LaunchObtainResourcePipe],[l.UserPipeName.HANDLE_OBTAIN_RESOURCE,d.HandleObtainResourcePipe],[l.UserPipeName.LAUNCH_REPORT_RESOURCE_STAT,d.LaunchReportResourceStatPipe],[l.UserPipeName.HANDLE_REPORT_RESOURCE_STAT,d.HandleReportResourceStatPipe],[l.UserPipeName.LAUNCH_REPORT_RESOURCE_STATS,d.LaunchReportResourceStatsPipe],[l.UserPipeName.HANDLE_REPORT_RESOURCE_STATS,d.HandleReportResourceStatsPipe],[l.UserPipeName.LAUNCH_NOTIFY_EXCEPTION,d.LaunchNotifyExceptionPipe],[l.UserPipeName.HANDLE_NOTIFY_EXCEPTION,d.HandleNotifyExceptionPipe],[l.UserPipeName.LAUNCH_DELIVER_ICE_CANDIDATE,d.LaunchDeliverIceCandidatePipe]])},2724:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),a(s(8186),t),a(s(6155),t),a(s(7941),t),a(s(2181),t)},8186:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HandleNotifyExceptionFlow=t.LaunchNotifyExceptionFlow=void 0;const n=s(3897),a=s(2841),o=s(6897),c=s(5493);class LaunchNotifyExceptionFlow extends c.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeCreator(),await this._recordMessage(),await this._forwardMessage()}async _intakeBroker(){this._broker=this._obtainPeerBroker()}async _intakeCreator(){var e=new a.PeerErrorMessageCreator(this._id,this._content.error);await this._expose(n.FlowKey.CREATOR,e)}async _recordMessage(){var e=this._require(n.FlowKey.CREATOR);this._logWarn("Log error message.",e.error.params,{error:e.error})}async _forwardMessage(){var e=this._require(n.FlowKey.CREATOR);await this._broker.commitMessage(e.buffer)}}t.LaunchNotifyExceptionFlow=LaunchNotifyExceptionFlow;class HandleNotifyExceptionFlow extends c.AbstractProcessFlow{async process(){await this._recordMessage()}async _recordMessage(){var e=new o.ErrorMessageDetector(this._content.buffer);this._logWarn("Log error message.",e.error.params,{error:e.error})}}t.HandleNotifyExceptionFlow=HandleNotifyExceptionFlow},6155:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchReportHealthFlow=void 0;const n=s(1744),a=s(3897),o=s(1693),c=s(2890),u=s(5493);class LaunchReportHealthFlow extends u.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeMessage(),await this._forwardMessage()}async _intakeBroker(){this._broker=this._obtainNodeBroker()}async _intakeMessage(){var e={action:o.NodeActionName.MESSAGE_REPORT_HEALTH,header:{correlation_id:this._id,source_peer_id:n.kernelSettings.client.peerID}};await this._expose(a.FlowKey.PAYLOAD,e)}async _forwardMessage(){var e=this._require(a.FlowKey.PAYLOAD);await this._broker.commitMessage(c.PeerReportHealthMessage.encode(e).finish())}}t.LaunchReportHealthFlow=LaunchReportHealthFlow},7941:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HandleReportResourceStatsFlow=t.LaunchReportResourceStatsFlow=t.HandleReportResourceStatFlow=t.LaunchReportResourceStatFlow=t.HandleObtainResourceFlow=t.LaunchObtainResourceFlow=void 0;const n=s(2016),a=s(1744),o=s(7464),c=s(3897),u=s(1442),l=s(1693),d=s(2890),h=s(6897),_=s(5493);class LaunchObtainResourceFlow extends _.AbstractProcessFlow{async process(){return await this._intakeBroker(),await this._intakeRequest(),await this._forwardRequest(),await this._intakeResponse(),await this._intakeOutcome(),this._outcome}async _intakeBroker(){this._broker=this._obtainPeerBroker()}async _intakeRequest(){var e=this._content;e={action:l.UserActionName.REQUEST_OBTAIN_RESOURCE,header:{correlation_id:this._id,source_peer_id:a.kernelSettings.client.peerID},content:{id:e.id,uri:e.uri,range:e.range}};await this._expose(c.FlowKey.REQUEST,e)}async _forwardRequest(){var e=this._require(c.FlowKey.REQUEST);await this._broker.commitMessage(d.PeerObtainResourceRequest.encode(e).finish())}async _intakeResponse(){var e=await this._broker.messageHub.extract(this._id,!0);await h.ErrorMessageDetector.throwIfError(e.buffer),e=d.PeerObtainResourceResponse.decode(e.buffer);await this._expose(c.FlowKey.RESPONSE,e)}async _intakeOutcome(){var e=this._require(c.FlowKey.RESPONSE).content;this._outcome={type:e.type,total:e.total,range:e.range,pieces:e.pieces}}}t.LaunchObtainResourceFlow=LaunchObtainResourceFlow;class HandleObtainResourceFlow extends _.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeRequest(),await this._intakeResource(),await this._intakeResponse(),await this._forwardResponse()}async _intakeBroker(){this._broker=this._obtainPeerBroker()}async _intakeRequest(){var e=d.PeerObtainResourceRequest.decode(this._content.buffer);await this._expose(c.FlowKey.REQUEST,e)}async _intakeResource(){var e=this._require(c.FlowKey.REQUEST).content,t=u.resourceCache.get(e.id);if(!t)throw new n.InternalError(o.MessageCode.WSP020,void 0,{id:e.id,uri:e.uri});await this._expose(c.FlowKey.RESOURCE,t)}async _intakeResponse(){var e=this._require(c.FlowKey.REQUEST),t=this._require(c.FlowKey.RESOURCE),s=(e=e.content,t.content.slice(e.range.start,e.range.end));t={action:l.UserActionName.RESPOND_OBTAIN_RESOURCE,header:{correlation_id:this._id,response_code:1200,response_status:!0,response_message:"success"},content:{id:t.id,uri:t.uri,type:t.type,total:t.total,range:{start:e.range.start,end:e.range.start+s.length},pieces:s}};await this._expose(c.FlowKey.RESPONSE,t)}async _forwardResponse(){var e=this._require(c.FlowKey.RESPONSE);await this._broker.commitMessage(d.PeerObtainResourceResponse.encode(e).finish())}}t.HandleObtainResourceFlow=HandleObtainResourceFlow;class LaunchReportResourceStatFlow extends _.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeMessage(),await this._forwardMessage()}async _intakeBroker(){this._broker=this._obtainPeerBroker()}async _intakeMessage(){var e={action:l.UserActionName.MESSAGE_REPORT_RESOURCE_STAT,header:{correlation_id:this._id,source_peer_id:a.kernelSettings.client.peerID},content:{stat:this._content}};await this._expose(c.FlowKey.PAYLOAD,e)}async _forwardMessage(){var e=this._require(c.FlowKey.PAYLOAD);await this._broker.commitMessage(d.PeerReportResourceStatMessage.encode(e).finish())}}t.LaunchReportResourceStatFlow=LaunchReportResourceStatFlow;class HandleReportResourceStatFlow extends _.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeMessage(),await this._intakeStat(),await this._updateBrokerInfo()}async _intakeBroker(){this._broker=this._obtainPeerBroker()}async _intakeMessage(){var e=d.PeerReportResourceStatMessage.decode(this._content.buffer);await this._expose(c.FlowKey.PAYLOAD,e)}async _intakeStat(){var e=this._require(c.FlowKey.PAYLOAD).content.stat;await this._expose(c.FlowKey.STAT,e)}async _updateBrokerInfo(){var e=this._require(c.FlowKey.STAT);await this._broker.info.resourceStats.set(e.id,e.completion)}}t.HandleReportResourceStatFlow=HandleReportResourceStatFlow;class LaunchReportResourceStatsFlow extends _.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeMessage(),await this._forwardMessage()}async _intakeBroker(){this._broker=this._obtainPeerBroker()}async _intakeMessage(){var e={action:l.UserActionName.MESSAGE_REPORT_RESOURCE_STATS,header:{correlation_id:this._id,source_peer_id:a.kernelSettings.client.peerID},content:{stats:this._content}};await this._expose(c.FlowKey.PAYLOAD,e)}async _forwardMessage(){var e=this._require(c.FlowKey.PAYLOAD);await this._broker.commitMessage(d.PeerReportResourceStatsMessage.encode(e).finish())}}t.LaunchReportResourceStatsFlow=LaunchReportResourceStatsFlow;class HandleReportResourceStatsFlow extends _.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeMessage(),await this._intakeStats(),await this._updateBrokerInfo()}async _intakeBroker(){this._broker=this._obtainPeerBroker()}async _intakeMessage(){var e=d.PeerReportResourceStatsMessage.decode(this._content.buffer);await this._expose(c.FlowKey.PAYLOAD,e)}async _intakeStats(){var e=this._require(c.FlowKey.PAYLOAD).content.stats.map((e=>[e.id,e.completion]));await this._expose(c.FlowKey.STATS,e)}async _updateBrokerInfo(){var e=this._require(c.FlowKey.STATS);this._broker.info.resourceStats=new Map(e)}}t.HandleReportResourceStatsFlow=HandleReportResourceStatsFlow},2181:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HandleDeliverIceCandidateFlow=void 0;const n=s(3897),a=s(1716),o=s(5493),c=s(2733);class HandleDeliverIceCandidateFlow extends o.AbstractProcessFlow{async process(){await this._intakeMessage(),await this._intakeBrokerID(),await this._intakeBroker(),await this._updateBroker()}async _intakeMessage(){var e=a.TrackerDeliverIceCandidateMessage.decode(this._content.buffer);await this._expose(n.FlowKey.MESSAGE,e)}async _intakeBrokerID(){var e=this._require(n.FlowKey.MESSAGE).content;this._brokerID=c.PeerBrokerID.make(e.peer_id,e.swarm_id)}async _intakeBroker(){this._broker=this._obtainPeerBroker()}async _updateBroker(){var e=this._require(n.FlowKey.MESSAGE).content;await this._broker.addIceCandidate(e.ice)}}t.HandleDeliverIceCandidateFlow=HandleDeliverIceCandidateFlow},3726:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserPipeName=t.NodePipeName=void 0;const n=s(8979);class NodePipeName extends n.BasePeerPipeName{}(t.NodePipeName=NodePipeName).LAUNCH_CONNECT_NODE="launch connect node",NodePipeName.LAUNCH_OBTAIN_RESOURCE="launch obtain resource",NodePipeName.LAUNCH_REPORT_HEALTH="launch report health";class UserPipeName extends n.BasePeerPipeName{}(t.UserPipeName=UserPipeName).LAUNCH_CONNECT_USER="launch connect user",UserPipeName.HANDLE_CONNECT_USER="handle connect user",UserPipeName.LAUNCH_OBTAIN_RESOURCE="launch obtain resource",UserPipeName.HANDLE_OBTAIN_RESOURCE="handle obtain resource",UserPipeName.LAUNCH_REPORT_RESOURCE_STAT="launch report resource stat",UserPipeName.HANDLE_REPORT_RESOURCE_STAT="handle report resource stat",UserPipeName.LAUNCH_REPORT_RESOURCE_STATS="launch report resource stats",UserPipeName.HANDLE_REPORT_RESOURCE_STATS="handle report resource stats"},6059:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),a(s(4287),t),a(s(3912),t),a(s(7451),t),a(s(1917),t),a(s(5100),t),a(s(4778),t)},4287:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchConnectNodePipe=void 0;const c=s(3897),u=s(8024),l=o(s(2643));class LaunchConnectNodePipe extends u.AbstractProcessPipe{async process(){await this._intakeBroker(),await this._intakeOffer(),await this._connectNode(),await this._commitAnswer(),await this._updateNodeInfo()}async _intakeBroker(){this._broker=this._obtainNodeBroker()}async _intakeOffer(){var e=await this._broker.createOffer();await this._expose(c.FlowKey.OFFER,e)}async _connectNode(){var e=await this._require(c.FlowKey.OFFER),t={sdp:(e=await this._bypass(new l.LaunchConnectNodeFlow({content:e}))).sdp,type:e.type};await this._expose(c.FlowKey.ANSWER,t),await this._expose(c.FlowKey.NODE_ID,e.peerID)}async _commitAnswer(){var e=this._require(c.FlowKey.ANSWER);await this._broker.commitAnswer(e)}async _updateNodeInfo(){this._broker.info.peerID=this._require(c.FlowKey.NODE_ID)}}t.LaunchConnectNodePipe=LaunchConnectNodePipe},3912:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HandleNotifyExceptionPipe=t.LaunchNotifyExceptionPipe=void 0;const c=s(8024),u=o(s(2724));class LaunchNotifyExceptionPipe extends c.AbstractProcessPipe{async process(){await this._notifyException()}async _notifyException(){var e=this._content;await this._bypass(new u.LaunchNotifyExceptionFlow({brokerID:this._brokerID,content:{error:e.error}}))}}t.LaunchNotifyExceptionPipe=LaunchNotifyExceptionPipe;class HandleNotifyExceptionPipe extends c.AbstractProcessPipe{async process(){await this._notifyException()}async _notifyException(){await this._bypass(new u.HandleNotifyExceptionFlow({content:this._content}))}}t.HandleNotifyExceptionPipe=HandleNotifyExceptionPipe},7451:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchReportHealthPipe=void 0;const c=s(8024),u=o(s(2724));class LaunchReportHealthPipe extends c.AbstractProcessPipe{async process(){await this._reportHealth()}async _reportHealth(){await this._bypass(new u.LaunchReportHealthFlow)}}t.LaunchReportHealthPipe=LaunchReportHealthPipe},1917:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HandleReportResourceStatsPipe=t.LaunchReportResourceStatsPipe=t.HandleReportResourceStatPipe=t.LaunchReportResourceStatPipe=t.HandleObtainResourcePipe=t.LaunchObtainResourcePipe=void 0;const c=s(3050),u=s(3897),l=s(9560),d=s(8024),h=o(s(2724));class LaunchObtainResourcePipe extends d.AbstractProcessPipe{async process(){await this._intakeBroker(),await this._intakeResource(),await this._intakeStates(),await this._obtainResource(),await this._updateResource(),await this._recordDownload()}async _intakeBroker(){this._broker=this._obtainPeerBroker()}async _intakeResource(){await this._expose(u.FlowKey.RESOURCE,this._content)}async _intakeStates(){var e=this._require(u.FlowKey.RESOURCE);this._startSize=e.size,this._startTime=Date.now(),this._startPerfTime=c.performance.now()}async _obtainResource(){var e=this._require(u.FlowKey.RESOURCE);e=await this._bypass(new h.LaunchObtainResourceFlow({brokerID:this._brokerID,content:{id:e.id,uri:e.uri,range:e.nextRange()}}));await this._expose(u.FlowKey.FRAGMENT,e)}async _updateResource(){var e=this._require(u.FlowKey.RESOURCE),t=this._require(u.FlowKey.FRAGMENT);e.type=t.type,e.total=t.total,e.concat({chunk:t.pieces,range:t.range})}async _recordDownload(){var e=this._require(u.FlowKey.RESOURCE);await l.P2PDownloadRecorder.process({peerID:this._broker.info.peerID,peerType:this._broker.info.peerType,resource:e,startSize:this._startSize,startTime:this._startTime,startPerfTime:this._startPerfTime,endPerfTime:c.performance.now()})}}t.LaunchObtainResourcePipe=LaunchObtainResourcePipe;class HandleObtainResourcePipe extends d.AbstractProcessPipe{async process(){await this._obtainResource()}async _obtainResource(){await this._bypass(new h.HandleObtainResourceFlow({brokerID:this._brokerID,content:this._content}))}}t.HandleObtainResourcePipe=HandleObtainResourcePipe;class LaunchReportResourceStatPipe extends d.AbstractProcessPipe{async process(){await this._reportResourceStat()}async _reportResourceStat(){await this._bypass(new h.LaunchReportResourceStatFlow({brokerID:this._brokerID,content:this._content}))}}t.LaunchReportResourceStatPipe=LaunchReportResourceStatPipe;class HandleReportResourceStatPipe extends d.AbstractProcessPipe{async process(){await this._reportResourceStat()}async _reportResourceStat(){await this._bypass(new h.HandleReportResourceStatFlow({brokerID:this._brokerID,content:this._content}))}}t.HandleReportResourceStatPipe=HandleReportResourceStatPipe;class LaunchReportResourceStatsPipe extends d.AbstractProcessPipe{async process(){await this._reportResourceStats()}async _reportResourceStats(){await this._bypass(new h.LaunchReportResourceStatsFlow({brokerID:this._brokerID,content:this._content}))}}t.LaunchReportResourceStatsPipe=LaunchReportResourceStatsPipe;class HandleReportResourceStatsPipe extends d.AbstractProcessPipe{async process(){await this._reportResourceStats()}async _reportResourceStats(){await this._bypass(new h.HandleReportResourceStatsFlow({brokerID:this._brokerID,content:this._content}))}}t.HandleReportResourceStatsPipe=HandleReportResourceStatsPipe},5100:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HandleConnectUserPipe=t.LaunchConnectUserPipe=void 0;const c=s(3897),u=s(8024),l=o(s(2643));class LaunchConnectUserPipe extends u.AbstractProcessPipe{async process(){await this._intakeBroker(),await this._intakeOffer(),await this._connectUser(),await this._commitAnswer()}async _intakeBroker(){this._broker=this._obtainPeerBroker()}async _intakeOffer(){var e=await this._broker.createOffer();await this._expose(c.FlowKey.OFFER,e)}async _connectUser(){var e=this._content,t=await this._require(c.FlowKey.OFFER);t={sdp:(e=await this._bypass(new l.LaunchConnectUserFlow({content:{peerID:e.peerID,swarmID:e.swarmID,offer:t}}))).sdp,type:e.type};await this._expose(c.FlowKey.ANSWER,t)}async _commitAnswer(){var e=this._require(c.FlowKey.ANSWER);await this._broker.commitAnswer(e)}}t.LaunchConnectUserPipe=LaunchConnectUserPipe;class HandleConnectUserPipe extends u.AbstractProcessPipe{async process(){await this._intakeBroker(),await this._commitOffer(),await this._intakeAnswer(),await this._connectUser()}async _intakeBroker(){this._broker=this._obtainPeerBroker()}async _commitOffer(){var e=this._content.offer;await this._broker.commitOffer(e)}async _intakeAnswer(){var e=await this._broker.createAnswer();await this._expose(c.FlowKey.ANSWER,e)}async _connectUser(){var e=this._content,t=this._require(c.FlowKey.ANSWER);await this._bypass(new l.HandleConnectUserFlow({content:{peerID:e.peerID,swarmID:e.swarmID,answer:t}}))}}t.HandleConnectUserPipe=HandleConnectUserPipe},4778:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchDeliverIceCandidatePipe=void 0;const c=s(8024),u=o(s(2643));class LaunchDeliverIceCandidatePipe extends c.AbstractProcessPipe{async process(){await this._deliverIceCandidate()}async _deliverIceCandidate(){await this._bypass(new u.LaunchDeliverIceCandidateFlow({content:this._content}))}}t.LaunchDeliverIceCandidatePipe=LaunchDeliverIceCandidatePipe},3710:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeDaemon=void 0;const n=s(7926),a=s(9282),o=s(5227),c=s(2733),u=s(1598),l=s(4153),d=s(2914),h=s(3726),_=s(7431);class NodeDaemon extends l.AbstractPeerDaemon{constructor(){super(),this._initialize()}_initialize(){this._agent=new d.NodeAgent,this._broker=new c.PeerBroker,this._broker.info.peerType=a.PeerType.NODE}async _activate(){await this._broker.activate(),await this._taskManager.activate(),await this._storePool(),await this._buildTasks()}async _deactivate(){await this._broker.deactivate(),await this._taskManager.deactivate(),await this._commands.close(),await this._submissions.close(),await this._clearPool()}async _storePool(){await u.peerBrokerPool.register(n.BrokerID.NODE,this._broker),await _.peerDaemonPool.register(n.DaemonID.NODE,this)}async _clearPool(){await u.peerBrokerPool.deregister(n.BrokerID.NODE),await _.peerDaemonPool.deregister(n.DaemonID.NODE);var e=this._broker.info.id;e&&await u.peerBrokerPool.deregister(e)}async _buildTasks(){await this._buildWaitToStartTask(),await this._buildConnectPeerTask(),await this._buildListenIceNegotiationEventTask(),await this._buildListenIceCandidateEventTask(),await this._buildListenIceSignalingEventTask(),await this._buildListenIceGatheringEventTask(),await this._buildListenIceConnectionEventTask(),await this._buildListenDataChannelOpenEventTask(),await this._buildListenDataChannelDataEventTask(),await this._buildListenDataChannelErrorEventTask(),await this._buildListenDataChannelCloseEventTask(),await this._buildListenConnectionClosedEventTask(),await this._buildDeliverMessageTask(),await this._buildReceiveMessageTask(),await this._buildProcessMessageTask(),await this._buildProcessCommandTask(),await this._buildReportHealthTask(),await this._buildExitProcessTask()}async _buildConnectPeerTask(){await this._taskManager.createCommonTask({name:l.PeerDaemonTaskName.CONNECT_PEER,callee:async()=>{await this._execConnectPeerTaskCallee()},onFinish:async()=>{await this._execConnectPeerTaskOnFinish()},pretasks:[this._taskManager.cueTask(l.PeerDaemonTaskName.WAIT_TO_START)],runningTimeout:10})}async _execConnectPeerTaskCallee(){await this._agent.operate({name:h.NodePipeName.LAUNCH_CONNECT_NODE})}async _execConnectPeerTaskOnFinish(){await u.peerBrokerPool.register(this._broker.info.id,this._broker)}async _buildReportHealthTask(){await this._taskManager.createCyclicTask({name:NodeDaemonTaskName.REPORT_HEALTH,callee:async()=>{await this._execReportHealthTaskCallee()},pretasks:[this._taskManager.cueTask(l.PeerDaemonTaskName.LISTEN_DATACHANNEL_OPEN_EVENT)],sleepFirst:!0,sleepSeconds:60,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execReportHealthTaskCallee(){await this._agent.operate({name:h.NodePipeName.LAUNCH_REPORT_HEALTH})}async _recordEnabled(){await o.MetricsCollectorHolder.emit(o.MetricsCollectorEvent.NODE_STATE_RECORD,{peerID:this._broker.info.peerID,isAvailable:!0})}async _recordDisabled(){await o.MetricsCollectorHolder.emit(o.MetricsCollectorEvent.NODE_STATE_RECORD,{peerID:null,isAvailable:!1})}}t.NodeDaemon=NodeDaemon;class NodeDaemonTaskName{}NodeDaemonTaskName.REPORT_HEALTH="node daemon: report health"},7431:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.peerDaemonPool=void 0;const n=new(s(6903).BasePool);t.peerDaemonPool=n},8146:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserDaemon=void 0;const n=s(5227),a=s(2733),o=s(1598),c=s(4153),u=s(2914),l=s(3726),d=s(7431);class UserDaemon extends c.AbstractPeerDaemon{constructor(e){super(),this._options=e,this._initialize()}_initialize(){this._agent=new u.UserAgent,this._broker=new a.PeerBroker,this._broker.info.peerID=this._options.peerID,this._broker.info.swarmID=this._options.swarmID}async _activate(){await this._broker.activate(),await this._taskManager.activate(),await this._storePool(),await this._buildTasks()}async _deactivate(){await this._broker.deactivate(),await this._taskManager.deactivate(),await this._commands.close(),await this._submissions.close(),await this._clearPool()}async _storePool(){await o.peerBrokerPool.register(this._broker.info.id,this._broker),await d.peerDaemonPool.register(this._broker.info.id,this)}async _clearPool(){await o.peerBrokerPool.deregister(this._broker.info.id),await d.peerDaemonPool.deregister(this._broker.info.id)}async _buildTasks(){await this._buildWaitToStartTask(),await this._buildConnectPeerTask(),await this._buildListenIceNegotiationEventTask(),await this._buildListenIceCandidateEventTask(),await this._buildListenIceSignalingEventTask(),await this._buildListenIceGatheringEventTask(),await this._buildListenIceConnectionEventTask(),await this._buildListenDataChannelOpenEventTask(),await this._buildListenDataChannelDataEventTask(),await this._buildListenDataChannelErrorEventTask(),await this._buildListenDataChannelCloseEventTask(),await this._buildListenConnectionClosedEventTask(),await this._buildDeliverMessageTask(),await this._buildReceiveMessageTask(),await this._buildProcessMessageTask(),await this._buildProcessCommandTask(),await this._buildExitProcessTask()}async _buildConnectPeerTask(){await this._taskManager.createCommonTask({name:c.PeerDaemonTaskName.CONNECT_PEER,callee:async()=>{await this._execConnectPeerTaskCallee()},pretasks:[this._taskManager.cueTask(c.PeerDaemonTaskName.WAIT_TO_START)],runningTimeout:10})}async _execConnectPeerTaskCallee(){var e=this._broker.info.id,t=this._options;t.offer?await this._agent.operate({name:l.UserPipeName.HANDLE_CONNECT_USER,data:{id:t.flowID,brokerID:e,content:{peerID:t.peerID,swarmID:t.swarmID,offer:t.offer}}}):await this._agent.operate({name:l.UserPipeName.LAUNCH_CONNECT_USER,data:{id:t.flowID,brokerID:e,content:{peerID:t.peerID,swarmID:t.swarmID}}})}async _recordEnabled(){await n.MetricsCollectorHolder.emit(n.MetricsCollectorEvent.USER_STATE_RECORD,{peerID:this._broker.info.peerID,swarmID:this._broker.info.swarmID,isAvailable:!0})}async _recordDisabled(){await n.MetricsCollectorHolder.emit(n.MetricsCollectorEvent.USER_STATE_RECORD,{peerID:this._broker.info.peerID,swarmID:this._broker.info.swarmID,isAvailable:!1})}}t.UserDaemon=UserDaemon},6565:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PeerLauncherEvent=t.AbstractPeerLauncher=void 0;const n=s(49);class AbstractPeerLauncher extends n.AbstractLauncher{}t.AbstractPeerLauncher=AbstractPeerLauncher;class PeerLauncherEvent{}(t.PeerLauncherEvent=PeerLauncherEvent).CONNECTED="connected",PeerLauncherEvent.DISCONNECTED="disconnected"},3003:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeLauncher=void 0;const n=s(4153),a=s(3710),o=s(6565);class NodeLauncher extends o.AbstractPeerLauncher{_initialize(){}async _activate(){this._daemon=new a.NodeDaemon,await this._daemon.activate(),await this._bindEvents()}async _deactivate(){var e;await(null==(e=this._daemon)?void 0:e.clearListeners()),await(null==(e=this._daemon)?void 0:e.deactivate()),this._daemon=null}async _reactivate(){await this._deactivate(),await this._activate()}async _bindEvents(){await this._daemon.on(n.PeerDaemonEvent.CONNECTED,(async()=>{await this._onConnected()})),await this._daemon.on(n.PeerDaemonEvent.DISCONNECTED,(async()=>{await this._onDisconnected()}))}async _buildTasks(){}async _onConnected(){await this._backoff.reset(),await this.emit(o.PeerLauncherEvent.CONNECTED)}async _onDisconnected(){await this._backoff.apply((async()=>{await this._reactivate()}))}}t.NodeLauncher=NodeLauncher},6824:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserLauncher=void 0;const n=s(4153),a=s(8146),o=s(6565);class UserLauncher extends o.AbstractPeerLauncher{constructor(e){super(),this._options=e}_initialize(){}async _activate(){this._daemon=new a.UserDaemon(this._options),await this._daemon.activate(),await this._bindEvents()}async _deactivate(){var e;await(null==(e=this._daemon)?void 0:e.clearListeners()),await(null==(e=this._daemon)?void 0:e.deactivate()),this._daemon=null}async _reactivate(){}async _bindEvents(){await this._daemon.on(n.PeerDaemonEvent.DISCONNECTED,(async()=>{await this._onDisconnected()}))}async _buildTasks(){}async _onDisconnected(){await this._deactivate(),await this.emit(o.PeerLauncherEvent.DISCONNECTED)}}t.UserLauncher=UserLauncher},1111:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserManager=void 0;const n=s(533),a=s(6903),o=s(9729),c=s(7431),u=s(6565);class UserManager extends a.BasePool{constructor(){super(...arguments),this._unavailableBrokerIDs=new n.LRUCache("BROKER",{max:o.ClientConstant.UNAVAILABLE_USER_SIZE})}get hasReachedMaxConnections(){return this.size>=o.ClientConstant.MAX_USER_CONNECTIONS}isInUnavailableBrokerIDs(e){return this._unavailableBrokerIDs.has([e])}async register(e,t){await this._register(e,t)}async _register(e,t){await t.activate(),await t.on(u.PeerLauncherEvent.DISCONNECTED,(async()=>{await this._deregister(e)})),await super.register(e,t)}async deregister(e){await this._deregister(e)}async _deregister(e){var t=this.retrieve(e);await(null==t?void 0:t.deactivate()),await this._unavailableBrokerIDs.set([e],!0,1e3*o.ClientConstant.UNAVAILABLE_USER_TTL),await super.deregister(e)}async discharge(){for(const e of this.values)await(null==e?void 0:e.deactivate());await super.discharge()}async broadcast(e){var t=new Array;for(const n of this.keys){var s=c.peerDaemonPool.retrieve(n);await t.push(s.command(e))}return Promise.all(t)}}t.UserManager=UserManager},413:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SwarmScorer=t.SwarmInfo=void 0;const n=s(1139),a=s(9283),o=s(1442),c=s(4916),u=s(9729),l=s(1111);t.SwarmInfo=class SwarmInfo{constructor(e){this._swarmUsers=n.Queue.make(),this._userManager=new l.UserManager,this._timer=new a.Timer,this._swarmID=e.swarmID,this._swarmURI=e.swarmURI,this._segmentIDs=e.segmentIDs}get swarmID(){return this._swarmID}get swarmURI(){return this._swarmURI}get segmentIDs(){return this._segmentIDs}set segmentIDs(e){this._segmentIDs=e}get swarmUsers(){return this._swarmUsers}set swarmUsers(e){this._swarmUsers=e}get userManager(){return this._userManager}get timer(){return this._timer.stamp()}};(t.SwarmScorer=class SwarmScorer{static give(e){var t=0;return((t+=.2*this._calculateByElapsedTime(e))+.8*this._calculateBySegmentsCompletion(e))*this._calculateByUserConnections(e)}static _calculateByElapsedTime(e){return e=e.timer.elapsedTimeS/600,c.MathFunction.upwardExponentialCurve(e,9.2103)}static _calculateBySegmentsCompletion(e){if(0===(e=e.segmentIDs).size)return 1;let t=0;return e.forEach((e=>{e=this._resourceCache.get(e);t+=null!=(e=null==e?void 0:e.completion)?e:0})),t/e.size}static _calculateByUserConnections(e){return e=e.userManager.size,e=c.MathFunction.downwardExponentialCurve(e,u.ClientConstant.MAX_USER_CONNECTIONS),Math.max(e,0)}})._resourceCache=o.resourceCache},5832:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SwarmDaemonTaskName=t.SwarmDaemonEvent=t.AbstractSwarmDaemon=void 0;const n=s(8240),a=s(2016),o=s(4944),c=s(287),u=s(1139),l=s(7464),d=s(7926),h=s(7835),_=s(2733),p=s(4865),f=s(413),m=s(5754);class AbstractSwarmDaemon extends h.AbstractDaemon{constructor(e){super(),this._options=e,this._commands=new o.Channel,this._submissions=new o.ChannelHub}get info(){return this._info}async command(e){return await this._commands.deliver(e),this._submissions.extract(e.id,!0)}async _buildWaitToStartTask(){await this._taskManager.createCommonTask({name:SwarmDaemonTaskName.WAIT_TO_START,callee:async()=>{await this._execWaitToStartTaskCallee()}})}async _execWaitToStartTaskCallee(){await p.trackerBrokerPool.available(d.BrokerID.TRACKER)}async _buildJoinSwarmTask(){await this._taskManager.createCommonTask({name:SwarmDaemonTaskName.JOIN_SWARM,callee:async()=>{await this._execJoinSwarmTaskCallee()},onFinish:async()=>{await this._execJoinSwarmTaskOnFinish()},pretasks:[this._taskManager.cueTask(SwarmDaemonTaskName.WAIT_TO_START)]})}async _execJoinSwarmTaskCallee(){await this._agent.operate({name:m.SwarmProcessPipeName.LAUNCH_JOIN_SWARM,data:{content:{swarmID:this._info.swarmID,swarmScore:f.SwarmScorer.give(this._info)}}})}async _execJoinSwarmTaskOnFinish(){await this._recordEnabled(),await this.emit(SwarmDaemonEvent.CONNECTED)}async _buildReportSwarmStatsTask(){await this._taskManager.createCyclicTask({name:SwarmDaemonTaskName.REPORT_SWARM_STATS,callee:async()=>{await this._execReportSwarmStatsCallee()},pretasks:[this._taskManager.cueTask(SwarmDaemonTaskName.JOIN_SWARM)],sleepFirst:!0,sleepSeconds:30,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execReportSwarmStatsCallee(){await this._agent.operate({name:m.SwarmProcessPipeName.LAUNCH_REPORT_SWARM_STATS,data:{content:{swarmID:this._info.swarmID,swarmScore:f.SwarmScorer.give(this._info)}}})}async _buildObtainSwarmUsersTask(){await this._taskManager.createCyclicTask({name:SwarmDaemonTaskName.OBTAIN_SWARM_USERS,callee:async()=>{await this._execObtainSwarmUsersCallee()},pretasks:[this._taskManager.cueTask(SwarmDaemonTaskName.JOIN_SWARM)],sleepSeconds:30,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execObtainSwarmUsersCallee(){this._shouldObtainSwarmUsers&&await this._agent.operate({name:m.SwarmProcessPipeName.LAUNCH_OBTAIN_SWARM_USERS,data:{content:{swarmID:this._info.swarmID}}}).then((async e=>{e=e.swarmUsers.map((e=>({peerID:e.peerID,swarmScore:e.swarmScore}))),this._info.swarmUsers=u.Queue.from(n.RandomTool.shuffle(e))}))}get _shouldObtainSwarmUsers(){return!this._info.userManager.hasReachedMaxConnections}async _buildConnectSwarmUsersTask(){await this._taskManager.createCyclicTask({name:SwarmDaemonTaskName.CONNECT_SWARM_USERS,callee:async()=>{await this._execConnectSwarmUsersCallee()},pretasks:[this._taskManager.cueTask(SwarmDaemonTaskName.JOIN_SWARM)],loopPretasks:[this._taskManager.cueCyclicTask(SwarmDaemonTaskName.OBTAIN_SWARM_USERS)],sleepSeconds:20,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execConnectSwarmUsersCallee(){for(;this._shouldConnectSwarmUser;){var e=this._nextCandidateSwarmUser;e&&await this._agent.operate({name:m.SwarmProcessPipeName.LAUNCH_CONNECT_SWARM_USER,data:{content:{info:this._info,peerID:e.peerID,swarmID:this._info.swarmID}}})}}get _shouldConnectSwarmUser(){return!this._info.userManager.hasReachedMaxConnections&&0<this._info.swarmUsers.size}get _nextCandidateSwarmUser(){var e=this._info.userManager,t=this._info.swarmUsers.pull(),s=_.PeerBrokerID.make(t.peerID,this._info.swarmID);return e.isInUnavailableBrokerIDs(s)||e.isRegistered(s)?null:t}async _buildReportResourceStatsTask(){await this._taskManager.createCyclicTask({name:SwarmDaemonTaskName.REPORT_RESOURCE_STATS,callee:async()=>{await this._execReportResourceStatsCallee()},pretasks:[this._taskManager.cueTask(SwarmDaemonTaskName.JOIN_SWARM)],sleepSeconds:60,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execReportResourceStatsCallee(){this._shouldReportResourceStats&&await this._agent.operate({name:m.SwarmProcessPipeName.LAUNCH_REPORT_RESOURCE_STATS,data:{content:{info:this._info}}})}get _shouldReportResourceStats(){return 0<this._info.userManager.size}async _buildProcessCommandTask(){await this._taskManager.createCyclicTask({name:SwarmDaemonTaskName.PROCESS_COMMAND,callee:async()=>{await this._execProcessCommandTaskCallee()},pretasks:[this._taskManager.cueTask(SwarmDaemonTaskName.JOIN_SWARM)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execProcessCommandTaskCallee(){var e=await this._commands.extract(),t=this._info.swarmID,s=e.name;if(await c.Logger.track("Swarm command received.",{swarmID:t,command:e}),s)try{var n=await this._agent.operate({name:s,data:{id:e.id,content:e.content}});await this._submissions.deliver(e.id,n)}catch(t){await this._submissions.caution(e.id,t)}else t=new a.InternalError(l.MessageCode.ESS011,void 0,{command:e}),await this._submissions.caution(e.id,t)}async _buildExitProcessTask(){await this._taskManager.createCommonTask({name:SwarmDaemonTaskName.EXIT_PROCESS,onClose:async()=>{await this._execExitProcessTaskOnClose()},pretasks:[...this._taskManager.cueAllTasks()],callbackTimeout:15})}async _execExitProcessTaskOnClose(){await this._agent.operate({name:m.SwarmProcessPipeName.LAUNCH_LEAVE_SWARM,data:{content:{swarmID:this._info.swarmID}}}).finally((async()=>{await this._recordDisabled(),await this.emit(SwarmDaemonEvent.DISCONNECTED)}))}}t.AbstractSwarmDaemon=AbstractSwarmDaemon;class SwarmDaemonEvent{}(t.SwarmDaemonEvent=SwarmDaemonEvent).CONNECTED="connected",SwarmDaemonEvent.DISCONNECTED="disconnected";class SwarmDaemonTaskName{}(t.SwarmDaemonTaskName=SwarmDaemonTaskName).WAIT_TO_START="swarm daemon: wait to start",SwarmDaemonTaskName.JOIN_SWARM="swarm daemon: join swarm",SwarmDaemonTaskName.REPORT_SWARM_STATS="swarm daemon: report swarm stats",SwarmDaemonTaskName.OBTAIN_SWARM_USERS="swarm daemon: obtain swarm users",SwarmDaemonTaskName.CONNECT_SWARM_USERS="swarm daemon: connect swarm users",SwarmDaemonTaskName.REPORT_RESOURCE_STATS="swarm daemon: report resource stats",SwarmDaemonTaskName.PROCESS_COMMAND="swarm daemon: process command",SwarmDaemonTaskName.EXIT_PROCESS="swarm daemon: exit process"},8098:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.SwarmProcessAgent=void 0;const c=s(741),u=s(5754),l=o(s(3467));class SwarmProcessAgent extends c.AbstractProcessAgent{get _pipeNames(){return SwarmProcessAgent.PIPE_NAMES}get _pipeClasses(){return SwarmProcessAgent.PIPE_CLASSES}}(t.SwarmProcessAgent=SwarmProcessAgent).PIPE_NAMES=new Map,SwarmProcessAgent.PIPE_CLASSES=new Map([[u.SwarmProcessPipeName.LAUNCH_JOIN_SWARM,l.LaunchJoinSwarmPipe],[u.SwarmProcessPipeName.LAUNCH_REPORT_SWARM_STATS,l.LaunchReportSwarmStatsPipe],[u.SwarmProcessPipeName.LAUNCH_OBTAIN_SWARM_USERS,l.LaunchObtainSwarmUsersPipe],[u.SwarmProcessPipeName.LAUNCH_CONNECT_SWARM_USER,l.LaunchConnectSwarmUserPipe],[u.SwarmProcessPipeName.LAUNCH_REPORT_RESOURCE_STAT,l.LaunchReportResourceStatPipe],[u.SwarmProcessPipeName.LAUNCH_REPORT_RESOURCE_STATS,l.LaunchReportResourceStatsPipe],[u.SwarmProcessPipeName.LAUNCH_LEAVE_SWARM,l.LaunchLeaveSwarmPipe]])},741:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractProcessAgent=void 0;t.AbstractProcessAgent=class AbstractProcessAgent{async operate(e){return new(this._pipeClasses.get(e.name))(null!=(e=e.data)?e:{}).process()}findPipeName(e){return this._pipeNames.get(e)}}},8666:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractProcessFlow=void 0;const n=s(3267);class AbstractProcessFlow extends n.AbstractFlow{constructor(e){super(e)}}t.AbstractProcessFlow=AbstractProcessFlow},5785:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractProcessPipe=void 0;const n=s(8666);class AbstractProcessPipe extends n.AbstractProcessFlow{constructor(e){super(e)}}t.AbstractProcessPipe=AbstractProcessPipe},9820:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),a(s(831),t)},831:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchReportResourceStatsFlow=t.LaunchReportResourceStatFlow=t.LaunchConnectSwarmUserFlow=void 0;const n=s(2016),a=s(7464),o=s(3897),c=s(1442),u=s(2733),l=s(3726),d=s(6824),h=s(8666);class LaunchConnectSwarmUserFlow extends h.AbstractProcessFlow{async process(){await this._connectSwarmUser()}async _connectSwarmUser(){var e=this._content,t=e.info.userManager,s=u.PeerBrokerID.make(e.peerID,e.swarmID);if(t.hasReachedMaxConnections)throw new n.InternalError(a.MessageCode.ESS005,void 0,{brokerID:s});if(t.isInUnavailableBrokerIDs(s))throw new n.InternalError(a.MessageCode.ESS006,void 0,{brokerID:s});if(t.isRegistered(s))throw new n.InternalError(a.MessageCode.ESS007,void 0,{brokerID:s});await t.register(s,new d.UserLauncher({flowID:this._id,peerID:e.peerID,swarmID:e.swarmID,offer:e.offer}))}}t.LaunchConnectSwarmUserFlow=LaunchConnectSwarmUserFlow;class LaunchReportResourceStatFlow extends h.AbstractProcessFlow{async process(){await this._intakeResourceStat(),await this._reportResourceStat()}async _intakeResourceStat(){var e=this._content.resourceID,t={id:e,completion:null!=(e=null==(t=c.resourceCache.get(e))?void 0:t.completion)?e:0};await this._expose(o.FlowKey.STAT,t)}async _reportResourceStat(){var e=this._require(o.FlowKey.STAT);await this._content.info.userManager.broadcast({id:this._id,name:l.UserPipeName.LAUNCH_REPORT_RESOURCE_STAT,content:e})}}t.LaunchReportResourceStatFlow=LaunchReportResourceStatFlow;class LaunchReportResourceStatsFlow extends h.AbstractProcessFlow{async process(){await this._intakeResourceStats(),await this._reportResourceStats()}async _intakeResourceStats(){var e=new Array;for(const s of this._content.info.segmentIDs){var t=c.resourceCache.get(s);await e.push({id:s,completion:null!=(t=null==t?void 0:t.completion)?t:0})}await this._expose(o.FlowKey.STATS,e)}async _reportResourceStats(){var e=this._require(o.FlowKey.STATS);await this._content.info.userManager.broadcast({id:this._id,name:l.UserPipeName.LAUNCH_REPORT_RESOURCE_STATS,content:e})}}t.LaunchReportResourceStatsFlow=LaunchReportResourceStatsFlow},5754:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SwarmProcessPipeName=void 0;class SwarmProcessPipeName{}(t.SwarmProcessPipeName=SwarmProcessPipeName).LAUNCH_JOIN_SWARM="launch join swarm",SwarmProcessPipeName.LAUNCH_REPORT_SWARM_STATS="launch report swarm stats",SwarmProcessPipeName.LAUNCH_OBTAIN_SWARM_USERS="launch obtain swarm users",SwarmProcessPipeName.LAUNCH_CONNECT_SWARM_USER="launch connect swarm user",SwarmProcessPipeName.LAUNCH_REPORT_RESOURCE_STAT="launch report resource stat",SwarmProcessPipeName.LAUNCH_REPORT_RESOURCE_STATS="launch report resource stats",SwarmProcessPipeName.LAUNCH_LEAVE_SWARM="launch leave swarm"},3467:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),a(s(2274),t),a(s(1892),t)},2274:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchLeaveSwarmPipe=t.LaunchObtainSwarmUsersPipe=t.LaunchReportSwarmStatsPipe=t.LaunchJoinSwarmPipe=void 0;const c=o(s(2643)),u=s(5785);class LaunchJoinSwarmPipe extends u.AbstractProcessPipe{async process(){await this._joinSwarm()}async _joinSwarm(){await this._bypass(new c.LaunchJoinSwarmFlow({content:this._content}))}}t.LaunchJoinSwarmPipe=LaunchJoinSwarmPipe;class LaunchReportSwarmStatsPipe extends u.AbstractProcessPipe{async process(){await this._reportSwarmStats()}async _reportSwarmStats(){await this._bypass(new c.LaunchReportSwarmStatsFlow({content:this._content}))}}t.LaunchReportSwarmStatsPipe=LaunchReportSwarmStatsPipe;class LaunchObtainSwarmUsersPipe extends u.AbstractProcessPipe{async process(){return await this._obtainSwarmUsers(),this._outcome}async _obtainSwarmUsers(){this._outcome=await this._bypass(new c.LaunchObtainSwarmUsersFlow({content:this._content}))}}t.LaunchObtainSwarmUsersPipe=LaunchObtainSwarmUsersPipe;class LaunchLeaveSwarmPipe extends u.AbstractProcessPipe{async process(){await this._leaveSwarm()}async _leaveSwarm(){await this._bypass(new c.LaunchLeaveSwarmFlow({content:this._content}))}}t.LaunchLeaveSwarmPipe=LaunchLeaveSwarmPipe},1892:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchReportResourceStatsPipe=t.LaunchReportResourceStatPipe=t.LaunchConnectSwarmUserPipe=void 0;const c=s(5785),u=o(s(9820));class LaunchConnectSwarmUserPipe extends c.AbstractProcessPipe{async process(){await this._connectSwarmUser()}async _connectSwarmUser(){await this._bypass(new u.LaunchConnectSwarmUserFlow({content:this._content}))}}t.LaunchConnectSwarmUserPipe=LaunchConnectSwarmUserPipe;class LaunchReportResourceStatPipe extends c.AbstractProcessPipe{async process(){await this._reportResourceStat()}async _reportResourceStat(){await this._bypass(new u.LaunchReportResourceStatFlow({content:this._content}))}}t.LaunchReportResourceStatPipe=LaunchReportResourceStatPipe;class LaunchReportResourceStatsPipe extends c.AbstractProcessPipe{async process(){await this._reportResourceStats()}async _reportResourceStats(){await this._bypass(new u.LaunchReportResourceStatsFlow({content:this._content}))}}t.LaunchReportResourceStatsPipe=LaunchReportResourceStatsPipe},596:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SwarmDaemon=void 0;const n=s(5227),a=s(5832),o=s(8098),c=s(8144);class SwarmDaemon extends a.AbstractSwarmDaemon{constructor(e){super(e),this._options=e,this._initialize()}_initialize(){this._info=this._options.info,this._agent=new o.SwarmProcessAgent}async _activate(){await this._taskManager.activate(),await this._storePool(),await this._buildTasks()}async _deactivate(){await this._taskManager.deactivate(),await this._commands.close(),await this._submissions.close(),await this._clearPool()}async _storePool(){await c.swarmDaemonPool.register(this._info.swarmID,this)}async _clearPool(){await c.swarmDaemonPool.deregister(this._info.swarmID)}async _buildTasks(){await this._buildWaitToStartTask(),await this._buildJoinSwarmTask(),await this._buildReportSwarmStatsTask(),await this._buildObtainSwarmUsersTask(),await this._buildConnectSwarmUsersTask(),await this._buildReportResourceStatsTask(),await this._buildProcessCommandTask(),await this._buildExitProcessTask()}async _recordEnabled(){await n.MetricsCollectorHolder.emit(n.MetricsCollectorEvent.SWARM_STATE_RECORD,{swarmID:this._info.swarmID,swarmURI:this._info.swarmURI,isAvailable:!0})}async _recordDisabled(){await n.MetricsCollectorHolder.emit(n.MetricsCollectorEvent.SWARM_STATE_RECORD,{swarmID:this._info.swarmID,isAvailable:!1})}}t.SwarmDaemon=SwarmDaemon},8144:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.swarmDaemonPool=void 0;const n=new(s(6903).BasePool);t.swarmDaemonPool=n},2149:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractSwarmLauncher=void 0;const n=s(49);class AbstractSwarmLauncher extends n.AbstractLauncher{constructor(e){super(),this._options=e}}t.AbstractSwarmLauncher=AbstractSwarmLauncher},9124:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SwarmLauncher=void 0;const n=s(5832),a=s(596),o=s(2149);class SwarmLauncher extends o.AbstractSwarmLauncher{constructor(e){super(e),this._options=e,this._initialize()}_initialize(){this._info=this._options.info}async _activate(){this._daemon=new a.SwarmDaemon(this._options),await this._daemon.activate(),await this._bindEvents()}async _deactivate(){var e;await(null==(e=this._daemon)?void 0:e.clearListeners()),await(null==(e=this._daemon)?void 0:e.deactivate()),this._daemon=null}async _terminate(){await super._terminate(),await this._info.userManager.discharge()}async _reactivate(){await this._deactivate(),await this._activate()}async _bindEvents(){await this._daemon.on(n.SwarmDaemonEvent.CONNECTED,(async()=>{await this._onConnected()})),await this._daemon.on(n.SwarmDaemonEvent.DISCONNECTED,(async()=>{await this._onDisconnected()}))}async _buildTasks(){}async _onConnected(){await this._backoff.reset()}async _onDisconnected(){await this._backoff.apply((async()=>{await this._reactivate()}))}}t.SwarmLauncher=SwarmLauncher},7097:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SwarmManagerHolder=t.SwarmManager=void 0;const n=s(6903);class SwarmManager extends n.BasePool{async register(e,t){await t.activate(),await super.register(e,t)}async deregister(e){var t=this.retrieve(e);await(null==t?void 0:t.deactivate()),await super.deregister(e)}async recharge(){for(const e of this.values)await e.reactivate()}async discharge(){for(const e of this.values)await e.deactivate();await super.discharge()}}t.SwarmManager=SwarmManager;t.SwarmManagerHolder=class SwarmManagerHolder{static get instance(){return this._instance}static set instance(e){this._instance=e}static isRegistered(e){return this._instance.isRegistered(e)}static async register(e,t){await this._instance.register(e,t)}static async deregister(e){await this._instance.deregister(e)}static async recharge(){await this._instance.recharge()}}},4203:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SwarmProvider=void 0;const n=s(7097);t.SwarmProvider=class SwarmProvider{async activate(){await this._loadSwarmManager()}async _loadSwarmManager(){n.SwarmManagerHolder.instance=new n.SwarmManager}async deactivate(){await this._unloadSwarmManager()}async _unloadSwarmManager(){var e=n.SwarmManagerHolder.instance;await(null==e?void 0:e.discharge()),n.SwarmManagerHolder.instance=null}}},7433:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Centrifuge=void 0;const a=n(s(5641));t.Centrifuge=a.default},8982:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CentrifugeCode=void 0;(t.CentrifugeCode=class CentrifugeCode{}).SELF_TERMINATION=1007},4808:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerEvent=t.TrackerBrokerInfo=t.TrackerBroker=void 0;const u=c(s(148)),l=s(4944),d=s(8925),h=s(97),_=o(s(9991)),p=s(1744),f=s(9131),m=s(7433),y=s(8982);t.TrackerBroker=class TrackerBroker{constructor(e){this._uri=e,this._condition=new l.Condition,this._eventHub=new l.ChannelHub,this._messageHub=new l.ChannelHub,this._deliverChannel=new l.Channel,this._receiveChannel=new l.Channel,this._info=new TrackerBrokerInfo}get info(){return this._info}get condition(){return this._condition}get eventHub(){return this._eventHub}get messageHub(){return this._messageHub}get deliverChannel(){return this._deliverChannel}get receiveChannel(){return this._receiveChannel}get serverChannelID(){return this._client.serverChannelID}get isActivated(){return!this._client.state.isDestroyed}get isConnected(){return this._client.state.isConnected}get isAvailable(){return this._client.state.isConnected&&this._condition.isDone}async activate(){this._client=new TrackerClient(this._uri),await this._client.open(),await this._bindEvents(),await this._openEventHub()}async deactivate(){await this._client.close(),await this._client.clearListeners(),await this._eventHub.close(),await this._messageHub.close(),await this._deliverChannel.close(),await this._receiveChannel.close()}async sendMessage(e){await this._client.send(e)}async commitMessage(e){await this._deliverChannel.deliver(e)}async _bindEvents(){this._client.on(TrackerEvent.STATE,(async e=>{await this._eventHub.deliver(TrackerEvent.STATE,e)})),this._client.on(TrackerEvent.CONNECTING,(async e=>{await this._eventHub.deliver(TrackerEvent.CONNECTING,e)})),this._client.on(TrackerEvent.CONNECTED,(async e=>{await this._eventHub.deliver(TrackerEvent.CONNECTED,e)})),this._client.on(TrackerEvent.DISCONNECTED,(async e=>{await this._eventHub.deliver(TrackerEvent.DISCONNECTED,e)})),this._client.on(TrackerEvent.TERMINATED,(async()=>{await this._eventHub.deliver(TrackerEvent.TERMINATED,void 0)})),this._client.on(TrackerEvent.SUBSCRIBING,(async e=>{await this._eventHub.deliver(TrackerEvent.SUBSCRIBING,e)})),this._client.on(TrackerEvent.SUBSCRIBED,(async e=>{await this._eventHub.deliver(TrackerEvent.SUBSCRIBED,e)})),this._client.on(TrackerEvent.UNSUBSCRIBED,(async e=>{await this._eventHub.deliver(TrackerEvent.UNSUBSCRIBED,e)})),this._client.on(TrackerEvent.JOIN,(async e=>{await this._eventHub.deliver(TrackerEvent.JOIN,e)})),this._client.on(TrackerEvent.LEAVE,(async e=>{await this._eventHub.deliver(TrackerEvent.LEAVE,e)})),this._client.on(TrackerEvent.SERVER_DATA,(async e=>{await this._eventHub.deliver(TrackerEvent.SERVER_DATA,e)})),this._client.on(TrackerEvent.SPREAD_DATA,(async e=>{await this._eventHub.deliver(TrackerEvent.SPREAD_DATA,e)})),this._client.on(TrackerEvent.MESSAGE,(async e=>{await this._eventHub.deliver(TrackerEvent.MESSAGE,e)})),this._client.on(TrackerEvent.ERROR,(async e=>{await this._eventHub.deliver(TrackerEvent.ERROR,e)}))}async _openEventHub(){await this._eventHub.connect(TrackerEvent.STATE),await this._eventHub.connect(TrackerEvent.CONNECTING),await this._eventHub.connect(TrackerEvent.CONNECTED),await this._eventHub.connect(TrackerEvent.DISCONNECTED),await this._eventHub.connect(TrackerEvent.TERMINATED),await this._eventHub.connect(TrackerEvent.SUBSCRIBING),await this._eventHub.connect(TrackerEvent.SUBSCRIBED),await this._eventHub.connect(TrackerEvent.UNSUBSCRIBED),await this._eventHub.connect(TrackerEvent.JOIN),await this._eventHub.connect(TrackerEvent.LEAVE),await this._eventHub.connect(TrackerEvent.SERVER_DATA),await this._eventHub.connect(TrackerEvent.SPREAD_DATA),await this._eventHub.connect(TrackerEvent.MESSAGE),await this._eventHub.connect(TrackerEvent.ERROR)}};class TrackerBrokerInfo extends f.AbstractBrokerInfo{constructor(){super(...arguments),this._peerID=p.kernelSettings.client.peerID}get id(){return this._peerID}}t.TrackerBrokerInfo=TrackerBrokerInfo;class TrackerClient extends u.default{constructor(e){super(),this._uri=e,this._state=new TrackerState,this._serverChannelID="#"+p.kernelSettings.client.peerID,this._centrifuge=new m.Centrifuge(e,{websocket:h.WebSocket,token:p.kernelSettings.client.token,getToken:this._renewToken.bind(this),protocol:"protobuf",timeout:1e4,maxReconnectDelay:1e4,maxServerPingDelay:1e3}),this._bindCentrifuge()}get state(){return this._state}get serverChannelID(){return this._serverChannelID}async send(e){await this._centrifuge.publish(this._serverChannelID,d.Buffer.from(e)).catch((async e=>{throw e.code===y.CentrifugeCode.SELF_TERMINATION&&(await this._state.toDestroyed(),await this.emit(TrackerEvent.TERMINATED)),e}))}async open(){await this._centrifuge.connect()}async close(){await this._centrifuge.disconnect()}_bindCentrifuge(){this._centrifuge.on(CentrifugeEvent.STATE,(async e=>{await this._onState(e)})),this._centrifuge.on(CentrifugeEvent.CONNECTING,(async e=>{await this._onConnecting(e)})),this._centrifuge.on(CentrifugeEvent.CONNECTED,(async e=>{await this._onConnected(e)})),this._centrifuge.on(CentrifugeEvent.DISCONNECTED,(async e=>{await this._onDisconnected(e)})),this._centrifuge.on(CentrifugeEvent.SUBSCRIBING,(async e=>{await this._onSubscribing(e)})),this._centrifuge.on(CentrifugeEvent.SUBSCRIBED,(async e=>{await this._onSubscribed(e)})),this._centrifuge.on(CentrifugeEvent.UNSUBSCRIBED,(async e=>{await this._onUnsubscribed(e)})),this._centrifuge.on(CentrifugeEvent.JOIN,(async e=>{await this._onJoin(e)})),this._centrifuge.on(CentrifugeEvent.LEAVE,(async e=>{await this._onLeave(e)})),this._centrifuge.on(CentrifugeEvent.PUBLICATION,(async e=>{await this._onPublication(e)})),this._centrifuge.on(CentrifugeEvent.MESSAGE,(async e=>{await this._onMessage(e)})),this._centrifuge.on(CentrifugeEvent.ERROR,(async e=>{await this._onError(e)}))}async _renewToken(){var e=await _.TokenAPIRenewTokenHandler.process();return p.kernelSettings.client.token=e.token,p.kernelSettings.client.peerID=e.peerID,e.token}async _onState(e){await this.emit(TrackerEvent.STATE,e)}async _onConnecting(e){await this._state.toConnecting(),await this.emit(TrackerEvent.CONNECTING,e)}async _onConnected(e){await this.emit(TrackerEvent.CONNECTED,e)}async _onDisconnected(e){await this._state.toDestroyed(),await this.emit(TrackerEvent.DISCONNECTED,e),await this.emit(TrackerEvent.TERMINATED)}async _onSubscribing(e){await this.emit(TrackerEvent.SUBSCRIBING,e)}async _onSubscribed(e){e.channel===this._serverChannelID&&await this._state.toConnected(),await this.emit(TrackerEvent.SUBSCRIBED,e)}async _onUnsubscribed(e){await this.emit(TrackerEvent.UNSUBSCRIBED,e)}async _onJoin(e){await this.emit(TrackerEvent.JOIN,e)}async _onLeave(e){await this.emit(TrackerEvent.LEAVE,e)}async _onPublication(e){e.channel===this._serverChannelID?await this.emit(TrackerEvent.SERVER_DATA,e):await this.emit(TrackerEvent.SPREAD_DATA,e)}async _onMessage(e){await this.emit(TrackerEvent.MESSAGE,e)}async _onError(e){await this.emit(TrackerEvent.ERROR,e)}}class CentrifugeEvent{}CentrifugeEvent.STATE="state",CentrifugeEvent.CONNECTING="connecting",CentrifugeEvent.CONNECTED="connected",CentrifugeEvent.DISCONNECTED="disconnected",CentrifugeEvent.SUBSCRIBING="subscribing",CentrifugeEvent.SUBSCRIBED="subscribed",CentrifugeEvent.UNSUBSCRIBED="unsubscribed",CentrifugeEvent.JOIN="join",CentrifugeEvent.LEAVE="leave",CentrifugeEvent.PUBLICATION="publication",CentrifugeEvent.MESSAGE="message",CentrifugeEvent.ERROR="error";class TrackerEvent extends CentrifugeEvent{}(t.TrackerEvent=TrackerEvent).TERMINATED="terminated",TrackerEvent.SERVER_DATA="server_data",TrackerEvent.SPREAD_DATA="spread_data";class TrackerState{constructor(){this._name=TrackerStateName.INITIAL}get isInitial(){return this._name===TrackerStateName.INITIAL}get isConnecting(){return this._name===TrackerStateName.CONNECTING}get isConnected(){return this._name===TrackerStateName.CONNECTED}get isDestroyed(){return this._name===TrackerStateName.DESTROYED}toInitial(){this._name=TrackerStateName.INITIAL}toConnecting(){this._name=TrackerStateName.CONNECTING}toConnected(){this._name=TrackerStateName.CONNECTED}toDestroyed(){this._name=TrackerStateName.DESTROYED}}class TrackerStateName{}TrackerStateName.INITIAL="initial",TrackerStateName.CONNECTING="connecting",TrackerStateName.CONNECTED="connected",TrackerStateName.DESTROYED="destroyed"},4865:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackerBrokerPool=void 0;const n=new(s(9131).BrokerPool);t.trackerBrokerPool=n},5856:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerDaemonTaskName=t.TrackerDaemonEvent=t.AbstractTrackerDaemon=void 0;const n=s(93),a=s(2016),o=s(4944),c=s(287),u=s(8925),l=s(1744),d=s(7464),h=s(9007),_=s(7835),p=s(4808),f=s(7646);class AbstractTrackerDaemon extends _.AbstractDaemon{constructor(){super(...arguments),this._feedbacks=new o.Channel}get broker(){return this._broker}_makeURI(){var e=l.kernelSettings.server.tracker.fqdns;return`wss://${e[Math.floor(Math.random()*e.length)]}/centrifugo/connection/websocket`}async feedback(){return this._feedbacks.extract()}async _buildWaitToStartTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.WAIT_TO_START,sentinel:async()=>this._execWaitToStartTaskSentinel(),sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1,runningTimeout:10})}async _execWaitToStartTaskSentinel(){var e=await this._broker.eventHub.extract(p.TrackerEvent.SUBSCRIBED);return await c.Logger.track("Tracker subscribed event.",{context:e}),e.channel===this._broker.serverChannelID}async _buildListenStateEventTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.LISTEN_STATE_EVENT,callee:async()=>{await this._execListenStateEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenStateEventTaskCallee(){var e=await this._broker.eventHub.extract(p.TrackerEvent.STATE);await c.Logger.track("Tracker state event.",{context:e})}async _buildListenConnectingEventTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.LISTEN_CONNECTING_EVENT,callee:async()=>{await this._execListenConnectingEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenConnectingEventTaskCallee(){var e=await this._broker.eventHub.extract(p.TrackerEvent.CONNECTING);await c.Logger.track("Tracker connecting event.",{context:e})}async _buildListenConnectedEventTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.LISTEN_CONNECTED_EVENT,callee:async()=>{await this._execListenConnectedEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenConnectedEventTaskCallee(){var e=await this._broker.eventHub.extract(p.TrackerEvent.CONNECTED);await c.Logger.track("Tracker connected event.",{context:e})}async _buildListenDisconnectedEventTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.LISTEN_DISCONNECTED_EVENT,callee:async()=>{await this._execListenDisconnectedEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenDisconnectedEventTaskCallee(){var e=await this._broker.eventHub.extract(p.TrackerEvent.DISCONNECTED);await c.Logger.track("Tracker disconnected event.",{context:e})}async _buildListenTerminatedEventTask(){await this._taskManager.createCommonTask({name:TrackerDaemonTaskName.LISTEN_TERMINATED_EVENT,callee:async()=>{await this._execListenTerminatedEventTaskCallee()}})}async _execListenTerminatedEventTaskCallee(){throw await this._broker.eventHub.extract(p.TrackerEvent.TERMINATED),TrackerDaemonError.BROKER_CLOSED}async _buildListenSubscribingEventTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.LISTEN_SUBSCRIBING_EVENT,callee:async()=>{await this._execListenSubscribingEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenSubscribingEventTaskCallee(){var e=await this._broker.eventHub.extract(p.TrackerEvent.SUBSCRIBING);await c.Logger.track("Tracker subscribing event.",{context:e})}async _buildListenSubscribedEventTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.LISTEN_SUBSCRIBED_EVENT,callee:async()=>{await this._execListenSubscribedEventTaskCallee()},pretasks:[this._taskManager.cueTask(TrackerDaemonTaskName.WAIT_TO_START)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenSubscribedEventTaskCallee(){var e=await this._broker.eventHub.extract(p.TrackerEvent.SUBSCRIBED);await c.Logger.track("Tracker subscribed event.",{context:e})}async _buildListenUnsubscribedEventTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.LISTEN_UNSUBSCRIBED_EVENT,callee:async()=>{await this._execListenUnsubscribedEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenUnsubscribedEventTaskCallee(){var e=await this._broker.eventHub.extract(p.TrackerEvent.UNSUBSCRIBED);await c.Logger.track("Tracker unsubscribed event.",{context:e})}async _buildListenJoinEventTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.LISTEN_JOIN_EVENT,callee:async()=>{await this._execListenJoinEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenJoinEventTaskCallee(){var e=await this._broker.eventHub.extract(p.TrackerEvent.JOIN);await c.Logger.track("Tracker join event.",{context:e})}async _buildListenLeaveEventTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.LISTEN_LEAVE_EVENT,callee:async()=>{await this._execListenLeaveEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenLeaveEventTaskCallee(){var e=await this._broker.eventHub.extract(p.TrackerEvent.LEAVE);await c.Logger.track("Tracker leave event.",{context:e})}async _buildListenServerDataEventTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.LISTEN_SERVER_DATA_EVENT,callee:async()=>{await this._execListenServerDataEventTaskCallee()},pretasks:[this._taskManager.cueTask(TrackerDaemonTaskName.WAIT_TO_START)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenServerDataEventTaskCallee(){var e=await this._broker.eventHub.extract(p.TrackerEvent.SERVER_DATA),t=(e=new h.ProtocolMessage(u.Buffer.from(e.data))).payload,s=this._broker.info.id,n=null==(n=t.header)?void 0:n.correlation_id;await c.Logger.info("Tracker payload received.",{brokerID:s,payload:t}),n?await this._broker.messageHub.deliver(n,e):await this._broker.receiveChannel.deliver(e)}async _buildListenSpreadDataEventTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.LISTEN_SPREAD_DATA_EVENT,callee:async()=>{await this._execListenSpreadDataEventTaskCallee()},pretasks:[this._taskManager.cueTask(TrackerDaemonTaskName.WAIT_TO_START)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenSpreadDataEventTaskCallee(){var e=await this._broker.eventHub.extract(p.TrackerEvent.SPREAD_DATA);await c.Logger.track("Tracker spread data event.",{context:e})}async _buildListenMessageEventTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.LISTEN_MESSAGE_EVENT,callee:async()=>{await this._execListenMessageEventTaskCallee()},pretasks:[this._taskManager.cueTask(TrackerDaemonTaskName.WAIT_TO_START)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenMessageEventTaskCallee(){var e=await this._broker.eventHub.extract(p.TrackerEvent.MESSAGE);await c.Logger.track("Tracker message event.",{context:e})}async _buildListenErrorEventTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.LISTEN_ERROR_EVENT,callee:async()=>{await this._execListenErrorEventTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execListenErrorEventTaskCallee(){var e=await this._broker.eventHub.extract(p.TrackerEvent.ERROR);await c.Logger.warn("Tracker error event.",{context:e})}async _buildDeliverMessageTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.DELIVER_MESSAGE,callee:async()=>{await this._execDeliverMessageTaskCallee()},pretasks:[this._taskManager.cueTask(TrackerDaemonTaskName.WAIT_TO_START)],sleepSeconds:.02,sleepJitter:.5,maxErrorRetry:-1,maxTotalRetry:-1})}async _execDeliverMessageTaskCallee(){for(var e=await this._broker.deliverChannel.extract();this._broker.isActivated;){if(this._broker.isConnected)return void await this._broker.sendMessage(e);await n.TimeTool.sleepRandomly(.01)}}async _buildReceiveMessageTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.RECEIVE_MESSAGE,callee:async()=>{await this._execReceiveMessageTaskCallee()},pretasks:[this._taskManager.cueTask(TrackerDaemonTaskName.WAIT_TO_START)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execReceiveMessageTaskCallee(){var e=await this._broker.messageHub.lostCenter.extract();await this._broker.receiveChannel.deliver(e)}async _buildProcessMessageTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.PROCESS_MESSAGE,callee:async()=>{await this._execProcessMessageTaskCallee()},pretasks:[this._taskManager.cueTask(TrackerDaemonTaskName.WAIT_TO_START)],sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execProcessMessageTaskCallee(){var e=await this._broker.receiveChannel.extract(),t=e.payload,s=this._agent.findPipeName(t.action);s?await this._agent.operate({name:s,data:{id:null==(s=t.header)?void 0:s.correlation_id,content:e}}):await this._feedbacks.deliver({content:e})}async _buildReportHealthTask(){await this._taskManager.createCyclicTask({name:TrackerDaemonTaskName.REPORT_HEALTH,callee:async()=>{await this._execReportHealthTaskCallee()},pretasks:[this._taskManager.cueTask(TrackerDaemonTaskName.ENABLE_PEER)],sleepFirst:!0,sleepSeconds:60,sleepJitter:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execReportHealthTaskCallee(){await this._agent.operate({name:f.TrackerPipeName.LAUNCH_REPORT_HEALTH})}async _buildExitProcessTask(){await this._taskManager.createCommonTask({name:TrackerDaemonTaskName.EXIT_PROCESS,onClose:async()=>{await this._execExitProcessTaskOnClose()},pretasks:[...this._taskManager.cueAllTasks()],callbackTimeout:15})}async _execExitProcessTaskOnClose(){await this._broker.condition.deny(TrackerDaemonError.DAEMON_EXITED),await this._recordDisabled(),await this.emit(TrackerDaemonEvent.DISCONNECTED)}}t.AbstractTrackerDaemon=AbstractTrackerDaemon;class TrackerDaemonEvent{}(t.TrackerDaemonEvent=TrackerDaemonEvent).FEEDBACK="feedback",TrackerDaemonEvent.CONNECTED="connected",TrackerDaemonEvent.DISCONNECTED="disconnected";class TrackerDaemonTaskName{}(t.TrackerDaemonTaskName=TrackerDaemonTaskName).WAIT_TO_START="tracker daemon: wait to start",TrackerDaemonTaskName.LISTEN_STATE_EVENT="tracker daemon: listen state event",TrackerDaemonTaskName.LISTEN_CONNECTING_EVENT="tracker daemon: listen connecting event",TrackerDaemonTaskName.LISTEN_CONNECTED_EVENT="tracker daemon: listen connected event",TrackerDaemonTaskName.LISTEN_DISCONNECTED_EVENT="tracker daemon: listen disconnected event",TrackerDaemonTaskName.LISTEN_TERMINATED_EVENT="tracker daemon: listen terminated event",TrackerDaemonTaskName.LISTEN_SUBSCRIBING_EVENT="tracker daemon: listen subscribing event",TrackerDaemonTaskName.LISTEN_SUBSCRIBED_EVENT="tracker daemon: listen subscribed event",TrackerDaemonTaskName.LISTEN_UNSUBSCRIBED_EVENT="tracker daemon: listen unsubscribed event",TrackerDaemonTaskName.LISTEN_JOIN_EVENT="tracker daemon: listen join event",TrackerDaemonTaskName.LISTEN_LEAVE_EVENT="tracker daemon: listen leave event",TrackerDaemonTaskName.LISTEN_SERVER_DATA_EVENT="tracker daemon: listen server data event",TrackerDaemonTaskName.LISTEN_SPREAD_DATA_EVENT="tracker daemon: listen spread data event",TrackerDaemonTaskName.LISTEN_MESSAGE_EVENT="tracker daemon: listen message event",TrackerDaemonTaskName.LISTEN_ERROR_EVENT="tracker daemon: listen error event",TrackerDaemonTaskName.DELIVER_MESSAGE="tracker daemon: deliver message",TrackerDaemonTaskName.RECEIVE_MESSAGE="tracker daemon: receive message",TrackerDaemonTaskName.PROCESS_MESSAGE="tracker daemon: process message",TrackerDaemonTaskName.ENABLE_PEER="tracker daemon: enable peer",TrackerDaemonTaskName.REPORT_HEALTH="tracker daemon: report health",TrackerDaemonTaskName.EXIT_PROCESS="tracker daemon: exit process";class TrackerDaemonError{}TrackerDaemonError.BROKER_CLOSED=new a.InternalError(d.MessageCode.ESS020),TrackerDaemonError.DAEMON_EXITED=new a.InternalError(d.MessageCode.ESS021)},1970:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerAgent=void 0;const c=s(1693),u=s(1438),l=s(7646),d=o(s(3589));class TrackerAgent extends u.AbstractProcessAgent{get _pipeNames(){return TrackerAgent.PIPE_NAMES}get _pipeClasses(){return TrackerAgent.PIPE_CLASSES}}(t.TrackerAgent=TrackerAgent).PIPE_NAMES=new Map([[c.TrackerActionName.MESSAGE_NOTIFY_EXCEPTION,l.TrackerPipeName.HANDLE_NOTIFY_EXCEPTION],[c.TrackerActionName.MESSAGE_CONFIRM_RECEIPT,l.TrackerPipeName.HANDLE_CONFIRM_RECEIPT],[c.TrackerActionName.MESSAGE_DELIVER_ICE_CANDIDATE,l.TrackerPipeName.HANDLE_DELIVER_ICE_CANDIDATE]]),TrackerAgent.PIPE_CLASSES=new Map([[l.TrackerPipeName.LAUNCH_ENABLE_USER,d.LaunchEnableUserPipe],[l.TrackerPipeName.LAUNCH_REPORT_HEALTH,d.LaunchReportHealthPipe],[l.TrackerPipeName.HANDLE_NOTIFY_EXCEPTION,d.HandleNotifyExceptionPipe],[l.TrackerPipeName.HANDLE_CONFIRM_RECEIPT,d.HandleConfirmReceiptPipe],[l.TrackerPipeName.HANDLE_DELIVER_ICE_CANDIDATE,d.HandleDeliverIceCandidatePipe]])},2643:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),a(s(6069),t),a(s(3225),t),a(s(1461),t),a(s(9440),t),a(s(7177),t),a(s(1199),t),a(s(5405),t)},6069:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchConnectNodeFlow=void 0;const n=s(1744),a=s(3897),o=s(1693),c=s(1716),u=s(6897),l=s(5493);class LaunchConnectNodeFlow extends l.AbstractProcessFlow{async process(){return await this._intakeBroker(),await this._intakeRequest(),await this._forwardRequest(),await this._intakeResponse(),await this._intakeOutcome(),this._outcome}async _intakeBroker(){this._broker=this._obtainTrackerBroker()}async _intakeRequest(){var e=this._content;e={action:o.TrackerActionName.REQUEST_CONNECT_NODE,header:{correlation_id:this._id,source_peer_id:n.kernelSettings.client.peerID},content:{sdp:e.sdp,type:e.type}};await this._expose(a.FlowKey.REQUEST,e)}async _forwardRequest(){var e=this._require(a.FlowKey.REQUEST);await this._broker.commitMessage(c.TrackerConnectNodeRequest.encode(e).finish())}async _intakeResponse(){var e=await this._broker.messageHub.extract(this._id,!0);await u.ErrorMessageDetector.throwIfError(e.buffer),e=c.TrackerConnectNodeResponse.decode(e.buffer);await this._expose(a.FlowKey.RESPONSE,e)}async _intakeOutcome(){var e=this._require(a.FlowKey.RESPONSE).content;this._outcome={peerID:e.peer_id,sdp:e.sdp,type:e.type}}}t.LaunchConnectNodeFlow=LaunchConnectNodeFlow},3225:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HandleConfirmReceiptFlow=t.HandleNotifyExceptionFlow=void 0;const n=s(1716),a=s(6897),o=s(5493);class HandleNotifyExceptionFlow extends o.AbstractProcessFlow{async process(){await this._recordMessage()}async _recordMessage(){var e=new a.ErrorMessageDetector(this._content.buffer);this._logWarn("Log error message.",e.error.params,{error:e.error})}}t.HandleNotifyExceptionFlow=HandleNotifyExceptionFlow;class HandleConfirmReceiptFlow extends o.AbstractProcessFlow{async process(){await this._recordMessage()}async _recordMessage(){var e=n.TrackerConfirmReceiptMessage.decode(this._content.buffer);this._logTrack("Log info message.",{payload:e})}}t.HandleConfirmReceiptFlow=HandleConfirmReceiptFlow},1461:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchDeliverExceptionFlow=void 0;const n=s(3897),a=s(2841),o=s(5493);class LaunchDeliverExceptionFlow extends o.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeCreator(),await this._recordMessage(),await this._forwardMessage()}async _intakeBroker(){this._broker=this._obtainTrackerBroker()}async _intakeCreator(){var e=this._content;e=new a.TrackerErrorMessageCreator(this._id,e.error,e.peerID);await this._expose(n.FlowKey.CREATOR,e)}async _recordMessage(){var e=this._require(n.FlowKey.CREATOR);this._logWarn("Log error message.",e.error.params,{error:e.error})}async _forwardMessage(){var e=this._require(n.FlowKey.CREATOR);await this._broker.commitMessage(e.buffer)}}t.LaunchDeliverExceptionFlow=LaunchDeliverExceptionFlow},9440:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchReportHealthFlow=void 0;const n=s(1744),a=s(3897),o=s(1693),c=s(1716),u=s(5493);class LaunchReportHealthFlow extends u.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeMessage(),await this._forwardMessage()}async _intakeBroker(){this._broker=this._obtainTrackerBroker()}async _intakeMessage(){var e={action:o.TrackerActionName.MESSAGE_REPORT_HEALTH,header:{source_peer_id:n.kernelSettings.client.peerID}};await this._expose(a.FlowKey.MESSAGE,e)}async _forwardMessage(){var e=this._require(a.FlowKey.MESSAGE);await this._broker.commitMessage(c.TrackerReportHealthMessage.encode(e).finish())}}t.LaunchReportHealthFlow=LaunchReportHealthFlow},7177:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchLeaveSwarmFlow=t.LaunchObtainSwarmUsersFlow=t.LaunchReportSwarmStatsFlow=t.LaunchJoinSwarmFlow=void 0;const n=s(1744),a=s(3897),o=s(1693),c=s(1716),u=s(6897),l=s(5493);class LaunchJoinSwarmFlow extends l.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeRequest(),await this._forwardRequest(),await this._verifyResponse()}async _intakeBroker(){this._broker=this._obtainTrackerBroker()}async _intakeRequest(){var e=this._content;e={action:o.TrackerActionName.REQUEST_JOIN_SWARM,header:{correlation_id:this._id,source_peer_id:n.kernelSettings.client.peerID},content:{swarm_id:e.swarmID,swarm_score:e.swarmScore}};await this._expose(a.FlowKey.REQUEST,e)}async _forwardRequest(){var e=this._require(a.FlowKey.REQUEST);await this._broker.commitMessage(c.TrackerJoinSwarmRequest.encode(e).finish())}async _verifyResponse(){var e=await this._broker.messageHub.extract(this._id,!0);await u.ErrorMessageDetector.throwIfError(e.buffer)}}t.LaunchJoinSwarmFlow=LaunchJoinSwarmFlow;class LaunchReportSwarmStatsFlow extends l.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeMessage(),await this._forwardMessage()}async _intakeBroker(){this._broker=this._obtainTrackerBroker()}async _intakeMessage(){var e=this._content;e={action:o.TrackerActionName.MESSAGE_REPORT_SWARM_STATS,header:{correlation_id:this._id,source_peer_id:n.kernelSettings.client.peerID},content:{swarm_id:e.swarmID,swarm_score:e.swarmScore}};await this._expose(a.FlowKey.MESSAGE,e)}async _forwardMessage(){var e=this._require(a.FlowKey.MESSAGE);await this._broker.commitMessage(c.TrackerReportSwarmStatsMessage.encode(e).finish())}}t.LaunchReportSwarmStatsFlow=LaunchReportSwarmStatsFlow;class LaunchObtainSwarmUsersFlow extends l.AbstractProcessFlow{async process(){return await this._intakeBroker(),await this._intakeRequest(),await this._forwardRequest(),await this._intakeResponse(),await this._intakeOutcome(),this._outcome}async _intakeBroker(){this._broker=this._obtainTrackerBroker()}async _intakeRequest(){var e=this._content;e={action:o.TrackerActionName.REQUEST_OBTAIN_SWARM_USERS,header:{correlation_id:this._id,source_peer_id:n.kernelSettings.client.peerID},content:{swarm_id:e.swarmID}};await this._expose(a.FlowKey.REQUEST,e)}async _forwardRequest(){var e=this._require(a.FlowKey.REQUEST);await this._broker.commitMessage(c.TrackerObtainSwarmUsersRequest.encode(e).finish())}async _intakeResponse(){var e=await this._broker.messageHub.extract(this._id,!0);await u.ErrorMessageDetector.throwIfError(e.buffer),e=c.TrackerObtainSwarmUsersResponse.decode(e.buffer);await this._expose(a.FlowKey.RESPONSE,e)}async _intakeOutcome(){var e=this._require(a.FlowKey.RESPONSE),t=new Array;for(const s of e.content.swarm_users)s[0]!==n.kernelSettings.client.peerID&&await t.push({peerID:s[0],swarmScore:s[1]});this._outcome={swarmUsers:t}}}t.LaunchObtainSwarmUsersFlow=LaunchObtainSwarmUsersFlow;class LaunchLeaveSwarmFlow extends l.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeMessage(),await this._forwardMessage()}async _intakeBroker(){this._broker=this._obtainTrackerBroker()}async _intakeMessage(){var e=this._content;e={action:o.TrackerActionName.MESSAGE_LEAVE_SWARM,header:{correlation_id:this._id,source_peer_id:n.kernelSettings.client.peerID},content:{swarm_id:e.swarmID}};await this._expose(a.FlowKey.MESSAGE,e)}async _forwardMessage(){var e=this._require(a.FlowKey.MESSAGE);await this._broker.commitMessage(c.TrackerLeaveSwarmMessage.encode(e).finish())}}t.LaunchLeaveSwarmFlow=LaunchLeaveSwarmFlow},1199:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HandleConnectUserFlow=t.LaunchConnectUserFlow=t.LaunchEnableUserFlow=void 0;const n=s(1744),a=s(3897),o=s(1693),c=s(1716),u=s(6897),l=s(5493);class LaunchEnableUserFlow extends l.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeRequest(),await this._forwardRequest(),await this._verifyResponse()}async _intakeBroker(){this._broker=this._obtainTrackerBroker()}async _intakeRequest(){var e={action:o.TrackerActionName.REQUEST_ENABLE_USER,header:{correlation_id:this._id,source_peer_id:n.kernelSettings.client.peerID}};await this._expose(a.FlowKey.REQUEST,e)}async _forwardRequest(){var e=this._require(a.FlowKey.REQUEST);await this._broker.commitMessage(c.TrackerEnableUserRequest.encode(e).finish())}async _verifyResponse(){var e=await this._broker.messageHub.extract(this._id,!0);await u.ErrorMessageDetector.throwIfError(e.buffer)}}t.LaunchEnableUserFlow=LaunchEnableUserFlow;class LaunchConnectUserFlow extends l.AbstractProcessFlow{async process(){return await this._intakeBroker(),await this._intakeRequest(),await this._forwardRequest(),await this._intakeResponse(),await this._intakeOutcome(),this._outcome}async _intakeBroker(){this._broker=this._obtainTrackerBroker()}async _intakeRequest(){var e=this._content;e={action:o.TrackerActionName.REQUEST_CONNECT_USER,header:{correlation_id:this._id,source_peer_id:n.kernelSettings.client.peerID},content:{peer_id:e.peerID,swarm_id:e.swarmID,sdp:e.offer.sdp,type:e.offer.type}};await this._expose(a.FlowKey.REQUEST,e)}async _forwardRequest(){var e=this._require(a.FlowKey.REQUEST);await this._broker.commitMessage(c.TrackerConnectUserRequest.encode(e).finish())}async _intakeResponse(){var e=await this._broker.messageHub.extract(this._id,!0);await u.ErrorMessageDetector.throwIfError(e.buffer),e=c.TrackerConnectUserResponse.decode(e.buffer);await this._expose(a.FlowKey.RESPONSE,e)}async _intakeOutcome(){var e=this._require(a.FlowKey.RESPONSE).content;this._outcome={peerID:e.peer_id,swarmID:e.swarm_id,sdp:e.sdp,type:e.type}}}t.LaunchConnectUserFlow=LaunchConnectUserFlow;class HandleConnectUserFlow extends l.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeRequest(),await this._forwardRequest()}async _intakeBroker(){this._broker=this._obtainTrackerBroker()}async _intakeRequest(){var e=this._content;e={action:o.TrackerActionName.RESPOND_CONNECT_USER,header:{correlation_id:this._id,source_peer_id:n.kernelSettings.client.peerID},content:{peer_id:e.peerID,swarm_id:e.swarmID,sdp:e.answer.sdp,type:e.answer.type}};await this._expose(a.FlowKey.REQUEST,e)}async _forwardRequest(){var e=this._require(a.FlowKey.REQUEST);await this._broker.commitMessage(c.TrackerConnectUserRequest.encode(e).finish())}}t.HandleConnectUserFlow=HandleConnectUserFlow},5405:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchDeliverIceCandidateFlow=void 0;const n=s(1744),a=s(3897),o=s(1693),c=s(1716),u=s(5493);class LaunchDeliverIceCandidateFlow extends u.AbstractProcessFlow{async process(){await this._intakeBroker(),await this._intakeMessage(),await this._forwardMessage()}async _intakeBroker(){this._broker=this._obtainTrackerBroker()}async _intakeMessage(){var e=this._content;e={action:o.TrackerActionName.MESSAGE_DELIVER_ICE_CANDIDATE,header:{correlation_id:this._id,source_peer_id:n.kernelSettings.client.peerID},content:{peer_id:e.peerID,swarm_id:e.swarmID,ice:e.ice}};await this._expose(a.FlowKey.MESSAGE,e)}async _forwardMessage(){var e=this._require(a.FlowKey.MESSAGE);await this._broker.commitMessage(c.TrackerDeliverIceCandidateMessage.encode(e).finish())}}t.LaunchDeliverIceCandidateFlow=LaunchDeliverIceCandidateFlow},7646:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerPipeName=void 0;const n=s(8979);class TrackerPipeName extends n.BaseTrackerPipeName{}(t.TrackerPipeName=TrackerPipeName).LAUNCH_ENABLE_USER="launch enable user",TrackerPipeName.LAUNCH_CONNECT_USER="launch connect user"},3589:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),a(s(6399),t),a(s(3480),t),a(s(1494),t),a(s(2246),t),a(s(4081),t)},6399:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HandleConfirmReceiptPipe=t.HandleNotifyExceptionPipe=void 0;const c=s(8024),u=o(s(2643));class HandleNotifyExceptionPipe extends c.AbstractProcessPipe{async process(){await this._notifyException()}async _notifyException(){await this._bypass(new u.HandleNotifyExceptionFlow({content:this._content}))}}t.HandleNotifyExceptionPipe=HandleNotifyExceptionPipe;class HandleConfirmReceiptPipe extends c.AbstractProcessPipe{async process(){await this._confirmReceipt()}async _confirmReceipt(){await this._bypass(new u.HandleConfirmReceiptFlow({content:this._content}))}}t.HandleConfirmReceiptPipe=HandleConfirmReceiptPipe},3480:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchDeliverExceptionPipe=void 0;const c=s(8024),u=o(s(2643));class LaunchDeliverExceptionPipe extends c.AbstractProcessPipe{async process(){await this._deliverException()}async _deliverException(){await this._bypass(new u.LaunchDeliverExceptionFlow({content:this._content}))}}t.LaunchDeliverExceptionPipe=LaunchDeliverExceptionPipe},1494:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchReportHealthPipe=void 0;const c=s(8024),u=o(s(2643));class LaunchReportHealthPipe extends c.AbstractProcessPipe{async process(){await this._reportHealth()}async _reportHealth(){await this._bypass(new u.LaunchReportHealthFlow)}}t.LaunchReportHealthPipe=LaunchReportHealthPipe},2246:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchEnableUserPipe=void 0;const c=s(8024),u=o(s(2643));class LaunchEnableUserPipe extends c.AbstractProcessPipe{async process(){await this._enableUser()}async _enableUser(){await this._bypass(new u.LaunchEnableUserFlow)}}t.LaunchEnableUserPipe=LaunchEnableUserPipe},4081:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HandleDeliverIceCandidatePipe=void 0;const c=s(8024),u=o(s(2724));class HandleDeliverIceCandidatePipe extends c.AbstractProcessPipe{async process(){await this._addIceCandidate()}async _addIceCandidate(){await this._bypass(new u.HandleDeliverIceCandidateFlow({content:this._content}))}}t.HandleDeliverIceCandidatePipe=HandleDeliverIceCandidatePipe},1781:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerDaemon=void 0;const n=s(7926),a=s(5227),o=s(4808),c=s(4865),u=s(5856),l=s(1970),d=s(7646);class TrackerDaemon extends u.AbstractTrackerDaemon{constructor(){super(),this._initialize()}_initialize(){this._agent=new l.TrackerAgent,this._broker=new o.TrackerBroker(this._makeURI())}async _activate(){await this._broker.activate(),await this._taskManager.activate(),await this._storePool(),await this._buildTasks()}async _deactivate(){await this._broker.deactivate(),await this._taskManager.deactivate(),await this._feedbacks.close(),await this._clearPool()}async _storePool(){await c.trackerBrokerPool.register(n.BrokerID.TRACKER,this._broker)}async _clearPool(){await c.trackerBrokerPool.deregister(n.BrokerID.TRACKER)}async _buildTasks(){await this._buildWaitToStartTask(),await this._buildListenStateEventTask(),await this._buildListenConnectingEventTask(),await this._buildListenConnectedEventTask(),await this._buildListenDisconnectedEventTask(),await this._buildListenTerminatedEventTask(),await this._buildListenSubscribingEventTask(),await this._buildListenSubscribedEventTask(),await this._buildListenUnsubscribedEventTask(),await this._buildListenJoinEventTask(),await this._buildListenLeaveEventTask(),await this._buildListenServerDataEventTask(),await this._buildListenSpreadDataEventTask(),await this._buildListenMessageEventTask(),await this._buildListenErrorEventTask(),await this._buildDeliverMessageTask(),await this._buildReceiveMessageTask(),await this._buildProcessMessageTask(),await this._buildEnablePeerTask(),await this._buildReportHealthTask(),await this._buildExitProcessTask()}async _buildEnablePeerTask(){await this._taskManager.createCommonTask({name:u.TrackerDaemonTaskName.ENABLE_PEER,callee:async()=>{await this._execEnablePeerTaskCallee()},onFinish:async()=>{await this._execEnablePeerTaskOnFinish()},pretasks:[this._taskManager.cueTask(u.TrackerDaemonTaskName.WAIT_TO_START)],runningTimeout:5})}async _execEnablePeerTaskCallee(){await this._agent.operate({name:d.TrackerPipeName.LAUNCH_ENABLE_USER})}async _execEnablePeerTaskOnFinish(){await this._broker.condition.pass(),await this._recordEnabled(),await this.emit(u.TrackerDaemonEvent.CONNECTED)}async _recordEnabled(){await a.MetricsCollectorHolder.emit(a.MetricsCollectorEvent.TRACKER_STATE_RECORD,{peerID:this._broker.info.peerID,isAvailable:!0})}async _recordDisabled(){await a.MetricsCollectorHolder.emit(a.MetricsCollectorEvent.TRACKER_STATE_RECORD,{peerID:null,isAvailable:!1})}}t.TrackerDaemon=TrackerDaemon},7148:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerFeedbackAgent=void 0;const c=s(1693),u=s(6719),l=s(3048),d=o(s(5498));class TrackerFeedbackAgent extends u.AbstractFeedbackAgent{get _pipeNames(){return TrackerFeedbackAgent.PIPE_NAMES}get _pipeClasses(){return TrackerFeedbackAgent.PIPE_CLASSES}}(t.TrackerFeedbackAgent=TrackerFeedbackAgent).PIPE_NAMES=new Map([[c.TrackerActionName.REQUEST_CONNECT_USER,l.TrackerFeedbackPipeName.HANDLE_CONNECT_USER]]),TrackerFeedbackAgent.PIPE_CLASSES=new Map([[l.TrackerFeedbackPipeName.HANDLE_CONNECT_USER,d.HandleConnectUserPipe],[l.TrackerFeedbackPipeName.LAUNCH_DELIVER_EXCEPTION,d.LaunchDeliverExceptionPipe]])},6719:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractFeedbackAgent=void 0;t.AbstractFeedbackAgent=class AbstractFeedbackAgent{async operate(e){return new(this._pipeClasses.get(e.name))(null!=(e=e.data)?e:{}).process()}findPipeName(e){return this._pipeNames.get(e)}}},556:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractFeedbackFlow=void 0;const n=s(3267);class AbstractFeedbackFlow extends n.AbstractFlow{constructor(e){super(e)}}t.AbstractFeedbackFlow=AbstractFeedbackFlow},4904:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractFeedbackPipe=void 0;const n=s(556);class AbstractFeedbackPipe extends n.AbstractFeedbackFlow{constructor(e){super(e)}}t.AbstractFeedbackPipe=AbstractFeedbackPipe},3108:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),a(s(431),t),a(s(3859),t)},431:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchDeliverExceptionFlow=void 0;const c=o(s(3589)),u=s(556);class LaunchDeliverExceptionFlow extends u.AbstractFeedbackFlow{async process(){await this._deliverException()}async _deliverException(){await this._bypass(new c.LaunchDeliverExceptionPipe({content:this._content}))}}t.LaunchDeliverExceptionFlow=LaunchDeliverExceptionFlow},3859:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HandleConnectUserFlow=void 0;const n=s(2016),a=s(7464),o=s(3897),c=s(1716),u=s(5754),l=s(8144),d=s(556);class HandleConnectUserFlow extends d.AbstractFeedbackFlow{async process(){await this._intakeRequest(),await this._connectUser()}async _intakeRequest(){var e=this._content;e=c.TrackerConnectUserRequest.decode(e.buffer);await this._expose(o.FlowKey.REQUEST,e)}async _connectUser(){var e=this._require(o.FlowKey.REQUEST).content,t=e.swarm_id,s=l.swarmDaemonPool.retrieve(t);if(!s)throw new n.InternalError(a.MessageCode.ESS010,void 0,{swarmID:t});await s.command({id:this._id,name:u.SwarmProcessPipeName.LAUNCH_CONNECT_SWARM_USER,content:{info:s.info,peerID:e.peer_id,swarmID:e.swarm_id,offer:{sdp:e.sdp,type:e.type}}})}}t.HandleConnectUserFlow=HandleConnectUserFlow},3048:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerFeedbackPipeName=void 0;class TrackerFeedbackPipeName{}(t.TrackerFeedbackPipeName=TrackerFeedbackPipeName).HANDLE_CONNECT_USER="handle connect user",TrackerFeedbackPipeName.LAUNCH_DELIVER_EXCEPTION="launch deliver exception"},5498:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),a(s(5985),t),a(s(1221),t)},5985:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchDeliverExceptionPipe=void 0;const c=s(4904),u=o(s(3108));class LaunchDeliverExceptionPipe extends c.AbstractFeedbackPipe{async process(){await this._deliverException()}async _deliverException(){await this._bypass(new u.LaunchDeliverExceptionFlow({content:this._content}))}}t.LaunchDeliverExceptionPipe=LaunchDeliverExceptionPipe},1221:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HandleConnectUserPipe=void 0;const c=s(4904),u=o(s(3108));class HandleConnectUserPipe extends c.AbstractFeedbackPipe{async process(){await this._connectUser()}async _connectUser(){await this._bypass(new u.HandleConnectUserFlow({content:this._content}))}}t.HandleConnectUserPipe=HandleConnectUserPipe},6187:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerLauncherTaskName=t.TrackerLauncherEvent=t.AbstractTrackerLauncher=void 0;const n=s(2016),a=s(7464),o=s(49),c=s(3048);class AbstractTrackerLauncher extends o.AbstractLauncher{async _buildProcessFeedbackTask(){await this._taskManager.createCyclicTask({name:TrackerLauncherTaskName.PROCESS_FEEDBACK,callee:async()=>{await this._execProcessFeedbackTaskCallee()},sleepSeconds:0,maxErrorRetry:-1,maxTotalRetry:-1})}async _execProcessFeedbackTaskCallee(){var e,t=await this._daemon.feedback(),s=t.content,o=s.payload,u=this._agent.findPipeName(o.action);if(!u)throw new n.InternalError(a.MessageCode.ESS022,void 0,{feedback:t});try{await this._agent.operate({name:u,data:{id:null==(e=o.header)?void 0:e.correlation_id,content:s}})}catch(e){if(null==(t=o.header)||!t.source_peer_id)throw e;await this._agent.operate({name:c.TrackerFeedbackPipeName.LAUNCH_DELIVER_EXCEPTION,data:{id:o.header.correlation_id,content:{peerID:o.header.source_peer_id,error:e}}})}}}t.AbstractTrackerLauncher=AbstractTrackerLauncher;(t.TrackerLauncherEvent=class TrackerLauncherEvent{}).CONNECTED="connected";class TrackerLauncherTaskName{}(t.TrackerLauncherTaskName=TrackerLauncherTaskName).PROCESS_FEEDBACK="tracker launcher: process feedback"},8696:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerLauncher=void 0;const n=s(7097),a=s(5856),o=s(1781),c=s(7148),u=s(6187);class TrackerLauncher extends u.AbstractTrackerLauncher{constructor(){super(),this._initialize()}_initialize(){this._agent=new c.TrackerFeedbackAgent}async _activate(){this._daemon=new o.TrackerDaemon,await this._daemon.activate(),await this._taskManager.activate(),await this._bindEvents(),await this._buildTasks()}async _deactivate(){var e;await(null==(e=this._daemon)?void 0:e.clearListeners()),await(null==(e=this._daemon)?void 0:e.deactivate()),await this._taskManager.purgeTasks(),this._daemon=null}async _reactivate(){await this._deactivate(),await this._activate()}async _bindEvents(){await this._daemon.on(a.TrackerDaemonEvent.CONNECTED,(async()=>{await this._onConnected()})),await this._daemon.on(a.TrackerDaemonEvent.DISCONNECTED,(async()=>{await this._onDisconnected()}))}async _buildTasks(){await this._buildProcessFeedbackTask()}async _onConnected(){await this._backoff.reset(),await this.emit(u.TrackerLauncherEvent.CONNECTED)}async _onDisconnected(){await this._backoff.apply((async()=>{await this._reactivate(),await n.SwarmManagerHolder.recharge()}))}}t.TrackerLauncher=TrackerLauncher},6785:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilerConstant=void 0;(t.FilerConstant=class FilerConstant{}).MAX_USER_DOWNLOADER_RETRY=3},9348:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilerProvider=void 0;const n=s(1615),a=s(9771);class FilerProvider extends n.AbstractFilerProvider{async _activate(){await this._loadFileSeeker()}async _loadFileSeeker(){var e=new a.FileSeeker;await e.activate(),a.FileSeekerHolder.instance=e}async _deactivate(){await this._unloadFileSeeker()}async _unloadFileSeeker(){var e=a.FileSeekerHolder.instance;await(null==e?void 0:e.deactivate()),a.FileSeekerHolder.instance=null}}t.FilerProvider=FilerProvider},6592:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileDownloader=void 0;const n=s(287),a=s(3267),o=s(5610),c=s(5754),u=s(8144),l=s(4815);class FileDownloader extends o.AbstractFileDownloader{constructor(e){super(e),this._resource=e,this._initialize()}_initialize(){this._proxyAgent=new l.DownloaderAgent}async _fetching(){await super._fetching().finally((async()=>{var e=u.swarmDaemonPool.retrieve(this._resource.swarmID);e&&this._resource.isShareable&&e.command({id:a.FlowID.make(),name:c.SwarmProcessPipeName.LAUNCH_REPORT_RESOURCE_STAT,content:{info:e.info,resourceID:this._resource.id}}).catch((async e=>{var t=this._resource;await n.Logger.debug("Report resource stat failed.",{resource:t},{error:e})}))}))}}t.FileDownloader=FileDownloader},4815:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DownloaderProxyName=t.DownloaderAgent=void 0;const n=s(8240),a=s(1135),o=s(2016),c=s(287),u=s(1139),l=s(9283),d=s(3267),h=s(1744),_=s(7464),p=s(7926),f=s(2060),m=s(5309),y=s(4417),w=s(4916),g=s(3726),v=s(7431),E=s(8144),T=s(6785);class DownloaderProxyName extends y.BaseDownloaderProxyName{}(t.DownloaderProxyName=DownloaderProxyName).MCDN="mcdn",DownloaderProxyName.NODE="node",DownloaderProxyName.USER="user";class NodeDownloaderProxy extends y.AbstractDownloaderProxy{constructor(e){super(e),this._resource=e,this._noProgressCounter=new l.Counter,this._backoff=new a.DelayBackoff({delayerClass:a.LinearDelayer,delayerOptions:{baseInterval:.1,multiplier:.3,maxInterval:1}})}async _setup(){await this._resetStates(),await this._fetchDaemon()}async _resetStates(){this._startSize=this._resource.size}async _fetchDaemon(){if(this._daemon=v.peerDaemonPool.retrieve(p.DaemonID.NODE),!this._daemon.broker.isAvailable)throw new o.InternalError(_.MessageCode.ESC020)}async _fetching(){await this._backoff.apply((async()=>{await this._startCommand(),await this._checkProgress()}))}async _startCommand(){await this._daemon.command({id:d.FlowID.make(),name:g.NodePipeName.LAUNCH_OBTAIN_RESOURCE,content:this._resource}).catch((async e=>{var t=this._resource;await c.Logger.debug("Node downloader proxy fetch failed.",{resource:t},{error:e})}))}async _checkProgress(){if(this._isNoProgress?this._noProgressCounter.up():this._noProgressCounter.reset(),this._isToleranceReached)throw new o.InternalError(_.MessageCode.ESC021);this._canAccelerateFetchSpeed&&await this._backoff.reset()}get _increment(){return this._resource.size-this._startSize}get _isNoProgress(){return 0===this._increment}get _isToleranceReached(){return this._noProgressCounter.hasCountedUpTo(NodeDownloaderProxy.NO_PROGRESS_TOLERANCE)}get _canAccelerateFetchSpeed(){return this._increment>=f.WebRTCConstant.DATACHANNEL_CHUNK_SIZE}async _abort(){}}NodeDownloaderProxy.NO_PROGRESS_TOLERANCE=5;class UserDownloaderProxy extends y.AbstractDownloaderProxy{constructor(e){super(e),this._resource=e,this._randomNumber=Math.random(),this._noQueueCounter=new l.Counter,this._buildPossibility()}_buildPossibility(){var e=this._resource.priority;e=w.MathFunction.upwardExponentialCurve(e,.92103);this._possibility=e*h.kernelSettings.download.maxP2PPossibility}async _setup(){await this._resetStates(),await this._checkStates(),await this._ensureDaemon()}async _resetStates(){this._startSize=this._resource.size}async _checkStates(){if(!this._resource.isShareable)throw new o.InternalError(_.MessageCode.ESC030);if(this._isUrgentResource)throw new o.InternalError(_.MessageCode.ESC031);if(this._isNotChosenThisTime)throw new o.InternalError(_.MessageCode.ESC032)}get _isUrgentResource(){return this._resource.priority<f.ResourceConstant.URGENT_THRESHOLD_PRIORITY}get _isNotChosenThisTime(){return this._randomNumber>this._possibility}async _ensureDaemon(){this._daemon||(await this._ensureQueue(),await this._fetchDaemon())}async _ensureQueue(){this._shouldMakeQueue&&(await this._checkTolerance(),await this._buildDaemonQueue(),await this._checkDaemonQueue())}get _shouldMakeQueue(){return!this._daemons||this._isQueueEmpty}get _isQueueEmpty(){return 0===this._daemons.size}async _checkTolerance(){if(this._isToleranceReached)throw new o.InternalError(_.MessageCode.ESC034)}get _isToleranceReached(){return this._noQueueCounter.hasCountedUpTo(T.FilerConstant.MAX_USER_DOWNLOADER_RETRY)}async _buildDaemonQueue(){var e=this._resource.swarmID,t=(e=E.swarmDaemonPool.retrieve(e),new Array);for(const n of e.info.userManager.keys){var s=v.peerDaemonPool.retrieve(n);s&&this._isAvailableDaemon(s)&&await t.push(s)}this._daemons=u.Queue.from(n.RandomTool.shuffle(t)),await this._noQueueCounter.up()}_isAvailableDaemon(e){return null!=(e=e.broker.info.resourceStats.get(this._resource.id))&&0<e}async _checkDaemonQueue(){if(this._isQueueEmpty)throw new o.InternalError(_.MessageCode.ESC033)}async _fetchDaemon(){this._daemon=this._daemons.pull()}async _fetching(){await this._startCommand(),await this._checkProgress()}async _startCommand(){await this._daemon.command({id:d.FlowID.make(),name:g.UserPipeName.LAUNCH_OBTAIN_RESOURCE,content:this._resource}).catch((async e=>{var t=this._resource;await c.Logger.debug("User downloader proxy fetch failed.",{resource:t},{error:e})}))}async _checkProgress(){this._isLowProgress?this._daemon=null:this._noQueueCounter.reset()}get _increment(){return this._resource.size-this._startSize}get _isLowProgress(){return this._increment<f.WebRTCConstant.DATACHANNEL_CHUNK_SIZE}async _abort(){}}class DownloaderAgent extends y.AbstractDownloaderAgent{get _proxyNames(){var e=h.kernelSettings.system.mode;return DownloaderAgent.PROXY_NAMES.get(e)}get _proxyClasses(){return DownloaderAgent.PROXY_CLASSES}}(t.DownloaderAgent=DownloaderAgent).PROXY_NAMES=new Map([[m.SystemModeName.MCDN_ONLY,[DownloaderProxyName.MCDN]],[m.SystemModeName.P2P_MCDN,[DownloaderProxyName.USER,DownloaderProxyName.MCDN]],[m.SystemModeName.P2P_P2S,[DownloaderProxyName.USER,DownloaderProxyName.NODE]],[m.SystemModeName.P2S_ONLY,[DownloaderProxyName.NODE]]]),DownloaderAgent.PROXY_CLASSES=new Map([[DownloaderProxyName.MCDN,y.MCDNDownloaderProxy],[DownloaderProxyName.NODE,NodeDownloaderProxy],[DownloaderProxyName.USER,UserDownloaderProxy]])},9771:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileSeekerHolder=t.FileSeeker=void 0;const n=s(3977),a=s(1442),o=s(6592);class FileSeeker extends n.AbstractFileSeeker{constructor(){super(),this._initialize()}_initialize(){this._requester=new FileRequester,this._resourceCache=a.resourceCache}async _activate(){await this._requester.activate()}async _deactivate(){await this._requester.deactivate()}}t.FileSeeker=FileSeeker;class FileRequester extends n.AbstractFileRequester{async _activate(){await this._taskManager.activate(),await this._buildTasks()}async _deactivate(){await this._taskManager.purgeTasks(),await this._requestPool.clear()}async _buildTasks(){await this._buildClearRequestTask()}async _buildObtainResourceTask(e){return await this._taskManager.createCommonTask(new ObtainResourceDuty({name:n.FileRequesterTaskName.OBTAIN_RESOURCE,content:e}))}}class ObtainResourceDuty extends n.AbstractObtainResourceDuty{constructor(e){super(e),this._options=e,this._initialize()}_initialize(){this._downloader=new o.FileDownloader(this._options.content)}}t.FileSeekerHolder=class FileSeekerHolder{static get instance(){return this._instance}static set instance(e){this._instance=e}static async fetch(e){return this._instance.fetch(e)}static async prefetch(e){return this._instance.prefetch(e)}static async cache(e){return this._instance.cache(e)}static async abort(e){var t;await(null==(t=this._instance)?void 0:t.abort(e))}}},7932:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractSystemBooter=void 0;const n=s(4944),a=s(1744),o=s(8327);t.AbstractSystemBooter=class AbstractSystemBooter{constructor(){this._state=new BooterState,this._condition=new n.Condition,this._componentPool=new Map,this._componentNames=new Array}get state(){return this._state}get pool(){return this._componentPool}set pool(e){this._componentPool=e}get names(){return this._componentNames}set names(e){this._componentNames=e}async available(){await this._condition.done()}async activate(){await this._activate()}async _activate(){await this._state.toBooting(),await this._launch().then((async()=>{await this._state.toRunning(),await this._condition.pass()})).catch((async e=>{throw await this._state.toFailed(),await this._condition.deny(e),e}))}async _launch(){await this._initializeSystem(),await this._buildComponentNames(),await this._buildComponentPool()}async _initializeSystem(){var e=new(this._componentAgent.findMeta(o.BaseComponentName.SYSTEM).constructor);await e.activate(),await this._componentPool.set(o.BaseComponentName.SYSTEM,e)}async _buildComponentNames(){this._componentNames=this._makeComponentNames()}_makeComponentNames(){var e=a.kernelSettings.system.mode;e=[...new Set(this._componentAgent.findBundle(e).flat())];return this._sortComponentNames(e),e}_sortComponentNames(e){const t=this._makeComponentWeights(e);e.sort(((e,s)=>t.get(s)-t.get(e)))}_makeComponentWeights(e){var t=new Map(e.map((e=>[e,0])));return this._countComponentWeights(e,t),t}_countComponentWeights(e,t){for(const s of e)t.has(s)&&t.set(s,t.get(s)+1),this._countComponentWeights(this._componentAgent.findMeta(s).dependencies,t)}async _buildComponentPool(){var e;for(const t of this._componentNames)this._componentPool.has(t)||(await(e=new(this._componentAgent.findMeta(t).constructor)).activate(),await this._componentPool.set(t,e))}async deactivate(){await this._deactivate()}async _deactivate(){await this._state.toClosed(),await this._condition.reset(),await this._deactivateComponents(),this._componentPool=new Map,this._componentNames=[]}async _deactivateComponents(){var e=this._componentNames;for(let s=e.length-1;0<=s;s--){var t=this._componentPool.get(e[s]);t&&await t.deactivate()}}};class BooterState{constructor(){this._name=BooterStateName.INITIAL}get isInitial(){return this._name===BooterStateName.INITIAL}get isBooting(){return this._name===BooterStateName.BOOTING}get isRunning(){return this._name===BooterStateName.RUNNING}get isFailed(){return this._name===BooterStateName.FAILED}get isClosed(){return this._name===BooterStateName.CLOSED}get isCeased(){return this.isFailed||this.isClosed}toInitial(){this._name=BooterStateName.INITIAL}toBooting(){this._name=BooterStateName.BOOTING}toRunning(){this._name=BooterStateName.RUNNING}toFailed(){this._name=BooterStateName.FAILED}toClosed(){this._name=BooterStateName.CLOSED}}class BooterStateName{}BooterStateName.INITIAL="initial",BooterStateName.BOOTING="booting",BooterStateName.RUNNING="running",BooterStateName.FAILED="failed",BooterStateName.CLOSED="closed"},3970:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractComponentAgent=t.AbstractComponent=void 0;const a=n(s(148)),o=s(2016),c=s(7464);class AbstractComponent extends a.default{constructor(){super(...arguments),this._isActivated=!1}get isActivated(){return this._isActivated}async activate(){await this._activate()}async _activate(){this._isActivated=!0,await this._create().catch((async e=>{var t=this.toString();throw new o.InternalError(c.MessageCode.ESB000,e,{component:t})}))}async deactivate(){await this._deactivate()}async _deactivate(){await this._destroy()}async reactivate(){await this._reactivate()}async _reactivate(){await this._deactivate(),await this._activate()}toString(){return`<${this.constructor.name}>`}}t.AbstractComponent=AbstractComponent;t.AbstractComponentAgent=class AbstractComponentAgent{findMeta(e){return this._metas.get(e)}findBundle(e){return this._modeBundles.get(e)}}},8327:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponentBundle=t.BaseComponentName=void 0;class BaseComponentName{}(t.BaseComponentName=BaseComponentName).SYSTEM="system",BaseComponentName.METRICS="metrics",BaseComponentName.REPORT="report",BaseComponentName.FILER="filer";(t.BaseComponentBundle=class BaseComponentBundle{}).REQUIRED=[BaseComponentName.SYSTEM,BaseComponentName.METRICS,BaseComponentName.REPORT,BaseComponentName.FILER]},8055:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SystemBooterHolder=t.SystemBooter=void 0;const n=s(7932),a=s(7226);class SystemBooter extends n.AbstractSystemBooter{constructor(){super(),this._initialize()}_initialize(){this._componentAgent=new a.ComponentAgent}}t.SystemBooter=SystemBooter;(t.SystemBooterHolder=class SystemBooterHolder{static get instance(){return this._instance}static get state(){return this._instance.state}static async available(){await this._instance.available()}})._instance=new SystemBooter},7226:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentAgent=t.SwarmComponent=t.NodeComponent=t.TrackerComponent=t.MCDNComponent=t.FilerComponent=t.MetricsComponent=t.SystemComponent=void 0;const n=s(9612),a=s(5309),o=s(7237),c=s(3337),u=s(7937),l=s(3003),d=s(4203),h=s(8696),_=s(9348),p=s(3970),f=s(8290),m=s(6721);class SystemComponent extends p.AbstractComponent{constructor(){super(),this._initialize()}_initialize(){n.API.host=new n.HostRequester}async _create(){await f.SystemInitializer.process()}async _destroy(){await f.SystemDeinitializer.process()}}t.SystemComponent=SystemComponent;class MetricsComponent extends p.AbstractComponent{constructor(){super(),this._initialize()}_initialize(){this._provider=new o.MetricsProvider}async _create(){await this._provider.activate()}async _destroy(){await this._provider.deactivate()}}t.MetricsComponent=MetricsComponent;class ReportComponent extends p.AbstractComponent{constructor(){super(),this._initialize()}_initialize(){this._provider=new c.ReportProvider}async _create(){await this._provider.activate()}async _destroy(){await this._provider.deactivate()}}class FilerComponent extends p.AbstractComponent{constructor(){super(),this._initialize()}_initialize(){this._provider=new _.FilerProvider}async _create(){await this._provider.activate()}async _destroy(){await this._provider.deactivate()}}t.FilerComponent=FilerComponent;class MCDNComponent extends p.AbstractComponent{constructor(){super(),this._initialize()}_initialize(){this._provider=new u.MCDNProvider}async _create(){await this._provider.activate()}async _destroy(){await this._provider.deactivate()}}t.MCDNComponent=MCDNComponent;class TrackerComponent extends p.AbstractComponent{constructor(){super(),this._initialize()}_initialize(){this._launcher=new h.TrackerLauncher}async _create(){await this._launcher.activate()}async _destroy(){await this._launcher.deactivate()}}t.TrackerComponent=TrackerComponent;class NodeComponent extends p.AbstractComponent{constructor(){super(),this._initialize()}_initialize(){this._launcher=new l.NodeLauncher}async _create(){await this._launcher.activate()}async _destroy(){await this._launcher.deactivate()}}t.NodeComponent=NodeComponent;class SwarmComponent extends p.AbstractComponent{constructor(){super(),this._initialize()}_initialize(){this._provider=new d.SwarmProvider}async _create(){await this._provider.activate()}async _destroy(){await this._provider.deactivate()}}t.SwarmComponent=SwarmComponent;class ComponentAgent extends p.AbstractComponentAgent{get _metas(){return ComponentAgent.METAS}get _modeBundles(){return ComponentAgent.MODE_BUNDLE}}(t.ComponentAgent=ComponentAgent).METAS=new Map([[m.ComponentName.SYSTEM,{constructor:SystemComponent,dependencies:[]}],[m.ComponentName.METRICS,{constructor:MetricsComponent,dependencies:[m.ComponentName.SYSTEM]}],[m.ComponentName.REPORT,{constructor:ReportComponent,dependencies:[m.ComponentName.SYSTEM]}],[m.ComponentName.FILER,{constructor:FilerComponent,dependencies:[m.ComponentName.SYSTEM,m.ComponentName.MCDN,m.ComponentName.NODE,m.ComponentName.SWARM]}],[m.ComponentName.MCDN,{constructor:MCDNComponent,dependencies:[m.ComponentName.SYSTEM,m.ComponentName.METRICS,m.ComponentName.REPORT]}],[m.ComponentName.TRACKER,{constructor:TrackerComponent,dependencies:[m.ComponentName.SYSTEM,m.ComponentName.METRICS]}],[m.ComponentName.NODE,{constructor:NodeComponent,dependencies:[m.ComponentName.SYSTEM,m.ComponentName.TRACKER,m.ComponentName.METRICS]}],[m.ComponentName.SWARM,{constructor:SwarmComponent,dependencies:[m.ComponentName.SYSTEM,m.ComponentName.TRACKER,m.ComponentName.METRICS]}]]),ComponentAgent.MODE_BUNDLE=new Map([[a.SystemModeName.MCDN_ONLY,[m.ComponentBundle.REQUIRED,m.ComponentBundle.MCDN]],[a.SystemModeName.P2P_MCDN,[m.ComponentBundle.REQUIRED,m.ComponentBundle.MCDN,m.ComponentBundle.P2P]],[a.SystemModeName.P2P_P2S,[m.ComponentBundle.REQUIRED,m.ComponentBundle.P2P,m.ComponentBundle.P2S]],[a.SystemModeName.P2S_ONLY,[m.ComponentBundle.REQUIRED,m.ComponentBundle.P2S]]])},8290:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var a=Object.getOwnPropertyDescriptor(t,s);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,a)}:function(e,t,s,n){e[n=void 0===n?s:n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.SystemDeinitializer=t.SystemInitializer=void 0;const c=s(3267),u=o(s(9991)),l=s(9612),d=s(1744),h=s(3897),_=s(5309);class SystemInitializer extends c.AbstractFlow{async process(){await this._updateServerHosts(),await this._createAPIRequester(),await this._updateClientToken(),await this._updateSystemConfig()}async _updateServerHosts(){await UpdateServerHostsHandler.process()}async _createAPIRequester(){l.API.token=new l.TokenRequester,l.API.cdnScore=new l.CDNScoreRequester,l.API.metering=new l.MeteringRequester}async _updateClientToken(){await UpdateClientTokenHandler.process()}async _updateSystemConfig(){await UpdateSystemConfigHandler.process()}static async process(){await(new SystemInitializer).process()}}t.SystemInitializer=SystemInitializer;class UpdateServerHostsHandler extends c.AbstractFlow{async process(){await this._intakeResult(),await this._updateSettings()}async _intakeResult(){var e=await u.HostAPIReadHostsHandler.process();await this._expose(h.FlowKey.RESULT,e)}async _updateSettings(){var e=this._require(h.FlowKey.RESULT);d.kernelSettings.server.token.fqdn=e.token,d.kernelSettings.server.cdnScore.fqdn=e.cdnScore,d.kernelSettings.server.metering.fqdn=e.metering,d.kernelSettings.server.tracker.fqdns=e.tracker}static async process(){await(new UpdateServerHostsHandler).process()}}class UpdateClientTokenHandler extends c.AbstractFlow{async process(){await this._intakeResult(),await this._updateSettings()}async _intakeResult(){var e=await u.TokenAPIReadTokenHandler.process();await this._expose(h.FlowKey.RESULT,e)}async _updateSettings(){var e=this._require(h.FlowKey.RESULT);d.kernelSettings.client.token=e.token,d.kernelSettings.client.peerID=e.peerID}static async process(){await(new UpdateClientTokenHandler).process()}}class UpdateSystemConfigHandler extends c.AbstractFlow{async process(){await this._updateP2PMode()}async _updateP2PMode(){var e;d.kernelSettings.system.isP2PAllowed||(e=_.systemP2PFallbackModes.get(d.kernelSettings.system.mode),d.kernelSettings.system.mode=null!=e?e:d.kernelSettings.system.mode)}static async process(){await(new UpdateSystemConfigHandler).process()}}class SystemDeinitializer extends c.AbstractFlow{async process(){await this._resetAPIRequester()}async _resetAPIRequester(){l.API.token=null,l.API.cdnScore=null,l.API.metering=null}static async process(){await(new SystemDeinitializer).process()}}t.SystemDeinitializer=SystemDeinitializer},6721:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentBundle=t.ComponentName=void 0;const n=s(8327);class ComponentName extends n.BaseComponentName{}(t.ComponentName=ComponentName).MCDN="mcdn",ComponentName.TRACKER="tracker",ComponentName.NODE="node",ComponentName.SWARM="swarm";class ComponentBundle extends n.BaseComponentBundle{}(t.ComponentBundle=ComponentBundle).MCDN=[ComponentName.MCDN],ComponentBundle.P2P=[ComponentName.TRACKER,ComponentName.SWARM],ComponentBundle.P2S=[ComponentName.TRACKER,ComponentName.NODE]},5419:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KernelValidator=t.KernelConfigurator=void 0;const a=n(s(6486)),o=s(8754),c=s(6940),u=s(93),l=s(2016),d=s(287),h=s(1744),_=s(7464);class KernelConfigurator{constructor(e){this._options=e}config(){this._mergeOptions(),this._updateLogger(),this._updateClient(),this._updateMonitor()}_mergeOptions(){a.default.merge(h.kernelSettings,this._options)}_updateLogger(){this._updateLoggerLevel()}_updateLoggerLevel(){var e=h.kernelSettings.logger.level;d.Logger.displayLevel=d.LogLevelName[e.toUpperCase()]}_updateClient(){this._updateClientOrigin(),this._updateClientSessionID()}_updateClientOrigin(){void 0===h.kernelSettings.client.origin&&(h.kernelSettings.client.origin=""!==self.location.host?self.location.origin:null)}_updateClientSessionID(){void 0===h.kernelSettings.client.sessionID&&(h.kernelSettings.client.sessionID=SessionID.make())}_updateMonitor(){var e;null!=(null==(e=null==(e=this._options)?void 0:e.monitor)?void 0:e.muxSampleRate)&&(h.kernelSettings.monitor.isMuxEnabled=Math.random()<h.kernelSettings.monitor.muxSampleRate)}static config(e){new KernelConfigurator(e).config()}}t.KernelConfigurator=KernelConfigurator;class SessionID{static make(){return`session-${u.TimeTool.makeNowFstring(this.TIME_PART_FORMAT)}-`+c.ByteTool.makeRandomBase36String(this.RANDOM_PART_LENGTH).toLowerCase()}}SessionID.TIME_PART_FORMAT="YYYYMMDDHHmmss",SessionID.RANDOM_PART_LENGTH=20;class KernelValidator{constructor(e){this._options=e,this._schema=o.z.object({logger:o.z.object({level:o.z.enum(Object.keys(d.LogLevelName))}).strict(),server:o.z.object({host:o.z.object({fqdn:o.z.string().regex(/^(?:[0-9a-z](?:[0-9a-z-]{0,61}[0-9a-z])?\.)+[0-9a-z][0-9a-z-]{0,61}[0-9a-z]$/)}).strict()}).strict(),system:o.z.object({isP2PAllowed:o.z.boolean()}).strict(),stream:o.z.object({maxBufferSize:o.z.number().int().min(0),minBufferTime:o.z.number().min(0),maxBufferTime:o.z.number().min(0)}).strict(),swproxy:o.z.object({scriptPath:o.z.string().regex(/^(?:\/|\.\/|(?:\.\.\/)+)?(?:\.?[\w-]+\/)*\.?(?:[\w-]+\.)*[\w-]+$/),scriptScope:o.z.string().regex(/^(?=\S+)(?:\/|\.\/|(?:\.\.\/)+)?(?:\.?[\w-]+\/)*(?:\.?[\w-]+\/?)?$/)}).strict(),monitor:o.z.object({muxSampleRate:o.z.number().min(0).max(1)}).strict(),download:o.z.object({maxCacheItems:o.z.number().int().min(0),maxP2PPossibility:o.z.number().min(0).max(1),httpResponseTimeout:o.z.number().min(0)}).strict()}).strict().deepPartial().optional()}verify(){try{this._verify()}catch(e){throw d.Logger.error("Kernel options verify failed.",void 0,{error:e}),e}}_verify(){try{this._schema.parse(this._options)}catch(e){throw new l.ValidationError(_.MessageCode.WSB010,e)}}static verify(e){new KernelValidator(e).verify()}}t.KernelValidator=KernelValidator},4239:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageCodeObject=t.MessageCode=t.StatusCodes=void 0;const n=s(5519);Object.defineProperty(t,"StatusCodes",{enumerable:!0,get:function(){return n.StatusCodes}});class MessageCodeObject{constructor(e,t,s,n,a){this._statusCode=e,this._logCode=t,this._metaCode=s,this._metaContent=n,this._logContent=a,this._initialize()}get statusCode(){return this._statusCode}get logCode(){return this._logCode}get logContent(){return`(${this._logCode}) `+this._logContent}get metaCode(){return parseInt(""+MessageCodeObject._metaCodePrefix+this._metaCode,10)}get metaStatus(){return this._statusCode<n.StatusCodes.BAD_REQUEST}get metaContent(){return this._metaContent}_initialize(){this._checkStatusCode(),this._checkLogCode(),this._storeLogCode(),this._checkMetaCode()}_checkStatusCode(){var e=this._statusCode,t=n.StatusCodes.CONTINUE,s=n.StatusCodes.NETWORK_AUTHENTICATION_REQUIRED;if(e<t||s<e)throw new Error(`Status code ${e} must be between ${t} and ${s}.`)}_checkLogCode(){var e=this._logCode,t=MessageCodeObject._messageCodePool,s=MessageCodeObject.LOG_CODE_REGEX;if(t.has(e))throw new Error(`Duplicate log code ${e} is found.`);if(!s.test(e))throw new Error(`Log code ${e} cannot match ${s}.`)}_storeLogCode(){MessageCodeObject._messageCodePool.set(this._logCode,this)}_checkMetaCode(){var e=this._metaCode,t=MessageCodeObject.META_CODE_REGEX;if(!t.test(e))throw new Error(`Meta code ${e} cannot match ${t}.`)}static get metaCodePrefix(){return this._metaCodePrefix}static set metaCodePrefix(e){this._metaCodePrefix=e}}(t.MessageCodeObject=MessageCodeObject).LOG_CODE_REGEX=/^[IWEF][A-Z]{2}[0-9]{3}$/,MessageCodeObject.META_CODE_REGEX=/^[0-9]{3}$/,MessageCodeObject._metaCodePrefix="1",MessageCodeObject._messageCodePool=new Map;class MessageCode{}(t.MessageCode=MessageCode).WMV400=new MessageCodeObject(n.StatusCodes.BAD_REQUEST,"WMV400","400","Restful view: Bad request.","Bad request."),MessageCode.WMV403=new MessageCodeObject(n.StatusCodes.FORBIDDEN,"WMV403","403","Restful view: Forbidden.","Forbidden."),MessageCode.WMV404=new MessageCodeObject(n.StatusCodes.NOT_FOUND,"WMV404","404","Restful view: Not found.","Not found."),MessageCode.EMV500=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMV500","500","Restful view: Internal server error.","Internal server error."),MessageCode.EMU000=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU000","520","Auxiliary util: Internal error.","Backoff operation has been exhausted."),MessageCode.EMU010=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU010","520","Auxiliary util: Internal error.","Future operation timeout exceeded."),MessageCode.EMU011=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU011","520","Auxiliary util: Internal error.","Future condition has been done."),MessageCode.EMU012=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU012","520","Auxiliary util: Internal error.","Future condition has never been done."),MessageCode.EMU013=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU013","520","Auxiliary util: Internal error.","Future precondition has been done."),MessageCode.EMU014=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU014","520","Auxiliary util: Internal error.","Future task has been cancelled."),MessageCode.EMU015=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU015","520","Auxiliary util: Internal error.","Future task loop has been cancelled."),MessageCode.EMU016=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU016","520","Auxiliary util: Internal error.","Future task retry exceeded."),MessageCode.EMU017=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU017","520","Auxiliary util: Internal error.","Future task manager has been aborted."),MessageCode.EMU018=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU018","520","Auxiliary util: Internal error.","Future lock has been released."),MessageCode.EMU019=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU019","520","Auxiliary util: Internal error.","Future channel has been closed."),MessageCode.EMU050=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU050","520","Auxiliary util: Internal error.","Flow key to a value must be in flow storage."),MessageCode.EMU060=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU060","520","Auxiliary util: Internal error.","Graceful processor received some process errors."),MessageCode.EMU070=new MessageCodeObject(n.StatusCodes.INTERNAL_SERVER_ERROR,"EMU070","525","Auxiliary util: Internal error.","Request carrier encountered an error before response."),MessageCode.EMU071=new MessageCodeObject(n.StatusCodes.SERVICE_UNAVAILABLE,"EMU071","526","Auxiliary util: External API error.","Request carrier received unexpected failure response."),MessageCode.WMU072=new MessageCodeObject(n.StatusCodes.BAD_REQUEST,"WMU072","527","Auxiliary util: External API error.","Request carrier received validation failure response.")},6796:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentKind=t.ContentType=t.HTTPHeader=t.HTTPMethod=void 0;class HTTPMethod{}(t.HTTPMethod=HTTPMethod).GET="GET",HTTPMethod.HEAD="HEAD",HTTPMethod.POST="POST",HTTPMethod.PUT="PUT",HTTPMethod.PATCH="PATCH",HTTPMethod.DELETE="DELETE",HTTPMethod.TRACE="TRACE",HTTPMethod.OPTIONS="OPTIONS";class HTTPHeader{}(t.HTTPHeader=HTTPHeader).RANGE="range",HTTPHeader.CONTENT_TYPE="content-type",HTTPHeader.CONTENT_LENGTH="content-length";class ContentType{}(t.ContentType=ContentType).XML="application/xml",ContentType.JSON="application/json",ContentType.BYTE="application/octet-stream",ContentType.TEXT="text/plain",ContentType.FILE="multipart/form-data",ContentType.FORM="application/x-www-form-urlencoded",ContentType.HTML="text/html",ContentType.WEBVTT="text/vtt",ContentType.HLS_M3U="audio/mpegurl",ContentType.HLS_M3U_2="audio/x-mpegurl",ContentType.HLS_M3U8="application/vnd.apple.mpegurl",ContentType.HLS_M3U8_2="application/x-mpegurl",ContentType.HLS_TS="video/mp2t",ContentType.MP4_AUDIO="audio/mp4",ContentType.MP4_VIDEO="video/mp4";class ContentKind{}(t.ContentKind=ContentKind).XML="xml",ContentKind.JSON="json",ContentKind.BYTE="byte",ContentKind.TEXT="text",ContentKind.FORM="form"},6940:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ByteTool=void 0;const n=s(8710);class ByteTool{static makeRandomBytes(e){return(0,n.randomBytes)(e)}static makeRandomBase10String(e){return this._makeRandomBaseRadixString(e,this.DEFAULT_BASE10_STRING)}static makeRandomBase16String(e){return this._makeRandomBaseRadixString(e,this.DEFAULT_BASE16_STRING)}static makeRandomBase36String(e){return this._makeRandomBaseRadixString(e,this.DEFAULT_BASE36_STRING)}static makeRandomBase62String(e){return this._makeRandomBaseRadixString(e,this.DEFAULT_BASE62_STRING)}static _makeRandomBaseRadixString(e,t){return[...this.makeRandomBytes(e)].map((e=>t.charAt(e%t.length))).join("")}}(t.ByteTool=ByteTool).DEFAULT_BASE10_STRING="0123456789",ByteTool.DEFAULT_BASE16_STRING="0123456789ABCDEF",ByteTool.DEFAULT_BASE36_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",ByteTool.DEFAULT_BASE62_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"},1545:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckTool=void 0;class CheckTool{static isNil(e){return null==e}static isNotNil(e){return null!=e}static isNull(e){return null===e}static isNotNull(e){return null!==e}static isUndefined(e){return void 0===e}static isNotUndefined(e){return void 0!==e}static isEqual(e,t){return e===t}static isNotEqual(e,t){return e!==t}static isTypeOf(e,...t){return t.some((t=>typeof e===t))}static isNotTypeOf(e,...t){return t.every((t=>typeof e!==t))}static isInstanceOf(e,...t){return t.some((t=>e instanceof t))}static isNotInstanceOf(e,...t){return t.every((t=>!(e instanceof t)))}static isBoolean(e){return"boolean"==typeof e}static isNotBoolean(e){return"boolean"!=typeof e}static isTrue(e){return!0===e}static isNotTrue(e){return!0!==e}static isFalse(e){return!1===e}static isNotFalse(e){return!1!==e}static isNumber(e){return"number"==typeof e}static isNotNumber(e){return"number"!=typeof e}static isNaN(e){return"number"==typeof e&&isNaN(e)}static isNotNaN(e){return"number"==typeof e&&!isNaN(e)}static isFinite(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}static isInfinite(e){return"number"==typeof e&&!isNaN(e)&&!isFinite(e)}static isInteger(e){return this.isFinite(e)&&Number.isInteger(e)}static isNotInteger(e){return this.isFinite(e)&&!Number.isInteger(e)}static isFloat(e){return this.isFinite(e)&&!Number.isInteger(e)}static isNotFloat(e){return this.isFinite(e)&&Number.isInteger(e)}static isLt(e,t){return this.isFinite(e)&&e<t}static isLte(e,t){return this.isFinite(e)&&e<=t}static isGt(e,t){return this.isFinite(e)&&t<e}static isGte(e,t){return this.isFinite(e)&&t<=e}static isBetween(e,t,s){return this.isFinite(e)&&t<=e&&e<=s}static isZero(e){return this.isFinite(e)&&0===e}static isNonzero(e){return this.isFinite(e)&&0!==e}static isPositive(e){return this.isFinite(e)&&0<e}static isNonpositive(e){return this.isFinite(e)&&e<=0}static isNegative(e){return this.isFinite(e)&&e<0}static isNonnegative(e){return this.isFinite(e)&&0<=e}static isPositiveInteger(e){return this.isInteger(e)&&0<e}static isNonpositiveInteger(e){return this.isInteger(e)&&e<=0}static isNegativeInteger(e){return this.isInteger(e)&&e<0}static isNonnegativeInteger(e){return this.isInteger(e)&&0<=e}static isString(e){return"string"==typeof e}static isNotString(e){return"string"!=typeof e}static isBlankString(e){return 0===e.length}static isFilledString(e){return 0!==e.length}static isValidString(e,t){return null!=e.match(t)}static isInvalidString(e,t){return null==e.match(t)}static isDigitString(e){return this.isValidString(e,this.INTEGER_REGEX)}static isNotDigitString(e){return this.isInvalidString(e,this.INTEGER_REGEX)}static isFloatString(e){return this.isValidString(e,this.FLOAT_REGEX)}static isNotFloatString(e){return this.isInvalidString(e,this.FLOAT_REGEX)}static isObject(e){return e instanceof Object}static isNotObject(e){return!(e instanceof Object)}static isEmptyObject(e){return 0===Object.keys(e).length}static isFilledObject(e){return 0!==Object.keys(e).length}static isArray(e){return e instanceof Array}static isNotArray(e){return!(e instanceof Array)}static isEmptyArray(e){return 0===e.length}static isFilledArray(e){return 0!==e.length}static isMap(e){return e instanceof Map}static isNotMap(e){return!(e instanceof Map)}static isEmptyMap(e){return 0===e.size}static isFilledMap(e){return 0!==e.size}static isSet(e){return e instanceof Set}static isNotSet(e){return!(e instanceof Set)}static isEmptySet(e){return 0===e.size}static isFilledSet(e){return 0!==e.size}static isCollection(e){return e instanceof Array||e instanceof Set}static isNotCollection(e){return!(e instanceof Array||e instanceof Set)}static isEmptyCollection(e){return e instanceof Array?0===e.length:0===e.size}static isFilledCollection(e){return e instanceof Array?0!==e.length:0!==e.size}static isFunction(e){return"function"==typeof e}static isNotFunction(e){return"function"!=typeof e}static isAsyncFunction(e){return"function"==typeof e&&"AsyncFunction"===e.constructor.name}static isNotAsyncFunction(e){return"function"==typeof e&&"AsyncFunction"!==e.constructor.name}static isGeneratorFunction(e){return"function"==typeof e&&"GeneratorFunction"===e.constructor.name}static isNotGeneratorFunction(e){return"function"==typeof e&&"GeneratorFunction"!==e.constructor.name}}(t.CheckTool=CheckTool).FLOAT_REGEX=/^[+-]?(?:\d+\.?\d*|\.\d+)(?:[Ee][+-]?\d+)?$/,CheckTool.INTEGER_REGEX=/^[+-]?\d+$/},2064:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HashTool=void 0;const a=n(s(1354)),o=s(8925),c=s(6544);t.HashTool=class HashTool{static makeMD5Buffer(e){return this._wordArrayToBuffer(a.default.MD5(this._bufferToWordArray(e)))}static makeMD5Base16String(e){return c.RadixTool.bufferToBase16String(this.makeMD5Buffer(e))}static makeMD5Base32String(e){return c.RadixTool.bufferToBase32String(this.makeMD5Buffer(e))}static makeMD5Base32URLString(e){return c.RadixTool.bufferToBase32URLString(this.makeMD5Buffer(e))}static makeMD5Base64String(e){return c.RadixTool.bufferToBase64String(this.makeMD5Buffer(e))}static makeMD5Base64URLString(e){return c.RadixTool.bufferToBase64URLString(this.makeMD5Buffer(e))}static makeSHA256Buffer(e){return this._wordArrayToBuffer(a.default.SHA256(this._bufferToWordArray(e)))}static makeSHA256Base16String(e){return c.RadixTool.bufferToBase16String(this.makeSHA256Buffer(e))}static makeSHA256Base32String(e){return c.RadixTool.bufferToBase32String(this.makeSHA256Buffer(e))}static makeSHA256Base32URLString(e){return c.RadixTool.bufferToBase32URLString(this.makeSHA256Buffer(e))}static makeSHA256Base64String(e){return c.RadixTool.bufferToBase64String(this.makeSHA256Buffer(e))}static makeSHA256Base64URLString(e){return c.RadixTool.bufferToBase64URLString(this.makeSHA256Buffer(e))}static _bufferToWordArray(e){return a.default.lib.WordArray.create(o.Buffer.from(e))}static _wordArrayToBuffer(e){var t=new Uint8Array(new ArrayBuffer(e.sigBytes));for(let s=0;s<e.sigBytes;s++)t[s]=e.words[s>>>2]>>>24-s%4*8&255;return o.Buffer.from(t)}}},2065:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONTool=void 0;const n=s(8925);t.JSONTool=class JSONTool{static dumps(e){return JSON.stringify(e,this._replacer)}static loads(e){return JSON.parse(e)}static dumpb(e){return n.Buffer.from(this.dumps(e))}static loadb(e){return this.loads(n.Buffer.from(e).toString())}static get _replacer(){const e=new WeakSet;return(t,s)=>{if("object"==typeof s&&null!==s){if(e.has(s))return;e.add(s)}return s}}static clear(e){return Object.keys(e).forEach((t=>{delete e[t]})),e}}},9714:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ListTool=void 0;const a=n(s(6486));t.ListTool=class ListTool{static flatObject(e,t,s){var n=new Array;return this._flatObject(n,e,0,t=null!=t?t:1,s=t+(null!=s?s:0)),n}static _flatObject(e,t,s,n,o){if(!(o<s))if(s<o&&a.default.isPlainObject(t))for(const a of Object.values(t))this._flatObject(e,a,s+1,n,o);else n<=s&&e.push(t)}}},6544:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RadixTool=void 0;const n=s(9911),a=s(8925);t.RadixTool=class RadixTool{static bufferToBase16String(e){return n.base16.stringify(a.Buffer.from(e))}static base16StringToBuffer(e){return a.Buffer.from(n.base16.parse(e))}static stringToBase16String(e){return n.base16.stringify(a.Buffer.from(e))}static base16StringToString(e){return a.Buffer.from(n.base16.parse(e)).toString()}static bufferToBase32String(e){return n.base32.stringify(a.Buffer.from(e))}static base32StringToBuffer(e){return a.Buffer.from(n.base32.parse(e))}static stringToBase32String(e){return n.base32.stringify(a.Buffer.from(e))}static base32StringToString(e){return a.Buffer.from(n.base32.parse(e)).toString()}static bufferToBase32URLString(e){return n.base32.stringify(a.Buffer.from(e),{pad:!1})}static base32URLStringToBuffer(e){return a.Buffer.from(n.base32.parse(e,{loose:!0}))}static stringToBase32URLString(e){return n.base32.stringify(a.Buffer.from(e),{pad:!1})}static base32URLStringToString(e){return a.Buffer.from(n.base32.parse(e,{loose:!0})).toString()}static bufferToBase64String(e){return n.base64.stringify(a.Buffer.from(e))}static base64StringToBuffer(e){return a.Buffer.from(n.base64.parse(e))}static stringToBase64String(e){return n.base64.stringify(a.Buffer.from(e))}static base64StringToString(e){return a.Buffer.from(n.base64.parse(e)).toString()}static bufferToBase64URLString(e){return n.base64url.stringify(a.Buffer.from(e),{pad:!1})}static base64URLStringToBuffer(e){return a.Buffer.from(n.base64url.parse(e,{loose:!0}))}static stringToBase64URLString(e){return n.base64url.stringify(a.Buffer.from(e),{pad:!1})}static base64URLStringToString(e){return a.Buffer.from(n.base64url.parse(e,{loose:!0})).toString()}}},8240:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RandomTool=void 0;t.RandomTool=class RandomTool{static shuffle(e){for(let s=e.length-1;0<s;s--){var t=Math.floor(Math.random()*(s+1));[e[s],e[t]]=[e[t],e[s]]}return e}}},302:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringTool=void 0;t.StringTool=class StringTool{static prefix(e,t){return e.startsWith(t)?e:""+t+e}static suffix(e,t){return e.endsWith(t)?e:""+e+t}}},93:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TimeTool=void 0;const a=n(s(7484));class TimeTool{static makeNow(){return(0,a.default)()}static makeNowS(){return this.makeNow().unix()}static makeNowMs(){return this.makeNow().valueOf()}static makeNowFstring(e){return this.timeToFstring(this.makeNow(),e)}static unixToTime(e){return a.default.unix(e)}static unixToFstring(e,t){return this.timeToFstring(this.unixToTime(e),t)}static timeToFstring(e,t){return e.format(null!=t?t:this.DEFAULT_TIME_FORMAT)}static async sleep(e){await this._sleep(e)}static async sleepMomently(){await this._sleep(0)}static async sleepRandomly(e,t){var s;e=null!=(s=null!=(s=null==t?void 0:t.seconds)?s:e)?s:this.DEFAULT_SLEEP_RANDOMLY_SECONDS,t=null!=(s=null==t?void 0:t.jitter)?s:this.DEFAULT_SLEEP_RANDOMLY_JITTER;await this._sleep(e*(1-t+2*Math.random()*t))}static async _sleep(e){await new Promise((t=>setTimeout(t,1e3*e)))}}(t.TimeTool=TimeTool).DEFAULT_TIME_FORMAT="YYYY-MM-DD HH:mm:ss",TimeTool.DEFAULT_SLEEP_RANDOMLY_SECONDS=.2,TimeTool.DEFAULT_SLEEP_RANDOMLY_JITTER=.2},1135:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PermanentError=t.BackoffError=t.RetryBackoff=t.DelayBackoff=t.ExponentialDelayer=t.LinearDelayer=void 0;const n=s(4239),a=s(93),o=s(2016),c=s(9283);class AbstractDelayer{constructor(e){var t;this._interval=0,this._seconds=new c.Counter,this._attempts=new c.Counter,this._baseInterval=null!=(t=null==e?void 0:e.baseInterval)?t:AbstractDelayer.DEFAULT_BASE_INTERVAL,this._multiplier=null!=(t=null==e?void 0:e.multiplier)?t:AbstractDelayer.DEFAULT_MULTIPLIER,this._jitterFactor=null!=(t=null==e?void 0:e.jitterFactor)?t:AbstractDelayer.DEFAULT_JITTER_FACTOR,this._maxInterval=null!=(t=null==e?void 0:e.maxInterval)?t:AbstractDelayer.DEFAULT_MAX_INTERVAL,this._maxSeconds=null!=(t=null==e?void 0:e.maxSeconds)?t:AbstractDelayer.DEFAULT_MAX_SECONDS,this._maxAttempts=null!=(t=null==e?void 0:e.maxAttempts)?t:AbstractDelayer.DEFAULT_MAX_ATTEMPTS}next(){return this._increaseSeconds(),this._increaseAttempts(),this._isOverMaxSeconds||this._isOverMaxAttempts?-1:this._interval}_increaseSeconds(){var e=this._makeNextInterval();this._interval=e,this._seconds.plus(e)}_makeNextInterval(){var e=this._computeInterval();e=this._jitterInterval(e);return this._restrictInterval(e)}_jitterInterval(e){return e*(1-this._jitterFactor+2*Math.random()*this._jitterFactor)}_restrictInterval(e){return e<=this._maxInterval?e:this._maxInterval}_increaseAttempts(){this._attempts.up()}get _isOverMaxSeconds(){return 0<=this._maxSeconds&&this._seconds.hasCountedOver(this._maxSeconds)}get _isOverMaxAttempts(){return 0<=this._maxAttempts&&this._attempts.hasCountedOver(this._maxAttempts)}reset(){this._interval=0,this._seconds.reset(),this._attempts.reset()}}AbstractDelayer.DEFAULT_BASE_INTERVAL=0,AbstractDelayer.DEFAULT_MULTIPLIER=1,AbstractDelayer.DEFAULT_JITTER_FACTOR=.2,AbstractDelayer.DEFAULT_MAX_INTERVAL=5,AbstractDelayer.DEFAULT_MAX_SECONDS=-1,AbstractDelayer.DEFAULT_MAX_ATTEMPTS=-1;class LinearDelayer extends AbstractDelayer{constructor(e){var t;super(e),this._baseInterval=null!=(t=null==e?void 0:e.baseInterval)?t:LinearDelayer.DEFAULT_BASE_INTERVAL,this._multiplier=null!=(t=null==e?void 0:e.multiplier)?t:LinearDelayer.DEFAULT_MULTIPLIER,this._jitterFactor=null!=(t=null==e?void 0:e.jitterFactor)?t:LinearDelayer.DEFAULT_JITTER_FACTOR,this._maxInterval=null!=(t=null==e?void 0:e.maxInterval)?t:LinearDelayer.DEFAULT_MAX_INTERVAL,this._maxSeconds=null!=(t=null==e?void 0:e.maxSeconds)?t:LinearDelayer.DEFAULT_MAX_SECONDS,this._maxAttempts=null!=(t=null==e?void 0:e.maxAttempts)?t:LinearDelayer.DEFAULT_MAX_ATTEMPTS}_computeInterval(){return this._baseInterval+this._multiplier*this._attempts.count}}(t.LinearDelayer=LinearDelayer).DEFAULT_BASE_INTERVAL=.5,LinearDelayer.DEFAULT_MULTIPLIER=2,LinearDelayer.DEFAULT_MAX_INTERVAL=10;class ExponentialDelayer extends AbstractDelayer{constructor(e){var t;super(e),this._baseInterval=null!=(t=null==e?void 0:e.baseInterval)?t:ExponentialDelayer.DEFAULT_BASE_INTERVAL,this._multiplier=null!=(t=null==e?void 0:e.multiplier)?t:ExponentialDelayer.DEFAULT_MULTIPLIER,this._magnification=null!=(t=null==e?void 0:e.magnification)?t:ExponentialDelayer.DEFAULT_MAGNIFICATION,this._jitterFactor=null!=(t=null==e?void 0:e.jitterFactor)?t:ExponentialDelayer.DEFAULT_JITTER_FACTOR,this._maxInterval=null!=(t=null==e?void 0:e.maxInterval)?t:ExponentialDelayer.DEFAULT_MAX_INTERVAL,this._maxSeconds=null!=(t=null==e?void 0:e.maxSeconds)?t:ExponentialDelayer.DEFAULT_MAX_SECONDS,this._maxAttempts=null!=(t=null==e?void 0:e.maxAttempts)?t:ExponentialDelayer.DEFAULT_MAX_ATTEMPTS}_computeInterval(){return this._baseInterval+this._magnification*(Math.pow(this._multiplier,this._attempts.count)-1)}}(t.ExponentialDelayer=ExponentialDelayer).DEFAULT_BASE_INTERVAL=1,ExponentialDelayer.DEFAULT_MULTIPLIER=1.8,ExponentialDelayer.DEFAULT_MAGNIFICATION=1,ExponentialDelayer.DEFAULT_MAX_INTERVAL=20,ExponentialDelayer.DEFAULT_MAX_ATTEMPTS=5;class AbstractBackoff{constructor(e){var t=null!=(t=null==e?void 0:e.delayerClass)?t:AbstractBackoff.DEFAULT_DELAYER_CLASS;this._delayer=new t(null==e?void 0:e.delayerOptions)}async apply(e){const t=this._makeInvoker(e);return await this._apply(t).catch((async e=>{if(t.error)throw t.error;throw e})),t.value}async delay(){await this._delay()}async _delay(){var e=this._delayer.next();if(e<0)throw BackoffError.OPERATION_EXHAUSTED;await a.TimeTool.sleep(e)}async reset(){await this._reset()}async _reset(){await this._delayer.reset()}}AbstractBackoff.DEFAULT_DELAYER_CLASS=ExponentialDelayer;t.DelayBackoff=class DelayBackoff extends AbstractBackoff{constructor(e){super(e)}async _apply(e){await this._delay(),await e.apply(),await e.throwIfError()}_makeInvoker(e){return new DelayInvoker(e)}};class RetryBackoff extends AbstractBackoff{constructor(e){super(e),this._delayFirst=null!=(e=null==e?void 0:e.delayFirst)?e:RetryBackoff.DEFAULT_DELAY_FIRST}async _apply(e){for(;this._delayFirst&&await this._delay(),await e.reset(),await e.apply(),!e.isDone;)this._delayFirst||await this._delay();await e.throwIfError()}_makeInvoker(e){return new RetryInvoker(e)}}(t.RetryBackoff=RetryBackoff).DEFAULT_DELAY_FIRST=!1;class AbstractInvoker{constructor(e){this._operator=e,this._isDone=!1}get isDone(){return this._isDone}get value(){return this._value}get error(){return this._error}async reset(){this._isDone=!1,this._value=null,this._error=null}async throwIfError(){if(this._error)throw this._error}}class DelayInvoker extends AbstractInvoker{constructor(e){super(e),this._operator=e}async apply(){try{this._value=await this._operator(),this._isDone=!0}catch(e){this._error=e}}}class RetryInvoker extends AbstractInvoker{constructor(e){super(e),this._operator=e}async apply(){try{this._value=await this._operator(),this._isDone=!0}catch(e){e instanceof PermanentError?(this._error=e.cause,this._isDone=!0):this._error=e}}}class BackoffError{}(t.BackoffError=BackoffError).OPERATION_EXHAUSTED=new o.InternalError(n.MessageCode.EMU000);class PermanentError extends Error{constructor(e){super(),this._cause=e}get cause(){return this._cause}}t.PermanentError=PermanentError},533:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=void 0;const a=n(s(7064)),o=s(1545),c=s(2065);class BaseCache{constructor(e){this._prefix=e}_makeCacheKey(e){return e=e.map((e=>o.CheckTool.isCollection(e)?c.JSONTool.dumps([...new Set(e)].sort()):e)),`/${this._prefix}/`+e.join("/")}_makeCacheValue(e){return e}}t.LRUCache=class LRUCache extends BaseCache{constructor(e,t){super(e),this._prefix=e,this._options=t,this._lru=new a.default(t)}get size(){return this._lru.size}set(e,t,s){e=this._makeCacheKey(e),t=this._makeCacheValue(t),this._lru.set(e,t,{ttl:s})}get(e){return e=this._makeCacheKey(e),this._lru.get(e)}peek(e){return e=this._makeCacheKey(e),this._lru.peek(e)}has(e){return e=this._makeCacheKey(e),this._lru.has(e)}delete(e){e=this._makeCacheKey(e),this._lru.delete(e)}keys(){return this._lru.keys()}values(){return this._lru.values()}forEach(e,t){this._lru.forEach(e,t)}rforEach(e,t){this._lru.rforEach(e,t)}prune(){this._lru.purgeStale()}clear(){this._lru.clear()}toJSON(){const{_lru:e,...t}=this;return t}}},2016:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnexpectedError=t.ValidationError=t.InternalError=void 0;class InternalError extends Error{constructor(e,t,s){super(),this._code=e,this._cause=t,this._params=s}get name(){return this.constructor.name}get message(){var e;return`<${this.constructor.name}| ${this._code.logContent}> caused from: `+(null==(e=this._cause)?void 0:e.message)}get code(){return this._code}get cause(){return this._cause}get params(){return this._params}}class ValidationError extends(t.InternalError=InternalError){}t.ValidationError=ValidationError;class UnexpectedError extends InternalError{static aggravate(e){return e instanceof ValidationError?new UnexpectedError(e.code,e.cause,e.params):e}}t.UnexpectedError=UnexpectedError},4944:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t._TaskState=t._TaskType=t.FutureError=t.ChannelHub=t.Channel=t.MutexLocker=t.TaskManager=t.CyclicDuty=t.CyclicTask=t.CommonDuty=t.CommonTask=t.Condition=void 0;const a=n(s(6486)),o=n(s(148)),c=s(4239),u=s(6940),l=s(93),d=s(2016),h=s(287),_=s(1139),p=s(9283);class Condition{constructor(e){this._precondition=e,this._isDone=!1,this._conditions=new Set,this._timeouters=new Array,this._joinPrecondition()}get isDone(){return this._isDone}get value(){return this._value}get error(){return this._error}pass(e){this._isDone||(this._isDone=!0,this._value=e,this._resolve&&this._resolve(e),this._denyConditions(FutureError.PRECONDITION_DONE),this._quitPrecondition())}deny(e){this._isDone||(this._isDone=!0,this._error=e,this._reject&&this._reject(e),this._denyConditions(FutureError.PRECONDITION_DONE),this._quitPrecondition())}fork(){if(this._isDone)throw FutureError.CONDITION_DONE;return new Condition(this)}reset(){var e;if(!this._isDone)throw FutureError.CONDITION_UNDONE;if(null!=(e=this._precondition)&&e.isDone)throw FutureError.PRECONDITION_DONE;this._joinPrecondition(),this._resetTimeouters(),this._resetProperties()}_denyConditions(e){this._conditions.forEach((t=>{t.deny(e)}))}_resetTimeouters(){this._timeouters.forEach((e=>{e.reset()}))}_resetProperties(){this._isDone=!1,this._error=null,this._value=null,this._promise=null,this._resolve=null,this._reject=null,this._conditions=new Set,this._timeouters=new Array}done(){return this._ensurePromise(),this._promise}with(e,t){if(this._isDone)throw FutureError.CONDITION_DONE;return this._invokeOperator(e,t),this._ensurePromise(),this._promise}_invokeOperator(e,t){e=e().then((e=>{this.pass(e)})).catch((e=>{this.deny(e)})),null!=t&&0<=t&&this._setupTimeout(e,t)}_setupTimeout(e,t){var s=new p.Timeouter;s.setup((async()=>{await this.deny(FutureError.OPERATION_TIMEOUT)}),t),s.apply((async()=>{await e})),this._timeouters.push(s)}_ensurePromise(){this._promise||(this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t,this._isDone&&(this._error?this._reject(this._error):this._resolve(this._value))})))}_attach(e){this._conditions.add(e)}_detach(e){this._conditions.delete(e)}_joinPrecondition(){var e;null!=(e=this._precondition)&&e._attach(this)}_quitPrecondition(){var e;null!=(e=this._precondition)&&e._detach(this)}static async all(e){return await Promise.all(e.map((e=>e.done()))),e}static async allSettled(e){return await Promise.allSettled(e.map((e=>e.done()))),e}static async with(e,t){return(new Condition).with(e,t)}}t.Condition=Condition;class AbstractRunner{constructor(){this._timer=new p.Timer,this._condition=new Condition,this._subcondition=this._condition.fork()}get isActive(){return this._isActive}get isActivated(){return null!=this._promise}get elapsedTime(){return this._isActive&&this._timer.stamp(),this._timer.elapsedTimeS}get _isActive(){return null!=this._promise&&!this._condition.isDone}async exit(){await this._activate(),await this._condition.done()}async done(){await this._activate(),await this._condition.done(),await this._subcondition.done()}async activate(){await this._activate()}async _activate(){this._promise||(this._promise=this._condition.with((async()=>{await this._launch()})))}async deactivate(){await this._deactivate()}async _deactivate(){await this._cancel()}_arrive(){this._timer.stamp(),this._subcondition.pass()}_desist(e){this._timer.stamp(),this._subcondition.deny(e)}async _relay(e,t){await this._subcondition.fork().with(e,t)}async _bypass(e,t){await Condition.with(e,t)}}class TaskID{static make(){return`task-${l.TimeTool.makeNowFstring(this.TIME_PART_FORMAT)}-`+u.ByteTool.makeRandomBase36String(this.RANDOM_PART_LENGTH).toLowerCase()}}TaskID.TIME_PART_FORMAT="YYYYMMDDHHmmss",TaskID.RANDOM_PART_LENGTH=20;class TaskType{}(t._TaskType=TaskType).COMMON="common",TaskType.CYCLIC="cyclic";class TaskEvent{}TaskEvent.INITIAL="initial",TaskEvent.READY="ready",TaskEvent.RUNNING="running",TaskEvent.FINISH="finish",TaskEvent.FAIL="fail",TaskEvent.CANCEL="cancel",TaskEvent.CLOSE="close",TaskEvent.LOOP_RESUME="loop_resume",TaskEvent.LOOP_READY="loop_ready",TaskEvent.LOOP_RUNNING="loop_running",TaskEvent.LOOP_FINISH="loop_finish",TaskEvent.LOOP_FAIL="loop_fail",TaskEvent.LOOP_PAUSE="loop_pause";class TaskState{constructor(){this._name=TaskStateName.INITIAL}get isInitial(){return this._name===TaskStateName.INITIAL}get isReady(){return this._name===TaskStateName.READY}get isRunning(){return this._name===TaskStateName.RUNNING}get isFinished(){return this._name===TaskStateName.FINISHED}get isFailed(){return this._name===TaskStateName.FAILED}get isCancelled(){return this._name===TaskStateName.CANCELLED}get isTerminated(){return this.isFinished||this.isFailed||this.isCancelled}toInitial(){this._name=TaskStateName.INITIAL}toReady(){this._name=TaskStateName.READY}toRunning(){this._name=TaskStateName.RUNNING}toFinished(){this._name=TaskStateName.FINISHED}toFailed(){this._name=TaskStateName.FAILED}toCancelled(){this._name=TaskStateName.CANCELLED}toString(){var e=new Array;return e.push("name: "+this._name),`<${this.constructor.name}| ${e.join(", ")}>`}}t._TaskState=TaskState;class TaskStateName{}TaskStateName.INITIAL="initial",TaskStateName.READY="ready",TaskStateName.RUNNING="running",TaskStateName.FINISHED="finished",TaskStateName.FAILED="failed",TaskStateName.CANCELLED="cancelled";class CommonTask extends AbstractRunner{constructor(e){var t;super(),this._id=TaskID.make(),this._type=TaskType.COMMON,this._state=new TaskState,this._emittery=new o.default,this._name=null==e?void 0:e.name,this._caller=null!=(t=null==e?void 0:e.caller)?t:this,this._callee=null==e?void 0:e.callee,this._content=null==e?void 0:e.content,this._pretasks=null!=(t=null==e?void 0:e.pretasks)?t:[],this._runningTimeout=null!=(t=null==e?void 0:e.runningTimeout)?t:CommonTask.DEFAULT_RUNNING_TIMEOUT,this._callbackTimeout=null!=(t=null==e?void 0:e.callbackTimeout)?t:CommonTask.DEFAULT_CALLBACK_TIMEOUT,this._bindEvent(e)}get id(){return this._id}get name(){return this._name}get type(){return this._type}get state(){return this._state}get error(){return this._error}get content(){return this._content}get outcome(){return this._outcome}async abort(e){this._toCancel(e)}async _launch(){try{await this._toInitial(),await this._toReady(),await this._toRunning(),await this._toFinish()}catch(e){await this._toFail(e)}finally{await this._toClose()}}async _toInitial(){await this._emitInitial(),await this._execInitial()}async _emitInitial(){await this._relay((async()=>{await this._emittery.emit(TaskEvent.INITIAL,this)}),this._callbackTimeout)}async _execInitial(){await l.TimeTool.sleep(0)}async _toReady(){await this._emitReady(),await this._execReady()}async _emitReady(){await this._relay((async()=>{await this._emittery.emit(TaskEvent.READY,this)}),this._callbackTimeout)}async _execReady(){await this._state.toReady(),await this._waitForPretasks()}async _waitForPretasks(){var e=this._pretasks.map((e=>e.done()));await Promise.all(e).catch((async()=>{throw await this._revoke(),this._error}))}async _toRunning(){await this._emitRunning(),await this._execRunning()}async _emitRunning(){await this._relay((async()=>{await this._emittery.emit(TaskEvent.RUNNING,this)}),this._callbackTimeout)}async _execRunning(){await this._state.toRunning(),await this._relay((async()=>{await this._running()}),this._runningTimeout)}async _running(){await this._invoke()}async _invoke(){this._callee&&(this._outcome=await this._bind(this._callee)(this))}async _toFinish(){await this._emitFinish(),await this._execFinish()}async _emitFinish(){await this._relay((async()=>{await this._emittery.emit(TaskEvent.FINISH,this)}),this._callbackTimeout)}async _execFinish(){var e=this.toString();await this._state.toFinished(),await this._arrive(),await FutureLogger.track("Task run succeeded.",{task:e})}async _toFail(e){this._state.isTerminated||(await this._execFail(e),await this._emitFail())}async _emitFail(){await this._suppress((async()=>{await this._bypass((async()=>{await this._emittery.emit(TaskEvent.FAIL,this)}),this._callbackTimeout)}))}async _execFail(e){var t=this.toString();this._error=e,await this._state.toFailed(),await this._desist(e),await FutureLogger.warn("Task run failed.",{task:t},{error:e})}async _toClose(){await this._execClose(),await this._emitClose()}async _emitClose(){await this._suppress((async()=>{await this._bypass((async()=>{await this._emittery.emit(TaskEvent.CLOSE,this)}),this._callbackTimeout)}))}async _execClose(){await this._timer.stamp()}async _toCancel(e){await this._execCancel(e),await this._emitCancel()}async _emitCancel(){await this._suppress((async()=>{await this._bypass((async()=>{await this._emittery.emit(TaskEvent.CANCEL,this)}),this._callbackTimeout)}))}async _execCancel(e){var t=this.toString();this._error=e,await this._state.toCancelled(),await this._desist(e),await FutureLogger.warn("Task run cancelled.",{task:t},{error:e})}async _suppress(e){await e().catch((async e=>{var t=this.toString();await FutureLogger.warn("Task error suppressed.",{task:t},{error:e})}))}async _cancel(){this._toCancel(FutureError.TASK_CANCELLED)}async _revoke(){await this._toCancel(FutureError.TASK_CANCELLED)}toString(){var e=new Array;return e.push(`id: ${this._id}>`),e.push("name: "+this._name),e.push("type: "+this._type),e.push("state: "+this._state),e.push("content: "+this._content),e.push("outcome: "+this._outcome),`<${this.constructor.name}| ${e.join(", ")}>`}_bind(e){return e.bind(this._caller)}_bindEvent(e){null!=e&&e.onInitial&&this._emittery.on(TaskEvent.INITIAL,this._bind(e.onInitial)),null!=e&&e.onReady&&this._emittery.on(TaskEvent.READY,this._bind(e.onReady)),null!=e&&e.onRunning&&this._emittery.on(TaskEvent.RUNNING,this._bind(e.onRunning)),null!=e&&e.onFinish&&this._emittery.on(TaskEvent.FINISH,this._bind(e.onFinish)),null!=e&&e.onFail&&this._emittery.on(TaskEvent.FAIL,this._bind(e.onFail)),null!=e&&e.onCancel&&this._emittery.on(TaskEvent.CANCEL,this._bind(e.onCancel)),null!=e&&e.onClose&&this._emittery.on(TaskEvent.CLOSE,this._bind(e.onClose))}}(t.CommonTask=CommonTask).DEFAULT_RUNNING_TIMEOUT=-1,CommonTask.DEFAULT_CALLBACK_TIMEOUT=10;class CommonDuty{constructor(e){Object.assign(this,a.default.merge({caller:this},e))}}t.CommonDuty=CommonDuty;class CyclicTask extends CommonTask{constructor(e){var t;super(e),this._type=TaskType.CYCLIC,this._loopCondition=this._subcondition.fork(),this._errorCounter=new p.Counter,this._totalCounter=new p.Counter,this._sentinel=null==e?void 0:e.sentinel,this._loopPretasks=null!=(t=null==e?void 0:e.loopPretasks)?t:[],this._sleepFirst=null!=(t=null==e?void 0:e.sleepFirst)?t:CyclicTask.DEFAULT_SLEEP_FIRST,this._sleepSeconds=null!=(t=null==e?void 0:e.sleepSeconds)?t:CyclicTask.DEFAULT_SLEEP_SECONDS,this._sleepJitter=null!=(t=null==e?void 0:e.sleepJitter)?t:CyclicTask.DEFAULT_SLEEP_JITTER,this._maxErrorRetry=null!=(t=null==e?void 0:e.maxErrorRetry)?t:CyclicTask.DEFAULT_MAX_ERROR_RETRY,this._maxTotalRetry=null!=(t=null==e?void 0:e.maxTotalRetry)?t:CyclicTask.DEFAULT_MAX_TOTAL_RETRY}get loopError(){return this._loopError}async loopDone(){await this._loopCondition.done()}async _running(){for(;;){try{await this._toLoopResume(),await this._toLoopReady(),await this._toLoopRunning(),await this._toLoopFinish()}catch(e){await this._toLoopFail(e)}finally{await this._toLoopPause()}if(await this._shouldLoopBreak())break}}async _toLoopResume(){await this._emitLoopResume(),await this._execLoopResume()}async _emitLoopResume(){await this._relay((async()=>{await this._emittery.emit(TaskEvent.LOOP_RESUME,this)}),this._callbackTimeout)}async _execLoopResume(){this._outcome=null,this._loopError=null,this._loopCondition.isDone&&await this._loopCondition.reset(),(this._sleepFirst||0<this._totalCounter.count)&&await l.TimeTool.sleepRandomly(void 0,{seconds:this._sleepSeconds,jitter:this._sleepJitter})}async _toLoopReady(){await this._emitLoopReady(),await this._execLoopReady()}async _emitLoopReady(){await this._relay((async()=>{await this._emittery.emit(TaskEvent.LOOP_READY,this)}),this._callbackTimeout)}async _execLoopReady(){await this._checkLoopPretasks(),await this._waitForLoopPretasks()}async _checkLoopPretasks(){for(const e of this._loopPretasks)if(e.state.isTerminated)throw await this._revoke(),this._error}async _waitForLoopPretasks(){var e=this._loopPretasks.map((e=>e.loopDone()));await Promise.all(e).catch((async()=>{throw FutureError.TASK_LOOP_CANCELLED}))}async _toLoopRunning(){await this._emitLoopRunning(),await this._execLoopRunning()}async _emitLoopRunning(){await this._relay((async()=>{await this._emittery.emit(TaskEvent.LOOP_RUNNING,this)}),this._callbackTimeout)}async _execLoopRunning(){await this._invoke()}async _toLoopFinish(){await this._emitLoopFinish(),await this._execLoopFinish()}async _emitLoopFinish(){await this._relay((async()=>{await this._emittery.emit(TaskEvent.LOOP_FINISH,this)}),this._callbackTimeout)}async _execLoopFinish(){await this._loopCondition.pass()}async _toLoopFail(e){await this._execLoopFail(e),await this._emitLoopFail()}async _emitLoopFail(){await this._suppress((async()=>{await this._bypass((async()=>{await this._emittery.emit(TaskEvent.LOOP_FAIL,this)}),this._callbackTimeout)}))}async _execLoopFail(e){var t=this.toString();this._loopError=e,await this._errorCounter.up(),await this._loopCondition.deny(e),await FutureLogger.warn("Task loop failed.",{task:t},{error:e})}async _toLoopPause(){await this._execLoopPause(),await this._emitLoopPause()}async _emitLoopPause(){await this._suppress((async()=>{await this._bypass((async()=>{await this._emittery.emit(TaskEvent.LOOP_PAUSE,this)}),this._callbackTimeout)}))}async _execLoopPause(){await this._totalCounter.up()}async _shouldLoopBreak(){if(this._state.isTerminated)return!0;if(this._sentinel&&await this._bind(this._sentinel)(this))return!0;if(0<=this._maxErrorRetry&&this._errorCounter.hasCountedOver(this._maxErrorRetry))throw FutureError.TASK_RETRY_EXCEEDED;if(0<=this._maxTotalRetry&&this._totalCounter.hasCountedOver(this._maxTotalRetry)){if(this._loopError)throw this._loopError;return!0}return!1}_bindEvent(e){super._bindEvent(e),null!=e&&e.onLoopResume&&this._emittery.on(TaskEvent.LOOP_RESUME,this._bind(e.onLoopResume)),null!=e&&e.onLoopReady&&this._emittery.on(TaskEvent.LOOP_READY,this._bind(e.onLoopReady)),null!=e&&e.onLoopRunning&&this._emittery.on(TaskEvent.LOOP_RUNNING,this._bind(e.onLoopRunning)),null!=e&&e.onLoopFinish&&this._emittery.on(TaskEvent.LOOP_FINISH,this._bind(e.onLoopFinish)),null!=e&&e.onLoopFail&&this._emittery.on(TaskEvent.LOOP_FAIL,this._bind(e.onLoopFail)),null!=e&&e.onLoopPause&&this._emittery.on(TaskEvent.LOOP_PAUSE,this._bind(e.onLoopPause))}}(t.CyclicTask=CyclicTask).DEFAULT_SLEEP_FIRST=!1,CyclicTask.DEFAULT_SLEEP_SECONDS=3,CyclicTask.DEFAULT_SLEEP_JITTER=.5,CyclicTask.DEFAULT_MAX_ERROR_RETRY=3,CyclicTask.DEFAULT_MAX_TOTAL_RETRY=0;t.CyclicDuty=class CyclicDuty extends CommonDuty{constructor(e){super(e)}};class AbstractDurableRunner extends AbstractRunner{_resume(){this._subcondition.pass(),this._subcondition.reset()}async _pause(){await this._subcondition.done()}}class TaskManager extends AbstractDurableRunner{constructor(e){super(),this._pool=new Map,this._group=new Map,this._poolSize=null!=(e=null==e?void 0:e.poolSize)?e:TaskManager.DEFAULT_POOL_SIZE}cueTask(e){return this._group.get(e)}cueCommonTask(e){return this._group.get(e)}cueCyclicTask(e){return this._group.get(e)}cueAllTasks(){return this._group.values()}async _launch(){await this._running().catch((async e=>{await FutureLogger.warn("Task manager exited.",void 0,{error:e})}))}async _running(){for(;;)0===this._pool.size?await this._pause():await this._recycle(),await l.TimeTool.sleep(10)}_recycle(){var e=this._pool.size-this._poolSize,t=new p.Counter;if(!(e<=0))for(var[s,n]of this._pool.entries())if(n.state.isTerminated&&(this._pool.delete(s),t.up().hasCountedUpTo(e)))break}async _cancel(){await this._group.clear(),await this._desist(FutureError.TASK_MANAGER_ABORTED),await this._purgeTasks()}async purgeTasks(){await this._purgeTasks()}async _purgeTasks(){for(const e of this._pool.keys())await this._cancelTask(e)}async cancelTask(e){await this._cancelTask(e)}async _cancelTask(e){var t=this._pool.get(e);t&&(t.state.isTerminated||await t.deactivate(),await this._pool.delete(e))}async createCommonTask(e){return e=new CommonTask(e),await this._dispatchTask(e),e}async createCyclicTask(e){return e=new CyclicTask(e),await this._dispatchTask(e),e}async _dispatchTask(e){await e.activate(),await this._pool.set(e.id,e),await this._group.set(e.name,e),await this._resume()}}(t.TaskManager=TaskManager).DEFAULT_POOL_SIZE=50;class MutexLocker{constructor(){this._pool=new Map,this._queue=_.Queue.make()}with(e,t){return this.apply().with(e,t)}apply(){return new MutexLock(this)}invoke(e){this._joinPool(e),this._invokeNext()}_joinPool(e){this._pool.has(e.id)||(this._pool.set(e.id,e),this._queue.push(e))}_invokeNext(){var e=this._queue.peek();e&&e.invoke()}revoke(e){this._leavePool(e),this._flushQueue(),this._invokeNext()}_leavePool(e){this._pool.delete(e.id),e.revoke(),e.reset()}_flushQueue(){for(const e of this._queue){if(this._pool.has(e.id))break;this._queue.pull()}}static make(){return new MutexLocker}}t.MutexLocker=MutexLocker;class MutexLock{constructor(e){this._locker=e,this.reset()}get id(){return this._id}reset(){this._id=u.ByteTool.makeRandomBase62String(32),this._condition=new Condition}invoke(){this._condition.pass()}revoke(){this._condition.deny(FutureError.LOCK_RELEASED)}async with(e,t){try{return await this.acquire(t),await e()}finally{await this.release()}}async acquire(e){await Condition.with((async()=>{await this.tryLock(),await this._condition.done()}),e)}async tryLock(){return await this._locker.invoke(this),this._condition.isDone}async release(){return await this._locker.revoke(this),!this._condition.isDone}}class Channel{constructor(e){this._isClosed=!1,this._buffer=_.Queue.make(),this._deliverLocker=MutexLocker.make(),this._receiveLocker=MutexLocker.make(),this._deliverCondition=new Condition,this._receiveCondition=new Condition,this._bufferSize=null!=e?e:Channel.DEFAULT_BUFFER_SIZE}get isClosed(){return this._isClosed}async caution(e){if(this._isClosed)throw FutureError.CHANNEL_CLOSED;await this._deliverWith((async()=>{var t=new ChannelPacket(void 0,e,!0);await this._buffer.push(t)}))}async deliver(e){if(this._isClosed)throw FutureError.CHANNEL_CLOSED;await this._deliverWith((async()=>{var t=new ChannelPacket(e,void 0,!0);await this._buffer.push(t)}))}async _deliverWith(e){await this._deliverLocker.with((async()=>{await this._isDeliverable()&&(await e(),await this._receiveCondition.pass(),await this._receiveCondition.reset())}))}async _isDeliverable(){return!(this._isClosed||this._isBufferFull&&(await this._deliverCondition.done(),this._isClosed))}get _isBufferFull(){return 0<=this._bufferSize&&this._buffer.size>=this._bufferSize}async receive(){let e=new ChannelPacket;return await this._receiveWith((async()=>{e=await this._buffer.pull()})),e}async _receiveWith(e){await this._receiveLocker.with((async()=>{await this._deliverCondition.pass(),await this._isReceivable()&&(await e(),await this._deliverCondition.reset())}))}async _isReceivable(){return!this._isClosed&&this._isBufferEmpty&&await this._receiveCondition.done(),!this._isBufferEmpty}get _isBufferEmpty(){return 0===this._buffer.size}async extract(){var e=await this.receive();if(!e.isValid)throw FutureError.CHANNEL_CLOSED;if(e.error)throw e.error;return e.data}close(){this._isClosed=!0,this._deliverCondition.pass(),this._receiveCondition.pass()}async*[Symbol.asyncIterator](){for(;;){var e=await this.receive();if(!e.isValid)break;if(e.error)throw e.error;yield e.data}}}(t.Channel=Channel).DEFAULT_BUFFER_SIZE=0;class ChannelPacket{constructor(e,t,s=!1){this._data=e,this._error=t,this._isValid=s}get data(){return this._data}get error(){return this._error}get isValid(){return this._isValid}}t.ChannelHub=class ChannelHub{constructor(){this._isClosed=!1,this._lostCenter=new Channel,this._channelPool=new Map}get isClosed(){return this._isClosed}get lostCenter(){return this._lostCenter}async connect(e){if(this._isClosed)throw FutureError.CHANNEL_CLOSED;await this._ensureChannel(e)}async disconnect(e){var t=this._channelPool.get(e);t&&(await t.close(),await this._channelPool.delete(e))}async caution(e,t){if(this._isClosed)throw FutureError.CHANNEL_CLOSED;(e=this._channelPool.get(e))?await e.caution(t):await this._lostCenter.caution(t)}async deliver(e,t){if(this._isClosed)throw FutureError.CHANNEL_CLOSED;(e=this._channelPool.get(e))?await e.deliver(t):await this._lostCenter.deliver(t)}async receive(e,t){if(this._isClosed)return new ChannelPacket;const s=this._ensureChannel(e);return s.receive().finally((async()=>{t&&(await s.close(),await this._channelPool.delete(e))}))}async extract(e,t){if(this._isClosed)throw FutureError.CHANNEL_CLOSED;const s=this._ensureChannel(e);return s.extract().finally((async()=>{t&&(await s.close(),await this._channelPool.delete(e))}))}close(){this._isClosed=!0;for(const e of this._channelPool.values())e.close();this._lostCenter.close(),this._channelPool.clear()}_ensureChannel(e){let t=this._channelPool.get(e);return t||(t=new Channel,this._channelPool.set(e,t)),t}};class FutureError{}(t.FutureError=FutureError).OPERATION_TIMEOUT=new d.InternalError(c.MessageCode.EMU010),FutureError.CONDITION_DONE=new d.InternalError(c.MessageCode.EMU011),FutureError.CONDITION_UNDONE=new d.InternalError(c.MessageCode.EMU012),FutureError.PRECONDITION_DONE=new d.InternalError(c.MessageCode.EMU013),FutureError.TASK_CANCELLED=new d.InternalError(c.MessageCode.EMU014),FutureError.TASK_LOOP_CANCELLED=new d.InternalError(c.MessageCode.EMU015),FutureError.TASK_RETRY_EXCEEDED=new d.InternalError(c.MessageCode.EMU016),FutureError.TASK_MANAGER_ABORTED=new d.InternalError(c.MessageCode.EMU017),FutureError.LOCK_RELEASED=new d.InternalError(c.MessageCode.EMU018),FutureError.CHANNEL_CLOSED=new d.InternalError(c.MessageCode.EMU019);class FutureLogger extends h.Logger{static _print(e,t,s,n){var o=null==n?void 0:n.error;o&&this.TRIVIAL_ERRORS.has(o)&&(e=h.LogLevelName.DEBUG),super._print(e,t,s,a.default.merge({frame:1},n))}}FutureLogger.TRIVIAL_ERRORS=new Set([FutureError.CONDITION_DONE,FutureError.TASK_CANCELLED,FutureError.TASK_LOOP_CANCELLED,FutureError.TASK_MANAGER_ABORTED,FutureError.CHANNEL_CLOSED])},287:function(e,t,s){"use strict";var n,a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevelName=t.Logger=void 0;const o=a(s(6486)),c=s(2065),u=s(93),l=s(2016);class LogLevel{constructor(e,t,s,n){this._name=e,this._weight=t,this._status=s,this._stream=n}get name(){return this._name}get weight(){return this._weight}get status(){return this._status}get stream(){return this._stream}}var d;(d=n=n||{}).TRACE="trace",d.TRACK="track",d.DEBUG="debug",d.INFO="info",d.WARN="warning",d.ERROR="error",d.CRITICAL="critical",t.LogLevelName=n;const h=new Map([[n.TRACE,new LogLevel(n.TRACE,1,!0,console.trace.name)],[n.TRACK,new LogLevel(n.TRACK,2,!0,console.debug.name)],[n.DEBUG,new LogLevel(n.DEBUG,3,!0,console.debug.name)],[n.INFO,new LogLevel(n.INFO,4,!0,console.info.name)],[n.WARN,new LogLevel(n.WARN,5,!1,console.warn.name)],[n.ERROR,new LogLevel(n.ERROR,6,!1,console.error.name)],[n.CRITICAL,new LogLevel(n.CRITICAL,99,!0,console.warn.name)]]);(t.Logger=class Logger{static get displayLevel(){return this._displayLogLevel.name}static set displayLevel(e){this._displayLogLevel=h.get(e)}static trace(e,t,s){this._print(n.TRACE,e,t,s)}static track(e,t,s){this._print(n.TRACK,e,t,s)}static debug(e,t,s){this._print(n.DEBUG,e,t,s)}static info(e,t,s){this._print(n.INFO,e,t,s)}static warn(e,t,s){this._print(n.WARN,e,t,s)}static error(e,t,s){this._print(n.ERROR,e,t,s)}static critical(e,t,s){this._print(n.CRITICAL,e,t,s)}static _print(e,t,s,n){e=h.get(e),this._isDisplayable(e)&&(0,console[e.stream])(new LogRecord(e,t,s,n).toString())}static _isDisplayable(e){return e.weight>=this._displayLogLevel.weight}})._displayLogLevel=h.get(n.INFO);class LogRecord{constructor(e,t,s,n){this._level=e,this._message=t,this._params=s,this._options=n,this._context={},this._initialize()}_initialize(){this._setLevel(),this._setMessage(),this._setParams(),this._setMeta(),this._setTime(),this._setStatus()}_setLevel(){this._context.level=this._level.name}_setMessage(){var e=6+(null!=(e=null==(e=this._options)?void 0:e.frame)?e:0),t=(e=(t=(new Error).stack.split("\n"))[Math.min(e,t.length-1)].trimStart(),this._message);this._context.msg=`[${e}] `+t}_setParams(){var e,t=o.default.merge({},this._params);this._mergeErrorParams(null==(e=this._options)?void 0:e.error,t),this._context.params=t}_mergeErrorParams(e,t){e&&e instanceof l.InternalError&&(e.cause&&this._mergeErrorParams(e.cause,t),o.default.merge(t,e.params))}_setMeta(){var e;this._context.meta={traceId:null==(e=this._options)?void 0:e.traceID,error:null==(e=null==(e=this._options)?void 0:e.error)?void 0:e.message}}_setTime(){this._context.time=u.TimeTool.makeNowFstring()}_setStatus(){this._context.status=this._level.status}toString(){return c.JSONTool.dumps(this._context)}}},1139:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=t.Queue=void 0;class Queue{constructor(){this._size=0,this.clear()}get size(){return this._size}push(e){e=new QueueNode(e),this._tail?this._tail.next=e:this._head=e,this._tail=e,this._size++}pull(){var e;if(this._head)return e=this._head,this._head=e.next,this._size--,this._head||(this._tail=void 0),e.data}poll(){var e;if(this._head)return e=this._head,1<this._size&&(this._head=e.next,(this._tail.next=e).next=void 0,this._tail=e),e.data}peek(){var e;return null==(e=this._head)?void 0:e.data}clear(){this._size=0,this._head=void 0,this._tail=void 0}*iterator(){let e=this._head;for(;e;)yield new QueueIteratee(e),e=e.next}*[Symbol.iterator](){let e=this._head;for(;e;)yield e.data,e=e.next}static make(){return new Queue}static from(e){var t=new Queue;for(const s of e)t.push(s);return t}}t.Queue=Queue;class QueueNode{constructor(e){this._data=e}get data(){return this._data}get next(){return this._next}set next(e){this._next=e}}class QueueIteratee{constructor(e){this._node=e}get value(){return this._node.data}}class Deque{constructor(){this._size=0,this.clear()}get size(){return this._size}push(e){e=new DequeNode(e),this._tail?(this._tail.next=e).prev=this._tail:this._head=e,this._tail=e,this._size++}pull(){var e;if(this._head)return e=this._head,this._head=e.next,this._size--,this._head?this._head.prev=void 0:this._tail=void 0,e.data}poll(){var e;if(this._head)return e=this._head,1<this._size&&(this._head=e.next,this._head.prev=void 0,(this._tail.next=e).prev=this._tail,e.next=void 0,this._tail=e),e.data}peek(){var e;return null==(e=this._head)?void 0:e.data}rpush(e){e=new DequeNode(e),this._head?((this._head.prev=e).next=this._head,this._head=e):(this._head=e,this._tail=e),this._size++}rpull(){var e;if(this._tail)return e=this._tail,this._tail=e.prev,this._size--,this._tail?this._tail.next=void 0:this._head=void 0,e.data}rpoll(){var e;if(this._tail)return e=this._tail,1<this._size&&(this._tail=e.prev,this._tail.next=void 0,(this._head.prev=e).next=this._head,e.prev=void 0,this._head=e),e.data}rpeek(){var e;return null==(e=this._tail)?void 0:e.data}drop(e){switch(e){case this._head:this.pull();break;case this._tail:this.rpull();break;default:e.prev.next=e.next,e.next.prev=e.prev,this._size--}}clear(){this._size=0,this._head=void 0,this._tail=void 0}*iterator(){let e=this._head;for(;e;)yield new DequeIteratee(e,this),e=e.next}*[Symbol.iterator](){let e=this._head;for(;e;)yield e.data,e=e.next}static make(){return new Deque}static from(e){var t=new Deque;for(const s of e)t.push(s);return t}}t.Deque=Deque;class DequeNode{constructor(e){this._data=e}get data(){return this._data}get prev(){return this._prev}set prev(e){this._prev=e}get next(){return this._next}set next(e){this._next=e}}class DequeIteratee{constructor(e,t){this._node=e,this._deque=t,this._isDropped=!1}get value(){return this._node.data}drop(){this._isDropped||(this._deque.drop(this._node),this._isDropped=!0)}}},9283:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Timeouter=t.Timer=t.Counter=void 0;const n=s(3050);t.Counter=class Counter{constructor(e=0,t=1){this._initial=e,this._interval=t,this.reset()}get count(){return this._count}reset(){return this._count=this._initial,this}up(){return this._count+=this._interval,this}down(){return this._count-=this._interval,this}plus(e){return this._count+=e,this}minus(e){return this._count-=e,this}hasCountedOver(e){return this._count>e}hasCountedBelow(e){return this._count<e}hasCountedUpTo(e){return this._count>=e}hasCountedDownTo(e){return this._count<=e}};t.Timer=class Timer{constructor(){this.reset()}get initialTime(){return this._initialTime}get stampedTime(){return this._stampedTime}get elapsedTimeS(){return this.elapsedTimeMs/1e3}get elapsedTimeMs(){return this._stampedTime-this._initialTime}reset(){return this._initialTime=n.performance.now(),this._stampedTime=this._initialTime,this}stamp(){return this._stampedTime=n.performance.now(),this}hasElapsedTimeS(e){return this.elapsedTimeS>=e}hasElapsedTimeMs(e){return this.elapsedTimeMs>=e}};t.Timeouter=class Timeouter{async apply(e){return e().finally((async()=>{await this.reset()}))}setup(e,t){this._timeoutID=setTimeout(e,1e3*t)}reset(){null!=this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null)}}},27:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbortSignal=t.AbortController=void 0;let n=s(7729);const a=(n=n||s(4850)).AbortController,o=(t.AbortController=a,n.AbortSignal);t.AbortSignal=o},7729:e=>{"use strict";let t=null;globalThis&&(t={AbortController:globalThis.AbortController,AbortSignal:globalThis.AbortSignal},Object.values(t).some((e=>null==e)))&&(t=null),e.exports=t},2188:(e,t,s)=>{"use strict";var n;let a=null;if(globalThis){const e=null!=(n=globalThis.crypto)?n:globalThis.msCrypto;if(a={getRandomValues:null==e?void 0:e.getRandomValues},Object.values(a).some((e=>null==e)))a=null;else{const t=s(8764).Buffer;a.randomBytes=s=>a.getRandomValues.call(e,new t(s))}}e.exports=a},5016:e=>{"use strict";let t=null;(t=globalThis&&(t={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response},Object.values(t).some((e=>null==e)))?null:t)&&null==globalThis.ReadableStream.prototype[Symbol.asyncIterator]&&(globalThis.ReadableStream.prototype[Symbol.asyncIterator]=async function*(){var e=this.getReader();try{for(;;){var t=await e.read();if(t.done)break;yield t.value}}finally{e.releaseLock()}}),e.exports=t},194:e=>{"use strict";let t=null;globalThis&&(t={performance:globalThis.performance,PerformanceObserver:globalThis.PerformanceObserver},Object.values(t).some((e=>null==e)))&&(t=null),e.exports=t},8845:e=>{"use strict";let t=null;globalThis&&(t={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription},Object.values(t).some((e=>null==e)))&&(t=null),e.exports=t},8700:e=>{"use strict";let t=null;globalThis&&(t={WebSocket:globalThis.WebSocket},Object.values(t).some((e=>null==e)))&&(t=null),e.exports=t},8925:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=void 0;let n=s(896);const a=(n=n||s(8764)).Buffer;t.Buffer=a},8710:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomBytes=void 0;let n=s(2188);const a=(n=n||s(5865)).randomBytes;t.randomBytes=a},8351:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Response=t.Request=t.Headers=t.fetch=void 0;let n=s(5016);const a=(n=n||s(1503)).default,o=(t.fetch=a,n.Headers),c=(t.Headers=o,n.Request),u=(t.Request=c,n.Response);t.Response=u},896:e=>{"use strict";let t=null;globalThis&&(t={Buffer:globalThis.Buffer},Object.values(t).some((e=>null==e)))&&(t=null),e.exports=t},1934:(e,t,s)=>{"use strict";let n=s(8426);0===Object.getOwnPropertyNames(n).length&&(n=null),e.exports=n},9706:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.path=void 0;let n=s(1934);const a=n=n||s(6470);t.path=a},3050:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PerformanceObserver=t.performance=void 0;let n=s(194);const a=(n=n||s(9917)).performance,o=(t.performance=a,n.PerformanceObserver);t.PerformanceObserver=o},9770:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTCSessionDescription=t.RTCIceCandidate=t.RTCPeerConnection=void 0;let n=s(8845);const a=(n=n||s(9298)).RTCPeerConnection,o=(t.RTCPeerConnection=a,n.RTCIceCandidate),c=(t.RTCIceCandidate=o,n.RTCSessionDescription);t.RTCSessionDescription=c},97:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocket=void 0;let n=s(8700);const a=(n=n||s(7349)).WebSocket;t.WebSocket=a},3267:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FlowID=t.AbstractFlow=void 0;const a=n(s(6486)),o=s(4239),c=s(6940),u=s(93),l=s(2016),d=s(287);t.AbstractFlow=class AbstractFlow{constructor(e){var t;this._storage=new Map,this._id=null!=(t=null==e?void 0:e.id)?t:FlowID.make(),this._content=null==e?void 0:e.content}async _bypass(e){return e._id=this._id,e.process()}_contain(e){return this._storage.has(e)}_require(e){if(this._storage.has(e))return this._storage.get(e);throw new l.InternalError(o.MessageCode.EMU050,void 0,{key:e})}_expose(e,t){this._storage.set(e,t)}_remove(...e){for(const t of e)this._storage.delete(t)}_logTrace(e,t,s){d.Logger.trace(e,t,this._makeLogOptions(s))}_logTrack(e,t,s){d.Logger.track(e,t,this._makeLogOptions(s))}_logDebug(e,t,s){d.Logger.debug(e,t,this._makeLogOptions(s))}_logInfo(e,t,s){d.Logger.info(e,t,this._makeLogOptions(s))}_logWarn(e,t,s){d.Logger.warn(e,t,this._makeLogOptions(s))}_logError(e,t,s){d.Logger.error(e,t,this._makeLogOptions(s))}_logCritical(e,t,s){d.Logger.critical(e,t,this._makeLogOptions(s))}_makeLogOptions(e){return a.default.merge({traceID:this._id,frame:1},e)}};class FlowID{static make(){return`flow-${u.TimeTool.makeNowFstring(this.TIME_PART_FORMAT)}-`+c.ByteTool.makeRandomBase36String(this.RANDOM_PART_LENGTH).toLowerCase()}}(t.FlowID=FlowID).TIME_PART_FORMAT="YYYYMMDDHHmmss",FlowID.RANDOM_PART_LENGTH=20},5507:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Processor=void 0;const n=s(4239),a=s(93),o=s(2016),c=s(287),u=s(9283);class Processor{constructor(e){var t;this._options=e,this._state=new ProcessorState,this._processStats=new Array,this._gracefulTimeout=null!=(t=null==e?void 0:e.gracefulTimeout)?t:Processor.DEFAULT_GRACEFUL_TIMEOUT,this._heartbeatInterval=null!=(t=null==e?void 0:e.heartbeatInterval)?t:Processor.DEFAULT_HEARTBEAT_INTERVAL}get state(){return this._state}get processStats(){return this._processStats}async register(e){await this._processStats.push(new ProcessStat(e))}async activate(){await this._initProcesses(),await this._startProcesses(),await this._serveProcesses()}async deactivate(){await this._state.toExiting()}async _initProcesses(){for(const e of this._processStats)await e.initProcess();await this._state.toRunning()}async _startProcesses(){for(const e of this._processStats)e.startProcess(this._state).then((async()=>{await this._state.toExiting()}))}async _serveProcesses(){for(var e=new u.Timer;;){if(this._state.isExiting){await this._emitShutInfo(),await this._waitProcesses(),await this._emitExitInfo();break}e.stamp().hasElapsedTimeS(this._heartbeatInterval)&&(await this._emitBeatInfo(),await e.reset()),await a.TimeTool.sleep(1)}await this._state.toExited()}async _emitBeatInfo(){var e=this._makeProcessStatInfos();await c.Logger.info("Processor heartbeats.",{stats:e})}async _emitShutInfo(){await c.Logger.info(`Processor will graceful shutdown in ${this._gracefulTimeout} seconds.`)}async _waitProcesses(){for(var e=new u.Timer;!(await this._emitBeatInfo(),this._isEveryProcessExited||e.stamp().hasElapsedTimeS(this._gracefulTimeout));)await a.TimeTool.sleep(1)}async _emitExitInfo(){var e=this._makeProcessStatInfos();this._isEveryProcessExited?await c.Logger.info("Processor graceful shutdown normally.",{stats:e}):await c.Logger.warn("Processor graceful shutdown abnormally.",{stats:e})}_makeProcessStatInfos(){return this._processStats.map((e=>e.toString()))}get _isEveryProcessExited(){return this._processStats.every((e=>!e.isActive))}async throwIfError(){var e=this._processStats.filter((e=>e.error)).map((e=>e.error));throw new o.InternalError(n.MessageCode.EMU060,void 0,{errors:e})}}(t.Processor=Processor).DEFAULT_GRACEFUL_TIMEOUT=30,Processor.DEFAULT_HEARTBEAT_INTERVAL=300;class ProcessStat{constructor(e){this._process=e,this._isActive=!1}get error(){return this._error}get isActive(){return this._isActive}async initProcess(){await this._process.initialize().then((()=>{this._isActive=!0}))}async startProcess(e){await this._process.startDaemon(e).catch((e=>{this._error=e})).then((()=>{this._isActive=!1})).finally((()=>{var e=this.toString(),t=this._error;t?c.Logger.error("Process exit failed.",{stat:e},{error:t}):c.Logger.info("Process exit succeeded.",{stat:e})}))}toString(){var e=new Array;return e.push(`process: <${this._process.constructor.name}>`),e.push("isActive: "+this.isActive),`<${this.constructor.name}| ${e.join(", ")}>`}}class ProcessorState{constructor(){this._name=ProcessorStateName.INITIAL}get isInitial(){return this._name===ProcessorStateName.INITIAL}get isRunning(){return this._name===ProcessorStateName.RUNNING}get isExiting(){return this._name===ProcessorStateName.EXITING}get isExited(){return this._name===ProcessorStateName.EXITED}toInitial(){this._name=ProcessorStateName.INITIAL}toRunning(){this._name=ProcessorStateName.RUNNING}toExiting(){this._name=ProcessorStateName.EXITING}toExited(){this._name=ProcessorStateName.EXITED}}class ProcessorStateName{}ProcessorStateName.INITIAL="initail",ProcessorStateName.RUNNING="running",ProcessorStateName.EXITING="exiting",ProcessorStateName.EXITED="exited"},964:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.contentKinds=t.Requester=t.Carrier=t.Payload=void 0;const a=n(s(6486)),o=s(5519),c=s(4239),u=s(6796),l=s(2065),d=s(302),h=s(1135),_=s(2016),p=s(9283),f=s(27),m=s(8351);class Payload{constructor(e,t,s,n){this._method=e,this._path=t,this._options=s,this._defaults=n,this._timeouter=new p.Timeouter,this._json={},this._initialize()}get url(){return this._url}get method(){return this._method}get scheme(){return this._scheme}get host(){return this._host}get base(){return this._base}get path(){return this._path}get queries(){return this._queries}get headers(){return this._headers}get body(){return this._body}get aborter(){return this._aborter}get timeout(){return this._timeout}get initial(){return this._initial}get backoff(){return this._backoff}get request(){return this._request}set request(e){this._request=e}get response(){return this._response}set response(e){this._response=e}get error(){return this._error}set error(e){this._error=e}get status(){return this._status}set status(e){this._status=e}get result(){return this._result}set result(e){this._result=e}get timeouter(){return this._timeouter}set timeouter(e){this._timeouter=e}get options(){return this._options}get defaults(){return this._defaults}get shouldThrowError(){return this._shouldThrowError}get validationStatus(){return this._validationStatus}get unexpectedStatus(){return this._unexpectedStatus}get hasSuccess(){return!this.hasFailure}get hasFailure(){return this.hasValidationFailure||this.hasUnexpectedFailure}get hasValidationFailure(){return this._response.status>=this._validationStatus}get hasUnexpectedFailure(){return this._response.status>=this._unexpectedStatus}_initialize(){this._setURL(),this._url||(this._setScheme(),this._setHost(),this._setBase(),this._buildURL()),this._setQueries(),this._setHeaders(),this._setBody(),this._setAborter(),this._setTimeout(),this._setInitial(),this._setBackoff(),this._setShouldThrowError(),this._setValidationStatus(),this._setUnexpectedStatus()}_setURL(){this._path instanceof URL?this._url=this._path:this._path.match(Payload.SCHEME_REGEX)&&(this._url=new URL(this._path))}_setScheme(){var e;this._scheme=null!=(e=null!=(e=null==(e=this._options)?void 0:e.scheme)?e:null==(e=this._defaults)?void 0:e.scheme)?e:Payload.DEFAULT_SCHEME}_setHost(){var e;this._host=null!=(e=null==(e=this._options)?void 0:e.host)?e:null==(e=this._defaults)?void 0:e.host}_setBase(){var e=null!=(e=null!=(e=null==(e=this._options)?void 0:e.base)?e:null==(e=this._defaults)?void 0:e.base)?e:Payload.DEFAULT_BASE;this._base=d.StringTool.prefix(a.default.trimEnd(e,"/"),"/")}_buildURL(){var e=a.default.trimStart(this._path,"/"),t=d.StringTool.suffix(this._scheme+"://"+this._host+this._base,"/");this._url=new URL(e,t)}_setQueries(){var e,t,s=a.default.merge({},null==(s=this._defaults)?void 0:s.queries,null==(s=this._options)?void 0:s.queries);for([e,t]of(this._queries=this._url.searchParams,Object.entries(s)))if(t instanceof Array)for(const s of t)this._queries.append(e,""+s);else this._queries.append(e,""+t)}_setHeaders(){var e,t,s=a.default.merge({},null==(s=this._defaults)?void 0:s.headers,null==(s=this._options)?void 0:s.headers);for([e,t]of(this._headers=new m.Headers,Object.entries(s)))if(t instanceof Array)for(const s of t)this._headers.append(e,""+s);else this._headers.append(e,""+t)}_setBody(){var e;this._body=null!=(e=null==(e=this._options)?void 0:e.body)?e:null==(e=this._defaults)?void 0:e.body}_setAborter(){var e;this._aborter=null!=(e=null==(e=this._options)?void 0:e.aborter)?e:new f.AbortController}_setTimeout(){var e;this._timeout=null!=(e=null==(e=this._options)?void 0:e.timeout)?e:null==(e=this._defaults)?void 0:e.timeout}_setInitial(){var e;this._initial=a.default.merge({},null==(e=this._defaults)?void 0:e.initial,null==(e=this._options)?void 0:e.initial)}_setBackoff(){var e=a.default.merge({},null==(e=this._defaults)?void 0:e.backoffOptions,null==(e=this._options)?void 0:e.backoffOptions);a.default.isEmpty(e)||(this._backoff=new h.RetryBackoff(e))}_setShouldThrowError(){var e;this._shouldThrowError=null!=(e=null!=(e=null==(e=this._options)?void 0:e.shouldThrowError)?e:null==(e=this._defaults)?void 0:e.shouldThrowError)?e:Payload.DEFAULT_SHOULD_THROW_ERROR}_setValidationStatus(){var e;this._validationStatus=null!=(e=null!=(e=null==(e=this._options)?void 0:e.validationStatus)?e:null==(e=this._defaults)?void 0:e.validationStatus)?e:Payload.DEFAULT_VALIDATION_STATUS}_setUnexpectedStatus(){var e;this._unexpectedStatus=null!=(e=null!=(e=null==(e=this._options)?void 0:e.unexpectedStatus)?e:null==(e=this._defaults)?void 0:e.unexpectedStatus)?e:Payload.DEFAULT_UNEXPECTED_STATUS}toJSON(){const{_options:e,_defaults:t,...s}=this;return this._json=l.JSONTool.clear(this._json),this._json=a.default.merge(this._json,s),this._json}}(t.Payload=Payload).SCHEME_REGEX=/^http(s)?:\/\//,Payload.DEFAULT_SCHEME="https",Payload.DEFAULT_BASE="/",Payload.DEFAULT_SHOULD_THROW_ERROR=!0,Payload.DEFAULT_VALIDATION_STATUS=o.StatusCodes.BAD_REQUEST,Payload.DEFAULT_UNEXPECTED_STATUS=o.StatusCodes.INTERNAL_SERVER_ERROR;class Carrier{get payload(){return this._payload}async withRetry(e){var t=this._payload;t.backoff?await t.backoff.apply(e):await e()}async buildPayload(e,t,s,n){this._payload=new Payload(e,t,s,n)}async resetPayload(){var e=this._payload;e.request=null,e.response=null,e.error=null,e.status=null,e.result=null,e.timeouter=new p.Timeouter}async buildRequest(){var e=this._payload;e.request=new m.Request(e.url,a.default.merge({},e.initial,{method:e.method,headers:e.headers,body:e.body,signal:e.aborter.signal}))}async setupTimeout(){const e=this._payload;null!=e.timeout&&e.timeouter.setup((async()=>{await e.aborter.abort()}),e.timeout)}async startRequest(){const e=this._payload;await e.timeouter.apply((async()=>{try{var t=await(0,m.fetch)(e.request);e.status=t.status,e.response=t}catch(t){e.error=t}}))}async buildResponse(){var e=this._payload;if(e.response){var t=e.response.clone(),s=null==(s=t.headers.get(u.HTTPHeader.CONTENT_TYPE))?void 0:s.split(";")[0].toLowerCase();switch(y.get(s)){case u.ContentKind.JSON:e.result=await t.json();break;case u.ContentKind.TEXT:e.result=await t.text();break;case u.ContentKind.FORM:e.result=new URLSearchParams(await t.text());break;default:e.result=e.response}}}async buildError(){var e=this._payload;let t=e.error;t?t=new _.InternalError(c.MessageCode.EMU070,t,{payload:e}):e.hasUnexpectedFailure?t=new _.UnexpectedError(c.MessageCode.EMU071,void 0,{payload:e}):e.hasValidationFailure&&(t=new _.ValidationError(c.MessageCode.WMU072,void 0,{payload:e})),e.error=t}async throwIfError(){var e=this._payload;if(e.shouldThrowError){if(!e.response)throw this._finalizeError(e.error);if(e.hasUnexpectedFailure)throw e.error;if(e.hasValidationFailure)throw this._finalizeError(e.error)}}_finalizeError(e){return this._payload.backoff?new h.PermanentError(e):e}}t.Carrier=Carrier;class Requester{constructor(e){var t;this._defaults=null!=(t=null==e?void 0:e.defaults)?t:{},this._carrierClass=null!=(t=null==e?void 0:e.carrierClass)?t:Requester.DEFAULT_CARRIER_CLASS}get defaults(){return this._defaults}get carrierClass(){return this._carrierClass}async get(e,t){return this.request(u.HTTPMethod.GET,e,t)}async head(e,t){return this.request(u.HTTPMethod.HEAD,e,t)}async post(e,t){return this.request(u.HTTPMethod.POST,e,t)}async put(e,t){return this.request(u.HTTPMethod.PUT,e,t)}async patch(e,t){return this.request(u.HTTPMethod.PATCH,e,t)}async delete(e,t){return this.request(u.HTTPMethod.DELETE,e,t)}async trace(e,t){return this.request(u.HTTPMethod.TRACE,e,t)}async options(e,t){return this.request(u.HTTPMethod.OPTIONS,e,t)}async request(e,t,s){const n=new this._carrierClass;return await n.buildPayload(e,t,s,this._defaults),await n.withRetry((async()=>{await n.resetPayload(),await n.buildRequest(),await n.setupTimeout(),await n.startRequest(),await n.buildResponse(),await n.buildError(),await n.throwIfError()})),n.payload}static async get(e,t){return(new this).get(e,t)}static async head(e,t){return(new this).head(e,t)}static async post(e,t){return(new this).post(e,t)}static async put(e,t){return(new this).put(e,t)}static async patch(e,t){return(new this).patch(e,t)}static async delete(e,t){return(new this).delete(e,t)}static async trace(e,t){return(new this).trace(e,t)}static async options(e,t){return(new this).options(e,t)}static async request(e,t,s){return(new this).request(e,t,s)}}(t.Requester=Requester).DEFAULT_CARRIER_CLASS=Carrier;const y=new Map([[u.ContentType.XML,u.ContentKind.TEXT],[u.ContentType.JSON,u.ContentKind.JSON],[u.ContentType.TEXT,u.ContentKind.TEXT],[u.ContentType.FORM,u.ContentKind.FORM],[u.ContentType.HTML,u.ContentKind.TEXT]]);t.contentKinds=y},4537:e=>{"use strict";e.exports=function(e,t){var s=new Array(arguments.length-1),n=0,a=2,o=!0;for(;a<arguments.length;)s[n++]=arguments[a++];return new Promise((function(a,c){s[n]=function(e){if(o)if(o=!1,e)c(e);else{for(var t=new Array(arguments.length-1),s=0;s<t.length;)t[s++]=arguments[s];a.apply(null,t)}};try{e.apply(t||null,s)}catch(e){o&&(o=!1,c(e))}}))}},7419:(e,t)=>{"use strict";var s=t;s.length=function(e){var t=e.length;if(!t)return 0;for(var s=0;--t%4>1&&"="===e.charAt(t);)++s;return Math.ceil(3*e.length)/4-s};for(var n=new Array(64),a=new Array(123),o=0;o<64;)a[n[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;s.encode=function(e,t,s){for(var a,o=null,c=[],u=0,l=0;t<s;){var d=e[t++];switch(l){case 0:c[u++]=n[d>>2],a=(3&d)<<4,l=1;break;case 1:c[u++]=n[a|d>>4],a=(15&d)<<2,l=2;break;case 2:c[u++]=n[a|d>>6],c[u++]=n[63&d],l=0}u>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,c)),u=0)}return l&&(c[u++]=n[a],c[u++]=61,1===l&&(c[u++]=61)),o?(u&&o.push(String.fromCharCode.apply(String,c.slice(0,u))),o.join("")):String.fromCharCode.apply(String,c.slice(0,u))};var c="invalid encoding";s.decode=function(e,t,s){for(var n,o=s,u=0,l=0;l<e.length;){var d=e.charCodeAt(l++);if(61===d&&u>1)break;if(void 0===(d=a[d]))throw Error(c);switch(u){case 0:n=d,u=1;break;case 1:t[s++]=n<<2|(48&d)>>4,n=d,u=2;break;case 2:t[s++]=(15&n)<<4|(60&d)>>2,n=d,u=3;break;case 3:t[s++]=(3&n)<<6|d,u=0}}if(1===u)throw Error(c);return s-o},s.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},5124:e=>{"use strict";function t(e,s){"string"==typeof e&&(s=e,e=void 0);var n=[];function a(e){if("string"!=typeof e){var s=o();if(t.verbose&&console.log("codegen: "+s),s="return "+s,e){for(var c=Object.keys(e),u=new Array(c.length+1),l=new Array(c.length),d=0;d<c.length;)u[d]=c[d],l[d]=e[c[d++]];return u[d]=s,Function.apply(null,u).apply(null,l)}return Function(s)()}for(var h=new Array(arguments.length-1),_=0;_<h.length;)h[_]=arguments[++_];if(_=0,e=e.replace(/%([%dfijs])/g,(function(e,t){var s=h[_++];switch(t){case"d":case"f":return String(Number(s));case"i":return String(Math.floor(s));case"j":return JSON.stringify(s);case"s":return String(s)}return"%"})),_!==h.length)throw Error("parameter count mismatch");return n.push(e),a}function o(t){return"function "+(t||s||"")+"("+(e&&e.join(",")||"")+"){\n  "+n.join("\n  ")+"\n}"}return a.toString=o,a}e.exports=t,t.verbose=!1},9211:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,s){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:s||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var s=this._listeners[e],n=0;n<s.length;)s[n].fn===t?s.splice(n,1):++n;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var s=[],n=1;n<arguments.length;)s.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,s)}return this}},9054:(e,t,s)=>{"use strict";e.exports=o;var n=s(4537),a=s(7199)("fs");function o(e,t,s){return"function"==typeof t?(s=t,t={}):t||(t={}),s?!t.xhr&&a&&a.readFile?a.readFile(e,(function(n,a){return n&&"undefined"!=typeof XMLHttpRequest?o.xhr(e,t,s):n?s(n):s(null,t.binary?a:a.toString("utf8"))})):o.xhr(e,t,s):n(o,this,e,t)}o.xhr=function(e,t,s){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState){if(0!==n.status&&200!==n.status)return s(Error("status "+n.status));if(t.binary){var e=n.response;if(!e){e=[];for(var a=0;a<n.responseText.length;++a)e.push(255&n.responseText.charCodeAt(a))}return s(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return s(null,n.responseText)}},t.binary&&("overrideMimeType"in n&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.responseType="arraybuffer"),n.open("GET",e),n.send()}},945:e=>{"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),s=new Uint8Array(t.buffer),n=128===s[3];function a(e,n,a){t[0]=e,n[a]=s[0],n[a+1]=s[1],n[a+2]=s[2],n[a+3]=s[3]}function o(e,n,a){t[0]=e,n[a]=s[3],n[a+1]=s[2],n[a+2]=s[1],n[a+3]=s[0]}function c(e,n){return s[0]=e[n],s[1]=e[n+1],s[2]=e[n+2],s[3]=e[n+3],t[0]}function u(e,n){return s[3]=e[n],s[2]=e[n+1],s[1]=e[n+2],s[0]=e[n+3],t[0]}e.writeFloatLE=n?a:o,e.writeFloatBE=n?o:a,e.readFloatLE=n?c:u,e.readFloatBE=n?u:c}():function(){function t(e,t,s,n){var a=t<0?1:0;if(a&&(t=-t),0===t)e(1/t>0?0:2147483648,s,n);else if(isNaN(t))e(2143289344,s,n);else if(t>34028234663852886e22)e((a<<31|2139095040)>>>0,s,n);else if(t<11754943508222875e-54)e((a<<31|Math.round(t/1401298464324817e-60))>>>0,s,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((a<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,s,n)}}function c(e,t,s){var n=e(t,s),a=2*(n>>31)+1,o=n>>>23&255,c=8388607&n;return 255===o?c?NaN:a*(1/0):0===o?1401298464324817e-60*a*c:a*Math.pow(2,o-150)*(c+8388608)}e.writeFloatLE=t.bind(null,s),e.writeFloatBE=t.bind(null,n),e.readFloatLE=c.bind(null,a),e.readFloatBE=c.bind(null,o)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),s=new Uint8Array(t.buffer),n=128===s[7];function a(e,n,a){t[0]=e,n[a]=s[0],n[a+1]=s[1],n[a+2]=s[2],n[a+3]=s[3],n[a+4]=s[4],n[a+5]=s[5],n[a+6]=s[6],n[a+7]=s[7]}function o(e,n,a){t[0]=e,n[a]=s[7],n[a+1]=s[6],n[a+2]=s[5],n[a+3]=s[4],n[a+4]=s[3],n[a+5]=s[2],n[a+6]=s[1],n[a+7]=s[0]}function c(e,n){return s[0]=e[n],s[1]=e[n+1],s[2]=e[n+2],s[3]=e[n+3],s[4]=e[n+4],s[5]=e[n+5],s[6]=e[n+6],s[7]=e[n+7],t[0]}function u(e,n){return s[7]=e[n],s[6]=e[n+1],s[5]=e[n+2],s[4]=e[n+3],s[3]=e[n+4],s[2]=e[n+5],s[1]=e[n+6],s[0]=e[n+7],t[0]}e.writeDoubleLE=n?a:o,e.writeDoubleBE=n?o:a,e.readDoubleLE=n?c:u,e.readDoubleBE=n?u:c}():function(){function t(e,t,s,n,a,o){var c=n<0?1:0;if(c&&(n=-n),0===n)e(0,a,o+t),e(1/n>0?0:2147483648,a,o+s);else if(isNaN(n))e(0,a,o+t),e(2146959360,a,o+s);else if(n>17976931348623157e292)e(0,a,o+t),e((c<<31|2146435072)>>>0,a,o+s);else{var u;if(n<22250738585072014e-324)e((u=n/5e-324)>>>0,a,o+t),e((c<<31|u/4294967296)>>>0,a,o+s);else{var l=Math.floor(Math.log(n)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(u=n*Math.pow(2,-l))>>>0,a,o+t),e((c<<31|l+1023<<20|1048576*u&1048575)>>>0,a,o+s)}}}function c(e,t,s,n,a){var o=e(n,a+t),c=e(n,a+s),u=2*(c>>31)+1,l=c>>>20&2047,d=4294967296*(1048575&c)+o;return 2047===l?d?NaN:u*(1/0):0===l?5e-324*u*d:u*Math.pow(2,l-1075)*(d+4503599627370496)}e.writeDoubleLE=t.bind(null,s,0,4),e.writeDoubleBE=t.bind(null,n,4,0),e.readDoubleLE=c.bind(null,a,0,4),e.readDoubleBE=c.bind(null,o,4,0)}(),e}function s(e,t,s){t[s]=255&e,t[s+1]=e>>>8&255,t[s+2]=e>>>16&255,t[s+3]=e>>>24}function n(e,t,s){t[s]=e>>>24,t[s+1]=e>>>16&255,t[s+2]=e>>>8&255,t[s+3]=255&e}function a(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function o(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},7199:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},8626:(e,t)=>{"use strict";var s=t,n=s.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},a=s.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),s=n(e),a="";s&&(a=t.shift()+"/");for(var o=0;o<t.length;)".."===t[o]?o>0&&".."!==t[o-1]?t.splice(--o,2):s?t.splice(o,1):++o:"."===t[o]?t.splice(o,1):++o;return a+t.join("/")};s.resolve=function(e,t,s){return s||(t=a(t)),n(t)?t:(s||(e=a(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?a(e+"/"+t):t)}},6662:e=>{"use strict";e.exports=function(e,t,s){var n=s||8192,a=n>>>1,o=null,c=n;return function(s){if(s<1||s>a)return e(s);c+s>n&&(o=e(n),c=0);var u=t.call(o,c,c+=s);return 7&c&&(c=1+(7|c)),u}}},4997:(e,t)=>{"use strict";var s=t;s.length=function(e){for(var t=0,s=0,n=0;n<e.length;++n)(s=e.charCodeAt(n))<128?t+=1:s<2048?t+=2:55296==(64512&s)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},s.read=function(e,t,s){if(s-t<1)return"";for(var n,a=null,o=[],c=0;t<s;)(n=e[t++])<128?o[c++]=n:n>191&&n<224?o[c++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[c++]=55296+(n>>10),o[c++]=56320+(1023&n)):o[c++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],c>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,o)),c=0);return a?(c&&a.push(String.fromCharCode.apply(String,o.slice(0,c))),a.join("")):String.fromCharCode.apply(String,o.slice(0,c))},s.write=function(e,t,s){for(var n,a,o=s,c=0;c<e.length;++c)(n=e.charCodeAt(c))<128?t[s++]=n:n<2048?(t[s++]=n>>6|192,t[s++]=63&n|128):55296==(64512&n)&&56320==(64512&(a=e.charCodeAt(c+1)))?(n=65536+((1023&n)<<10)+(1023&a),++c,t[s++]=n>>18|240,t[s++]=n>>12&63|128,t[s++]=n>>6&63|128,t[s++]=63&n|128):(t[s++]=n>>12|224,t[s++]=n>>6&63|128,t[s++]=63&n|128);return s-o}},9742:(e,t)=>{"use strict";t.byteLength=function(e){var t=u(e),s=t[0],n=t[1];return 3*(s+n)/4-n},t.toByteArray=function(e){var t,s,o=u(e),c=o[0],l=o[1],d=new a(function(e,t,s){return 3*(t+s)/4-s}(0,c,l)),h=0,_=l>0?c-4:c;for(s=0;s<_;s+=4)t=n[e.charCodeAt(s)]<<18|n[e.charCodeAt(s+1)]<<12|n[e.charCodeAt(s+2)]<<6|n[e.charCodeAt(s+3)],d[h++]=t>>16&255,d[h++]=t>>8&255,d[h++]=255&t;2===l&&(t=n[e.charCodeAt(s)]<<2|n[e.charCodeAt(s+1)]>>4,d[h++]=255&t);1===l&&(t=n[e.charCodeAt(s)]<<10|n[e.charCodeAt(s+1)]<<4|n[e.charCodeAt(s+2)]>>2,d[h++]=t>>8&255,d[h++]=255&t);return d},t.fromByteArray=function(e){for(var t,n=e.length,a=n%3,o=[],c=16383,u=0,d=n-a;u<d;u+=c)o.push(l(e,u,u+c>d?d:u+c));1===a?(t=e[n-1],o.push(s[t>>2]+s[t<<4&63]+"==")):2===a&&(t=(e[n-2]<<8)+e[n-1],o.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"="));return o.join("")};for(var s=[],n=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0;c<64;++c)s[c]=o[c],n[o.charCodeAt(c)]=c;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=e.indexOf("=");return-1===s&&(s=t),[s,s===t?0:4-s%4]}function l(e,t,n){for(var a,o,c=[],u=t;u<n;u+=3)a=(e[u]<<16&16711680)+(e[u+1]<<8&65280)+(255&e[u+2]),c.push(s[(o=a)>>18&63]+s[o>>12&63]+s[o>>6&63]+s[63&o]);return c.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},8764:(e,t,s)=>{"use strict";const n=s(9742),a=s(645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50;const c=2147483647;function u(e){if(e>c)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,s){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return _(e)}return d(e,t,s)}function d(e,t,s){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const s=0|y(e,t);let n=u(s);const a=n.write(e,t);a!==s&&(n=n.slice(0,a));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Y(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return p(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Y(e,ArrayBuffer)||e&&Y(e.buffer,ArrayBuffer))return f(e,t,s);if("undefined"!=typeof SharedArrayBuffer&&(Y(e,SharedArrayBuffer)||e&&Y(e.buffer,SharedArrayBuffer)))return f(e,t,s);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return l.from(n,t,s);const a=function(e){if(l.isBuffer(e)){const t=0|m(e.length),s=u(t);return 0===s.length||e.copy(s,0,0,t),s}if(void 0!==e.length)return"number"!=typeof e.length||J(e.length)?u(0):p(e);if("Buffer"===e.type&&Array.isArray(e.data))return p(e.data)}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,s);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function _(e){return h(e),u(e<0?0:0|m(e))}function p(e){const t=e.length<0?0:0|m(e.length),s=u(t);for(let n=0;n<t;n+=1)s[n]=255&e[n];return s}function f(e,t,s){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(s||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===s?new Uint8Array(e):void 0===s?new Uint8Array(e,t):new Uint8Array(e,t,s),Object.setPrototypeOf(n,l.prototype),n}function m(e){if(e>=c)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c.toString(16)+" bytes");return 0|e}function y(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Y(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const s=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===s)return 0;let a=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*s;case"hex":return s>>>1;case"base64":return $(e).length;default:if(a)return n?-1:G(e).length;t=(""+t).toLowerCase(),a=!0}}function w(e,t,s){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===s||s>this.length)&&(s=this.length),s<=0)return"";if((s>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,s);case"utf8":case"utf-8":return D(this,t,s);case"ascii":return N(this,t,s);case"latin1":case"binary":return P(this,t,s);case"base64":return k(this,t,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,s);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,s){const n=e[t];e[t]=e[s],e[s]=n}function v(e,t,s,n,a){if(0===e.length)return-1;if("string"==typeof s?(n=s,s=0):s>2147483647?s=2147483647:s<-2147483648&&(s=-2147483648),J(s=+s)&&(s=a?0:e.length-1),s<0&&(s=e.length+s),s>=e.length){if(a)return-1;s=e.length-1}else if(s<0){if(!a)return-1;s=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:E(e,t,s,n,a);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,s):Uint8Array.prototype.lastIndexOf.call(e,t,s):E(e,[t],s,n,a);throw new TypeError("val must be string, number or Buffer")}function E(e,t,s,n,a){let o,c=1,u=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;c=2,u/=2,l/=2,s/=2}function d(e,t){return 1===c?e[t]:e.readUInt16BE(t*c)}if(a){let n=-1;for(o=s;o<u;o++)if(d(e,o)===d(t,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===l)return n*c}else-1!==n&&(o-=o-n),n=-1}else for(s+l>u&&(s=u-l),o=s;o>=0;o--){let s=!0;for(let n=0;n<l;n++)if(d(e,o+n)!==d(t,n)){s=!1;break}if(s)return o}return-1}function T(e,t,s,n){s=Number(s)||0;const a=e.length-s;n?(n=Number(n))>a&&(n=a):n=a;const o=t.length;let c;for(n>o/2&&(n=o/2),c=0;c<n;++c){const n=parseInt(t.substr(2*c,2),16);if(J(n))return c;e[s+c]=n}return c}function b(e,t,s,n){return X(G(t,e.length-s),e,s,n)}function S(e,t,s,n){return X(function(e){const t=[];for(let s=0;s<e.length;++s)t.push(255&e.charCodeAt(s));return t}(t),e,s,n)}function C(e,t,s,n){return X($(t),e,s,n)}function R(e,t,s,n){return X(function(e,t){let s,n,a;const o=[];for(let c=0;c<e.length&&!((t-=2)<0);++c)s=e.charCodeAt(c),n=s>>8,a=s%256,o.push(a),o.push(n);return o}(t,e.length-s),e,s,n)}function k(e,t,s){return 0===t&&s===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,s))}function D(e,t,s){s=Math.min(e.length,s);const n=[];let a=t;for(;a<s;){const t=e[a];let o=null,c=t>239?4:t>223?3:t>191?2:1;if(a+c<=s){let s,n,u,l;switch(c){case 1:t<128&&(o=t);break;case 2:s=e[a+1],128==(192&s)&&(l=(31&t)<<6|63&s,l>127&&(o=l));break;case 3:s=e[a+1],n=e[a+2],128==(192&s)&&128==(192&n)&&(l=(15&t)<<12|(63&s)<<6|63&n,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:s=e[a+1],n=e[a+2],u=e[a+3],128==(192&s)&&128==(192&n)&&128==(192&u)&&(l=(15&t)<<18|(63&s)<<12|(63&n)<<6|63&u,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,c=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),a+=c}return function(e){const t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);let s="",n=0;for(;n<t;)s+=String.fromCharCode.apply(String,e.slice(n,n+=A));return s}(n)}t.kMaxLength=c,l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,s){return d(e,t,s)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,s){return function(e,t,s){return h(e),e<=0?u(e):void 0!==t?"string"==typeof s?u(e).fill(t,s):u(e).fill(t):u(e)}(e,t,s)},l.allocUnsafe=function(e){return _(e)},l.allocUnsafeSlow=function(e){return _(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(Y(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),Y(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let s=e.length,n=t.length;for(let a=0,o=Math.min(s,n);a<o;++a)if(e[a]!==t[a]){s=e[a],n=t[a];break}return s<n?-1:n<s?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let s;if(void 0===t)for(t=0,s=0;s<e.length;++s)t+=e[s].length;const n=l.allocUnsafe(t);let a=0;for(s=0;s<e.length;++s){let t=e[s];if(Y(t,Uint8Array))a+t.length>n.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(n,a)):Uint8Array.prototype.set.call(n,t,a);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,a)}a+=t.length}return n},l.byteLength=y,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?D(this,0,e):w.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const s=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(e+=" ... "),"<Buffer "+e+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(e,t,s,n,a){if(Y(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===s&&(s=e?e.length:0),void 0===n&&(n=0),void 0===a&&(a=this.length),t<0||s>e.length||n<0||a>this.length)throw new RangeError("out of range index");if(n>=a&&t>=s)return 0;if(n>=a)return-1;if(t>=s)return 1;if(this===e)return 0;let o=(a>>>=0)-(n>>>=0),c=(s>>>=0)-(t>>>=0);const u=Math.min(o,c),d=this.slice(n,a),h=e.slice(t,s);for(let e=0;e<u;++e)if(d[e]!==h[e]){o=d[e],c=h[e];break}return o<c?-1:c<o?1:0},l.prototype.includes=function(e,t,s){return-1!==this.indexOf(e,t,s)},l.prototype.indexOf=function(e,t,s){return v(this,e,t,s,!0)},l.prototype.lastIndexOf=function(e,t,s){return v(this,e,t,s,!1)},l.prototype.write=function(e,t,s,n){if(void 0===t)n="utf8",s=this.length,t=0;else if(void 0===s&&"string"==typeof t)n=t,s=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(s)?(s>>>=0,void 0===n&&(n="utf8")):(n=s,s=void 0)}const a=this.length-t;if((void 0===s||s>a)&&(s=a),e.length>0&&(s<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return T(this,e,t,s);case"utf8":case"utf-8":return b(this,e,t,s);case"ascii":case"latin1":case"binary":return S(this,e,t,s);case"base64":return C(this,e,t,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,t,s);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const A=4096;function N(e,t,s){let n="";s=Math.min(e.length,s);for(let a=t;a<s;++a)n+=String.fromCharCode(127&e[a]);return n}function P(e,t,s){let n="";s=Math.min(e.length,s);for(let a=t;a<s;++a)n+=String.fromCharCode(e[a]);return n}function O(e,t,s){const n=e.length;(!t||t<0)&&(t=0),(!s||s<0||s>n)&&(s=n);let a="";for(let n=t;n<s;++n)a+=Q[e[n]];return a}function I(e,t,s){const n=e.slice(t,s);let a="";for(let e=0;e<n.length-1;e+=2)a+=String.fromCharCode(n[e]+256*n[e+1]);return a}function M(e,t,s){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>s)throw new RangeError("Trying to access beyond buffer length")}function x(e,t,s,n,a,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<o)throw new RangeError('"value" argument is out of bounds');if(s+n>e.length)throw new RangeError("Index out of range")}function L(e,t,s,n,a){Z(t,n,a,e,s,7);let o=Number(t&BigInt(4294967295));e[s++]=o,o>>=8,e[s++]=o,o>>=8,e[s++]=o,o>>=8,e[s++]=o;let c=Number(t>>BigInt(32)&BigInt(4294967295));return e[s++]=c,c>>=8,e[s++]=c,c>>=8,e[s++]=c,c>>=8,e[s++]=c,s}function F(e,t,s,n,a){Z(t,n,a,e,s,7);let o=Number(t&BigInt(4294967295));e[s+7]=o,o>>=8,e[s+6]=o,o>>=8,e[s+5]=o,o>>=8,e[s+4]=o;let c=Number(t>>BigInt(32)&BigInt(4294967295));return e[s+3]=c,c>>=8,e[s+2]=c,c>>=8,e[s+1]=c,c>>=8,e[s]=c,s+8}function U(e,t,s,n,a,o){if(s+n>e.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function H(e,t,s,n,o){return t=+t,s>>>=0,o||U(e,0,s,4),a.write(e,t,s,n,23,4),s+4}function B(e,t,s,n,o){return t=+t,s>>>=0,o||U(e,0,s,8),a.write(e,t,s,n,52,8),s+8}l.prototype.slice=function(e,t){const s=this.length;(e=~~e)<0?(e+=s)<0&&(e=0):e>s&&(e=s),(t=void 0===t?s:~~t)<0?(t+=s)<0&&(t=0):t>s&&(t=s),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,s){e>>>=0,t>>>=0,s||M(e,t,this.length);let n=this[e],a=1,o=0;for(;++o<t&&(a*=256);)n+=this[e+o]*a;return n},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,s){e>>>=0,t>>>=0,s||M(e,t,this.length);let n=this[e+--t],a=1;for(;t>0&&(a*=256);)n+=this[e+--t]*a;return n},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=ee((function(e){W(e>>>=0,"offset");const t=this[e],s=this[e+7];void 0!==t&&void 0!==s||z(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,a=this[++e]+256*this[++e]+65536*this[++e]+s*2**24;return BigInt(n)+(BigInt(a)<<BigInt(32))})),l.prototype.readBigUInt64BE=ee((function(e){W(e>>>=0,"offset");const t=this[e],s=this[e+7];void 0!==t&&void 0!==s||z(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],a=this[++e]*2**24+65536*this[++e]+256*this[++e]+s;return(BigInt(n)<<BigInt(32))+BigInt(a)})),l.prototype.readIntLE=function(e,t,s){e>>>=0,t>>>=0,s||M(e,t,this.length);let n=this[e],a=1,o=0;for(;++o<t&&(a*=256);)n+=this[e+o]*a;return a*=128,n>=a&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,s){e>>>=0,t>>>=0,s||M(e,t,this.length);let n=t,a=1,o=this[e+--n];for(;n>0&&(a*=256);)o+=this[e+--n]*a;return a*=128,o>=a&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||M(e,2,this.length);const s=this[e]|this[e+1]<<8;return 32768&s?4294901760|s:s},l.prototype.readInt16BE=function(e,t){e>>>=0,t||M(e,2,this.length);const s=this[e+1]|this[e]<<8;return 32768&s?4294901760|s:s},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=ee((function(e){W(e>>>=0,"offset");const t=this[e],s=this[e+7];void 0!==t&&void 0!==s||z(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(s<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=ee((function(e){W(e>>>=0,"offset");const t=this[e],s=this[e+7];void 0!==t&&void 0!==s||z(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+s)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||M(e,4,this.length),a.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||M(e,4,this.length),a.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||M(e,8,this.length),a.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||M(e,8,this.length),a.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,s,n){if(e=+e,t>>>=0,s>>>=0,!n){x(this,e,t,s,Math.pow(2,8*s)-1,0)}let a=1,o=0;for(this[t]=255&e;++o<s&&(a*=256);)this[t+o]=e/a&255;return t+s},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,s,n){if(e=+e,t>>>=0,s>>>=0,!n){x(this,e,t,s,Math.pow(2,8*s)-1,0)}let a=s-1,o=1;for(this[t+a]=255&e;--a>=0&&(o*=256);)this[t+a]=e/o&255;return t+s},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,s){return e=+e,t>>>=0,s||x(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,s){return e=+e,t>>>=0,s||x(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,s){return e=+e,t>>>=0,s||x(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,s){return e=+e,t>>>=0,s||x(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,s){return e=+e,t>>>=0,s||x(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=ee((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=ee((function(e,t=0){return F(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,s,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*s-1);x(this,e,t,s,n-1,-n)}let a=0,o=1,c=0;for(this[t]=255&e;++a<s&&(o*=256);)e<0&&0===c&&0!==this[t+a-1]&&(c=1),this[t+a]=(e/o>>0)-c&255;return t+s},l.prototype.writeIntBE=function(e,t,s,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*s-1);x(this,e,t,s,n-1,-n)}let a=s-1,o=1,c=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===c&&0!==this[t+a+1]&&(c=1),this[t+a]=(e/o>>0)-c&255;return t+s},l.prototype.writeInt8=function(e,t,s){return e=+e,t>>>=0,s||x(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,s){return e=+e,t>>>=0,s||x(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,s){return e=+e,t>>>=0,s||x(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,s){return e=+e,t>>>=0,s||x(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,s){return e=+e,t>>>=0,s||x(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=ee((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=ee((function(e,t=0){return F(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,s){return H(this,e,t,!0,s)},l.prototype.writeFloatBE=function(e,t,s){return H(this,e,t,!1,s)},l.prototype.writeDoubleLE=function(e,t,s){return B(this,e,t,!0,s)},l.prototype.writeDoubleBE=function(e,t,s){return B(this,e,t,!1,s)},l.prototype.copy=function(e,t,s,n){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(s||(s=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<s&&(n=s),n===s)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(s<0||s>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-s&&(n=e.length-t+s);const a=n-s;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,s,n):Uint8Array.prototype.set.call(e,this.subarray(s,n),t),a},l.prototype.fill=function(e,t,s,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,s=this.length):"string"==typeof s&&(n=s,s=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<s)throw new RangeError("Out of range index");if(s<=t)return this;let a;if(t>>>=0,s=void 0===s?this.length:s>>>0,e||(e=0),"number"==typeof e)for(a=t;a<s;++a)this[a]=e;else{const o=l.isBuffer(e)?e:l.from(e,n),c=o.length;if(0===c)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<s-t;++a)this[a+t]=o[a%c]}return this};const j={};function q(e,t,s){j[e]=class NodeError extends s{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function K(e){let t="",s=e.length;const n="-"===e[0]?1:0;for(;s>=n+4;s-=3)t=`_${e.slice(s-3,s)}${t}`;return`${e.slice(0,s)}${t}`}function Z(e,t,s,n,a,o){if(e>s||e<t){const n="bigint"==typeof t?"n":"";let a;throw a=o>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${t}${n} and <= ${s}${n}`,new j.ERR_OUT_OF_RANGE("value",a,e)}!function(e,t,s){W(t,"offset"),void 0!==e[t]&&void 0!==e[t+s]||z(t,e.length-(s+1))}(n,a,o)}function W(e,t){if("number"!=typeof e)throw new j.ERR_INVALID_ARG_TYPE(t,"number",e)}function z(e,t,s){if(Math.floor(e)!==e)throw W(e,s),new j.ERR_OUT_OF_RANGE(s||"offset","an integer",e);if(t<0)throw new j.ERR_BUFFER_OUT_OF_BOUNDS;throw new j.ERR_OUT_OF_RANGE(s||"offset",`>= ${s?1:0} and <= ${t}`,e)}q("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),q("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),q("ERR_OUT_OF_RANGE",(function(e,t,s){let n=`The value of "${e}" is out of range.`,a=s;return Number.isInteger(s)&&Math.abs(s)>2**32?a=K(String(s)):"bigint"==typeof s&&(a=String(s),(s>BigInt(2)**BigInt(32)||s<-(BigInt(2)**BigInt(32)))&&(a=K(a)),a+="n"),n+=` It must be ${t}. Received ${a}`,n}),RangeError);const V=/[^+/0-9A-Za-z-_]/g;function G(e,t){let s;t=t||1/0;const n=e.length;let a=null;const o=[];for(let c=0;c<n;++c){if(s=e.charCodeAt(c),s>55295&&s<57344){if(!a){if(s>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(c+1===n){(t-=3)>-1&&o.push(239,191,189);continue}a=s;continue}if(s<56320){(t-=3)>-1&&o.push(239,191,189),a=s;continue}s=65536+(a-55296<<10|s-56320)}else a&&(t-=3)>-1&&o.push(239,191,189);if(a=null,s<128){if((t-=1)<0)break;o.push(s)}else if(s<2048){if((t-=2)<0)break;o.push(s>>6|192,63&s|128)}else if(s<65536){if((t-=3)<0)break;o.push(s>>12|224,s>>6&63|128,63&s|128)}else{if(!(s<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(s>>18|240,s>>12&63|128,s>>6&63|128,63&s|128)}}return o}function $(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function X(e,t,s,n){let a;for(a=0;a<n&&!(a+s>=t.length||a>=e.length);++a)t[a+s]=e[a];return a}function Y(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function J(e){return e!=e}const Q=function(){const e="0123456789abcdef",t=new Array(256);for(let s=0;s<16;++s){const n=16*s;for(let a=0;a<16;++a)t[n+a]=e[s]+e[a]}return t}();function ee(e){return"undefined"==typeof BigInt?te:e}function te(){throw new Error("BigInt not supported")}},2601:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Centrifuge=void 0;const a=s(3562),o=s(7370),c=s(4957),u=s(6026),l=s(8270),d=s(7817),h=s(4903),_=s(9386),p=s(1632),f=s(2847),m=n(s(7187)),y={protocol:"json",token:null,getToken:null,data:null,debug:!1,name:"js",version:"",fetch:null,readableStream:null,websocket:null,eventsource:null,sockjs:null,sockjsOptions:{},emulationEndpoint:"/emulation",minReconnectDelay:500,maxReconnectDelay:2e4,timeout:5e3,maxServerPingDelay:1e4,networkEventTarget:null};class Centrifuge extends m.default{constructor(e,t){super(),this._reconnectTimeout=null,this._refreshTimeout=null,this._serverPingTimeout=null,this.state=f.State.Disconnected,this._endpoint=e,this._emulation=!1,this._transports=[],this._currentTransportIndex=0,this._triedAllTransports=!1,this._transportWasOpen=!1,this._transport=null,this._transportClosed=!0,this._encoder=null,this._decoder=null,this._reconnecting=!1,this._reconnectTimeout=null,this._reconnectAttempts=0,this._client=null,this._session="",this._node="",this._subs={},this._serverSubs={},this._commandId=0,this._commands=[],this._batching=!1,this._refreshRequired=!1,this._refreshTimeout=null,this._callbacks={},this._token=void 0,this._dispatchPromise=Promise.resolve(),this._serverPing=0,this._serverPingTimeout=null,this._sendPong=!1,this._promises={},this._promiseId=0,this._debugEnabled=!1,this._networkEventsSet=!1,this._config=Object.assign(Object.assign({},y),t),this._configure(),this._debugEnabled?(this.on("state",(e=>{this._debug("client state",e.oldState,"->",e.newState)})),this.on("error",(e=>{this._debug("client error",e)}))):this.on("error",(function(){Function.prototype()}))}newSubscription(e,t){if(null!==this.getSubscription(e))throw new Error("Subscription to the channel "+e+" already exists");const s=new a.Subscription(this,e,t);return this._subs[e]=s,s}getSubscription(e){return this._getSub(e)}removeSubscription(e){e&&(e.state!==f.SubscriptionState.Unsubscribed&&e.unsubscribe(),this._removeSubscription(e))}subscriptions(){return this._subs}ready(e){return this.state===f.State.Disconnected?Promise.reject({code:o.errorCodes.clientDisconnected,message:"client disconnected"}):this.state===f.State.Connected?Promise.resolve():new Promise(((t,s)=>{const n={resolve:t,reject:s};e&&(n.timeout=setTimeout((function(){s({code:o.errorCodes.timeout,message:"timeout"})}),e)),this._promises[this._nextPromiseId()]=n}))}connect(){this._isConnected()?this._debug("connect called when already connected"):this._isConnecting()?this._debug("connect called when already connecting"):(this._debug("connect called"),this._reconnectAttempts=0,this._startConnecting())}disconnect(){this._disconnect(o.disconnectedCodes.disconnectCalled,"disconnect called",!1)}send(e){const t={send:{data:e}},s=this;return this._methodCall().then((function(){return s._transportSendCommands([t])?Promise.resolve():Promise.reject(s._createErrorObject(o.errorCodes.transportWriteError,"transport write error"))}))}rpc(e,t){const s={rpc:{method:e,data:t}},n=this;return this._methodCall().then((function(){return n._callPromise(s,(function(e){return{data:e.rpc.data}}))}))}publish(e,t){const s={publish:{channel:e,data:t}},n=this;return this._methodCall().then((function(){return n._callPromise(s,(function(){return{}}))}))}history(e,t){const s={history:this._getHistoryRequest(e,t)},n=this;return this._methodCall().then((function(){return n._callPromise(s,(function(t){const s=t.history,a=[];if(s.publications)for(let t=0;t<s.publications.length;t++)a.push(n._getPublicationContext(e,s.publications[t]));return{publications:a,epoch:s.epoch||"",offset:s.offset||0}}))}))}presence(e){const t={presence:{channel:e}},s=this;return this._methodCall().then((function(){return s._callPromise(t,(function(e){const t=e.presence.presence;for(const e in t)if(t.hasOwnProperty(e)){const s=t[e].conn_info,n=t[e].chan_info;s&&(t[e].connInfo=s),n&&(t[e].chanInfo=n)}return{clients:t}}))}))}presenceStats(e){const t={presence_stats:{channel:e}},s=this;return this._methodCall().then((function(){return s._callPromise(t,(function(e){const t=e.presence_stats;return{numUsers:t.num_users,numClients:t.num_clients}}))}))}startBatching(){this._batching=!0}stopBatching(){const e=this;Promise.resolve().then((function(){Promise.resolve().then((function(){e._batching=!1,e._flush()}))}))}_debug(...e){this._debugEnabled&&(0,p.log)("debug",e)}_setFormat(e){if(!this._formatOverride(e)){if("protobuf"===e)throw new Error("not implemented by JSON-only Centrifuge client, use client with Protobuf support");this._encoder=new _.JsonEncoder,this._decoder=new _.JsonDecoder}}_formatOverride(e){return!1}_configure(){if(!("Promise"in globalThis))throw new Error("Promise polyfill required");if(!this._endpoint)throw new Error("endpoint configuration required");if("json"!==this._config.protocol&&"protobuf"!==this._config.protocol)throw new Error("unsupported protocol "+this._config.protocol);if(null!==this._config.token&&(this._token=this._config.token),this._setFormat("json"),"protobuf"===this._config.protocol&&this._setFormat("protobuf"),(!0===this._config.debug||"undefined"!=typeof localStorage&&localStorage.getItem("centrifuge.debug"))&&(this._debugEnabled=!0),this._debug("config",this._config),"string"==typeof this._endpoint);else{if(!("object"==typeof this._endpoint&&this._endpoint instanceof Array))throw new Error("unsupported url configuration type: only string or array of objects are supported");this._transports=this._endpoint,this._emulation=!0;for(const e in this._transports){const t=this._transports[e];if(!t.endpoint||!t.transport)throw new Error("malformed transport configuration");const s=t.transport;if(["websocket","http_stream","sse","sockjs","webtransport"].indexOf(s)<0)throw new Error("unsupported transport name: "+s)}}}_setState(e){if(this.state!==e){this._reconnecting=!1;const t=this.state;return this.state=e,this.emit("state",{newState:e,oldState:t}),!0}return!1}_isDisconnected(){return this.state===f.State.Disconnected}_isConnecting(){return this.state===f.State.Connecting}_isConnected(){return this.state===f.State.Connected}_nextCommandId(){return++this._commandId}_setNetworkEvents(){if(this._networkEventsSet)return;let e=null;null!==this._config.networkEventTarget?e=this._config.networkEventTarget:void 0!==globalThis.addEventListener&&(e=globalThis),e&&(e.addEventListener("offline",(()=>{this._debug("offline event triggered"),this.state!==f.State.Connected&&this.state!==f.State.Connecting||this._disconnect(o.connectingCodes.transportClosed,"transport closed",!0)})),e.addEventListener("online",(()=>{this._debug("online event triggered"),this.state===f.State.Connecting&&(this._clearReconnectTimeout(),this._startReconnecting())})),this._networkEventsSet=!0)}_getReconnectDelay(){const e=(0,p.backoff)(this._reconnectAttempts,this._config.minReconnectDelay,this._config.maxReconnectDelay);return this._reconnectAttempts+=1,e}_clearOutgoingRequests(){for(const e in this._callbacks)if(this._callbacks.hasOwnProperty(e)){const t=this._callbacks[e];clearTimeout(t.timeout);const s=t.errback;if(!s)continue;s({error:this._createErrorObject(o.errorCodes.connectionClosed,"connection closed")})}this._callbacks={}}_clearConnectedState(){this._client=null,this._clearServerPingTimeout(),this._clearRefreshTimeout();for(const e in this._subs){if(!this._subs.hasOwnProperty(e))continue;const t=this._subs[e];t.state===f.SubscriptionState.Subscribed&&t._setSubscribing(o.subscribingCodes.transportClosed,"transport closed")}for(const e in this._serverSubs)this._serverSubs.hasOwnProperty(e)&&this.emit("subscribing",{channel:e})}_handleWriteError(e){for(const t of e){const e=t.id;if(!(e in this._callbacks))continue;const s=this._callbacks[e];clearTimeout(this._callbacks[e].timeout),delete this._callbacks[e];(0,s.errback)({error:this._createErrorObject(o.errorCodes.transportWriteError,"transport write error")})}}_transportSendCommands(e){if(!e.length)return!0;if(!this._transport)return!1;try{this._transport.send(this._encoder.encodeCommands(e),this._session,this._node)}catch(t){return this._debug("error writing commands",t),this._handleWriteError(e),!1}return!0}_initializeTransport(){let e;null!==this._config.websocket?e=this._config.websocket:"function"!=typeof globalThis.WebSocket&&"object"!=typeof globalThis.WebSocket||(e=globalThis.WebSocket);let t=null;null!==this._config.sockjs?t=this._config.sockjs:void 0!==globalThis.SockJS&&(t=globalThis.SockJS);let s=null;null!==this._config.eventsource?s=this._config.eventsource:void 0!==globalThis.EventSource&&(s=globalThis.EventSource);let n=null;null!==this._config.fetch?n=this._config.fetch:void 0!==globalThis.fetch&&(n=globalThis.fetch);let a=null;if(null!==this._config.readableStream?a=this._config.readableStream:void 0!==globalThis.ReadableStream&&(a=globalThis.ReadableStream),this._emulation){this._currentTransportIndex>=this._transports.length&&(this._triedAllTransports=!0,this._currentTransportIndex=0);let o=0;for(;;){if(o>=this._transports.length)throw new Error("no supported transport found");const _=this._transports[this._currentTransportIndex],p=_.transport,f=_.endpoint;if("websocket"===p){if(this._debug("trying websocket transport"),this._transport=new u.WebsocketTransport(f,{websocket:e}),!this._transport.supported()){this._debug("websocket transport not available"),this._currentTransportIndex++,o++;continue}}else if("webtransport"===p){if(this._debug("trying webtransport transport"),this._transport=new h.WebtransportTransport(f,{webtransport:globalThis.WebTransport,decoder:this._decoder,encoder:this._encoder}),!this._transport.supported()){this._debug("webtransport transport not available"),this._currentTransportIndex++,o++;continue}}else if("http_stream"===p){if(this._debug("trying http_stream transport"),this._transport=new l.HttpStreamTransport(f,{fetch:n,readableStream:a,emulationEndpoint:this._config.emulationEndpoint,decoder:this._decoder,encoder:this._encoder}),!this._transport.supported()){this._debug("http_stream transport not available"),this._currentTransportIndex++,o++;continue}}else if("sse"===p){if(this._debug("trying sse transport"),this._transport=new d.SseTransport(f,{eventsource:s,fetch:n,emulationEndpoint:this._config.emulationEndpoint}),!this._transport.supported()){this._debug("sse transport not available"),this._currentTransportIndex++,o++;continue}}else{if("sockjs"!==p)throw new Error("unknown transport "+p);if(this._debug("trying sockjs"),this._transport=new c.SockjsTransport(f,{sockjs:t,sockjsOptions:this._config.sockjsOptions}),!this._transport.supported()){this._debug("sockjs transport not available"),this._currentTransportIndex++,o++;continue}}break}}else{if((0,p.startsWith)(this._endpoint,"http"))throw new Error("Provide explicit transport endpoints configuration in case of using HTTP (i.e. using array of TransportEndpoint instead of a single string), or use ws(s):// scheme in an endpoint if you aimed using WebSocket transport");if(this._debug("client will use websocket"),this._transport=new u.WebsocketTransport(this._endpoint,{websocket:e}),!this._transport.supported())throw new Error("WebSocket not available")}const _=this,f=this._transport;let m=!1,y=!0;"sse"===this._transport.name()&&(y=!1);const w=[];if(this._transport.emulation()){const e=_._sendConnect(!0);if(w.push(e),y){const e=_._sendSubscribeCommands(!0,!0);for(const t in e)w.push(e[t])}}this._setNetworkEvents();const g=this._encoder.encodeCommands(w);this._transportClosed=!1,this._transport.initialize(this._config.protocol,{onOpen:function(){m=!0,_._debug(f.subName(),"transport open"),_._transportWasOpen=!0,f.emulation()||(_.startBatching(),_._sendConnect(!1),y&&_._sendSubscribeCommands(!0,!1),_.stopBatching())},onError:function(e){_._debug("transport level error",e)},onClose:function(e){_._debug(f.subName(),"transport closed"),_._transportClosed=!0;let t="connection closed",s=!0,n=0;if(e&&"code"in e&&e.code&&(n=e.code),e&&e.reason)try{const n=JSON.parse(e.reason);t=n.reason,s=n.reconnect}catch(a){t=e.reason,(n>=3500&&n<4e3||n>=4500&&n<5e3)&&(s=!1)}n<3e3?(1009===n?(n=o.disconnectedCodes.messageSizeLimit,t="message size limit exceeded",s=!1):(n=o.connectingCodes.transportClosed,t="transport closed"),_._emulation&&!_._transportWasOpen&&(_._currentTransportIndex++,_._currentTransportIndex>=_._transports.length&&(_._triedAllTransports=!0,_._currentTransportIndex=0))):_._transportWasOpen=!0;let a=!1;if(!_._emulation||_._transportWasOpen||_._triedAllTransports||(a=!0),_._isConnecting()&&!m&&_.emit("error",{type:"transport",error:{code:o.errorCodes.transportClosed,message:"transport closed"},transport:f.name()}),_._disconnect(n,t,s),_._isConnecting()){let e=_._getReconnectDelay();a&&(e=0),_._debug("reconnect after "+e+" milliseconds"),_._reconnecting=!1,_._reconnectTimeout=setTimeout((()=>{_._startReconnecting()}),e)}},onMessage:function(e){_._dataReceived(e)}},g)}_sendConnect(e){const t=this._constructConnectCommand(),s=this;return this._call(t,e).then((e=>{const t=e.reply.connect;s._connectResponse(t),e.next&&e.next()}),(e=>{s._connectError(e.error),e.next&&e.next()})),t}_startReconnecting(){if(!this._isConnecting()||this._reconnecting)return;if(this._debug("start reconnecting"),this._reconnecting=!0,!1===this._transportClosed)return void this._debug("waiting for transport close");if(!(this._refreshRequired||!this._token&&null!==this._config.getToken))return void this._initializeTransport();const e=this;this._getToken().then((function(t){e._isConnecting()&&(t?(e._token=t,e._debug("connection token refreshed"),e._initializeTransport()):e._failUnauthorized())})).catch((function(t){if(!e._isConnecting())return;e.emit("error",{type:"connectToken",error:{code:o.errorCodes.clientConnectToken,message:void 0!==t?t.toString():""}});const s=e._getReconnectDelay();e._debug("error on connection token refresh, reconnect after "+s+" milliseconds",t),e._reconnecting=!1,e._reconnectTimeout=setTimeout((()=>{e._startReconnecting()}),s)}))}_connectError(e){if(this.state===f.State.Connecting)if(109===e.code&&(this._refreshRequired=!0),e.code<100||!0===e.temporary||109===e.code){if(this.emit("error",{type:"connect",error:e}),this._debug("closing transport due to connect error"),this._transport){const e=this._transport;this._transport=null,e.close()}}else this._disconnect(e.code,e.message,!1)}_constructConnectCommand(){const e={};this._token&&(e.token=this._token),this._config.data&&(e.data=this._config.data),this._config.name&&(e.name=this._config.name),this._config.version&&(e.version=this._config.version);const t={};let s=!1;for(const e in this._serverSubs)if(this._serverSubs.hasOwnProperty(e)&&this._serverSubs[e].recoverable){s=!0;const n={recover:!0};this._serverSubs[e].offset&&(n.offset=this._serverSubs[e].offset),this._serverSubs[e].epoch&&(n.epoch=this._serverSubs[e].epoch),t[e]=n}return s&&(e.subs=t),{connect:e}}_getHistoryRequest(e,t){const s={channel:e};return void 0!==t&&(t.since&&(s.since={offset:t.since.offset},t.since.epoch&&(s.since.epoch=t.since.epoch)),void 0!==t.limit&&(s.limit=t.limit),!0===t.reverse&&(s.reverse=!0)),s}_methodCall(){return this._isConnected()?Promise.resolve():new Promise(((e,t)=>{const s=setTimeout((function(){t({code:o.errorCodes.timeout,message:"timeout"})}),this._config.timeout);this._promises[this._nextPromiseId()]={timeout:s,resolve:e,reject:t}}))}_callPromise(e,t){return new Promise(((s,n)=>{this._call(e,!1).then((e=>{s(t(e.reply)),e.next&&e.next()}),(e=>{n(e.error),e.next&&e.next()}))}))}_dataReceived(e){this._serverPing>0&&this._waitServerPing();const t=this._decoder.decodeReplies(e);this._dispatchPromise=this._dispatchPromise.then((()=>{let e;this._dispatchPromise=new Promise((t=>{e=t})),this._dispatchSynchronized(t,e)}))}_dispatchSynchronized(e,t){let s=Promise.resolve();for(const t in e)e.hasOwnProperty(t)&&(s=s.then((()=>this._dispatchReply(e[t]))));s=s.then((()=>{t()}))}_dispatchReply(e){let t;const s=new Promise((e=>{t=e}));if(null==e)return this._debug("dispatch: got undefined or null reply"),t(),s;const n=e.id;return n&&n>0?this._handleReply(e,t):e.push?this._handlePush(e.push,t):this._handleServerPing(t),s}_call(e,t){return new Promise(((s,n)=>{e.id=this._nextCommandId(),this._registerCall(e.id,s,n),t||this._addCommand(e)}))}_startConnecting(){this._debug("start connecting"),this._setState(f.State.Connecting)&&this.emit("connecting",{code:o.connectingCodes.connectCalled,reason:"connect called"}),this._client=null,this._startReconnecting()}_disconnect(e,t,s){if(this._isDisconnected())return;const n=this.state,a={code:e,reason:t};let c=!1;if(s?c=this._setState(f.State.Connecting):(c=this._setState(f.State.Disconnected),this._rejectPromises({code:o.errorCodes.clientDisconnected,message:"disconnected"})),this._clearOutgoingRequests(),n===f.State.Connecting&&this._clearReconnectTimeout(),n===f.State.Connected&&this._clearConnectedState(),c&&(this._isConnecting()?this.emit("connecting",a):this.emit("disconnected",a)),this._transport){const e=this._transport;this._transport=null,e.close()}}_failUnauthorized(){this._disconnect(o.disconnectedCodes.unauthorized,"unauthorized",!1)}_getToken(){if(this._debug("get connection token"),!this._config.getToken)throw new Error("provide a function to get connection token");return this._config.getToken({})}_refresh(){const e=this._client,t=this;this._getToken().then((function(s){if(e!==t._client)return;if(!s)return void t._failUnauthorized();if(t._token=s,t._debug("connection token refreshed"),!t._isConnected())return;const n={refresh:{token:t._token}};t._call(n,!1).then((e=>{const s=e.reply.refresh;t._refreshResponse(s),e.next&&e.next()}),(e=>{t._refreshError(e.error),e.next&&e.next()}))})).catch((function(e){t.emit("error",{type:"refreshToken",error:{code:o.errorCodes.clientRefreshToken,message:void 0!==e?e.toString():""}}),t._refreshTimeout=setTimeout((()=>t._refresh()),t._getRefreshRetryDelay())}))}_refreshError(e){e.code<100||!0===e.temporary?(this.emit("error",{type:"refresh",error:e}),this._refreshTimeout=setTimeout((()=>this._refresh()),this._getRefreshRetryDelay())):this._disconnect(e.code,e.message,!1)}_getRefreshRetryDelay(){return(0,p.backoff)(0,5e3,1e4)}_refreshResponse(e){this._refreshTimeout&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null),e.expires&&(this._client=e.client,this._refreshTimeout=setTimeout((()=>this._refresh()),(0,p.ttlMilliseconds)(e.ttl)))}_removeSubscription(e){null!==e&&delete this._subs[e.channel]}_unsubscribe(e){if(!this._isConnected())return;const t={unsubscribe:{channel:e.channel}},s=this;this._call(t,!1).then((e=>{e.next&&e.next()}),(e=>{e.next&&e.next(),s._disconnect(o.connectingCodes.unsubscribeError,"unsubscribe error",!0)}))}_getSub(e){const t=this._subs[e];return t||null}_isServerSub(e){return void 0!==this._serverSubs[e]}_sendSubscribeCommands(e,t){const s=[];for(const n in this._subs){if(!this._subs.hasOwnProperty(n))continue;const a=this._subs[n];if(!0!==a._inflight&&a.state===f.SubscriptionState.Subscribing){const n=a._subscribe(e,t);n&&s.push(n)}}return s}_connectResponse(e){if(this._transportWasOpen=!0,this._reconnectAttempts=0,this._refreshRequired=!1,this._isConnected())return;this._client=e.client,this._setState(f.State.Connected),this._refreshTimeout&&clearTimeout(this._refreshTimeout),e.expires&&(this._refreshTimeout=setTimeout((()=>this._refresh()),(0,p.ttlMilliseconds)(e.ttl))),this._session=e.session,this._node=e.node,this.startBatching(),this._sendSubscribeCommands(!1,!1),this.stopBatching();const t={client:e.client,transport:this._transport.subName()};e.data&&(t.data=e.data),this.emit("connected",t),this._resolvePromises(),this._processServerSubs(e.subs||{}),e.ping&&e.ping>0?(this._serverPing=1e3*e.ping,this._sendPong=!0===e.pong,this._waitServerPing()):this._serverPing=0}_processServerSubs(e){for(const t in e){if(!e.hasOwnProperty(t))continue;const s=e[t];this._serverSubs[t]={offset:s.offset,epoch:s.epoch,recoverable:s.recoverable||!1};const n=this._getSubscribeContext(t,s);this.emit("subscribed",n)}for(const t in e){if(!e.hasOwnProperty(t))continue;const s=e[t];if(s.recovered){const e=s.publications;if(e&&e.length>0)for(const s in e)e.hasOwnProperty(s)&&this._handlePublication(t,e[s])}}for(const t in this._serverSubs)this._serverSubs.hasOwnProperty(t)&&(e[t]||(this.emit("unsubscribed",{channel:t}),delete this._serverSubs[t]))}_clearRefreshTimeout(){null!==this._refreshTimeout&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null)}_clearReconnectTimeout(){null!==this._reconnectTimeout&&(clearTimeout(this._reconnectTimeout),this._reconnectTimeout=null)}_clearServerPingTimeout(){null!==this._serverPingTimeout&&(clearTimeout(this._serverPingTimeout),this._serverPingTimeout=null)}_waitServerPing(){0!==this._config.maxServerPingDelay&&this._isConnected()&&(this._clearServerPingTimeout(),this._serverPingTimeout=setTimeout((()=>{this._isConnected()&&this._disconnect(o.connectingCodes.noPing,"no ping",!0)}),this._serverPing+this._config.maxServerPingDelay))}_getSubscribeContext(e,t){const s={channel:e,positioned:!1,recoverable:!1,wasRecovering:!1,recovered:!1};t.recovered&&(s.recovered=!0),t.positioned&&(s.positioned=!0),t.recoverable&&(s.recoverable=!0),t.was_recovering&&(s.wasRecovering=!0);let n="";"epoch"in t&&(n=t.epoch);let a=0;return"offset"in t&&(a=t.offset),(s.positioned||s.recoverable)&&(s.streamPosition={offset:a,epoch:n}),t.data&&(s.data=t.data),s}_handleReply(e,t){const s=e.id;if(!(s in this._callbacks))return void t();const n=this._callbacks[s];if(clearTimeout(this._callbacks[s].timeout),delete this._callbacks[s],(0,p.errorExists)(e)){const s=n.errback;if(!s)return void t();s({error:e.error,next:t})}else{const s=n.callback;if(!s)return;s({reply:e,next:t})}}_handleJoin(e,t){const s=this._getSub(e);if(s)s._handleJoin(t);else if(this._isServerSub(e)){const s={channel:e,info:this._getJoinLeaveContext(t.info)};this.emit("join",s)}}_handleLeave(e,t){const s=this._getSub(e);if(s)s._handleLeave(t);else if(this._isServerSub(e)){const s={channel:e,info:this._getJoinLeaveContext(t.info)};this.emit("leave",s)}}_handleUnsubscribe(e,t){const s=this._getSub(e);s?t.code<2500?s._setUnsubscribed(t.code,t.reason,!1):s._setSubscribing(t.code,t.reason):this._isServerSub(e)&&(delete this._serverSubs[e],this.emit("unsubscribed",{channel:e}))}_handleSubscribe(e,t){this._serverSubs[e]={offset:t.offset,epoch:t.epoch,recoverable:t.recoverable||!1},this.emit("subscribed",this._getSubscribeContext(e,t))}_handleDisconnect(e){const t=e.code;let s=!0;(t>=3500&&t<4e3||t>=4500&&t<5e3)&&(s=!1),this._disconnect(t,e.reason,s)}_getPublicationContext(e,t){const s={channel:e,data:t.data};return t.offset&&(s.offset=t.offset),t.info&&(s.info=this._getJoinLeaveContext(t.info)),t.tags&&(s.tags=t.tags),s}_getJoinLeaveContext(e){const t={client:e.client,user:e.user};return e.conn_info&&(t.connInfo=e.conn_info),e.chan_info&&(t.chanInfo=e.chan_info),t}_handlePublication(e,t){const s=this._getSub(e);if(s)s._handlePublication(t);else if(this._isServerSub(e)){const s=this._getPublicationContext(e,t);this.emit("publication",s),void 0!==t.offset&&(this._serverSubs[e].offset=t.offset)}}_handleMessage(e){this.emit("message",{data:e.data})}_handleServerPing(e){if(this._sendPong){const e={};this._transportSendCommands([e])}e()}_handlePush(e,t){const s=e.channel;e.pub?this._handlePublication(s,e.pub):e.message?this._handleMessage(e.message):e.join?this._handleJoin(s,e.join):e.leave?this._handleLeave(s,e.leave):e.unsubscribe?this._handleUnsubscribe(s,e.unsubscribe):e.subscribe?this._handleSubscribe(s,e.subscribe):e.disconnect&&this._handleDisconnect(e.disconnect),t()}_flush(){const e=this._commands.slice(0);this._commands=[],this._transportSendCommands(e)}_createErrorObject(e,t,s){const n={code:e,message:t};return s&&(n.temporary=!0),n}_registerCall(e,t,s){this._callbacks[e]={callback:t,errback:s,timeout:null},this._callbacks[e].timeout=setTimeout((()=>{delete this._callbacks[e],(0,p.isFunction)(s)&&s({error:this._createErrorObject(o.errorCodes.timeout,"timeout")})}),this._config.timeout)}_addCommand(e){this._batching?this._commands.push(e):this._transportSendCommands([e])}_nextPromiseId(){return++this._promiseId}_resolvePromises(){for(const e in this._promises)this._promises[e].timeout&&clearTimeout(this._promises[e].timeout),this._promises[e].resolve(),delete this._promises[e]}_rejectPromises(e){for(const t in this._promises)this._promises[t].timeout&&clearTimeout(this._promises[t].timeout),this._promises[t].reject(e),delete this._promises[t]}}t.Centrifuge=Centrifuge,Centrifuge.SubscriptionState=f.SubscriptionState,Centrifuge.State=f.State},7370:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unsubscribedCodes=t.subscribingCodes=t.disconnectedCodes=t.connectingCodes=t.errorCodes=void 0,t.errorCodes={timeout:1,transportClosed:2,clientDisconnected:3,clientClosed:4,clientConnectToken:5,clientRefreshToken:6,subscriptionUnsubscribed:7,subscriptionSubscribeToken:8,subscriptionRefreshToken:9,transportWriteError:10,connectionClosed:11},t.connectingCodes={connectCalled:0,transportClosed:1,noPing:2,subscribeTimeout:3,unsubscribeError:4},t.disconnectedCodes={disconnectCalled:0,unauthorized:1,badProtocol:2,messageSizeLimit:3},t.subscribingCodes={subscribeCalled:0,transportClosed:1},t.unsubscribedCodes={unsubscribeCalled:0,unauthorized:1,clientClosed:2}},9386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JsonDecoder=t.JsonEncoder=void 0;t.JsonEncoder=class JsonEncoder{encodeCommands(e){return e.map((e=>JSON.stringify(e))).join("\n")}};t.JsonDecoder=class JsonDecoder{decodeReplies(e){return e.trim().split("\n").map((e=>JSON.parse(e)))}}},5641:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtobufDecoder=t.ProtobufEncoder=void 0;const n=s(2601),a=s(4492),o=a.Root.fromJSON(s(7725)),c=o.lookupType("protocol.Command"),u=o.lookupType("protocol.Reply"),l=o.lookupType("protocol.EmulationRequest");class ProtobufEncoder{encodeEmulationRequest(e){const t=a.Writer.create();return l.encode(e,t),t.finish()}encodeCommands(e){const t=a.Writer.create();for(const s in e)if(e.hasOwnProperty(s)){const n=Object.assign({},e[s]);c.encodeDelimited(n,t)}return t.finish()}}t.ProtobufEncoder=ProtobufEncoder;class ProtobufDecoder{decodeReplies(e){const t=[],s=a.Reader.create(new Uint8Array(e));for(;s.pos<s.len;){const e=u.decodeDelimited(s);t.push(e)}return t}decodeReply(e){const t=a.Reader.create(new Uint8Array(e));for(;t.pos<t.len;)return u.decodeDelimited(t),{ok:!0,pos:t.pos};return{ok:!1}}}t.ProtobufDecoder=ProtobufDecoder;class CentrifugeProtobuf extends n.Centrifuge{_formatOverride(e){return"protobuf"===e&&(this._encoder=new ProtobufEncoder,this._decoder=new ProtobufDecoder,!0)}}t.default=CentrifugeProtobuf},3562:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Subscription=void 0;const a=n(s(7187)),o=s(7370),c=s(2847),u=s(1632);class Subscription extends a.default{constructor(e,t,s){super(),this._resubscribeTimeout=null,this._refreshTimeout=null,this.channel=t,this.state=c.SubscriptionState.Unsubscribed,this._centrifuge=e,this._token=null,this._getToken=null,this._data=null,this._recover=!1,this._offset=null,this._epoch=null,this._recoverable=!1,this._positioned=!1,this._joinLeave=!1,this._minResubscribeDelay=500,this._maxResubscribeDelay=2e4,this._resubscribeTimeout=null,this._resubscribeAttempts=0,this._promises={},this._promiseId=0,this._inflight=!1,this._refreshTimeout=null,this._setOptions(s),this._centrifuge._debugEnabled?(this.on("state",(e=>{this._centrifuge._debug("subscription state",t,e.oldState,"->",e.newState)})),this.on("error",(e=>{this._centrifuge._debug("subscription error",t,e)}))):this.on("error",(function(){Function.prototype()}))}ready(e){return this.state===c.SubscriptionState.Unsubscribed?Promise.reject({code:o.errorCodes.subscriptionUnsubscribed,message:this.state}):this.state===c.SubscriptionState.Subscribed?Promise.resolve():new Promise(((t,s)=>{const n={resolve:t,reject:s};e&&(n.timeout=setTimeout((function(){s({code:o.errorCodes.timeout,message:"timeout"})}),e)),this._promises[this._nextPromiseId()]=n}))}subscribe(){this._isSubscribed()||(this._resubscribeAttempts=0,this._setSubscribing(o.subscribingCodes.subscribeCalled,"subscribe called"))}unsubscribe(){this._setUnsubscribed(o.unsubscribedCodes.unsubscribeCalled,"unsubscribe called",!0)}publish(e){const t=this;return this._methodCall().then((function(){return t._centrifuge.publish(t.channel,e)}))}presence(){const e=this;return this._methodCall().then((function(){return e._centrifuge.presence(e.channel)}))}presenceStats(){const e=this;return this._methodCall().then((function(){return e._centrifuge.presenceStats(e.channel)}))}history(e){const t=this;return this._methodCall().then((function(){return t._centrifuge.history(t.channel,e)}))}_methodCall(){return this._isSubscribed()?Promise.resolve():this._isUnsubscribed()?Promise.reject({code:o.errorCodes.subscriptionUnsubscribed,message:this.state}):new Promise(((e,t)=>{const s=setTimeout((function(){t({code:o.errorCodes.timeout,message:"timeout"})}),this._centrifuge._config.timeout);this._promises[this._nextPromiseId()]={timeout:s,resolve:e,reject:t}}))}_nextPromiseId(){return++this._promiseId}_needRecover(){return!0===this._recover}_isUnsubscribed(){return this.state===c.SubscriptionState.Unsubscribed}_isSubscribing(){return this.state===c.SubscriptionState.Subscribing}_isSubscribed(){return this.state===c.SubscriptionState.Subscribed}_setState(e){if(this.state!==e){const t=this.state;return this.state=e,this.emit("state",{newState:e,oldState:t,channel:this.channel}),!0}return!1}_usesToken(){return null!==this._token||null!==this._getToken}_clearSubscribingState(){this._resubscribeAttempts=0,this._clearResubscribeTimeout()}_clearSubscribedState(){this._clearRefreshTimeout()}_setSubscribed(e){if(!this._isSubscribing())return;this._clearSubscribingState(),e.recoverable&&(this._recover=!0,this._offset=e.offset||0,this._epoch=e.epoch||""),this._setState(c.SubscriptionState.Subscribed);const t=this._centrifuge._getSubscribeContext(this.channel,e);this.emit("subscribed",t),this._resolvePromises();const s=e.publications;if(s&&s.length>0)for(const e in s)s.hasOwnProperty(e)&&this._handlePublication(s[e]);!0===e.expires&&(this._refreshTimeout=setTimeout((()=>this._refresh()),(0,u.ttlMilliseconds)(e.ttl)))}_setSubscribing(e,t){this._isSubscribing()||(this._isSubscribed()&&this._clearSubscribedState(),this._setState(c.SubscriptionState.Subscribing)&&this.emit("subscribing",{channel:this.channel,code:e,reason:t}),this._subscribe(!1,!1))}_subscribe(e,t){if(this._centrifuge._debug("subscribing on",this.channel),this._centrifuge.state!==c.State.Connected&&!e)return this._centrifuge._debug("delay subscribe on",this.channel,"till connected"),null;if(this._usesToken()){if(this._token)return this._sendSubscribe(this._token,t);{if(e)return null;const t=this;return this._getSubscriptionToken().then((function(e){t._isSubscribing()&&(e?(t._token=e,t._sendSubscribe(e,!1)):t._failUnauthorized())})).catch((function(e){t._isSubscribing()&&(t.emit("error",{type:"subscribeToken",channel:t.channel,error:{code:o.errorCodes.subscriptionSubscribeToken,message:void 0!==e?e.toString():""}}),t._scheduleResubscribe())})),null}}return this._sendSubscribe("",t)}_sendSubscribe(e,t){const s={channel:this.channel};if(e&&(s.token=e),this._data&&(s.data=this._data),this._positioned&&(s.positioned=!0),this._recoverable&&(s.recoverable=!0),this._joinLeave&&(s.join_leave=!0),this._needRecover()){s.recover=!0;const e=this._getOffset();e&&(s.offset=e);const t=this._getEpoch();t&&(s.epoch=t)}const n={subscribe:s};return this._inflight=!0,this._centrifuge._call(n,t).then((e=>{this._inflight=!1;const t=e.reply.subscribe;this._handleSubscribeResponse(t),e.next&&e.next()}),(e=>{this._inflight=!1,this._handleSubscribeError(e.error),e.next&&e.next()})),n}_handleSubscribeError(e){this._isSubscribing()&&(e.code!==o.errorCodes.timeout?this._subscribeError(e):this._centrifuge._disconnect(o.connectingCodes.subscribeTimeout,"subscribe timeout",!0))}_handleSubscribeResponse(e){this._isSubscribing()&&this._setSubscribed(e)}_setUnsubscribed(e,t,s){this._isUnsubscribed()||(this._isSubscribed()&&(s&&this._centrifuge._unsubscribe(this),this._clearSubscribedState()),this._isSubscribing()&&this._clearSubscribingState(),this._setState(c.SubscriptionState.Unsubscribed)&&this.emit("unsubscribed",{channel:this.channel,code:e,reason:t}),this._rejectPromises({code:o.errorCodes.subscriptionUnsubscribed,message:this.state}))}_handlePublication(e){const t=this._centrifuge._getPublicationContext(this.channel,e);this.emit("publication",t),e.offset&&(this._offset=e.offset)}_handleJoin(e){const t=this._centrifuge._getJoinLeaveContext(e.info);this.emit("join",{channel:this.channel,info:t})}_handleLeave(e){const t=this._centrifuge._getJoinLeaveContext(e.info);this.emit("leave",{channel:this.channel,info:t})}_resolvePromises(){for(const e in this._promises)this._promises[e].timeout&&clearTimeout(this._promises[e].timeout),this._promises[e].resolve(),delete this._promises[e]}_rejectPromises(e){for(const t in this._promises)this._promises[t].timeout&&clearTimeout(this._promises[t].timeout),this._promises[t].reject(e),delete this._promises[t]}_scheduleResubscribe(){const e=this,t=this._getResubscribeDelay();this._resubscribeTimeout=setTimeout((function(){e._isSubscribing()&&e._subscribe(!1,!1)}),t)}_subscribeError(e){if(this._isSubscribing())if(e.code<100||109===e.code||!0===e.temporary){109===e.code&&(this._token=null);const t={channel:this.channel,type:"subscribe",error:e};this._centrifuge.state===c.State.Connected&&this.emit("error",t),this._scheduleResubscribe()}else this._setUnsubscribed(e.code,e.message,!1)}_getResubscribeDelay(){const e=(0,u.backoff)(this._resubscribeAttempts,this._minResubscribeDelay,this._maxResubscribeDelay);return this._resubscribeAttempts++,e}_setOptions(e){e&&(e.since&&(this._offset=e.since.offset,this._epoch=e.since.epoch,this._recover=!0),e.data&&(this._data=e.data),void 0!==e.minResubscribeDelay&&(this._minResubscribeDelay=e.minResubscribeDelay),void 0!==e.maxResubscribeDelay&&(this._maxResubscribeDelay=e.maxResubscribeDelay),e.token&&(this._token=e.token),e.getToken&&(this._getToken=e.getToken),!0===e.positioned&&(this._positioned=!0),!0===e.recoverable&&(this._recoverable=!0),!0===e.joinLeave&&(this._joinLeave=!0))}_getOffset(){const e=this._offset;return null!==e?e:0}_getEpoch(){const e=this._epoch;return null!==e?e:""}_clearRefreshTimeout(){null!==this._refreshTimeout&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null)}_clearResubscribeTimeout(){null!==this._resubscribeTimeout&&(clearTimeout(this._resubscribeTimeout),this._resubscribeTimeout=null)}_getSubscriptionToken(){this._centrifuge._debug("get subscription token for channel",this.channel);const e={channel:this.channel},t=this._getToken;if(null===t)throw new Error("provide a function to get channel subscription token");return t(e)}_refresh(){this._clearRefreshTimeout();const e=this;this._getSubscriptionToken().then((function(t){if(!e._isSubscribed())return;if(!t)return void e._failUnauthorized();e._token=t;const s={sub_refresh:{channel:e.channel,token:t}};e._centrifuge._call(s).then((t=>{const s=t.reply.sub_refresh;e._refreshResponse(s),t.next&&t.next()}),(t=>{e._refreshError(t.error),t.next&&t.next()}))})).catch((function(t){e.emit("error",{type:"refreshToken",channel:e.channel,error:{code:o.errorCodes.subscriptionRefreshToken,message:void 0!==t?t.toString():""}}),e._refreshTimeout=setTimeout((()=>e._refresh()),e._getRefreshRetryDelay())}))}_refreshResponse(e){this._isSubscribed()&&(this._centrifuge._debug("subscription token refreshed, channel",this.channel),this._clearRefreshTimeout(),!0===e.expires&&(this._refreshTimeout=setTimeout((()=>this._refresh()),(0,u.ttlMilliseconds)(e.ttl))))}_refreshError(e){this._isSubscribed()&&(e.code<100||!0===e.temporary?(this.emit("error",{type:"refresh",channel:this.channel,error:e}),this._refreshTimeout=setTimeout((()=>this._refresh()),this._getRefreshRetryDelay())):this._setUnsubscribed(e.code,e.message,!0))}_getRefreshRetryDelay(){return(0,u.backoff)(0,1e4,2e4)}_failUnauthorized(){this._setUnsubscribed(o.unsubscribedCodes.unauthorized,"unauthorized",!0)}}t.Subscription=Subscription},8270:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpStreamTransport=void 0;t.HttpStreamTransport=class HttpStreamTransport{constructor(e,t){this.endpoint=e,this.options=t,this._abortController=null,this._utf8decoder=new TextDecoder,this._protocol="json"}name(){return"http_stream"}subName(){return"http_stream"}emulation(){return!0}_handleErrors(e){if(!e.ok)throw new Error(e.status);return e}_fetchEventTarget(e,t,s){const n=new EventTarget;return(0,e.options.fetch)(t,s).then(e._handleErrors).then((t=>{n.dispatchEvent(new Event("open"));let s="",a=0,o=new Uint8Array;const c=t.body.getReader();return new e.options.readableStream({start:t=>function u(){return c.read().then((({done:c,value:l})=>{if(c)return n.dispatchEvent(new Event("close")),void t.close();try{if("json"===e._protocol)for(s+=e._utf8decoder.decode(l);a<s.length;)if("\n"===s[a]){const e=s.substring(0,a);n.dispatchEvent(new MessageEvent("message",{data:e})),s=s.substring(a+1),a=0}else++a;else{const t=new Uint8Array(o.length+l.length);for(t.set(o),t.set(l,o.length),o=t;;){const t=e.options.decoder.decodeReply(o);if(!t.ok)break;{const e=o.slice(0,t.pos);n.dispatchEvent(new MessageEvent("message",{data:e})),o=o.slice(t.pos)}}}}catch(e){return n.dispatchEvent(new Event("error",{detail:e})),n.dispatchEvent(new Event("close")),void t.close()}u()})).catch((function(e){n.dispatchEvent(new Event("error",{detail:e})),n.dispatchEvent(new Event("close")),t.close()}))}()})})).catch((e=>{n.dispatchEvent(new Event("error",{detail:e})),n.dispatchEvent(new Event("close"))})),n}supported(){return null!==this.options.fetch&&null!==this.options.readableStream&&"undefined"!=typeof TextDecoder&&"undefined"!=typeof AbortController&&"undefined"!=typeof EventTarget&&"undefined"!=typeof Event&&"undefined"!=typeof MessageEvent&&"undefined"!=typeof Error}initialize(e,t,s){let n,a;this._protocol=e,this._abortController=new AbortController,"json"===e?(n={Accept:"application/json","Content-Type":"application/json"},a=s):(n={Accept:"application/octet-stream","Content-Type":"application/octet-stream"},a=s);const o={method:"POST",headers:n,body:a,mode:"cors",credentials:"same-origin",cache:"no-cache",signal:this._abortController.signal},c=this._fetchEventTarget(this,this.endpoint,o);c.addEventListener("open",(()=>{t.onOpen()})),c.addEventListener("error",(e=>{this._abortController.abort(),t.onError(e)})),c.addEventListener("close",(()=>{this._abortController.abort(),t.onClose({code:4,reason:"connection closed"})})),c.addEventListener("message",(e=>{t.onMessage(e.data)}))}close(){this._abortController.abort()}send(e,t,s){let n,a;const o={session:t,node:s,data:e};"json"===this._protocol?(n={"Content-Type":"application/json"},a=JSON.stringify(o)):(n={"Content-Type":"application/octet-stream"},a=this.options.encoder.encodeEmulationRequest(o));const c={method:"POST",headers:n,body:a,mode:"cors",credentials:"same-origin",cache:"no-cache"};(0,this.options.fetch)(this.options.emulationEndpoint,c)}}},4957:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SockjsTransport=void 0;t.SockjsTransport=class SockjsTransport{constructor(e,t){this.endpoint=e,this.options=t,this._transport=null}name(){return"sockjs"}subName(){return"sockjs-"+this._transport.transport}emulation(){return!1}supported(){return null!==this.options.sockjs}initialize(e,t){this._transport=new this.options.sockjs(this.endpoint,null,this.options.sockjsOptions),this._transport.onopen=()=>{t.onOpen()},this._transport.onerror=e=>{t.onError(e)},this._transport.onclose=e=>{t.onClose(e)},this._transport.onmessage=e=>{t.onMessage(e.data)}}close(){this._transport.close()}send(e){this._transport.send(e)}}},7817:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SseTransport=void 0;t.SseTransport=class SseTransport{constructor(e,t){this.endpoint=e,this.options=t,this._protocol="json",this._transport=null,this._onClose=null}name(){return"sse"}subName(){return"sse"}emulation(){return!0}supported(){return null!==this.options.eventsource&&null!==this.options.fetch}initialize(e,t,s){let n;n=globalThis&&globalThis.document&&globalThis.document.baseURI?new URL(this.endpoint,globalThis.document.baseURI):new URL(this.endpoint),n.searchParams.append("cf_connect",s);const a=new this.options.eventsource(n.toString(),{});this._transport=a;a.onopen=function(){t.onOpen()},a.onerror=function(e){a.close(),t.onError(e),t.onClose({code:4,reason:"connection closed"})},a.onmessage=function(e){t.onMessage(e.data)},this._onClose=function(){t.onClose({code:4,reason:"connection closed"})}}close(){this._transport.close(),null!==this._onClose&&this._onClose()}send(e,t,s){const n={session:t,node:s,data:e},a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),mode:"cors",credentials:"same-origin",cache:"no-cache"};(0,this.options.fetch)(this.options.emulationEndpoint,a)}}},6026:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebsocketTransport=void 0;t.WebsocketTransport=class WebsocketTransport{constructor(e,t){this.endpoint=e,this.options=t,this._transport=null}name(){return"websocket"}subName(){return"websocket"}emulation(){return!1}supported(){return void 0!==this.options.websocket&&null!==this.options.websocket}initialize(e,t){let s="";"protobuf"===e&&(s="centrifuge-protobuf"),this._transport=""!==s?new this.options.websocket(this.endpoint,s):new this.options.websocket(this.endpoint),"protobuf"===e&&(this._transport.binaryType="arraybuffer"),this._transport.onopen=()=>{t.onOpen()},this._transport.onerror=e=>{t.onError(e)},this._transport.onclose=e=>{t.onClose(e)},this._transport.onmessage=e=>{t.onMessage(e.data)}}close(){this._transport.close()}send(e){this._transport.send(e)}}},4903:function(e,t){"use strict";var s=this&&this.__awaiter||function(e,t,s,n){return new(s||(s=Promise))((function(a,o){function c(e){try{l(n.next(e))}catch(e){o(e)}}function u(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(c,u)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WebtransportTransport=void 0;t.WebtransportTransport=class WebtransportTransport{constructor(e,t){this.endpoint=e,this.options=t,this._transport=null,this._stream=null,this._writer=null,this._utf8decoder=new TextDecoder,this._protocol="json"}name(){return"webtransport"}subName(){return"webtransport"}emulation(){return!1}supported(){return void 0!==this.options.webtransport&&null!==this.options.webtransport}initialize(e,t){return s(this,void 0,void 0,(function*(){let s;s=globalThis&&globalThis.document&&globalThis.document.baseURI?new URL(this.endpoint,globalThis.document.baseURI):new URL(this.endpoint),"protobuf"===e&&s.searchParams.append("cf_protocol","protobuf"),this._protocol=e;const n=new EventTarget;this._transport=new this.options.webtransport(s.toString()),this._transport.closed.then((()=>{t.onClose({code:4,reason:"connection closed"})})).catch((()=>{t.onClose({code:4,reason:"connection closed"})}));try{yield this._transport.ready}catch(e){return void this.close()}let a;try{a=yield this._transport.createBidirectionalStream()}catch(e){return void this.close()}this._stream=a,this._writer=this._stream.writable.getWriter(),n.addEventListener("close",(()=>{t.onClose({code:4,reason:"connection closed"})})),n.addEventListener("message",(e=>{t.onMessage(e.data)})),this._startReading(n),t.onOpen()}))}_startReading(e){return s(this,void 0,void 0,(function*(){const t=this._stream.readable.getReader();let s="",n=0,a=new Uint8Array;try{for(;;){const{done:o,value:c}=yield t.read();if(c.length>0)if("json"===this._protocol)for(s+=this._utf8decoder.decode(c);n<s.length;)if("\n"===s[n]){const t=s.substring(0,n);e.dispatchEvent(new MessageEvent("message",{data:t})),s=s.substring(n+1),n=0}else++n;else{const t=new Uint8Array(a.length+c.length);for(t.set(a),t.set(c,a.length),a=t;;){const t=this.options.decoder.decodeReply(a);if(!t.ok)break;{const s=a.slice(0,t.pos);e.dispatchEvent(new MessageEvent("message",{data:s})),a=a.slice(t.pos)}}}if(o)break}}catch(t){e.dispatchEvent(new Event("close"))}}))}close(){return s(this,void 0,void 0,(function*(){try{this._writer&&(yield this._writer.close()),this._transport.close()}catch(e){}}))}send(e){return s(this,void 0,void 0,(function*(){let t;t="json"===this._protocol?(new TextEncoder).encode(e+"\n"):e;try{yield this._writer.write(t)}catch(e){this.close()}}))}}},2847:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptionState=t.State=void 0,function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected"}(t.State||(t.State={})),function(e){e.Unsubscribed="unsubscribed",e.Subscribing="subscribing",e.Subscribed="subscribed"}(t.SubscriptionState||(t.SubscriptionState={}))},1632:(e,t)=>{"use strict";function s(e){return null!=e&&"function"==typeof e}Object.defineProperty(t,"__esModule",{value:!0}),t.ttlMilliseconds=t.errorExists=t.backoff=t.log=t.isFunction=t.startsWith=void 0,t.startsWith=function(e,t){return 0===e.lastIndexOf(t,0)},t.isFunction=s,t.log=function(e,t){if(globalThis.console){const n=globalThis.console[e];s(n)&&n.apply(globalThis.console,t)}},t.backoff=function(e,t,s){e>31&&(e=31);const n=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)}(0,Math.min(s,t*Math.pow(2,e)));return Math.min(s,t+n)},t.errorExists=function(e){return"error"in e&&null!==e.error},t.ttlMilliseconds=function(e){return Math.min(1e3*e,2147483647)}},452:function(e,t,s){var n;e.exports=(n=s(8249),s(8269),s(8214),s(888),s(5109),function(){var e=n,t=e.lib.BlockCipher,s=e.algo,a=[],o=[],c=[],u=[],l=[],d=[],h=[],_=[],p=[],f=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var s=0,n=0;for(t=0;t<256;t++){var m=n^n<<1^n<<2^n<<3^n<<4;m=m>>>8^255&m^99,a[s]=m,o[m]=s;var y=e[s],w=e[y],g=e[w],v=257*e[m]^16843008*m;c[s]=v<<24|v>>>8,u[s]=v<<16|v>>>16,l[s]=v<<8|v>>>24,d[s]=v,v=16843009*g^65537*w^257*y^16843008*s,h[m]=v<<24|v>>>8,_[m]=v<<16|v>>>16,p[m]=v<<8|v>>>24,f[m]=v,s?(s=y^e[e[e[g^y]]],n^=e[e[n]]):s=n=1}}();var m=[0,1,2,4,8,16,32,64,128,27,54],y=s.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,s=e.sigBytes/4,n=4*((this._nRounds=s+6)+1),o=this._keySchedule=[],c=0;c<n;c++)c<s?o[c]=t[c]:(d=o[c-1],c%s?s>6&&c%s==4&&(d=a[d>>>24]<<24|a[d>>>16&255]<<16|a[d>>>8&255]<<8|a[255&d]):(d=a[(d=d<<8|d>>>24)>>>24]<<24|a[d>>>16&255]<<16|a[d>>>8&255]<<8|a[255&d],d^=m[c/s|0]<<24),o[c]=o[c-s]^d);for(var u=this._invKeySchedule=[],l=0;l<n;l++){if(c=n-l,l%4)var d=o[c];else d=o[c-4];u[l]=l<4||c<=4?d:h[a[d>>>24]]^_[a[d>>>16&255]]^p[a[d>>>8&255]]^f[a[255&d]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,c,u,l,d,a)},decryptBlock:function(e,t){var s=e[t+1];e[t+1]=e[t+3],e[t+3]=s,this._doCryptBlock(e,t,this._invKeySchedule,h,_,p,f,o),s=e[t+1],e[t+1]=e[t+3],e[t+3]=s},_doCryptBlock:function(e,t,s,n,a,o,c,u){for(var l=this._nRounds,d=e[t]^s[0],h=e[t+1]^s[1],_=e[t+2]^s[2],p=e[t+3]^s[3],f=4,m=1;m<l;m++){var y=n[d>>>24]^a[h>>>16&255]^o[_>>>8&255]^c[255&p]^s[f++],w=n[h>>>24]^a[_>>>16&255]^o[p>>>8&255]^c[255&d]^s[f++],g=n[_>>>24]^a[p>>>16&255]^o[d>>>8&255]^c[255&h]^s[f++],v=n[p>>>24]^a[d>>>16&255]^o[h>>>8&255]^c[255&_]^s[f++];d=y,h=w,_=g,p=v}y=(u[d>>>24]<<24|u[h>>>16&255]<<16|u[_>>>8&255]<<8|u[255&p])^s[f++],w=(u[h>>>24]<<24|u[_>>>16&255]<<16|u[p>>>8&255]<<8|u[255&d])^s[f++],g=(u[_>>>24]<<24|u[p>>>16&255]<<16|u[d>>>8&255]<<8|u[255&h])^s[f++],v=(u[p>>>24]<<24|u[d>>>16&255]<<16|u[h>>>8&255]<<8|u[255&_])^s[f++],e[t]=y,e[t+1]=w,e[t+2]=g,e[t+3]=v},keySize:8});e.AES=t._createHelper(y)}(),n.AES)},5109:function(e,t,s){var n;e.exports=(n=s(8249),s(888),void(n.lib.Cipher||function(e){var t=n,s=t.lib,a=s.Base,o=s.WordArray,c=s.BufferedBlockAlgorithm,u=t.enc,l=(u.Utf8,u.Base64),d=t.algo.EvpKDF,h=s.Cipher=c.extend({cfg:a.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,s){this.cfg=this.cfg.extend(s),this._xformMode=e,this._key=t,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?E:g}return function(t){return{encrypt:function(s,n,a){return e(n).encrypt(t,s,n,a)},decrypt:function(s,n,a){return e(n).decrypt(t,s,n,a)}}}}()}),_=(s.StreamCipher=h.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),t.mode={}),p=s.BlockCipherMode=a.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),f=_.CBC=function(){var t=p.extend();function s(t,s,n){var a,o=this._iv;o?(a=o,this._iv=e):a=this._prevBlock;for(var c=0;c<n;c++)t[s+c]^=a[c]}return t.Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,a=n.blockSize;s.call(this,e,t,a),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+a)}}),t.Decryptor=t.extend({processBlock:function(e,t){var n=this._cipher,a=n.blockSize,o=e.slice(t,t+a);n.decryptBlock(e,t),s.call(this,e,t,a),this._prevBlock=o}}),t}(),m=(t.pad={}).Pkcs7={pad:function(e,t){for(var s=4*t,n=s-e.sigBytes%s,a=n<<24|n<<16|n<<8|n,c=[],u=0;u<n;u+=4)c.push(a);var l=o.create(c,n);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},y=(s.BlockCipher=h.extend({cfg:h.cfg.extend({mode:f,padding:m}),reset:function(){var e;h.reset.call(this);var t=this.cfg,s=t.iv,n=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=n.createEncryptor:(e=n.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,s&&s.words):(this._mode=e.call(n,this,s&&s.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),s.CipherParams=a.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),w=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,s=e.salt;return(s?o.create([1398893684,1701076831]).concat(s).concat(t):t).toString(l)},parse:function(e){var t,s=l.parse(e),n=s.words;return 1398893684==n[0]&&1701076831==n[1]&&(t=o.create(n.slice(2,4)),n.splice(0,4),s.sigBytes-=16),y.create({ciphertext:s,salt:t})}},g=s.SerializableCipher=a.extend({cfg:a.extend({format:w}),encrypt:function(e,t,s,n){n=this.cfg.extend(n);var a=e.createEncryptor(s,n),o=a.finalize(t),c=a.cfg;return y.create({ciphertext:o,key:s,iv:c.iv,algorithm:e,mode:c.mode,padding:c.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,s,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(s,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),v=(t.kdf={}).OpenSSL={execute:function(e,t,s,n){n||(n=o.random(8));var a=d.create({keySize:t+s}).compute(e,n),c=o.create(a.words.slice(t),4*s);return a.sigBytes=4*t,y.create({key:a,iv:c,salt:n})}},E=s.PasswordBasedCipher=g.extend({cfg:g.cfg.extend({kdf:v}),encrypt:function(e,t,s,n){var a=(n=this.cfg.extend(n)).kdf.execute(s,e.keySize,e.ivSize);n.iv=a.iv;var o=g.encrypt.call(this,e,t,a.key,n);return o.mixIn(a),o},decrypt:function(e,t,s,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var a=n.kdf.execute(s,e.keySize,e.ivSize,t.salt);return n.iv=a.iv,g.decrypt.call(this,e,t,a.key,n)}})}()))},8249:function(e,t,s){var n;e.exports=(n=n||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==s.g&&s.g.crypto&&(n=s.g.crypto),!n)try{n=s(2480)}catch(e){}var a=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var s;return e.prototype=t,s=new e,e.prototype=null,s}}(),c={},u=c.lib={},l=u.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},d=u.WordArray=l.extend({init:function(e,s){e=this.words=e||[],this.sigBytes=s!=t?s:4*e.length},toString:function(e){return(e||_).stringify(this)},concat:function(e){var t=this.words,s=e.words,n=this.sigBytes,a=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<a;o++){var c=s[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=c<<24-(n+o)%4*8}else for(var u=0;u<a;u+=4)t[n+u>>>2]=s[u>>>2];return this.sigBytes+=a,this},clamp:function(){var t=this.words,s=this.sigBytes;t[s>>>2]&=4294967295<<32-s%4*8,t.length=e.ceil(s/4)},clone:function(){var e=l.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],s=0;s<e;s+=4)t.push(a());return new d.init(t,e)}}),h=c.enc={},_=h.Hex={stringify:function(e){for(var t=e.words,s=e.sigBytes,n=[],a=0;a<s;a++){var o=t[a>>>2]>>>24-a%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,s=[],n=0;n<t;n+=2)s[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new d.init(s,t/2)}},p=h.Latin1={stringify:function(e){for(var t=e.words,s=e.sigBytes,n=[],a=0;a<s;a++){var o=t[a>>>2]>>>24-a%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,s=[],n=0;n<t;n++)s[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new d.init(s,t)}},f=h.Utf8={stringify:function(e){try{return decodeURIComponent(escape(p.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},m=u.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var s,n=this._data,a=n.words,o=n.sigBytes,c=this.blockSize,u=o/(4*c),l=(u=t?e.ceil(u):e.max((0|u)-this._minBufferSize,0))*c,h=e.min(4*l,o);if(l){for(var _=0;_<l;_+=c)this._doProcessBlock(a,_);s=a.splice(0,l),n.sigBytes-=h}return new d.init(s,h)},clone:function(){var e=l.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),y=(u.Hasher=m.extend({cfg:l.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,s){return new e.init(s).finalize(t)}},_createHmacHelper:function(e){return function(t,s){return new y.HMAC.init(e,s).finalize(t)}}}),c.algo={});return c}(Math),n)},8269:function(e,t,s){var n;e.exports=(n=s(8249),function(){var e=n,t=e.lib.WordArray;function s(e,s,n){for(var a=[],o=0,c=0;c<s;c++)if(c%4){var u=n[e.charCodeAt(c-1)]<<c%4*2|n[e.charCodeAt(c)]>>>6-c%4*2;a[o>>>2]|=u<<24-o%4*8,o++}return t.create(a,o)}e.enc.Base64={stringify:function(e){var t=e.words,s=e.sigBytes,n=this._map;e.clamp();for(var a=[],o=0;o<s;o+=3)for(var c=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,u=0;u<4&&o+.75*u<s;u++)a.push(n.charAt(c>>>6*(3-u)&63));var l=n.charAt(64);if(l)for(;a.length%4;)a.push(l);return a.join("")},parse:function(e){var t=e.length,n=this._map,a=this._reverseMap;if(!a){a=this._reverseMap=[];for(var o=0;o<n.length;o++)a[n.charCodeAt(o)]=o}var c=n.charAt(64);if(c){var u=e.indexOf(c);-1!==u&&(t=u)}return s(e,t,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),n.enc.Base64)},3786:function(e,t,s){var n;e.exports=(n=s(8249),function(){var e=n,t=e.lib.WordArray;function s(e,s,n){for(var a=[],o=0,c=0;c<s;c++)if(c%4){var u=n[e.charCodeAt(c-1)]<<c%4*2|n[e.charCodeAt(c)]>>>6-c%4*2;a[o>>>2]|=u<<24-o%4*8,o++}return t.create(a,o)}e.enc.Base64url={stringify:function(e,t=!0){var s=e.words,n=e.sigBytes,a=t?this._safe_map:this._map;e.clamp();for(var o=[],c=0;c<n;c+=3)for(var u=(s[c>>>2]>>>24-c%4*8&255)<<16|(s[c+1>>>2]>>>24-(c+1)%4*8&255)<<8|s[c+2>>>2]>>>24-(c+2)%4*8&255,l=0;l<4&&c+.75*l<n;l++)o.push(a.charAt(u>>>6*(3-l)&63));var d=a.charAt(64);if(d)for(;o.length%4;)o.push(d);return o.join("")},parse:function(e,t=!0){var n=e.length,a=t?this._safe_map:this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var c=0;c<a.length;c++)o[a.charCodeAt(c)]=c}var u=a.charAt(64);if(u){var l=e.indexOf(u);-1!==l&&(n=l)}return s(e,n,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}}(),n.enc.Base64url)},298:function(e,t,s){var n;e.exports=(n=s(8249),function(){var e=n,t=e.lib.WordArray,s=e.enc;function a(e){return e<<8&4278255360|e>>>8&16711935}s.Utf16=s.Utf16BE={stringify:function(e){for(var t=e.words,s=e.sigBytes,n=[],a=0;a<s;a+=2){var o=t[a>>>2]>>>16-a%4*8&65535;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var s=e.length,n=[],a=0;a<s;a++)n[a>>>1]|=e.charCodeAt(a)<<16-a%2*16;return t.create(n,2*s)}},s.Utf16LE={stringify:function(e){for(var t=e.words,s=e.sigBytes,n=[],o=0;o<s;o+=2){var c=a(t[o>>>2]>>>16-o%4*8&65535);n.push(String.fromCharCode(c))}return n.join("")},parse:function(e){for(var s=e.length,n=[],o=0;o<s;o++)n[o>>>1]|=a(e.charCodeAt(o)<<16-o%2*16);return t.create(n,2*s)}}}(),n.enc.Utf16)},888:function(e,t,s){var n,a,o,c,u,l,d,h;e.exports=(h=s(8249),s(2783),s(9824),a=(n=h).lib,o=a.Base,c=a.WordArray,u=n.algo,l=u.MD5,d=u.EvpKDF=o.extend({cfg:o.extend({keySize:4,hasher:l,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var s,n=this.cfg,a=n.hasher.create(),o=c.create(),u=o.words,l=n.keySize,d=n.iterations;u.length<l;){s&&a.update(s),s=a.update(e).finalize(t),a.reset();for(var h=1;h<d;h++)s=a.finalize(s),a.reset();o.concat(s)}return o.sigBytes=4*l,o}}),n.EvpKDF=function(e,t,s){return d.create(s).compute(e,t)},h.EvpKDF)},2209:function(e,t,s){var n,a,o,c;e.exports=(c=s(8249),s(5109),a=(n=c).lib.CipherParams,o=n.enc.Hex,n.format.Hex={stringify:function(e){return e.ciphertext.toString(o)},parse:function(e){var t=o.parse(e);return a.create({ciphertext:t})}},c.format.Hex)},9824:function(e,t,s){var n,a,o,c;e.exports=(n=s(8249),o=(a=n).lib.Base,c=a.enc.Utf8,void(a.algo.HMAC=o.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=c.parse(t));var s=e.blockSize,n=4*s;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var a=this._oKey=t.clone(),o=this._iKey=t.clone(),u=a.words,l=o.words,d=0;d<s;d++)u[d]^=1549556828,l[d]^=909522486;a.sigBytes=o.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,s=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(s))}})))},1354:function(e,t,s){var n;e.exports=(n=s(8249),s(4938),s(4433),s(298),s(8269),s(3786),s(8214),s(2783),s(2153),s(7792),s(34),s(7460),s(3327),s(706),s(9824),s(2112),s(888),s(5109),s(8568),s(4242),s(9968),s(7660),s(1148),s(3615),s(2807),s(1077),s(6475),s(6991),s(2209),s(452),s(4253),s(1857),s(4454),s(3974),n)},4433:function(e,t,s){var n;e.exports=(n=s(8249),function(){if("function"==typeof ArrayBuffer){var e=n.lib.WordArray,t=e.init,s=e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var s=e.byteLength,n=[],a=0;a<s;a++)n[a>>>2]|=e[a]<<24-a%4*8;t.call(this,n,s)}else t.apply(this,arguments)};s.prototype=e}}(),n.lib.WordArray)},8214:function(e,t,s){var n;e.exports=(n=s(8249),function(e){var t=n,s=t.lib,a=s.WordArray,o=s.Hasher,c=t.algo,u=[];!function(){for(var t=0;t<64;t++)u[t]=4294967296*e.abs(e.sin(t+1))|0}();var l=c.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var s=0;s<16;s++){var n=t+s,a=e[n];e[n]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var o=this._hash.words,c=e[t+0],l=e[t+1],f=e[t+2],m=e[t+3],y=e[t+4],w=e[t+5],g=e[t+6],v=e[t+7],E=e[t+8],T=e[t+9],b=e[t+10],S=e[t+11],C=e[t+12],R=e[t+13],k=e[t+14],D=e[t+15],A=o[0],N=o[1],P=o[2],O=o[3];A=d(A,N,P,O,c,7,u[0]),O=d(O,A,N,P,l,12,u[1]),P=d(P,O,A,N,f,17,u[2]),N=d(N,P,O,A,m,22,u[3]),A=d(A,N,P,O,y,7,u[4]),O=d(O,A,N,P,w,12,u[5]),P=d(P,O,A,N,g,17,u[6]),N=d(N,P,O,A,v,22,u[7]),A=d(A,N,P,O,E,7,u[8]),O=d(O,A,N,P,T,12,u[9]),P=d(P,O,A,N,b,17,u[10]),N=d(N,P,O,A,S,22,u[11]),A=d(A,N,P,O,C,7,u[12]),O=d(O,A,N,P,R,12,u[13]),P=d(P,O,A,N,k,17,u[14]),A=h(A,N=d(N,P,O,A,D,22,u[15]),P,O,l,5,u[16]),O=h(O,A,N,P,g,9,u[17]),P=h(P,O,A,N,S,14,u[18]),N=h(N,P,O,A,c,20,u[19]),A=h(A,N,P,O,w,5,u[20]),O=h(O,A,N,P,b,9,u[21]),P=h(P,O,A,N,D,14,u[22]),N=h(N,P,O,A,y,20,u[23]),A=h(A,N,P,O,T,5,u[24]),O=h(O,A,N,P,k,9,u[25]),P=h(P,O,A,N,m,14,u[26]),N=h(N,P,O,A,E,20,u[27]),A=h(A,N,P,O,R,5,u[28]),O=h(O,A,N,P,f,9,u[29]),P=h(P,O,A,N,v,14,u[30]),A=_(A,N=h(N,P,O,A,C,20,u[31]),P,O,w,4,u[32]),O=_(O,A,N,P,E,11,u[33]),P=_(P,O,A,N,S,16,u[34]),N=_(N,P,O,A,k,23,u[35]),A=_(A,N,P,O,l,4,u[36]),O=_(O,A,N,P,y,11,u[37]),P=_(P,O,A,N,v,16,u[38]),N=_(N,P,O,A,b,23,u[39]),A=_(A,N,P,O,R,4,u[40]),O=_(O,A,N,P,c,11,u[41]),P=_(P,O,A,N,m,16,u[42]),N=_(N,P,O,A,g,23,u[43]),A=_(A,N,P,O,T,4,u[44]),O=_(O,A,N,P,C,11,u[45]),P=_(P,O,A,N,D,16,u[46]),A=p(A,N=_(N,P,O,A,f,23,u[47]),P,O,c,6,u[48]),O=p(O,A,N,P,v,10,u[49]),P=p(P,O,A,N,k,15,u[50]),N=p(N,P,O,A,w,21,u[51]),A=p(A,N,P,O,C,6,u[52]),O=p(O,A,N,P,m,10,u[53]),P=p(P,O,A,N,b,15,u[54]),N=p(N,P,O,A,l,21,u[55]),A=p(A,N,P,O,E,6,u[56]),O=p(O,A,N,P,D,10,u[57]),P=p(P,O,A,N,g,15,u[58]),N=p(N,P,O,A,R,21,u[59]),A=p(A,N,P,O,y,6,u[60]),O=p(O,A,N,P,S,10,u[61]),P=p(P,O,A,N,f,15,u[62]),N=p(N,P,O,A,T,21,u[63]),o[0]=o[0]+A|0,o[1]=o[1]+N|0,o[2]=o[2]+P|0,o[3]=o[3]+O|0},_doFinalize:function(){var t=this._data,s=t.words,n=8*this._nDataBytes,a=8*t.sigBytes;s[a>>>5]|=128<<24-a%32;var o=e.floor(n/4294967296),c=n;s[15+(a+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),s[14+(a+64>>>9<<4)]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),t.sigBytes=4*(s.length+1),this._process();for(var u=this._hash,l=u.words,d=0;d<4;d++){var h=l[d];l[d]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8)}return u},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function d(e,t,s,n,a,o,c){var u=e+(t&s|~t&n)+a+c;return(u<<o|u>>>32-o)+t}function h(e,t,s,n,a,o,c){var u=e+(t&n|s&~n)+a+c;return(u<<o|u>>>32-o)+t}function _(e,t,s,n,a,o,c){var u=e+(t^s^n)+a+c;return(u<<o|u>>>32-o)+t}function p(e,t,s,n,a,o,c){var u=e+(s^(t|~n))+a+c;return(u<<o|u>>>32-o)+t}t.MD5=o._createHelper(l),t.HmacMD5=o._createHmacHelper(l)}(Math),n.MD5)},8568:function(e,t,s){var n;e.exports=(n=s(8249),s(5109),n.mode.CFB=function(){var e=n.lib.BlockCipherMode.extend();function t(e,t,s,n){var a,o=this._iv;o?(a=o.slice(0),this._iv=void 0):a=this._prevBlock,n.encryptBlock(a,0);for(var c=0;c<s;c++)e[t+c]^=a[c]}return e.Encryptor=e.extend({processBlock:function(e,s){var n=this._cipher,a=n.blockSize;t.call(this,e,s,a,n),this._prevBlock=e.slice(s,s+a)}}),e.Decryptor=e.extend({processBlock:function(e,s){var n=this._cipher,a=n.blockSize,o=e.slice(s,s+a);t.call(this,e,s,a,n),this._prevBlock=o}}),e}(),n.mode.CFB)},9968:function(e,t,s){var n;e.exports=(n=s(8249),s(5109),n.mode.CTRGladman=function(){var e=n.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,s=e>>8&255,n=255&e;255===t?(t=0,255===s?(s=0,255===n?n=0:++n):++s):++t,e=0,e+=t<<16,e+=s<<8,e+=n}else e+=1<<24;return e}function s(e){return 0===(e[0]=t(e[0]))&&(e[1]=t(e[1])),e}var a=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,a=n.blockSize,o=this._iv,c=this._counter;o&&(c=this._counter=o.slice(0),this._iv=void 0),s(c);var u=c.slice(0);n.encryptBlock(u,0);for(var l=0;l<a;l++)e[t+l]^=u[l]}});return e.Decryptor=a,e}(),n.mode.CTRGladman)},4242:function(e,t,s){var n,a,o;e.exports=(o=s(8249),s(5109),o.mode.CTR=(n=o.lib.BlockCipherMode.extend(),a=n.Encryptor=n.extend({processBlock:function(e,t){var s=this._cipher,n=s.blockSize,a=this._iv,o=this._counter;a&&(o=this._counter=a.slice(0),this._iv=void 0);var c=o.slice(0);s.encryptBlock(c,0),o[n-1]=o[n-1]+1|0;for(var u=0;u<n;u++)e[t+u]^=c[u]}}),n.Decryptor=a,n),o.mode.CTR)},1148:function(e,t,s){var n,a;e.exports=(a=s(8249),s(5109),a.mode.ECB=((n=a.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),n.Decryptor=n.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),n),a.mode.ECB)},7660:function(e,t,s){var n,a,o;e.exports=(o=s(8249),s(5109),o.mode.OFB=(n=o.lib.BlockCipherMode.extend(),a=n.Encryptor=n.extend({processBlock:function(e,t){var s=this._cipher,n=s.blockSize,a=this._iv,o=this._keystream;a&&(o=this._keystream=a.slice(0),this._iv=void 0),s.encryptBlock(o,0);for(var c=0;c<n;c++)e[t+c]^=o[c]}}),n.Decryptor=a,n),o.mode.OFB)},3615:function(e,t,s){var n;e.exports=(n=s(8249),s(5109),n.pad.AnsiX923={pad:function(e,t){var s=e.sigBytes,n=4*t,a=n-s%n,o=s+a-1;e.clamp(),e.words[o>>>2]|=a<<24-o%4*8,e.sigBytes+=a},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Ansix923)},2807:function(e,t,s){var n;e.exports=(n=s(8249),s(5109),n.pad.Iso10126={pad:function(e,t){var s=4*t,a=s-e.sigBytes%s;e.concat(n.lib.WordArray.random(a-1)).concat(n.lib.WordArray.create([a<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Iso10126)},1077:function(e,t,s){var n;e.exports=(n=s(8249),s(5109),n.pad.Iso97971={pad:function(e,t){e.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(e,t)},unpad:function(e){n.pad.ZeroPadding.unpad(e),e.sigBytes--}},n.pad.Iso97971)},6991:function(e,t,s){var n;e.exports=(n=s(8249),s(5109),n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding)},6475:function(e,t,s){var n;e.exports=(n=s(8249),s(5109),n.pad.ZeroPadding={pad:function(e,t){var s=4*t;e.clamp(),e.sigBytes+=s-(e.sigBytes%s||s)},unpad:function(e){var t=e.words,s=e.sigBytes-1;for(s=e.sigBytes-1;s>=0;s--)if(t[s>>>2]>>>24-s%4*8&255){e.sigBytes=s+1;break}}},n.pad.ZeroPadding)},2112:function(e,t,s){var n,a,o,c,u,l,d,h,_;e.exports=(_=s(8249),s(2783),s(9824),a=(n=_).lib,o=a.Base,c=a.WordArray,u=n.algo,l=u.SHA1,d=u.HMAC,h=u.PBKDF2=o.extend({cfg:o.extend({keySize:4,hasher:l,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var s=this.cfg,n=d.create(s.hasher,e),a=c.create(),o=c.create([1]),u=a.words,l=o.words,h=s.keySize,_=s.iterations;u.length<h;){var p=n.update(t).finalize(o);n.reset();for(var f=p.words,m=f.length,y=p,w=1;w<_;w++){y=n.finalize(y),n.reset();for(var g=y.words,v=0;v<m;v++)f[v]^=g[v]}a.concat(p),l[0]++}return a.sigBytes=4*h,a}}),n.PBKDF2=function(e,t,s){return h.create(s).compute(e,t)},_.PBKDF2)},3974:function(e,t,s){var n;e.exports=(n=s(8249),s(8269),s(8214),s(888),s(5109),function(){var e=n,t=e.lib.StreamCipher,s=e.algo,a=[],o=[],c=[],u=s.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,s=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],n=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var a=0;a<4;a++)l.call(this);for(a=0;a<8;a++)n[a]^=s[a+4&7];if(t){var o=t.words,c=o[0],u=o[1],d=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),h=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8),_=d>>>16|4294901760&h,p=h<<16|65535&d;for(n[0]^=d,n[1]^=_,n[2]^=h,n[3]^=p,n[4]^=d,n[5]^=_,n[6]^=h,n[7]^=p,a=0;a<4;a++)l.call(this)}},_doProcessBlock:function(e,t){var s=this._X;l.call(this),a[0]=s[0]^s[5]>>>16^s[3]<<16,a[1]=s[2]^s[7]>>>16^s[5]<<16,a[2]=s[4]^s[1]>>>16^s[7]<<16,a[3]=s[6]^s[3]>>>16^s[1]<<16;for(var n=0;n<4;n++)a[n]=16711935&(a[n]<<8|a[n]>>>24)|4278255360&(a[n]<<24|a[n]>>>8),e[t+n]^=a[n]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,s=0;s<8;s++)o[s]=t[s];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,s=0;s<8;s++){var n=e[s]+t[s],a=65535&n,u=n>>>16,l=((a*a>>>17)+a*u>>>15)+u*u,d=((4294901760&n)*n|0)+((65535&n)*n|0);c[s]=l^d}e[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,e[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,e[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,e[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,e[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,e[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,e[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,e[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}e.RabbitLegacy=t._createHelper(u)}(),n.RabbitLegacy)},4454:function(e,t,s){var n;e.exports=(n=s(8249),s(8269),s(8214),s(888),s(5109),function(){var e=n,t=e.lib.StreamCipher,s=e.algo,a=[],o=[],c=[],u=s.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,s=0;s<4;s++)e[s]=16711935&(e[s]<<8|e[s]>>>24)|4278255360&(e[s]<<24|e[s]>>>8);var n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],a=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,s=0;s<4;s++)l.call(this);for(s=0;s<8;s++)a[s]^=n[s+4&7];if(t){var o=t.words,c=o[0],u=o[1],d=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),h=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8),_=d>>>16|4294901760&h,p=h<<16|65535&d;for(a[0]^=d,a[1]^=_,a[2]^=h,a[3]^=p,a[4]^=d,a[5]^=_,a[6]^=h,a[7]^=p,s=0;s<4;s++)l.call(this)}},_doProcessBlock:function(e,t){var s=this._X;l.call(this),a[0]=s[0]^s[5]>>>16^s[3]<<16,a[1]=s[2]^s[7]>>>16^s[5]<<16,a[2]=s[4]^s[1]>>>16^s[7]<<16,a[3]=s[6]^s[3]>>>16^s[1]<<16;for(var n=0;n<4;n++)a[n]=16711935&(a[n]<<8|a[n]>>>24)|4278255360&(a[n]<<24|a[n]>>>8),e[t+n]^=a[n]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,s=0;s<8;s++)o[s]=t[s];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,s=0;s<8;s++){var n=e[s]+t[s],a=65535&n,u=n>>>16,l=((a*a>>>17)+a*u>>>15)+u*u,d=((4294901760&n)*n|0)+((65535&n)*n|0);c[s]=l^d}e[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,e[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,e[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,e[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,e[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,e[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,e[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,e[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}e.Rabbit=t._createHelper(u)}(),n.Rabbit)},1857:function(e,t,s){var n;e.exports=(n=s(8249),s(8269),s(8214),s(888),s(5109),function(){var e=n,t=e.lib.StreamCipher,s=e.algo,a=s.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,s=e.sigBytes,n=this._S=[],a=0;a<256;a++)n[a]=a;a=0;for(var o=0;a<256;a++){var c=a%s,u=t[c>>>2]>>>24-c%4*8&255;o=(o+n[a]+u)%256;var l=n[a];n[a]=n[o],n[o]=l}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=o.call(this)},keySize:8,ivSize:0});function o(){for(var e=this._S,t=this._i,s=this._j,n=0,a=0;a<4;a++){s=(s+e[t=(t+1)%256])%256;var o=e[t];e[t]=e[s],e[s]=o,n|=e[(e[t]+e[s])%256]<<24-8*a}return this._i=t,this._j=s,n}e.RC4=t._createHelper(a);var c=s.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)o.call(this)}});e.RC4Drop=t._createHelper(c)}(),n.RC4)},706:function(e,t,s){var n;e.exports=(n=s(8249),function(e){var t=n,s=t.lib,a=s.WordArray,o=s.Hasher,c=t.algo,u=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),l=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),d=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),_=a.create([0,1518500249,1859775393,2400959708,2840853838]),p=a.create([1352829926,1548603684,1836072691,2053994217,0]),f=c.RIPEMD160=o.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var s=0;s<16;s++){var n=t+s,a=e[n];e[n]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var o,c,f,T,b,S,C,R,k,D,A,N=this._hash.words,P=_.words,O=p.words,I=u.words,M=l.words,x=d.words,L=h.words;for(S=o=N[0],C=c=N[1],R=f=N[2],k=T=N[3],D=b=N[4],s=0;s<80;s+=1)A=o+e[t+I[s]]|0,A+=s<16?m(c,f,T)+P[0]:s<32?y(c,f,T)+P[1]:s<48?w(c,f,T)+P[2]:s<64?g(c,f,T)+P[3]:v(c,f,T)+P[4],A=(A=E(A|=0,x[s]))+b|0,o=b,b=T,T=E(f,10),f=c,c=A,A=S+e[t+M[s]]|0,A+=s<16?v(C,R,k)+O[0]:s<32?g(C,R,k)+O[1]:s<48?w(C,R,k)+O[2]:s<64?y(C,R,k)+O[3]:m(C,R,k)+O[4],A=(A=E(A|=0,L[s]))+D|0,S=D,D=k,k=E(R,10),R=C,C=A;A=N[1]+f+k|0,N[1]=N[2]+T+D|0,N[2]=N[3]+b+S|0,N[3]=N[4]+o+C|0,N[4]=N[0]+c+R|0,N[0]=A},_doFinalize:function(){var e=this._data,t=e.words,s=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),e.sigBytes=4*(t.length+1),this._process();for(var a=this._hash,o=a.words,c=0;c<5;c++){var u=o[c];o[c]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return a},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function m(e,t,s){return e^t^s}function y(e,t,s){return e&t|~e&s}function w(e,t,s){return(e|~t)^s}function g(e,t,s){return e&s|t&~s}function v(e,t,s){return e^(t|~s)}function E(e,t){return e<<t|e>>>32-t}t.RIPEMD160=o._createHelper(f),t.HmacRIPEMD160=o._createHmacHelper(f)}(Math),n.RIPEMD160)},2783:function(e,t,s){var n,a,o,c,u,l,d,h;e.exports=(h=s(8249),a=(n=h).lib,o=a.WordArray,c=a.Hasher,u=n.algo,l=[],d=u.SHA1=c.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var s=this._hash.words,n=s[0],a=s[1],o=s[2],c=s[3],u=s[4],d=0;d<80;d++){if(d<16)l[d]=0|e[t+d];else{var h=l[d-3]^l[d-8]^l[d-14]^l[d-16];l[d]=h<<1|h>>>31}var _=(n<<5|n>>>27)+u+l[d];_+=d<20?1518500249+(a&o|~a&c):d<40?1859775393+(a^o^c):d<60?(a&o|a&c|o&c)-1894007588:(a^o^c)-899497514,u=c,c=o,o=a<<30|a>>>2,a=n,n=_}s[0]=s[0]+n|0,s[1]=s[1]+a|0,s[2]=s[2]+o|0,s[3]=s[3]+c|0,s[4]=s[4]+u|0},_doFinalize:function(){var e=this._data,t=e.words,s=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(s/4294967296),t[15+(n+64>>>9<<4)]=s,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=c.clone.call(this);return e._hash=this._hash.clone(),e}}),n.SHA1=c._createHelper(d),n.HmacSHA1=c._createHmacHelper(d),h.SHA1)},7792:function(e,t,s){var n,a,o,c,u,l;e.exports=(l=s(8249),s(2153),a=(n=l).lib.WordArray,o=n.algo,c=o.SHA256,u=o.SHA224=c.extend({_doReset:function(){this._hash=new a.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=c._doFinalize.call(this);return e.sigBytes-=4,e}}),n.SHA224=c._createHelper(u),n.HmacSHA224=c._createHmacHelper(u),l.SHA224)},2153:function(e,t,s){var n;e.exports=(n=s(8249),function(e){var t=n,s=t.lib,a=s.WordArray,o=s.Hasher,c=t.algo,u=[],l=[];!function(){function t(t){for(var s=e.sqrt(t),n=2;n<=s;n++)if(!(t%n))return!1;return!0}function s(e){return 4294967296*(e-(0|e))|0}for(var n=2,a=0;a<64;)t(n)&&(a<8&&(u[a]=s(e.pow(n,.5))),l[a]=s(e.pow(n,1/3)),a++),n++}();var d=[],h=c.SHA256=o.extend({_doReset:function(){this._hash=new a.init(u.slice(0))},_doProcessBlock:function(e,t){for(var s=this._hash.words,n=s[0],a=s[1],o=s[2],c=s[3],u=s[4],h=s[5],_=s[6],p=s[7],f=0;f<64;f++){if(f<16)d[f]=0|e[t+f];else{var m=d[f-15],y=(m<<25|m>>>7)^(m<<14|m>>>18)^m>>>3,w=d[f-2],g=(w<<15|w>>>17)^(w<<13|w>>>19)^w>>>10;d[f]=y+d[f-7]+g+d[f-16]}var v=n&a^n&o^a&o,E=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),T=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&h^~u&_)+l[f]+d[f];p=_,_=h,h=u,u=c+T|0,c=o,o=a,a=n,n=T+(E+v)|0}s[0]=s[0]+n|0,s[1]=s[1]+a|0,s[2]=s[2]+o|0,s[3]=s[3]+c|0,s[4]=s[4]+u|0,s[5]=s[5]+h|0,s[6]=s[6]+_|0,s[7]=s[7]+p|0},_doFinalize:function(){var t=this._data,s=t.words,n=8*this._nDataBytes,a=8*t.sigBytes;return s[a>>>5]|=128<<24-a%32,s[14+(a+64>>>9<<4)]=e.floor(n/4294967296),s[15+(a+64>>>9<<4)]=n,t.sigBytes=4*s.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(h),t.HmacSHA256=o._createHmacHelper(h)}(Math),n.SHA256)},3327:function(e,t,s){var n;e.exports=(n=s(8249),s(4938),function(e){var t=n,s=t.lib,a=s.WordArray,o=s.Hasher,c=t.x64.Word,u=t.algo,l=[],d=[],h=[];!function(){for(var e=1,t=0,s=0;s<24;s++){l[e+5*t]=(s+1)*(s+2)/2%64;var n=(2*e+3*t)%5;e=t%5,t=n}for(e=0;e<5;e++)for(t=0;t<5;t++)d[e+5*t]=t+(2*e+3*t)%5*5;for(var a=1,o=0;o<24;o++){for(var u=0,_=0,p=0;p<7;p++){if(1&a){var f=(1<<p)-1;f<32?_^=1<<f:u^=1<<f-32}128&a?a=a<<1^113:a<<=1}h[o]=c.create(u,_)}}();var _=[];!function(){for(var e=0;e<25;e++)_[e]=c.create()}();var p=u.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var s=this._state,n=this.blockSize/2,a=0;a<n;a++){var o=e[t+2*a],c=e[t+2*a+1];o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),c=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),(N=s[a]).high^=c,N.low^=o}for(var u=0;u<24;u++){for(var p=0;p<5;p++){for(var f=0,m=0,y=0;y<5;y++)f^=(N=s[p+5*y]).high,m^=N.low;var w=_[p];w.high=f,w.low=m}for(p=0;p<5;p++){var g=_[(p+4)%5],v=_[(p+1)%5],E=v.high,T=v.low;for(f=g.high^(E<<1|T>>>31),m=g.low^(T<<1|E>>>31),y=0;y<5;y++)(N=s[p+5*y]).high^=f,N.low^=m}for(var b=1;b<25;b++){var S=(N=s[b]).high,C=N.low,R=l[b];R<32?(f=S<<R|C>>>32-R,m=C<<R|S>>>32-R):(f=C<<R-32|S>>>64-R,m=S<<R-32|C>>>64-R);var k=_[d[b]];k.high=f,k.low=m}var D=_[0],A=s[0];for(D.high=A.high,D.low=A.low,p=0;p<5;p++)for(y=0;y<5;y++){var N=s[b=p+5*y],P=_[b],O=_[(p+1)%5+5*y],I=_[(p+2)%5+5*y];N.high=P.high^~O.high&I.high,N.low=P.low^~O.low&I.low}N=s[0];var M=h[u];N.high^=M.high,N.low^=M.low}},_doFinalize:function(){var t=this._data,s=t.words,n=(this._nDataBytes,8*t.sigBytes),o=32*this.blockSize;s[n>>>5]|=1<<24-n%32,s[(e.ceil((n+1)/o)*o>>>5)-1]|=128,t.sigBytes=4*s.length,this._process();for(var c=this._state,u=this.cfg.outputLength/8,l=u/8,d=[],h=0;h<l;h++){var _=c[h],p=_.high,f=_.low;p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),d.push(f),d.push(p)}return new a.init(d,u)},clone:function(){for(var e=o.clone.call(this),t=e._state=this._state.slice(0),s=0;s<25;s++)t[s]=t[s].clone();return e}});t.SHA3=o._createHelper(p),t.HmacSHA3=o._createHmacHelper(p)}(Math),n.SHA3)},7460:function(e,t,s){var n,a,o,c,u,l,d,h;e.exports=(h=s(8249),s(4938),s(34),a=(n=h).x64,o=a.Word,c=a.WordArray,u=n.algo,l=u.SHA512,d=u.SHA384=l.extend({_doReset:function(){this._hash=new c.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var e=l._doFinalize.call(this);return e.sigBytes-=16,e}}),n.SHA384=l._createHelper(d),n.HmacSHA384=l._createHmacHelper(d),h.SHA384)},34:function(e,t,s){var n;e.exports=(n=s(8249),s(4938),function(){var e=n,t=e.lib.Hasher,s=e.x64,a=s.Word,o=s.WordArray,c=e.algo;function u(){return a.create.apply(a,arguments)}var l=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],d=[];!function(){for(var e=0;e<80;e++)d[e]=u()}();var h=c.SHA512=t.extend({_doReset:function(){this._hash=new o.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var s=this._hash.words,n=s[0],a=s[1],o=s[2],c=s[3],u=s[4],h=s[5],_=s[6],p=s[7],f=n.high,m=n.low,y=a.high,w=a.low,g=o.high,v=o.low,E=c.high,T=c.low,b=u.high,S=u.low,C=h.high,R=h.low,k=_.high,D=_.low,A=p.high,N=p.low,P=f,O=m,I=y,M=w,x=g,L=v,F=E,U=T,H=b,B=S,j=C,q=R,K=k,Z=D,W=A,z=N,V=0;V<80;V++){var G,$,X=d[V];if(V<16)$=X.high=0|e[t+2*V],G=X.low=0|e[t+2*V+1];else{var Y=d[V-15],J=Y.high,Q=Y.low,ee=(J>>>1|Q<<31)^(J>>>8|Q<<24)^J>>>7,te=(Q>>>1|J<<31)^(Q>>>8|J<<24)^(Q>>>7|J<<25),re=d[V-2],se=re.high,ne=re.low,ie=(se>>>19|ne<<13)^(se<<3|ne>>>29)^se>>>6,ae=(ne>>>19|se<<13)^(ne<<3|se>>>29)^(ne>>>6|se<<26),oe=d[V-7],ce=oe.high,ue=oe.low,le=d[V-16],de=le.high,he=le.low;$=($=($=ee+ce+((G=te+ue)>>>0<te>>>0?1:0))+ie+((G+=ae)>>>0<ae>>>0?1:0))+de+((G+=he)>>>0<he>>>0?1:0),X.high=$,X.low=G}var _e,pe=H&j^~H&K,fe=B&q^~B&Z,me=P&I^P&x^I&x,ye=O&M^O&L^M&L,we=(P>>>28|O<<4)^(P<<30|O>>>2)^(P<<25|O>>>7),ge=(O>>>28|P<<4)^(O<<30|P>>>2)^(O<<25|P>>>7),ve=(H>>>14|B<<18)^(H>>>18|B<<14)^(H<<23|B>>>9),Ee=(B>>>14|H<<18)^(B>>>18|H<<14)^(B<<23|H>>>9),Te=l[V],be=Te.high,Se=Te.low,Ce=W+ve+((_e=z+Ee)>>>0<z>>>0?1:0),Re=ge+ye;W=K,z=Z,K=j,Z=q,j=H,q=B,H=F+(Ce=(Ce=(Ce=Ce+pe+((_e+=fe)>>>0<fe>>>0?1:0))+be+((_e+=Se)>>>0<Se>>>0?1:0))+$+((_e+=G)>>>0<G>>>0?1:0))+((B=U+_e|0)>>>0<U>>>0?1:0)|0,F=x,U=L,x=I,L=M,I=P,M=O,P=Ce+(we+me+(Re>>>0<ge>>>0?1:0))+((O=_e+Re|0)>>>0<_e>>>0?1:0)|0}m=n.low=m+O,n.high=f+P+(m>>>0<O>>>0?1:0),w=a.low=w+M,a.high=y+I+(w>>>0<M>>>0?1:0),v=o.low=v+L,o.high=g+x+(v>>>0<L>>>0?1:0),T=c.low=T+U,c.high=E+F+(T>>>0<U>>>0?1:0),S=u.low=S+B,u.high=b+H+(S>>>0<B>>>0?1:0),R=h.low=R+q,h.high=C+j+(R>>>0<q>>>0?1:0),D=_.low=D+Z,_.high=k+K+(D>>>0<Z>>>0?1:0),N=p.low=N+z,p.high=A+W+(N>>>0<z>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,s=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(s/4294967296),t[31+(n+128>>>10<<5)]=s,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(h),e.HmacSHA512=t._createHmacHelper(h)}(),n.SHA512)},4253:function(e,t,s){var n;e.exports=(n=s(8249),s(8269),s(8214),s(888),s(5109),function(){var e=n,t=e.lib,s=t.WordArray,a=t.BlockCipher,o=e.algo,c=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],u=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],_=o.DES=a.extend({_doReset:function(){for(var e=this._key.words,t=[],s=0;s<56;s++){var n=c[s]-1;t[s]=e[n>>>5]>>>31-n%32&1}for(var a=this._subKeys=[],o=0;o<16;o++){var d=a[o]=[],h=l[o];for(s=0;s<24;s++)d[s/6|0]|=t[(u[s]-1+h)%28]<<31-s%6,d[4+(s/6|0)]|=t[28+(u[s+24]-1+h)%28]<<31-s%6;for(d[0]=d[0]<<1|d[0]>>>31,s=1;s<7;s++)d[s]=d[s]>>>4*(s-1)+3;d[7]=d[7]<<5|d[7]>>>27}var _=this._invSubKeys=[];for(s=0;s<16;s++)_[s]=a[15-s]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,s){this._lBlock=e[t],this._rBlock=e[t+1],p.call(this,4,252645135),p.call(this,16,65535),f.call(this,2,858993459),f.call(this,8,16711935),p.call(this,1,1431655765);for(var n=0;n<16;n++){for(var a=s[n],o=this._lBlock,c=this._rBlock,u=0,l=0;l<8;l++)u|=d[l][((c^a[l])&h[l])>>>0];this._lBlock=c,this._rBlock=o^u}var _=this._lBlock;this._lBlock=this._rBlock,this._rBlock=_,p.call(this,1,1431655765),f.call(this,8,16711935),f.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(e,t){var s=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=s,this._lBlock^=s<<e}function f(e,t){var s=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=s,this._rBlock^=s<<e}e.DES=a._createHelper(_);var m=o.TripleDES=a.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),n=e.length<4?e.slice(0,2):e.slice(2,4),a=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=_.createEncryptor(s.create(t)),this._des2=_.createEncryptor(s.create(n)),this._des3=_.createEncryptor(s.create(a))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=a._createHelper(m)}(),n.TripleDES)},4938:function(e,t,s){var n;e.exports=(n=s(8249),function(e){var t=n,s=t.lib,a=s.Base,o=s.WordArray,c=t.x64={};c.Word=a.extend({init:function(e,t){this.high=e,this.low=t}}),c.WordArray=a.extend({init:function(t,s){t=this.words=t||[],this.sigBytes=s!=e?s:8*t.length},toX32:function(){for(var e=this.words,t=e.length,s=[],n=0;n<t;n++){var a=e[n];s.push(a.high),s.push(a.low)}return o.create(s,this.sigBytes)},clone:function(){for(var e=a.clone.call(this),t=e.words=this.words.slice(0),s=t.length,n=0;n<s;n++)t[n]=t[n].clone();return e}})}(),n)},7484:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,s=36e5,n="millisecond",a="second",o="minute",c="hour",u="day",l="week",d="month",h="quarter",_="year",p="date",f="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],s=e%100;return"["+e+(t[(s-20)%10]||t[s]||t[0])+"]"}},g=function(e,t,s){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(s)+e},v={s:g,z:function(e){var t=-e.utcOffset(),s=Math.abs(t),n=Math.floor(s/60),a=s%60;return(t<=0?"+":"-")+g(n,2,"0")+":"+g(a,2,"0")},m:function e(t,s){if(t.date()<s.date())return-e(s,t);var n=12*(s.year()-t.year())+(s.month()-t.month()),a=t.clone().add(n,d),o=s-a<0,c=t.clone().add(n+(o?-1:1),d);return+(-(n+(s-a)/(o?a-c:c-a))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:d,y:_,w:l,d:u,D:p,h:c,m:o,s:a,ms:n,Q:h}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},E="en",T={};T[E]=w;var b=function(e){return e instanceof k},S=function e(t,s,n){var a;if(!t)return E;if("string"==typeof t){var o=t.toLowerCase();T[o]&&(a=o),s&&(T[o]=s,a=o);var c=t.split("-");if(!a&&c.length>1)return e(c[0])}else{var u=t.name;T[u]=t,a=u}return!n&&a&&(E=a),a||!n&&E},C=function(e,t){if(b(e))return e.clone();var s="object"==typeof t?t:{};return s.date=e,s.args=arguments,new k(s)},R=v;R.l=S,R.i=b,R.w=function(e,t){return C(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var k=function(){function w(e){this.$L=S(e.locale,null,!0),this.parse(e)}var g=w.prototype;return g.parse=function(e){this.$d=function(e){var t=e.date,s=e.utc;if(null===t)return new Date(NaN);if(R.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(m);if(n){var a=n[2]-1||0,o=(n[7]||"0").substring(0,3);return s?new Date(Date.UTC(n[1],a,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],a,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},g.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},g.$utils=function(){return R},g.isValid=function(){return!(this.$d.toString()===f)},g.isSame=function(e,t){var s=C(e);return this.startOf(t)<=s&&s<=this.endOf(t)},g.isAfter=function(e,t){return C(e)<this.startOf(t)},g.isBefore=function(e,t){return this.endOf(t)<C(e)},g.$g=function(e,t,s){return R.u(e)?this[t]:this.set(s,e)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(e,t){var s=this,n=!!R.u(t)||t,h=R.p(e),f=function(e,t){var a=R.w(s.$u?Date.UTC(s.$y,t,e):new Date(s.$y,t,e),s);return n?a:a.endOf(u)},m=function(e,t){return R.w(s.toDate()[e].apply(s.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),s)},y=this.$W,w=this.$M,g=this.$D,v="set"+(this.$u?"UTC":"");switch(h){case _:return n?f(1,0):f(31,11);case d:return n?f(1,w):f(0,w+1);case l:var E=this.$locale().weekStart||0,T=(y<E?y+7:y)-E;return f(n?g-T:g+(6-T),w);case u:case p:return m(v+"Hours",0);case c:return m(v+"Minutes",1);case o:return m(v+"Seconds",2);case a:return m(v+"Milliseconds",3);default:return this.clone()}},g.endOf=function(e){return this.startOf(e,!1)},g.$set=function(e,t){var s,l=R.p(e),h="set"+(this.$u?"UTC":""),f=(s={},s[u]=h+"Date",s[p]=h+"Date",s[d]=h+"Month",s[_]=h+"FullYear",s[c]=h+"Hours",s[o]=h+"Minutes",s[a]=h+"Seconds",s[n]=h+"Milliseconds",s)[l],m=l===u?this.$D+(t-this.$W):t;if(l===d||l===_){var y=this.clone().set(p,1);y.$d[f](m),y.init(),this.$d=y.set(p,Math.min(this.$D,y.daysInMonth())).$d}else f&&this.$d[f](m);return this.init(),this},g.set=function(e,t){return this.clone().$set(e,t)},g.get=function(e){return this[R.p(e)]()},g.add=function(n,h){var p,f=this;n=Number(n);var m=R.p(h),y=function(e){var t=C(f);return R.w(t.date(t.date()+Math.round(e*n)),f)};if(m===d)return this.set(d,this.$M+n);if(m===_)return this.set(_,this.$y+n);if(m===u)return y(1);if(m===l)return y(7);var w=(p={},p[o]=t,p[c]=s,p[a]=e,p)[m]||1,g=this.$d.getTime()+n*w;return R.w(g,this)},g.subtract=function(e,t){return this.add(-1*e,t)},g.format=function(e){var t=this,s=this.$locale();if(!this.isValid())return s.invalidDate||f;var n=e||"YYYY-MM-DDTHH:mm:ssZ",a=R.z(this),o=this.$H,c=this.$m,u=this.$M,l=s.weekdays,d=s.months,h=s.meridiem,_=function(e,s,a,o){return e&&(e[s]||e(t,n))||a[s].slice(0,o)},p=function(e){return R.s(o%12||12,e,"0")},m=h||function(e,t,s){var n=e<12?"AM":"PM";return s?n.toLowerCase():n};return n.replace(y,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return R.s(t.$y,4,"0");case"M":return u+1;case"MM":return R.s(u+1,2,"0");case"MMM":return _(s.monthsShort,u,d,3);case"MMMM":return _(d,u);case"D":return t.$D;case"DD":return R.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return _(s.weekdaysMin,t.$W,l,2);case"ddd":return _(s.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(o);case"HH":return R.s(o,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return m(o,c,!0);case"A":return m(o,c,!1);case"m":return String(c);case"mm":return R.s(c,2,"0");case"s":return String(t.$s);case"ss":return R.s(t.$s,2,"0");case"SSS":return R.s(t.$ms,3,"0");case"Z":return a}return null}(e)||a.replace(":","")}))},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(n,p,f){var m,y=this,w=R.p(p),g=C(n),v=(g.utcOffset()-this.utcOffset())*t,E=this-g,T=function(){return R.m(y,g)};switch(w){case _:m=T()/12;break;case d:m=T();break;case h:m=T()/3;break;case l:m=(E-v)/6048e5;break;case u:m=(E-v)/864e5;break;case c:m=E/s;break;case o:m=E/t;break;case a:m=E/e;break;default:m=E}return f?m:R.a(m)},g.daysInMonth=function(){return this.endOf(d).$D},g.$locale=function(){return T[this.$L]},g.locale=function(e,t){if(!e)return this.$L;var s=this.clone(),n=S(e,t,!0);return n&&(s.$L=n),s},g.clone=function(){return R.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},w}(),D=k.prototype;return C.prototype=D,[["$ms",n],["$s",a],["$m",o],["$H",c],["$W",u],["$M",d],["$y",_],["$D",p]].forEach((function(e){D[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),C.extend=function(e,t){return e.$i||(e(t,k,C),e.$i=!0),C},C.locale=S,C.isDayjs=b,C.unix=function(e){return C(1e3*e)},C.en=T[E],C.Ls=T,C.p={},C}()},148:(e,t,s)=>{"use strict";const{anyMap:n,producersMap:a,eventsMap:o}=s(2343),c=Symbol("anyProducer"),u=Promise.resolve(),l=Symbol("listenerAdded"),d=Symbol("listenerRemoved");let h=!1,_=!1;function p(e){if("string"!=typeof e&&"symbol"!=typeof e&&"number"!=typeof e)throw new TypeError("`eventName` must be a string, symbol, or number")}function f(e){if("function"!=typeof e)throw new TypeError("listener must be a function")}function m(e,t){const s=o.get(e);if(s.has(t))return s.get(t)}function y(e,t){const s="string"==typeof t||"symbol"==typeof t||"number"==typeof t?t:c,n=a.get(e);if(n.has(s))return n.get(s)}function w(e,t){t=Array.isArray(t)?t:[t];let s=!1,n=()=>{},o=[];const c={enqueue(e){o.push(e),n()},finish(){s=!0,n()}};for(const s of t){let t=y(e,s);if(!t){t=new Set;a.get(e).set(s,t)}t.add(c)}return{async next(){return o?0===o.length?s?(o=void 0,this.next()):(await new Promise((e=>{n=e})),this.next()):{done:!1,value:await o.shift()}:{done:!0}},async return(s){o=void 0;for(const s of t){const t=y(e,s);if(t&&(t.delete(c),0===t.size)){a.get(e).delete(s)}}return n(),arguments.length>0?{done:!0,value:await s}:{done:!0}},[Symbol.asyncIterator](){return this}}}function g(e){if(void 0===e)return T;if(!Array.isArray(e))throw new TypeError("`methodNames` must be an array of strings");for(const t of e)if(!T.includes(t)){if("string"!=typeof t)throw new TypeError("`methodNames` element must be a string");throw new Error(`${t} is not Emittery method`)}return e}const v=e=>e===l||e===d;function E(e,t,s){if(v(t))try{h=!0,e.emit(t,s)}finally{h=!1}}class Emittery{static mixin(e,t){return t=g(t),s=>{if("function"!=typeof s)throw new TypeError("`target` must be function");for(const e of t)if(void 0!==s.prototype[e])throw new Error(`The property \`${e}\` already exists on \`target\``);Object.defineProperty(s.prototype,e,{enumerable:!1,get:function(){return Object.defineProperty(this,e,{enumerable:!1,value:new Emittery}),this[e]}});const n=t=>function(...s){return this[e][t](...s)};for(const e of t)Object.defineProperty(s.prototype,e,{enumerable:!1,value:n(e)});return s}}static get isDebugEnabled(){if("object"!=typeof process)return _;const{env:e}=process||{env:{}};return"emittery"===e.DEBUG||"*"===e.DEBUG||_}static set isDebugEnabled(e){_=e}constructor(e={}){n.set(this,new Set),o.set(this,new Map),a.set(this,new Map),a.get(this).set(c,new Set),this.debug=e.debug||{},void 0===this.debug.enabled&&(this.debug.enabled=!1),this.debug.logger||(this.debug.logger=(e,t,s,n)=>{try{n=JSON.stringify(n)}catch{n=`Object with the following keys failed to stringify: ${Object.keys(n).join(",")}`}"symbol"!=typeof s&&"number"!=typeof s||(s=s.toString());const a=new Date,o=`${a.getHours()}:${a.getMinutes()}:${a.getSeconds()}.${a.getMilliseconds()}`;console.log(`[${o}][emittery:${e}][${t}] Event Name: ${s}\n\tdata: ${n}`)})}logIfDebugEnabled(e,t,s){(Emittery.isDebugEnabled||this.debug.enabled)&&this.debug.logger(e,this.debug.name,t,s)}on(e,t){f(t),e=Array.isArray(e)?e:[e];for(const s of e){p(s);let e=m(this,s);if(!e){e=new Set;o.get(this).set(s,e)}e.add(t),this.logIfDebugEnabled("subscribe",s,void 0),v(s)||E(this,l,{eventName:s,listener:t})}return this.off.bind(this,e,t)}off(e,t){f(t),e=Array.isArray(e)?e:[e];for(const s of e){p(s);const e=m(this,s);if(e&&(e.delete(t),0===e.size)){o.get(this).delete(s)}this.logIfDebugEnabled("unsubscribe",s,void 0),v(s)||E(this,d,{eventName:s,listener:t})}}once(e){let t;const s=new Promise((s=>{t=this.on(e,(e=>{t(),s(e)}))}));return s.off=t,s}events(e){e=Array.isArray(e)?e:[e];for(const t of e)p(t);return w(this,e)}async emit(e,t){if(p(e),v(e)&&!h)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emit",e,t),function(e,t,s){const n=a.get(e);if(n.has(t))for(const e of n.get(t))e.enqueue(s);if(n.has(c)){const e=Promise.all([t,s]);for(const t of n.get(c))t.enqueue(e)}}(this,e,t);const s=m(this,e)||new Set,o=n.get(this),l=[...s],d=v(e)?[]:[...o];await u,await Promise.all([...l.map((async e=>{if(s.has(e))return e(t)})),...d.map((async s=>{if(o.has(s))return s(e,t)}))])}async emitSerial(e,t){if(p(e),v(e)&&!h)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emitSerial",e,t);const s=m(this,e)||new Set,a=n.get(this),o=[...s],c=[...a];await u;for(const e of o)s.has(e)&&await e(t);for(const s of c)a.has(s)&&await s(e,t)}onAny(e){return f(e),this.logIfDebugEnabled("subscribeAny",void 0,void 0),n.get(this).add(e),E(this,l,{listener:e}),this.offAny.bind(this,e)}anyEvent(){return w(this)}offAny(e){f(e),this.logIfDebugEnabled("unsubscribeAny",void 0,void 0),E(this,d,{listener:e}),n.get(this).delete(e)}clearListeners(e){e=Array.isArray(e)?e:[e];for(const t of e)if(this.logIfDebugEnabled("clear",t,void 0),"string"==typeof t||"symbol"==typeof t||"number"==typeof t){const e=m(this,t);e&&e.clear();const s=y(this,t);if(s){for(const e of s)e.finish();s.clear()}}else{n.get(this).clear();for(const[e,t]of o.get(this).entries())t.clear(),o.get(this).delete(e);for(const[e,t]of a.get(this).entries()){for(const e of t)e.finish();t.clear(),a.get(this).delete(e)}}}listenerCount(e){e=Array.isArray(e)?e:[e];let t=0;for(const s of e)if("string"!=typeof s){void 0!==s&&p(s),t+=n.get(this).size;for(const e of o.get(this).values())t+=e.size;for(const e of a.get(this).values())t+=e.size}else t+=n.get(this).size+(m(this,s)||new Set).size+(y(this,s)||new Set).size+(y(this)||new Set).size;return t}bindMethods(e,t){if("object"!=typeof e||null===e)throw new TypeError("`target` must be an object");t=g(t);for(const s of t){if(void 0!==e[s])throw new Error(`The property \`${s}\` already exists on \`target\``);Object.defineProperty(e,s,{enumerable:!1,value:this[s].bind(this)})}}}const T=Object.getOwnPropertyNames(Emittery.prototype).filter((e=>"constructor"!==e));Object.defineProperty(Emittery,"listenerAdded",{value:l,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(Emittery,"listenerRemoved",{value:d,writable:!1,enumerable:!0,configurable:!1}),e.exports=Emittery},2343:e=>{const t=new WeakMap,s=new WeakMap,n=new WeakMap;e.exports={anyMap:t,eventsMap:s,producersMap:n}},7187:e=>{"use strict";var t,s="object"==typeof Reflect?Reflect:null,n=s&&"function"==typeof s.apply?s.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)};t=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(s,n){function a(s){e.removeListener(t,o),n(s)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",a),s([].slice.call(arguments))}y(e,t,o,{once:!0}),"error"!==t&&function(e,t,s){"function"==typeof e.on&&y(e,"error",t,s)}(e,a,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function d(e,t,s,n){var a,o,c,d;if(u(s),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,s.listener?s.listener:s),o=e._events),c=o[t]),void 0===c)c=o[t]=s,++e._eventsCount;else if("function"==typeof c?c=o[t]=n?[s,c]:[c,s]:n?c.unshift(s):c.push(s),(a=l(e))>0&&c.length>a&&!c.warned){c.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=c.length,d=h,console&&console.warn&&console.warn(d)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _(e,t,s){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:s},a=h.bind(n);return a.listener=s,n.wrapFn=a,a}function p(e,t,s){var n=e._events;if(void 0===n)return[];var a=n[t];return void 0===a?[]:"function"==typeof a?s?[a.listener||a]:[a]:s?function(e){for(var t=new Array(e.length),s=0;s<t.length;++s)t[s]=e[s].listener||e[s];return t}(a):m(a,a.length)}function f(e){var t=this._events;if(void 0!==t){var s=t[e];if("function"==typeof s)return 1;if(void 0!==s)return s.length}return 0}function m(e,t){for(var s=new Array(t),n=0;n<t;++n)s[n]=e[n];return s}function y(e,t,s,n){if("function"==typeof e.on)n.once?e.once(t,s):e.on(t,s);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function a(o){n.once&&e.removeEventListener(t,a),s(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);var a="error"===e,o=this._events;if(void 0!==o)a=a&&void 0===o.error;else if(!a)return!1;if(a){var c;if(t.length>0&&(c=t[0]),c instanceof Error)throw c;var u=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw u.context=c,u}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)n(l,this,t);else{var d=l.length,h=m(l,d);for(s=0;s<d;++s)n(h[s],this,t)}return!0},o.prototype.addListener=function(e,t){return d(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return d(this,e,t,!0)},o.prototype.once=function(e,t){return u(t),this.on(e,_(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,_(this,e,t)),this},o.prototype.removeListener=function(e,t){var s,n,a,o,c;if(u(t),void 0===(n=this._events))return this;if(void 0===(s=n[e]))return this;if(s===t||s.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,s.listener||t));else if("function"!=typeof s){for(a=-1,o=s.length-1;o>=0;o--)if(s[o]===t||s[o].listener===t){c=s[o].listener,a=o;break}if(a<0)return this;0===a?s.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(s,a),1===s.length&&(n[e]=s[0]),void 0!==n.removeListener&&this.emit("removeListener",e,c||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,s,n;if(void 0===(s=this._events))return this;if(void 0===s.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==s[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete s[e]),this;if(0===arguments.length){var a,o=Object.keys(s);for(n=0;n<o.length;++n)"removeListener"!==(a=o[n])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=s[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return p(this,e,!0)},o.prototype.rawListeners=function(e){return p(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},8908:(e,t,s)=>{var n;n="undefined"!=typeof window?window:void 0!==s.g?s.g:"undefined"!=typeof self?self:{},e.exports=n},5519:(e,t,s)=>{"use strict";s.r(t),s.d(t,{ACCEPTED:()=>n,BAD_GATEWAY:()=>a,BAD_REQUEST:()=>o,CONFLICT:()=>c,CONTINUE:()=>u,CREATED:()=>l,EXPECTATION_FAILED:()=>d,FAILED_DEPENDENCY:()=>h,FORBIDDEN:()=>_,GATEWAY_TIMEOUT:()=>p,GONE:()=>f,HTTP_VERSION_NOT_SUPPORTED:()=>m,IM_A_TEAPOT:()=>y,INSUFFICIENT_SPACE_ON_RESOURCE:()=>w,INSUFFICIENT_STORAGE:()=>g,INTERNAL_SERVER_ERROR:()=>v,LENGTH_REQUIRED:()=>E,LOCKED:()=>T,METHOD_FAILURE:()=>b,METHOD_NOT_ALLOWED:()=>S,MOVED_PERMANENTLY:()=>C,MOVED_TEMPORARILY:()=>R,MULTIPLE_CHOICES:()=>D,MULTI_STATUS:()=>k,NETWORK_AUTHENTICATION_REQUIRED:()=>A,NON_AUTHORITATIVE_INFORMATION:()=>P,NOT_ACCEPTABLE:()=>O,NOT_FOUND:()=>I,NOT_IMPLEMENTED:()=>M,NOT_MODIFIED:()=>x,NO_CONTENT:()=>N,OK:()=>L,PARTIAL_CONTENT:()=>F,PAYMENT_REQUIRED:()=>U,PERMANENT_REDIRECT:()=>H,PRECONDITION_FAILED:()=>B,PRECONDITION_REQUIRED:()=>j,PROCESSING:()=>q,PROXY_AUTHENTICATION_REQUIRED:()=>K,REQUESTED_RANGE_NOT_SATISFIABLE:()=>G,REQUEST_HEADER_FIELDS_TOO_LARGE:()=>Z,REQUEST_TIMEOUT:()=>W,REQUEST_TOO_LONG:()=>z,REQUEST_URI_TOO_LONG:()=>V,RESET_CONTENT:()=>$,ReasonPhrases:()=>de,SEE_OTHER:()=>X,SERVICE_UNAVAILABLE:()=>Y,SWITCHING_PROTOCOLS:()=>J,StatusCodes:()=>le,TEMPORARY_REDIRECT:()=>Q,TOO_MANY_REQUESTS:()=>ee,UNAUTHORIZED:()=>te,UNPROCESSABLE_ENTITY:()=>re,UNSUPPORTED_MEDIA_TYPE:()=>se,USE_PROXY:()=>ne,default:()=>pe,getReasonPhrase:()=>ce,getStatusCode:()=>ue,getStatusText:()=>he});var n=202,a=502,o=400,c=409,u=100,l=201,d=417,h=424,_=403,p=504,f=410,m=505,y=418,w=419,g=507,v=500,E=411,T=423,b=420,S=405,C=301,R=302,k=207,D=300,A=511,N=204,P=203,O=406,I=404,M=501,x=304,L=200,F=206,U=402,H=308,B=412,j=428,q=102,K=407,Z=431,W=408,z=413,V=414,G=416,$=205,X=303,Y=503,J=101,Q=307,ee=429,te=401,re=422,se=415,ne=305;const ie={ACCEPTED:n,BAD_GATEWAY:a,BAD_REQUEST:o,CONFLICT:c,CONTINUE:u,CREATED:l,EXPECTATION_FAILED:d,FORBIDDEN:_,GATEWAY_TIMEOUT:p,GONE:f,HTTP_VERSION_NOT_SUPPORTED:m,IM_A_TEAPOT:y,INSUFFICIENT_SPACE_ON_RESOURCE:w,INSUFFICIENT_STORAGE:g,INTERNAL_SERVER_ERROR:v,LENGTH_REQUIRED:E,LOCKED:T,METHOD_FAILURE:b,METHOD_NOT_ALLOWED:S,MOVED_PERMANENTLY:C,MOVED_TEMPORARILY:R,MULTI_STATUS:k,MULTIPLE_CHOICES:D,NETWORK_AUTHENTICATION_REQUIRED:A,NO_CONTENT:N,NON_AUTHORITATIVE_INFORMATION:P,NOT_ACCEPTABLE:O,NOT_FOUND:I,NOT_IMPLEMENTED:M,NOT_MODIFIED:x,OK:L,PARTIAL_CONTENT:F,PAYMENT_REQUIRED:U,PERMANENT_REDIRECT:H,PRECONDITION_FAILED:B,PRECONDITION_REQUIRED:j,PROCESSING:q,PROXY_AUTHENTICATION_REQUIRED:K,REQUEST_HEADER_FIELDS_TOO_LARGE:Z,REQUEST_TIMEOUT:W,REQUEST_TOO_LONG:z,REQUEST_URI_TOO_LONG:V,REQUESTED_RANGE_NOT_SATISFIABLE:G,RESET_CONTENT:$,SEE_OTHER:X,SERVICE_UNAVAILABLE:Y,SWITCHING_PROTOCOLS:J,TEMPORARY_REDIRECT:Q,TOO_MANY_REQUESTS:ee,UNAUTHORIZED:te,UNPROCESSABLE_ENTITY:re,UNSUPPORTED_MEDIA_TYPE:se,USE_PROXY:ne};var ae={202:"Accepted",502:"Bad Gateway",400:"Bad Request",409:"Conflict",100:"Continue",201:"Created",417:"Expectation Failed",424:"Failed Dependency",403:"Forbidden",504:"Gateway Timeout",410:"Gone",505:"HTTP Version Not Supported",418:"I'm a teapot",419:"Insufficient Space on Resource",507:"Insufficient Storage",500:"Internal Server Error",411:"Length Required",423:"Locked",420:"Method Failure",405:"Method Not Allowed",301:"Moved Permanently",302:"Moved Temporarily",207:"Multi-Status",300:"Multiple Choices",511:"Network Authentication Required",204:"No Content",203:"Non Authoritative Information",406:"Not Acceptable",404:"Not Found",501:"Not Implemented",304:"Not Modified",200:"OK",206:"Partial Content",402:"Payment Required",308:"Permanent Redirect",412:"Precondition Failed",428:"Precondition Required",102:"Processing",407:"Proxy Authentication Required",431:"Request Header Fields Too Large",408:"Request Timeout",413:"Request Entity Too Large",414:"Request-URI Too Long",416:"Requested Range Not Satisfiable",205:"Reset Content",303:"See Other",503:"Service Unavailable",101:"Switching Protocols",307:"Temporary Redirect",429:"Too Many Requests",401:"Unauthorized",451:"Unavailable For Legal Reasons",422:"Unprocessable Entity",415:"Unsupported Media Type",305:"Use Proxy",421:"Misdirected Request"},oe={Accepted:202,"Bad Gateway":502,"Bad Request":400,Conflict:409,Continue:100,Created:201,"Expectation Failed":417,"Failed Dependency":424,Forbidden:403,"Gateway Timeout":504,Gone:410,"HTTP Version Not Supported":505,"I'm a teapot":418,"Insufficient Space on Resource":419,"Insufficient Storage":507,"Internal Server Error":500,"Length Required":411,Locked:423,"Method Failure":420,"Method Not Allowed":405,"Moved Permanently":301,"Moved Temporarily":302,"Multi-Status":207,"Multiple Choices":300,"Network Authentication Required":511,"No Content":204,"Non Authoritative Information":203,"Not Acceptable":406,"Not Found":404,"Not Implemented":501,"Not Modified":304,OK:200,"Partial Content":206,"Payment Required":402,"Permanent Redirect":308,"Precondition Failed":412,"Precondition Required":428,Processing:102,"Proxy Authentication Required":407,"Request Header Fields Too Large":431,"Request Timeout":408,"Request Entity Too Large":413,"Request-URI Too Long":414,"Requested Range Not Satisfiable":416,"Reset Content":205,"See Other":303,"Service Unavailable":503,"Switching Protocols":101,"Temporary Redirect":307,"Too Many Requests":429,Unauthorized:401,"Unavailable For Legal Reasons":451,"Unprocessable Entity":422,"Unsupported Media Type":415,"Use Proxy":305,"Misdirected Request":421};function ce(e){var t=ae[e.toString()];if(!t)throw new Error("Status code does not exist: "+e);return t}function ue(e){var t=oe[e];if(!t)throw new Error("Reason phrase does not exist: "+e);return t}var le,de,he=ce;!function(e){e[e.ACCEPTED=202]="ACCEPTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.CONFLICT=409]="CONFLICT",e[e.CONTINUE=100]="CONTINUE",e[e.CREATED=201]="CREATED",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.GONE=410]="GONE",e[e.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",e[e.IM_A_TEAPOT=418]="IM_A_TEAPOT",e[e.INSUFFICIENT_SPACE_ON_RESOURCE=419]="INSUFFICIENT_SPACE_ON_RESOURCE",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.LOCKED=423]="LOCKED",e[e.METHOD_FAILURE=420]="METHOD_FAILURE",e[e.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",e[e.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",e[e.MOVED_TEMPORARILY=302]="MOVED_TEMPORARILY",e[e.MULTI_STATUS=207]="MULTI_STATUS",e[e.MULTIPLE_CHOICES=300]="MULTIPLE_CHOICES",e[e.NETWORK_AUTHENTICATION_REQUIRED=511]="NETWORK_AUTHENTICATION_REQUIRED",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.OK=200]="OK",e[e.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",e[e.PROCESSING=102]="PROCESSING",e[e.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",e[e.REQUEST_HEADER_FIELDS_TOO_LARGE=431]="REQUEST_HEADER_FIELDS_TOO_LARGE",e[e.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",e[e.REQUEST_TOO_LONG=413]="REQUEST_TOO_LONG",e[e.REQUEST_URI_TOO_LONG=414]="REQUEST_URI_TOO_LONG",e[e.REQUESTED_RANGE_NOT_SATISFIABLE=416]="REQUESTED_RANGE_NOT_SATISFIABLE",e[e.RESET_CONTENT=205]="RESET_CONTENT",e[e.SEE_OTHER=303]="SEE_OTHER",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",e[e.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",e[e.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.UNAVAILABLE_FOR_LEGAL_REASONS=451]="UNAVAILABLE_FOR_LEGAL_REASONS",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.USE_PROXY=305]="USE_PROXY",e[e.MISDIRECTED_REQUEST=421]="MISDIRECTED_REQUEST"}(le||(le={})),function(e){e.ACCEPTED="Accepted",e.BAD_GATEWAY="Bad Gateway",e.BAD_REQUEST="Bad Request",e.CONFLICT="Conflict",e.CONTINUE="Continue",e.CREATED="Created",e.EXPECTATION_FAILED="Expectation Failed",e.FAILED_DEPENDENCY="Failed Dependency",e.FORBIDDEN="Forbidden",e.GATEWAY_TIMEOUT="Gateway Timeout",e.GONE="Gone",e.HTTP_VERSION_NOT_SUPPORTED="HTTP Version Not Supported",e.IM_A_TEAPOT="I'm a teapot",e.INSUFFICIENT_SPACE_ON_RESOURCE="Insufficient Space on Resource",e.INSUFFICIENT_STORAGE="Insufficient Storage",e.INTERNAL_SERVER_ERROR="Internal Server Error",e.LENGTH_REQUIRED="Length Required",e.LOCKED="Locked",e.METHOD_FAILURE="Method Failure",e.METHOD_NOT_ALLOWED="Method Not Allowed",e.MOVED_PERMANENTLY="Moved Permanently",e.MOVED_TEMPORARILY="Moved Temporarily",e.MULTI_STATUS="Multi-Status",e.MULTIPLE_CHOICES="Multiple Choices",e.NETWORK_AUTHENTICATION_REQUIRED="Network Authentication Required",e.NO_CONTENT="No Content",e.NON_AUTHORITATIVE_INFORMATION="Non Authoritative Information",e.NOT_ACCEPTABLE="Not Acceptable",e.NOT_FOUND="Not Found",e.NOT_IMPLEMENTED="Not Implemented",e.NOT_MODIFIED="Not Modified",e.OK="OK",e.PARTIAL_CONTENT="Partial Content",e.PAYMENT_REQUIRED="Payment Required",e.PERMANENT_REDIRECT="Permanent Redirect",e.PRECONDITION_FAILED="Precondition Failed",e.PRECONDITION_REQUIRED="Precondition Required",e.PROCESSING="Processing",e.PROXY_AUTHENTICATION_REQUIRED="Proxy Authentication Required",e.REQUEST_HEADER_FIELDS_TOO_LARGE="Request Header Fields Too Large",e.REQUEST_TIMEOUT="Request Timeout",e.REQUEST_TOO_LONG="Request Entity Too Large",e.REQUEST_URI_TOO_LONG="Request-URI Too Long",e.REQUESTED_RANGE_NOT_SATISFIABLE="Requested Range Not Satisfiable",e.RESET_CONTENT="Reset Content",e.SEE_OTHER="See Other",e.SERVICE_UNAVAILABLE="Service Unavailable",e.SWITCHING_PROTOCOLS="Switching Protocols",e.TEMPORARY_REDIRECT="Temporary Redirect",e.TOO_MANY_REQUESTS="Too Many Requests",e.UNAUTHORIZED="Unauthorized",e.UNAVAILABLE_FOR_LEGAL_REASONS="Unavailable For Legal Reasons",e.UNPROCESSABLE_ENTITY="Unprocessable Entity",e.UNSUPPORTED_MEDIA_TYPE="Unsupported Media Type",e.USE_PROXY="Use Proxy",e.MISDIRECTED_REQUEST="Misdirected Request"}(de||(de={}));var _e=function(){return _e=Object.assign||function(e){for(var t,s=1,n=arguments.length;s<n;s++)for(var a in t=arguments[s])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},_e.apply(this,arguments)};const pe=_e(_e({},ie),{getStatusCode:ue,getStatusText:he})},645:(e,t)=>{t.read=function(e,t,s,n,a){var o,c,u=8*a-n-1,l=(1<<u)-1,d=l>>1,h=-7,_=s?a-1:0,p=s?-1:1,f=e[t+_];for(_+=p,o=f&(1<<-h)-1,f>>=-h,h+=u;h>0;o=256*o+e[t+_],_+=p,h-=8);for(c=o&(1<<-h)-1,o>>=-h,h+=n;h>0;c=256*c+e[t+_],_+=p,h-=8);if(0===o)o=1-d;else{if(o===l)return c?NaN:1/0*(f?-1:1);c+=Math.pow(2,n),o-=d}return(f?-1:1)*c*Math.pow(2,o-n)},t.write=function(e,t,s,n,a,o){var c,u,l,d=8*o-a-1,h=(1<<d)-1,_=h>>1,p=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,m=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,c=h):(c=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-c))<1&&(c--,l*=2),(t+=c+_>=1?p/l:p*Math.pow(2,1-_))*l>=2&&(c++,l/=2),c+_>=h?(u=0,c=h):c+_>=1?(u=(t*l-1)*Math.pow(2,a),c+=_):(u=t*Math.pow(2,_-1)*Math.pow(2,a),c=0));a>=8;e[s+f]=255&u,f+=m,u/=256,a-=8);for(c=c<<a|u,d+=a;d>0;e[s+f]=255&c,f+=m,c/=256,d-=8);e[s+f-m]|=128*y}},6486:function(e,t,s){var n;e=s.nmd(e),function(){var a,o="Expected a function",c="__lodash_hash_undefined__",u="__lodash_placeholder__",l=16,d=32,h=64,_=128,p=256,f=1/0,m=9007199254740991,y=NaN,w=4294967295,g=[["ary",_],["bind",1],["bindKey",2],["curry",8],["curryRight",l],["flip",512],["partial",d],["partialRight",h],["rearg",p]],v="[object Arguments]",E="[object Array]",T="[object Boolean]",b="[object Date]",S="[object Error]",C="[object Function]",R="[object GeneratorFunction]",k="[object Map]",D="[object Number]",A="[object Object]",N="[object Promise]",P="[object RegExp]",O="[object Set]",I="[object String]",M="[object Symbol]",x="[object WeakMap]",L="[object ArrayBuffer]",F="[object DataView]",U="[object Float32Array]",H="[object Float64Array]",B="[object Int8Array]",j="[object Int16Array]",q="[object Int32Array]",K="[object Uint8Array]",Z="[object Uint8ClampedArray]",W="[object Uint16Array]",z="[object Uint32Array]",V=/\b__p \+= '';/g,G=/\b(__p \+=) '' \+/g,$=/(__e\(.*?\)|\b__t\)) \+\n'';/g,X=/&(?:amp|lt|gt|quot|#39);/g,Y=/[&<>"']/g,J=RegExp(X.source),Q=RegExp(Y.source),ee=/<%-([\s\S]+?)%>/g,te=/<%([\s\S]+?)%>/g,re=/<%=([\s\S]+?)%>/g,se=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ne=/^\w*$/,ie=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ae=/[\\^$.*+?()[\]{}|]/g,oe=RegExp(ae.source),ce=/^\s+/,ue=/\s/,le=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,de=/\{\n\/\* \[wrapped with (.+)\] \*/,he=/,? & /,_e=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,pe=/[()=,{}\[\]\/\s]/,fe=/\\(\\)?/g,me=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ye=/\w*$/,we=/^[-+]0x[0-9a-f]+$/i,ge=/^0b[01]+$/i,ve=/^\[object .+?Constructor\]$/,Ee=/^0o[0-7]+$/i,Te=/^(?:0|[1-9]\d*)$/,be=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Se=/($^)/,Ce=/['\n\r\u2028\u2029\\]/g,Re="\\ud800-\\udfff",ke="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",De="\\u2700-\\u27bf",Ae="a-z\\xdf-\\xf6\\xf8-\\xff",Ne="A-Z\\xc0-\\xd6\\xd8-\\xde",Pe="\\ufe0e\\ufe0f",Oe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ie="['’]",Me="["+Re+"]",xe="["+Oe+"]",Le="["+ke+"]",Fe="\\d+",Ue="["+De+"]",He="["+Ae+"]",Be="[^"+Re+Oe+Fe+De+Ae+Ne+"]",je="\\ud83c[\\udffb-\\udfff]",qe="[^"+Re+"]",Ke="(?:\\ud83c[\\udde6-\\uddff]){2}",Ze="[\\ud800-\\udbff][\\udc00-\\udfff]",We="["+Ne+"]",ze="\\u200d",Ve="(?:"+He+"|"+Be+")",Ge="(?:"+We+"|"+Be+")",$e="(?:['’](?:d|ll|m|re|s|t|ve))?",Xe="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ye="(?:"+Le+"|"+je+")"+"?",Je="["+Pe+"]?",Qe=Je+Ye+("(?:"+ze+"(?:"+[qe,Ke,Ze].join("|")+")"+Je+Ye+")*"),et="(?:"+[Ue,Ke,Ze].join("|")+")"+Qe,tt="(?:"+[qe+Le+"?",Le,Ke,Ze,Me].join("|")+")",rt=RegExp(Ie,"g"),st=RegExp(Le,"g"),nt=RegExp(je+"(?="+je+")|"+tt+Qe,"g"),it=RegExp([We+"?"+He+"+"+$e+"(?="+[xe,We,"$"].join("|")+")",Ge+"+"+Xe+"(?="+[xe,We+Ve,"$"].join("|")+")",We+"?"+Ve+"+"+$e,We+"+"+Xe,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fe,et].join("|"),"g"),at=RegExp("["+ze+Re+ke+Pe+"]"),ot=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ct=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ut=-1,lt={};lt[U]=lt[H]=lt[B]=lt[j]=lt[q]=lt[K]=lt[Z]=lt[W]=lt[z]=!0,lt[v]=lt[E]=lt[L]=lt[T]=lt[F]=lt[b]=lt[S]=lt[C]=lt[k]=lt[D]=lt[A]=lt[P]=lt[O]=lt[I]=lt[x]=!1;var dt={};dt[v]=dt[E]=dt[L]=dt[F]=dt[T]=dt[b]=dt[U]=dt[H]=dt[B]=dt[j]=dt[q]=dt[k]=dt[D]=dt[A]=dt[P]=dt[O]=dt[I]=dt[M]=dt[K]=dt[Z]=dt[W]=dt[z]=!0,dt[S]=dt[C]=dt[x]=!1;var ht={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},_t=parseFloat,pt=parseInt,ft="object"==typeof s.g&&s.g&&s.g.Object===Object&&s.g,mt="object"==typeof self&&self&&self.Object===Object&&self,yt=ft||mt||Function("return this")(),wt=t&&!t.nodeType&&t,gt=wt&&e&&!e.nodeType&&e,vt=gt&&gt.exports===wt,Et=vt&&ft.process,Tt=function(){try{var e=gt&&gt.require&&gt.require("util").types;return e||Et&&Et.binding&&Et.binding("util")}catch(e){}}(),bt=Tt&&Tt.isArrayBuffer,St=Tt&&Tt.isDate,Ct=Tt&&Tt.isMap,Rt=Tt&&Tt.isRegExp,kt=Tt&&Tt.isSet,Dt=Tt&&Tt.isTypedArray;function At(e,t,s){switch(s.length){case 0:return e.call(t);case 1:return e.call(t,s[0]);case 2:return e.call(t,s[0],s[1]);case 3:return e.call(t,s[0],s[1],s[2])}return e.apply(t,s)}function Nt(e,t,s,n){for(var a=-1,o=null==e?0:e.length;++a<o;){var c=e[a];t(n,c,s(c),e)}return n}function Pt(e,t){for(var s=-1,n=null==e?0:e.length;++s<n&&!1!==t(e[s],s,e););return e}function Ot(e,t){for(var s=null==e?0:e.length;s--&&!1!==t(e[s],s,e););return e}function It(e,t){for(var s=-1,n=null==e?0:e.length;++s<n;)if(!t(e[s],s,e))return!1;return!0}function Mt(e,t){for(var s=-1,n=null==e?0:e.length,a=0,o=[];++s<n;){var c=e[s];t(c,s,e)&&(o[a++]=c)}return o}function xt(e,t){return!!(null==e?0:e.length)&&Wt(e,t,0)>-1}function Lt(e,t,s){for(var n=-1,a=null==e?0:e.length;++n<a;)if(s(t,e[n]))return!0;return!1}function Ft(e,t){for(var s=-1,n=null==e?0:e.length,a=Array(n);++s<n;)a[s]=t(e[s],s,e);return a}function Ut(e,t){for(var s=-1,n=t.length,a=e.length;++s<n;)e[a+s]=t[s];return e}function Ht(e,t,s,n){var a=-1,o=null==e?0:e.length;for(n&&o&&(s=e[++a]);++a<o;)s=t(s,e[a],a,e);return s}function Bt(e,t,s,n){var a=null==e?0:e.length;for(n&&a&&(s=e[--a]);a--;)s=t(s,e[a],a,e);return s}function jt(e,t){for(var s=-1,n=null==e?0:e.length;++s<n;)if(t(e[s],s,e))return!0;return!1}var qt=$t("length");function Kt(e,t,s){var n;return s(e,(function(e,s,a){if(t(e,s,a))return n=s,!1})),n}function Zt(e,t,s,n){for(var a=e.length,o=s+(n?1:-1);n?o--:++o<a;)if(t(e[o],o,e))return o;return-1}function Wt(e,t,s){return t==t?function(e,t,s){var n=s-1,a=e.length;for(;++n<a;)if(e[n]===t)return n;return-1}(e,t,s):Zt(e,Vt,s)}function zt(e,t,s,n){for(var a=s-1,o=e.length;++a<o;)if(n(e[a],t))return a;return-1}function Vt(e){return e!=e}function Gt(e,t){var s=null==e?0:e.length;return s?Jt(e,t)/s:y}function $t(e){return function(t){return null==t?a:t[e]}}function Xt(e){return function(t){return null==e?a:e[t]}}function Yt(e,t,s,n,a){return a(e,(function(e,a,o){s=n?(n=!1,e):t(s,e,a,o)})),s}function Jt(e,t){for(var s,n=-1,o=e.length;++n<o;){var c=t(e[n]);c!==a&&(s=s===a?c:s+c)}return s}function Qt(e,t){for(var s=-1,n=Array(e);++s<e;)n[s]=t(s);return n}function er(e){return e?e.slice(0,yr(e)+1).replace(ce,""):e}function tr(e){return function(t){return e(t)}}function rr(e,t){return Ft(t,(function(t){return e[t]}))}function sr(e,t){return e.has(t)}function nr(e,t){for(var s=-1,n=e.length;++s<n&&Wt(t,e[s],0)>-1;);return s}function ir(e,t){for(var s=e.length;s--&&Wt(t,e[s],0)>-1;);return s}var ar=Xt({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),or=Xt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function cr(e){return"\\"+ht[e]}function ur(e){return at.test(e)}function lr(e){var t=-1,s=Array(e.size);return e.forEach((function(e,n){s[++t]=[n,e]})),s}function dr(e,t){return function(s){return e(t(s))}}function hr(e,t){for(var s=-1,n=e.length,a=0,o=[];++s<n;){var c=e[s];c!==t&&c!==u||(e[s]=u,o[a++]=s)}return o}function _r(e){var t=-1,s=Array(e.size);return e.forEach((function(e){s[++t]=e})),s}function pr(e){var t=-1,s=Array(e.size);return e.forEach((function(e){s[++t]=[e,e]})),s}function fr(e){return ur(e)?function(e){var t=nt.lastIndex=0;for(;nt.test(e);)++t;return t}(e):qt(e)}function mr(e){return ur(e)?function(e){return e.match(nt)||[]}(e):function(e){return e.split("")}(e)}function yr(e){for(var t=e.length;t--&&ue.test(e.charAt(t)););return t}var wr=Xt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var gr=function e(t){var s,n=(t=null==t?yt:gr.defaults(yt.Object(),t,gr.pick(yt,ct))).Array,ue=t.Date,Re=t.Error,ke=t.Function,De=t.Math,Ae=t.Object,Ne=t.RegExp,Pe=t.String,Oe=t.TypeError,Ie=n.prototype,Me=ke.prototype,xe=Ae.prototype,Le=t["__core-js_shared__"],Fe=Me.toString,Ue=xe.hasOwnProperty,He=0,Be=(s=/[^.]+$/.exec(Le&&Le.keys&&Le.keys.IE_PROTO||""))?"Symbol(src)_1."+s:"",je=xe.toString,qe=Fe.call(Ae),Ke=yt._,Ze=Ne("^"+Fe.call(Ue).replace(ae,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),We=vt?t.Buffer:a,ze=t.Symbol,Ve=t.Uint8Array,Ge=We?We.allocUnsafe:a,$e=dr(Ae.getPrototypeOf,Ae),Xe=Ae.create,Ye=xe.propertyIsEnumerable,Je=Ie.splice,Qe=ze?ze.isConcatSpreadable:a,et=ze?ze.iterator:a,tt=ze?ze.toStringTag:a,nt=function(){try{var e=pi(Ae,"defineProperty");return e({},"",{}),e}catch(e){}}(),at=t.clearTimeout!==yt.clearTimeout&&t.clearTimeout,ht=ue&&ue.now!==yt.Date.now&&ue.now,ft=t.setTimeout!==yt.setTimeout&&t.setTimeout,mt=De.ceil,wt=De.floor,gt=Ae.getOwnPropertySymbols,Et=We?We.isBuffer:a,Tt=t.isFinite,qt=Ie.join,Xt=dr(Ae.keys,Ae),vr=De.max,Er=De.min,Tr=ue.now,br=t.parseInt,Sr=De.random,Cr=Ie.reverse,Rr=pi(t,"DataView"),kr=pi(t,"Map"),Dr=pi(t,"Promise"),Ar=pi(t,"Set"),Nr=pi(t,"WeakMap"),Pr=pi(Ae,"create"),Or=Nr&&new Nr,Ir={},Mr=Bi(Rr),xr=Bi(kr),Lr=Bi(Dr),Fr=Bi(Ar),Ur=Bi(Nr),Hr=ze?ze.prototype:a,Br=Hr?Hr.valueOf:a,jr=Hr?Hr.toString:a;function qr(e){if(so(e)&&!za(e)&&!(e instanceof zr)){if(e instanceof Wr)return e;if(Ue.call(e,"__wrapped__"))return ji(e)}return new Wr(e)}var Kr=function(){function e(){}return function(t){if(!ro(t))return{};if(Xe)return Xe(t);e.prototype=t;var s=new e;return e.prototype=a,s}}();function Zr(){}function Wr(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=a}function zr(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=w,this.__views__=[]}function Vr(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var n=e[t];this.set(n[0],n[1])}}function Gr(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var n=e[t];this.set(n[0],n[1])}}function $r(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var n=e[t];this.set(n[0],n[1])}}function Xr(e){var t=-1,s=null==e?0:e.length;for(this.__data__=new $r;++t<s;)this.add(e[t])}function Yr(e){var t=this.__data__=new Gr(e);this.size=t.size}function Jr(e,t){var s=za(e),n=!s&&Wa(e),a=!s&&!n&&Xa(e),o=!s&&!n&&!a&&ho(e),c=s||n||a||o,u=c?Qt(e.length,Pe):[],l=u.length;for(var d in e)!t&&!Ue.call(e,d)||c&&("length"==d||a&&("offset"==d||"parent"==d)||o&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||Ei(d,l))||u.push(d);return u}function Qr(e){var t=e.length;return t?e[Xs(0,t-1)]:a}function es(e,t){return Fi(On(e),us(t,0,e.length))}function ts(e){return Fi(On(e))}function rs(e,t,s){(s!==a&&!qa(e[t],s)||s===a&&!(t in e))&&os(e,t,s)}function ss(e,t,s){var n=e[t];Ue.call(e,t)&&qa(n,s)&&(s!==a||t in e)||os(e,t,s)}function ns(e,t){for(var s=e.length;s--;)if(qa(e[s][0],t))return s;return-1}function is(e,t,s,n){return ps(e,(function(e,a,o){t(n,e,s(e),o)})),n}function as(e,t){return e&&In(t,Mo(t),e)}function os(e,t,s){"__proto__"==t&&nt?nt(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function cs(e,t){for(var s=-1,o=t.length,c=n(o),u=null==e;++s<o;)c[s]=u?a:Ao(e,t[s]);return c}function us(e,t,s){return e==e&&(s!==a&&(e=e<=s?e:s),t!==a&&(e=e>=t?e:t)),e}function ls(e,t,s,n,o,c){var u,l=1&t,d=2&t,h=4&t;if(s&&(u=o?s(e,n,o,c):s(e)),u!==a)return u;if(!ro(e))return e;var _=za(e);if(_){if(u=function(e){var t=e.length,s=new e.constructor(t);t&&"string"==typeof e[0]&&Ue.call(e,"index")&&(s.index=e.index,s.input=e.input);return s}(e),!l)return On(e,u)}else{var p=yi(e),f=p==C||p==R;if(Xa(e))return Rn(e,l);if(p==A||p==v||f&&!o){if(u=d||f?{}:gi(e),!l)return d?function(e,t){return In(e,mi(e),t)}(e,function(e,t){return e&&In(t,xo(t),e)}(u,e)):function(e,t){return In(e,fi(e),t)}(e,as(u,e))}else{if(!dt[p])return o?e:{};u=function(e,t,s){var n=e.constructor;switch(t){case L:return kn(e);case T:case b:return new n(+e);case F:return function(e,t){var s=t?kn(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}(e,s);case U:case H:case B:case j:case q:case K:case Z:case W:case z:return Dn(e,s);case k:return new n;case D:case I:return new n(e);case P:return function(e){var t=new e.constructor(e.source,ye.exec(e));return t.lastIndex=e.lastIndex,t}(e);case O:return new n;case M:return a=e,Br?Ae(Br.call(a)):{}}var a}(e,p,l)}}c||(c=new Yr);var m=c.get(e);if(m)return m;c.set(e,u),co(e)?e.forEach((function(n){u.add(ls(n,t,s,n,e,c))})):no(e)&&e.forEach((function(n,a){u.set(a,ls(n,t,s,a,e,c))}));var y=_?a:(h?d?oi:ai:d?xo:Mo)(e);return Pt(y||e,(function(n,a){y&&(n=e[a=n]),ss(u,a,ls(n,t,s,a,e,c))})),u}function ds(e,t,s){var n=s.length;if(null==e)return!n;for(e=Ae(e);n--;){var o=s[n],c=t[o],u=e[o];if(u===a&&!(o in e)||!c(u))return!1}return!0}function hs(e,t,s){if("function"!=typeof e)throw new Oe(o);return Ii((function(){e.apply(a,s)}),t)}function _s(e,t,s,n){var a=-1,o=xt,c=!0,u=e.length,l=[],d=t.length;if(!u)return l;s&&(t=Ft(t,tr(s))),n?(o=Lt,c=!1):t.length>=200&&(o=sr,c=!1,t=new Xr(t));e:for(;++a<u;){var h=e[a],_=null==s?h:s(h);if(h=n||0!==h?h:0,c&&_==_){for(var p=d;p--;)if(t[p]===_)continue e;l.push(h)}else o(t,_,n)||l.push(h)}return l}qr.templateSettings={escape:ee,evaluate:te,interpolate:re,variable:"",imports:{_:qr}},qr.prototype=Zr.prototype,qr.prototype.constructor=qr,Wr.prototype=Kr(Zr.prototype),Wr.prototype.constructor=Wr,zr.prototype=Kr(Zr.prototype),zr.prototype.constructor=zr,Vr.prototype.clear=function(){this.__data__=Pr?Pr(null):{},this.size=0},Vr.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Vr.prototype.get=function(e){var t=this.__data__;if(Pr){var s=t[e];return s===c?a:s}return Ue.call(t,e)?t[e]:a},Vr.prototype.has=function(e){var t=this.__data__;return Pr?t[e]!==a:Ue.call(t,e)},Vr.prototype.set=function(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Pr&&t===a?c:t,this},Gr.prototype.clear=function(){this.__data__=[],this.size=0},Gr.prototype.delete=function(e){var t=this.__data__,s=ns(t,e);return!(s<0)&&(s==t.length-1?t.pop():Je.call(t,s,1),--this.size,!0)},Gr.prototype.get=function(e){var t=this.__data__,s=ns(t,e);return s<0?a:t[s][1]},Gr.prototype.has=function(e){return ns(this.__data__,e)>-1},Gr.prototype.set=function(e,t){var s=this.__data__,n=ns(s,e);return n<0?(++this.size,s.push([e,t])):s[n][1]=t,this},$r.prototype.clear=function(){this.size=0,this.__data__={hash:new Vr,map:new(kr||Gr),string:new Vr}},$r.prototype.delete=function(e){var t=hi(this,e).delete(e);return this.size-=t?1:0,t},$r.prototype.get=function(e){return hi(this,e).get(e)},$r.prototype.has=function(e){return hi(this,e).has(e)},$r.prototype.set=function(e,t){var s=hi(this,e),n=s.size;return s.set(e,t),this.size+=s.size==n?0:1,this},Xr.prototype.add=Xr.prototype.push=function(e){return this.__data__.set(e,c),this},Xr.prototype.has=function(e){return this.__data__.has(e)},Yr.prototype.clear=function(){this.__data__=new Gr,this.size=0},Yr.prototype.delete=function(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s},Yr.prototype.get=function(e){return this.__data__.get(e)},Yr.prototype.has=function(e){return this.__data__.has(e)},Yr.prototype.set=function(e,t){var s=this.__data__;if(s instanceof Gr){var n=s.__data__;if(!kr||n.length<199)return n.push([e,t]),this.size=++s.size,this;s=this.__data__=new $r(n)}return s.set(e,t),this.size=s.size,this};var ps=Ln(Ts),fs=Ln(bs,!0);function ms(e,t){var s=!0;return ps(e,(function(e,n,a){return s=!!t(e,n,a)})),s}function ys(e,t,s){for(var n=-1,o=e.length;++n<o;){var c=e[n],u=t(c);if(null!=u&&(l===a?u==u&&!lo(u):s(u,l)))var l=u,d=c}return d}function ws(e,t){var s=[];return ps(e,(function(e,n,a){t(e,n,a)&&s.push(e)})),s}function gs(e,t,s,n,a){var o=-1,c=e.length;for(s||(s=vi),a||(a=[]);++o<c;){var u=e[o];t>0&&s(u)?t>1?gs(u,t-1,s,n,a):Ut(a,u):n||(a[a.length]=u)}return a}var vs=Fn(),Es=Fn(!0);function Ts(e,t){return e&&vs(e,t,Mo)}function bs(e,t){return e&&Es(e,t,Mo)}function Ss(e,t){return Mt(t,(function(t){return Qa(e[t])}))}function Cs(e,t){for(var s=0,n=(t=Tn(t,e)).length;null!=e&&s<n;)e=e[Hi(t[s++])];return s&&s==n?e:a}function Rs(e,t,s){var n=t(e);return za(e)?n:Ut(n,s(e))}function ks(e){return null==e?e===a?"[object Undefined]":"[object Null]":tt&&tt in Ae(e)?function(e){var t=Ue.call(e,tt),s=e[tt];try{e[tt]=a;var n=!0}catch(e){}var o=je.call(e);n&&(t?e[tt]=s:delete e[tt]);return o}(e):function(e){return je.call(e)}(e)}function Ds(e,t){return e>t}function As(e,t){return null!=e&&Ue.call(e,t)}function Ns(e,t){return null!=e&&t in Ae(e)}function Ps(e,t,s){for(var o=s?Lt:xt,c=e[0].length,u=e.length,l=u,d=n(u),h=1/0,_=[];l--;){var p=e[l];l&&t&&(p=Ft(p,tr(t))),h=Er(p.length,h),d[l]=!s&&(t||c>=120&&p.length>=120)?new Xr(l&&p):a}p=e[0];var f=-1,m=d[0];e:for(;++f<c&&_.length<h;){var y=p[f],w=t?t(y):y;if(y=s||0!==y?y:0,!(m?sr(m,w):o(_,w,s))){for(l=u;--l;){var g=d[l];if(!(g?sr(g,w):o(e[l],w,s)))continue e}m&&m.push(w),_.push(y)}}return _}function Os(e,t,s){var n=null==(e=Ni(e,t=Tn(t,e)))?e:e[Hi(Ji(t))];return null==n?a:At(n,e,s)}function Is(e){return so(e)&&ks(e)==v}function Ms(e,t,s,n,o){return e===t||(null==e||null==t||!so(e)&&!so(t)?e!=e&&t!=t:function(e,t,s,n,o,c){var u=za(e),l=za(t),d=u?E:yi(e),h=l?E:yi(t),_=(d=d==v?A:d)==A,p=(h=h==v?A:h)==A,f=d==h;if(f&&Xa(e)){if(!Xa(t))return!1;u=!0,_=!1}if(f&&!_)return c||(c=new Yr),u||ho(e)?ni(e,t,s,n,o,c):function(e,t,s,n,a,o,c){switch(s){case F:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case L:return!(e.byteLength!=t.byteLength||!o(new Ve(e),new Ve(t)));case T:case b:case D:return qa(+e,+t);case S:return e.name==t.name&&e.message==t.message;case P:case I:return e==t+"";case k:var u=lr;case O:var l=1&n;if(u||(u=_r),e.size!=t.size&&!l)return!1;var d=c.get(e);if(d)return d==t;n|=2,c.set(e,t);var h=ni(u(e),u(t),n,a,o,c);return c.delete(e),h;case M:if(Br)return Br.call(e)==Br.call(t)}return!1}(e,t,d,s,n,o,c);if(!(1&s)){var m=_&&Ue.call(e,"__wrapped__"),y=p&&Ue.call(t,"__wrapped__");if(m||y){var w=m?e.value():e,g=y?t.value():t;return c||(c=new Yr),o(w,g,s,n,c)}}if(!f)return!1;return c||(c=new Yr),function(e,t,s,n,o,c){var u=1&s,l=ai(e),d=l.length,h=ai(t),_=h.length;if(d!=_&&!u)return!1;var p=d;for(;p--;){var f=l[p];if(!(u?f in t:Ue.call(t,f)))return!1}var m=c.get(e),y=c.get(t);if(m&&y)return m==t&&y==e;var w=!0;c.set(e,t),c.set(t,e);var g=u;for(;++p<d;){var v=e[f=l[p]],E=t[f];if(n)var T=u?n(E,v,f,t,e,c):n(v,E,f,e,t,c);if(!(T===a?v===E||o(v,E,s,n,c):T)){w=!1;break}g||(g="constructor"==f)}if(w&&!g){var b=e.constructor,S=t.constructor;b==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof S&&S instanceof S||(w=!1)}return c.delete(e),c.delete(t),w}(e,t,s,n,o,c)}(e,t,s,n,Ms,o))}function xs(e,t,s,n){var o=s.length,c=o,u=!n;if(null==e)return!c;for(e=Ae(e);o--;){var l=s[o];if(u&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<c;){var d=(l=s[o])[0],h=e[d],_=l[1];if(u&&l[2]){if(h===a&&!(d in e))return!1}else{var p=new Yr;if(n)var f=n(h,_,d,e,t,p);if(!(f===a?Ms(_,h,3,n,p):f))return!1}}return!0}function Ls(e){return!(!ro(e)||(t=e,Be&&Be in t))&&(Qa(e)?Ze:ve).test(Bi(e));var t}function Fs(e){return"function"==typeof e?e:null==e?ac:"object"==typeof e?za(e)?Ks(e[0],e[1]):qs(e):fc(e)}function Us(e){if(!Ri(e))return Xt(e);var t=[];for(var s in Ae(e))Ue.call(e,s)&&"constructor"!=s&&t.push(s);return t}function Hs(e){if(!ro(e))return function(e){var t=[];if(null!=e)for(var s in Ae(e))t.push(s);return t}(e);var t=Ri(e),s=[];for(var n in e)("constructor"!=n||!t&&Ue.call(e,n))&&s.push(n);return s}function Bs(e,t){return e<t}function js(e,t){var s=-1,a=Ga(e)?n(e.length):[];return ps(e,(function(e,n,o){a[++s]=t(e,n,o)})),a}function qs(e){var t=_i(e);return 1==t.length&&t[0][2]?Di(t[0][0],t[0][1]):function(s){return s===e||xs(s,e,t)}}function Ks(e,t){return bi(e)&&ki(t)?Di(Hi(e),t):function(s){var n=Ao(s,e);return n===a&&n===t?No(s,e):Ms(t,n,3)}}function Zs(e,t,s,n,o){e!==t&&vs(t,(function(c,u){if(o||(o=new Yr),ro(c))!function(e,t,s,n,o,c,u){var l=Pi(e,s),d=Pi(t,s),h=u.get(d);if(h)return void rs(e,s,h);var _=c?c(l,d,s+"",e,t,u):a,p=_===a;if(p){var f=za(d),m=!f&&Xa(d),y=!f&&!m&&ho(d);_=d,f||m||y?za(l)?_=l:$a(l)?_=On(l):m?(p=!1,_=Rn(d,!0)):y?(p=!1,_=Dn(d,!0)):_=[]:ao(d)||Wa(d)?(_=l,Wa(l)?_=vo(l):ro(l)&&!Qa(l)||(_=gi(d))):p=!1}p&&(u.set(d,_),o(_,d,n,c,u),u.delete(d));rs(e,s,_)}(e,t,u,s,Zs,n,o);else{var l=n?n(Pi(e,u),c,u+"",e,t,o):a;l===a&&(l=c),rs(e,u,l)}}),xo)}function Ws(e,t){var s=e.length;if(s)return Ei(t+=t<0?s:0,s)?e[t]:a}function zs(e,t,s){t=t.length?Ft(t,(function(e){return za(e)?function(t){return Cs(t,1===e.length?e[0]:e)}:e})):[ac];var n=-1;t=Ft(t,tr(di()));var a=js(e,(function(e,s,a){var o=Ft(t,(function(t){return t(e)}));return{criteria:o,index:++n,value:e}}));return function(e,t){var s=e.length;for(e.sort(t);s--;)e[s]=e[s].value;return e}(a,(function(e,t){return function(e,t,s){var n=-1,a=e.criteria,o=t.criteria,c=a.length,u=s.length;for(;++n<c;){var l=An(a[n],o[n]);if(l)return n>=u?l:l*("desc"==s[n]?-1:1)}return e.index-t.index}(e,t,s)}))}function Vs(e,t,s){for(var n=-1,a=t.length,o={};++n<a;){var c=t[n],u=Cs(e,c);s(u,c)&&tn(o,Tn(c,e),u)}return o}function Gs(e,t,s,n){var a=n?zt:Wt,o=-1,c=t.length,u=e;for(e===t&&(t=On(t)),s&&(u=Ft(e,tr(s)));++o<c;)for(var l=0,d=t[o],h=s?s(d):d;(l=a(u,h,l,n))>-1;)u!==e&&Je.call(u,l,1),Je.call(e,l,1);return e}function $s(e,t){for(var s=e?t.length:0,n=s-1;s--;){var a=t[s];if(s==n||a!==o){var o=a;Ei(a)?Je.call(e,a,1):pn(e,a)}}return e}function Xs(e,t){return e+wt(Sr()*(t-e+1))}function Ys(e,t){var s="";if(!e||t<1||t>m)return s;do{t%2&&(s+=e),(t=wt(t/2))&&(e+=e)}while(t);return s}function Js(e,t){return Mi(Ai(e,t,ac),e+"")}function Qs(e){return Qr(Ko(e))}function en(e,t){var s=Ko(e);return Fi(s,us(t,0,s.length))}function tn(e,t,s,n){if(!ro(e))return e;for(var o=-1,c=(t=Tn(t,e)).length,u=c-1,l=e;null!=l&&++o<c;){var d=Hi(t[o]),h=s;if("__proto__"===d||"constructor"===d||"prototype"===d)return e;if(o!=u){var _=l[d];(h=n?n(_,d,l):a)===a&&(h=ro(_)?_:Ei(t[o+1])?[]:{})}ss(l,d,h),l=l[d]}return e}var rn=Or?function(e,t){return Or.set(e,t),e}:ac,sn=nt?function(e,t){return nt(e,"toString",{configurable:!0,enumerable:!1,value:sc(t),writable:!0})}:ac;function nn(e){return Fi(Ko(e))}function an(e,t,s){var a=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(s=s>o?o:s)<0&&(s+=o),o=t>s?0:s-t>>>0,t>>>=0;for(var c=n(o);++a<o;)c[a]=e[a+t];return c}function on(e,t){var s;return ps(e,(function(e,n,a){return!(s=t(e,n,a))})),!!s}function cn(e,t,s){var n=0,a=null==e?n:e.length;if("number"==typeof t&&t==t&&a<=2147483647){for(;n<a;){var o=n+a>>>1,c=e[o];null!==c&&!lo(c)&&(s?c<=t:c<t)?n=o+1:a=o}return a}return un(e,t,ac,s)}function un(e,t,s,n){var o=0,c=null==e?0:e.length;if(0===c)return 0;for(var u=(t=s(t))!=t,l=null===t,d=lo(t),h=t===a;o<c;){var _=wt((o+c)/2),p=s(e[_]),f=p!==a,m=null===p,y=p==p,w=lo(p);if(u)var g=n||y;else g=h?y&&(n||f):l?y&&f&&(n||!m):d?y&&f&&!m&&(n||!w):!m&&!w&&(n?p<=t:p<t);g?o=_+1:c=_}return Er(c,4294967294)}function ln(e,t){for(var s=-1,n=e.length,a=0,o=[];++s<n;){var c=e[s],u=t?t(c):c;if(!s||!qa(u,l)){var l=u;o[a++]=0===c?0:c}}return o}function dn(e){return"number"==typeof e?e:lo(e)?y:+e}function hn(e){if("string"==typeof e)return e;if(za(e))return Ft(e,hn)+"";if(lo(e))return jr?jr.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function _n(e,t,s){var n=-1,a=xt,o=e.length,c=!0,u=[],l=u;if(s)c=!1,a=Lt;else if(o>=200){var d=t?null:Jn(e);if(d)return _r(d);c=!1,a=sr,l=new Xr}else l=t?[]:u;e:for(;++n<o;){var h=e[n],_=t?t(h):h;if(h=s||0!==h?h:0,c&&_==_){for(var p=l.length;p--;)if(l[p]===_)continue e;t&&l.push(_),u.push(h)}else a(l,_,s)||(l!==u&&l.push(_),u.push(h))}return u}function pn(e,t){return null==(e=Ni(e,t=Tn(t,e)))||delete e[Hi(Ji(t))]}function fn(e,t,s,n){return tn(e,t,s(Cs(e,t)),n)}function mn(e,t,s,n){for(var a=e.length,o=n?a:-1;(n?o--:++o<a)&&t(e[o],o,e););return s?an(e,n?0:o,n?o+1:a):an(e,n?o+1:0,n?a:o)}function yn(e,t){var s=e;return s instanceof zr&&(s=s.value()),Ht(t,(function(e,t){return t.func.apply(t.thisArg,Ut([e],t.args))}),s)}function wn(e,t,s){var a=e.length;if(a<2)return a?_n(e[0]):[];for(var o=-1,c=n(a);++o<a;)for(var u=e[o],l=-1;++l<a;)l!=o&&(c[o]=_s(c[o]||u,e[l],t,s));return _n(gs(c,1),t,s)}function gn(e,t,s){for(var n=-1,o=e.length,c=t.length,u={};++n<o;){var l=n<c?t[n]:a;s(u,e[n],l)}return u}function vn(e){return $a(e)?e:[]}function En(e){return"function"==typeof e?e:ac}function Tn(e,t){return za(e)?e:bi(e,t)?[e]:Ui(Eo(e))}var bn=Js;function Sn(e,t,s){var n=e.length;return s=s===a?n:s,!t&&s>=n?e:an(e,t,s)}var Cn=at||function(e){return yt.clearTimeout(e)};function Rn(e,t){if(t)return e.slice();var s=e.length,n=Ge?Ge(s):new e.constructor(s);return e.copy(n),n}function kn(e){var t=new e.constructor(e.byteLength);return new Ve(t).set(new Ve(e)),t}function Dn(e,t){var s=t?kn(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function An(e,t){if(e!==t){var s=e!==a,n=null===e,o=e==e,c=lo(e),u=t!==a,l=null===t,d=t==t,h=lo(t);if(!l&&!h&&!c&&e>t||c&&u&&d&&!l&&!h||n&&u&&d||!s&&d||!o)return 1;if(!n&&!c&&!h&&e<t||h&&s&&o&&!n&&!c||l&&s&&o||!u&&o||!d)return-1}return 0}function Nn(e,t,s,a){for(var o=-1,c=e.length,u=s.length,l=-1,d=t.length,h=vr(c-u,0),_=n(d+h),p=!a;++l<d;)_[l]=t[l];for(;++o<u;)(p||o<c)&&(_[s[o]]=e[o]);for(;h--;)_[l++]=e[o++];return _}function Pn(e,t,s,a){for(var o=-1,c=e.length,u=-1,l=s.length,d=-1,h=t.length,_=vr(c-l,0),p=n(_+h),f=!a;++o<_;)p[o]=e[o];for(var m=o;++d<h;)p[m+d]=t[d];for(;++u<l;)(f||o<c)&&(p[m+s[u]]=e[o++]);return p}function On(e,t){var s=-1,a=e.length;for(t||(t=n(a));++s<a;)t[s]=e[s];return t}function In(e,t,s,n){var o=!s;s||(s={});for(var c=-1,u=t.length;++c<u;){var l=t[c],d=n?n(s[l],e[l],l,s,e):a;d===a&&(d=e[l]),o?os(s,l,d):ss(s,l,d)}return s}function Mn(e,t){return function(s,n){var a=za(s)?Nt:is,o=t?t():{};return a(s,e,di(n,2),o)}}function xn(e){return Js((function(t,s){var n=-1,o=s.length,c=o>1?s[o-1]:a,u=o>2?s[2]:a;for(c=e.length>3&&"function"==typeof c?(o--,c):a,u&&Ti(s[0],s[1],u)&&(c=o<3?a:c,o=1),t=Ae(t);++n<o;){var l=s[n];l&&e(t,l,n,c)}return t}))}function Ln(e,t){return function(s,n){if(null==s)return s;if(!Ga(s))return e(s,n);for(var a=s.length,o=t?a:-1,c=Ae(s);(t?o--:++o<a)&&!1!==n(c[o],o,c););return s}}function Fn(e){return function(t,s,n){for(var a=-1,o=Ae(t),c=n(t),u=c.length;u--;){var l=c[e?u:++a];if(!1===s(o[l],l,o))break}return t}}function Un(e){return function(t){var s=ur(t=Eo(t))?mr(t):a,n=s?s[0]:t.charAt(0),o=s?Sn(s,1).join(""):t.slice(1);return n[e]()+o}}function Hn(e){return function(t){return Ht(ec(zo(t).replace(rt,"")),e,"")}}function Bn(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var s=Kr(e.prototype),n=e.apply(s,t);return ro(n)?n:s}}function jn(e){return function(t,s,n){var o=Ae(t);if(!Ga(t)){var c=di(s,3);t=Mo(t),s=function(e){return c(o[e],e,o)}}var u=e(t,s,n);return u>-1?o[c?t[u]:u]:a}}function qn(e){return ii((function(t){var s=t.length,n=s,c=Wr.prototype.thru;for(e&&t.reverse();n--;){var u=t[n];if("function"!=typeof u)throw new Oe(o);if(c&&!l&&"wrapper"==ui(u))var l=new Wr([],!0)}for(n=l?n:s;++n<s;){var d=ui(u=t[n]),h="wrapper"==d?ci(u):a;l=h&&Si(h[0])&&424==h[1]&&!h[4].length&&1==h[9]?l[ui(h[0])].apply(l,h[3]):1==u.length&&Si(u)?l[d]():l.thru(u)}return function(){var e=arguments,n=e[0];if(l&&1==e.length&&za(n))return l.plant(n).value();for(var a=0,o=s?t[a].apply(this,e):n;++a<s;)o=t[a].call(this,o);return o}}))}function Kn(e,t,s,o,c,u,l,d,h,p){var f=t&_,m=1&t,y=2&t,w=24&t,g=512&t,v=y?a:Bn(e);return function _(){for(var E=arguments.length,T=n(E),b=E;b--;)T[b]=arguments[b];if(w)var S=li(_),C=function(e,t){for(var s=e.length,n=0;s--;)e[s]===t&&++n;return n}(T,S);if(o&&(T=Nn(T,o,c,w)),u&&(T=Pn(T,u,l,w)),E-=C,w&&E<p){var R=hr(T,S);return Xn(e,t,Kn,_.placeholder,s,T,R,d,h,p-E)}var k=m?s:this,D=y?k[e]:e;return E=T.length,d?T=function(e,t){var s=e.length,n=Er(t.length,s),o=On(e);for(;n--;){var c=t[n];e[n]=Ei(c,s)?o[c]:a}return e}(T,d):g&&E>1&&T.reverse(),f&&h<E&&(T.length=h),this&&this!==yt&&this instanceof _&&(D=v||Bn(D)),D.apply(k,T)}}function Zn(e,t){return function(s,n){return function(e,t,s,n){return Ts(e,(function(e,a,o){t(n,s(e),a,o)})),n}(s,e,t(n),{})}}function Wn(e,t){return function(s,n){var o;if(s===a&&n===a)return t;if(s!==a&&(o=s),n!==a){if(o===a)return n;"string"==typeof s||"string"==typeof n?(s=hn(s),n=hn(n)):(s=dn(s),n=dn(n)),o=e(s,n)}return o}}function zn(e){return ii((function(t){return t=Ft(t,tr(di())),Js((function(s){var n=this;return e(t,(function(e){return At(e,n,s)}))}))}))}function Vn(e,t){var s=(t=t===a?" ":hn(t)).length;if(s<2)return s?Ys(t,e):t;var n=Ys(t,mt(e/fr(t)));return ur(t)?Sn(mr(n),0,e).join(""):n.slice(0,e)}function Gn(e){return function(t,s,o){return o&&"number"!=typeof o&&Ti(t,s,o)&&(s=o=a),t=mo(t),s===a?(s=t,t=0):s=mo(s),function(e,t,s,a){for(var o=-1,c=vr(mt((t-e)/(s||1)),0),u=n(c);c--;)u[a?c:++o]=e,e+=s;return u}(t,s,o=o===a?t<s?1:-1:mo(o),e)}}function $n(e){return function(t,s){return"string"==typeof t&&"string"==typeof s||(t=go(t),s=go(s)),e(t,s)}}function Xn(e,t,s,n,o,c,u,l,_,p){var f=8&t;t|=f?d:h,4&(t&=~(f?h:d))||(t&=-4);var m=[e,t,o,f?c:a,f?u:a,f?a:c,f?a:u,l,_,p],y=s.apply(a,m);return Si(e)&&Oi(y,m),y.placeholder=n,xi(y,e,t)}function Yn(e){var t=De[e];return function(e,s){if(e=go(e),(s=null==s?0:Er(yo(s),292))&&Tt(e)){var n=(Eo(e)+"e").split("e");return+((n=(Eo(t(n[0]+"e"+(+n[1]+s)))+"e").split("e"))[0]+"e"+(+n[1]-s))}return t(e)}}var Jn=Ar&&1/_r(new Ar([,-0]))[1]==f?function(e){return new Ar(e)}:dc;function Qn(e){return function(t){var s=yi(t);return s==k?lr(t):s==O?pr(t):function(e,t){return Ft(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function ei(e,t,s,c,f,m,y,w){var g=2&t;if(!g&&"function"!=typeof e)throw new Oe(o);var v=c?c.length:0;if(v||(t&=-97,c=f=a),y=y===a?y:vr(yo(y),0),w=w===a?w:yo(w),v-=f?f.length:0,t&h){var E=c,T=f;c=f=a}var b=g?a:ci(e),S=[e,t,s,c,f,E,T,m,y,w];if(b&&function(e,t){var s=e[1],n=t[1],a=s|n,o=a<131,c=n==_&&8==s||n==_&&s==p&&e[7].length<=t[8]||384==n&&t[7].length<=t[8]&&8==s;if(!o&&!c)return e;1&n&&(e[2]=t[2],a|=1&s?0:4);var l=t[3];if(l){var d=e[3];e[3]=d?Nn(d,l,t[4]):l,e[4]=d?hr(e[3],u):t[4]}(l=t[5])&&(d=e[5],e[5]=d?Pn(d,l,t[6]):l,e[6]=d?hr(e[5],u):t[6]);(l=t[7])&&(e[7]=l);n&_&&(e[8]=null==e[8]?t[8]:Er(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=a}(S,b),e=S[0],t=S[1],s=S[2],c=S[3],f=S[4],!(w=S[9]=S[9]===a?g?0:e.length:vr(S[9]-v,0))&&24&t&&(t&=-25),t&&1!=t)C=8==t||t==l?function(e,t,s){var o=Bn(e);return function c(){for(var u=arguments.length,l=n(u),d=u,h=li(c);d--;)l[d]=arguments[d];var _=u<3&&l[0]!==h&&l[u-1]!==h?[]:hr(l,h);return(u-=_.length)<s?Xn(e,t,Kn,c.placeholder,a,l,_,a,a,s-u):At(this&&this!==yt&&this instanceof c?o:e,this,l)}}(e,t,w):t!=d&&33!=t||f.length?Kn.apply(a,S):function(e,t,s,a){var o=1&t,c=Bn(e);return function t(){for(var u=-1,l=arguments.length,d=-1,h=a.length,_=n(h+l),p=this&&this!==yt&&this instanceof t?c:e;++d<h;)_[d]=a[d];for(;l--;)_[d++]=arguments[++u];return At(p,o?s:this,_)}}(e,t,s,c);else var C=function(e,t,s){var n=1&t,a=Bn(e);return function t(){return(this&&this!==yt&&this instanceof t?a:e).apply(n?s:this,arguments)}}(e,t,s);return xi((b?rn:Oi)(C,S),e,t)}function ti(e,t,s,n){return e===a||qa(e,xe[s])&&!Ue.call(n,s)?t:e}function ri(e,t,s,n,o,c){return ro(e)&&ro(t)&&(c.set(t,e),Zs(e,t,a,ri,c),c.delete(t)),e}function si(e){return ao(e)?a:e}function ni(e,t,s,n,o,c){var u=1&s,l=e.length,d=t.length;if(l!=d&&!(u&&d>l))return!1;var h=c.get(e),_=c.get(t);if(h&&_)return h==t&&_==e;var p=-1,f=!0,m=2&s?new Xr:a;for(c.set(e,t),c.set(t,e);++p<l;){var y=e[p],w=t[p];if(n)var g=u?n(w,y,p,t,e,c):n(y,w,p,e,t,c);if(g!==a){if(g)continue;f=!1;break}if(m){if(!jt(t,(function(e,t){if(!sr(m,t)&&(y===e||o(y,e,s,n,c)))return m.push(t)}))){f=!1;break}}else if(y!==w&&!o(y,w,s,n,c)){f=!1;break}}return c.delete(e),c.delete(t),f}function ii(e){return Mi(Ai(e,a,Vi),e+"")}function ai(e){return Rs(e,Mo,fi)}function oi(e){return Rs(e,xo,mi)}var ci=Or?function(e){return Or.get(e)}:dc;function ui(e){for(var t=e.name+"",s=Ir[t],n=Ue.call(Ir,t)?s.length:0;n--;){var a=s[n],o=a.func;if(null==o||o==e)return a.name}return t}function li(e){return(Ue.call(qr,"placeholder")?qr:e).placeholder}function di(){var e=qr.iteratee||oc;return e=e===oc?Fs:e,arguments.length?e(arguments[0],arguments[1]):e}function hi(e,t){var s,n,a=e.__data__;return("string"==(n=typeof(s=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==s:null===s)?a["string"==typeof t?"string":"hash"]:a.map}function _i(e){for(var t=Mo(e),s=t.length;s--;){var n=t[s],a=e[n];t[s]=[n,a,ki(a)]}return t}function pi(e,t){var s=function(e,t){return null==e?a:e[t]}(e,t);return Ls(s)?s:a}var fi=gt?function(e){return null==e?[]:(e=Ae(e),Mt(gt(e),(function(t){return Ye.call(e,t)})))}:wc,mi=gt?function(e){for(var t=[];e;)Ut(t,fi(e)),e=$e(e);return t}:wc,yi=ks;function wi(e,t,s){for(var n=-1,a=(t=Tn(t,e)).length,o=!1;++n<a;){var c=Hi(t[n]);if(!(o=null!=e&&s(e,c)))break;e=e[c]}return o||++n!=a?o:!!(a=null==e?0:e.length)&&to(a)&&Ei(c,a)&&(za(e)||Wa(e))}function gi(e){return"function"!=typeof e.constructor||Ri(e)?{}:Kr($e(e))}function vi(e){return za(e)||Wa(e)||!!(Qe&&e&&e[Qe])}function Ei(e,t){var s=typeof e;return!!(t=null==t?m:t)&&("number"==s||"symbol"!=s&&Te.test(e))&&e>-1&&e%1==0&&e<t}function Ti(e,t,s){if(!ro(s))return!1;var n=typeof t;return!!("number"==n?Ga(s)&&Ei(t,s.length):"string"==n&&t in s)&&qa(s[t],e)}function bi(e,t){if(za(e))return!1;var s=typeof e;return!("number"!=s&&"symbol"!=s&&"boolean"!=s&&null!=e&&!lo(e))||(ne.test(e)||!se.test(e)||null!=t&&e in Ae(t))}function Si(e){var t=ui(e),s=qr[t];if("function"!=typeof s||!(t in zr.prototype))return!1;if(e===s)return!0;var n=ci(s);return!!n&&e===n[0]}(Rr&&yi(new Rr(new ArrayBuffer(1)))!=F||kr&&yi(new kr)!=k||Dr&&yi(Dr.resolve())!=N||Ar&&yi(new Ar)!=O||Nr&&yi(new Nr)!=x)&&(yi=function(e){var t=ks(e),s=t==A?e.constructor:a,n=s?Bi(s):"";if(n)switch(n){case Mr:return F;case xr:return k;case Lr:return N;case Fr:return O;case Ur:return x}return t});var Ci=Le?Qa:gc;function Ri(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||xe)}function ki(e){return e==e&&!ro(e)}function Di(e,t){return function(s){return null!=s&&(s[e]===t&&(t!==a||e in Ae(s)))}}function Ai(e,t,s){return t=vr(t===a?e.length-1:t,0),function(){for(var a=arguments,o=-1,c=vr(a.length-t,0),u=n(c);++o<c;)u[o]=a[t+o];o=-1;for(var l=n(t+1);++o<t;)l[o]=a[o];return l[t]=s(u),At(e,this,l)}}function Ni(e,t){return t.length<2?e:Cs(e,an(t,0,-1))}function Pi(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Oi=Li(rn),Ii=ft||function(e,t){return yt.setTimeout(e,t)},Mi=Li(sn);function xi(e,t,s){var n=t+"";return Mi(e,function(e,t){var s=t.length;if(!s)return e;var n=s-1;return t[n]=(s>1?"& ":"")+t[n],t=t.join(s>2?", ":" "),e.replace(le,"{\n/* [wrapped with "+t+"] */\n")}(n,function(e,t){return Pt(g,(function(s){var n="_."+s[0];t&s[1]&&!xt(e,n)&&e.push(n)})),e.sort()}(function(e){var t=e.match(de);return t?t[1].split(he):[]}(n),s)))}function Li(e){var t=0,s=0;return function(){var n=Tr(),o=16-(n-s);if(s=n,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(a,arguments)}}function Fi(e,t){var s=-1,n=e.length,o=n-1;for(t=t===a?n:t;++s<t;){var c=Xs(s,o),u=e[c];e[c]=e[s],e[s]=u}return e.length=t,e}var Ui=function(e){var t=La(e,(function(e){return 500===s.size&&s.clear(),e})),s=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ie,(function(e,s,n,a){t.push(n?a.replace(fe,"$1"):s||e)})),t}));function Hi(e){if("string"==typeof e||lo(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Bi(e){if(null!=e){try{return Fe.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ji(e){if(e instanceof zr)return e.clone();var t=new Wr(e.__wrapped__,e.__chain__);return t.__actions__=On(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var qi=Js((function(e,t){return $a(e)?_s(e,gs(t,1,$a,!0)):[]})),Ki=Js((function(e,t){var s=Ji(t);return $a(s)&&(s=a),$a(e)?_s(e,gs(t,1,$a,!0),di(s,2)):[]})),Zi=Js((function(e,t){var s=Ji(t);return $a(s)&&(s=a),$a(e)?_s(e,gs(t,1,$a,!0),a,s):[]}));function Wi(e,t,s){var n=null==e?0:e.length;if(!n)return-1;var a=null==s?0:yo(s);return a<0&&(a=vr(n+a,0)),Zt(e,di(t,3),a)}function zi(e,t,s){var n=null==e?0:e.length;if(!n)return-1;var o=n-1;return s!==a&&(o=yo(s),o=s<0?vr(n+o,0):Er(o,n-1)),Zt(e,di(t,3),o,!0)}function Vi(e){return(null==e?0:e.length)?gs(e,1):[]}function Gi(e){return e&&e.length?e[0]:a}var $i=Js((function(e){var t=Ft(e,vn);return t.length&&t[0]===e[0]?Ps(t):[]})),Xi=Js((function(e){var t=Ji(e),s=Ft(e,vn);return t===Ji(s)?t=a:s.pop(),s.length&&s[0]===e[0]?Ps(s,di(t,2)):[]})),Yi=Js((function(e){var t=Ji(e),s=Ft(e,vn);return(t="function"==typeof t?t:a)&&s.pop(),s.length&&s[0]===e[0]?Ps(s,a,t):[]}));function Ji(e){var t=null==e?0:e.length;return t?e[t-1]:a}var Qi=Js(ea);function ea(e,t){return e&&e.length&&t&&t.length?Gs(e,t):e}var ta=ii((function(e,t){var s=null==e?0:e.length,n=cs(e,t);return $s(e,Ft(t,(function(e){return Ei(e,s)?+e:e})).sort(An)),n}));function ra(e){return null==e?e:Cr.call(e)}var sa=Js((function(e){return _n(gs(e,1,$a,!0))})),na=Js((function(e){var t=Ji(e);return $a(t)&&(t=a),_n(gs(e,1,$a,!0),di(t,2))})),ia=Js((function(e){var t=Ji(e);return t="function"==typeof t?t:a,_n(gs(e,1,$a,!0),a,t)}));function aa(e){if(!e||!e.length)return[];var t=0;return e=Mt(e,(function(e){if($a(e))return t=vr(e.length,t),!0})),Qt(t,(function(t){return Ft(e,$t(t))}))}function oa(e,t){if(!e||!e.length)return[];var s=aa(e);return null==t?s:Ft(s,(function(e){return At(t,a,e)}))}var ca=Js((function(e,t){return $a(e)?_s(e,t):[]})),ua=Js((function(e){return wn(Mt(e,$a))})),la=Js((function(e){var t=Ji(e);return $a(t)&&(t=a),wn(Mt(e,$a),di(t,2))})),da=Js((function(e){var t=Ji(e);return t="function"==typeof t?t:a,wn(Mt(e,$a),a,t)})),ha=Js(aa);var _a=Js((function(e){var t=e.length,s=t>1?e[t-1]:a;return s="function"==typeof s?(e.pop(),s):a,oa(e,s)}));function pa(e){var t=qr(e);return t.__chain__=!0,t}function fa(e,t){return t(e)}var ma=ii((function(e){var t=e.length,s=t?e[0]:0,n=this.__wrapped__,o=function(t){return cs(t,e)};return!(t>1||this.__actions__.length)&&n instanceof zr&&Ei(s)?((n=n.slice(s,+s+(t?1:0))).__actions__.push({func:fa,args:[o],thisArg:a}),new Wr(n,this.__chain__).thru((function(e){return t&&!e.length&&e.push(a),e}))):this.thru(o)}));var ya=Mn((function(e,t,s){Ue.call(e,s)?++e[s]:os(e,s,1)}));var wa=jn(Wi),ga=jn(zi);function va(e,t){return(za(e)?Pt:ps)(e,di(t,3))}function Ea(e,t){return(za(e)?Ot:fs)(e,di(t,3))}var Ta=Mn((function(e,t,s){Ue.call(e,s)?e[s].push(t):os(e,s,[t])}));var ba=Js((function(e,t,s){var a=-1,o="function"==typeof t,c=Ga(e)?n(e.length):[];return ps(e,(function(e){c[++a]=o?At(t,e,s):Os(e,t,s)})),c})),Sa=Mn((function(e,t,s){os(e,s,t)}));function Ca(e,t){return(za(e)?Ft:js)(e,di(t,3))}var Ra=Mn((function(e,t,s){e[s?0:1].push(t)}),(function(){return[[],[]]}));var ka=Js((function(e,t){if(null==e)return[];var s=t.length;return s>1&&Ti(e,t[0],t[1])?t=[]:s>2&&Ti(t[0],t[1],t[2])&&(t=[t[0]]),zs(e,gs(t,1),[])})),Da=ht||function(){return yt.Date.now()};function Aa(e,t,s){return t=s?a:t,t=e&&null==t?e.length:t,ei(e,_,a,a,a,a,t)}function Na(e,t){var s;if("function"!=typeof t)throw new Oe(o);return e=yo(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=a),s}}var Pa=Js((function(e,t,s){var n=1;if(s.length){var a=hr(s,li(Pa));n|=d}return ei(e,n,t,s,a)})),Oa=Js((function(e,t,s){var n=3;if(s.length){var a=hr(s,li(Oa));n|=d}return ei(t,n,e,s,a)}));function Ia(e,t,s){var n,c,u,l,d,h,_=0,p=!1,f=!1,m=!0;if("function"!=typeof e)throw new Oe(o);function y(t){var s=n,o=c;return n=c=a,_=t,l=e.apply(o,s)}function w(e){var s=e-h;return h===a||s>=t||s<0||f&&e-_>=u}function g(){var e=Da();if(w(e))return v(e);d=Ii(g,function(e){var s=t-(e-h);return f?Er(s,u-(e-_)):s}(e))}function v(e){return d=a,m&&n?y(e):(n=c=a,l)}function E(){var e=Da(),s=w(e);if(n=arguments,c=this,h=e,s){if(d===a)return function(e){return _=e,d=Ii(g,t),p?y(e):l}(h);if(f)return Cn(d),d=Ii(g,t),y(h)}return d===a&&(d=Ii(g,t)),l}return t=go(t)||0,ro(s)&&(p=!!s.leading,u=(f="maxWait"in s)?vr(go(s.maxWait)||0,t):u,m="trailing"in s?!!s.trailing:m),E.cancel=function(){d!==a&&Cn(d),_=0,n=h=c=d=a},E.flush=function(){return d===a?l:v(Da())},E}var Ma=Js((function(e,t){return hs(e,1,t)})),xa=Js((function(e,t,s){return hs(e,go(t)||0,s)}));function La(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Oe(o);var s=function(){var n=arguments,a=t?t.apply(this,n):n[0],o=s.cache;if(o.has(a))return o.get(a);var c=e.apply(this,n);return s.cache=o.set(a,c)||o,c};return s.cache=new(La.Cache||$r),s}function Fa(e){if("function"!=typeof e)throw new Oe(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}La.Cache=$r;var Ua=bn((function(e,t){var s=(t=1==t.length&&za(t[0])?Ft(t[0],tr(di())):Ft(gs(t,1),tr(di()))).length;return Js((function(n){for(var a=-1,o=Er(n.length,s);++a<o;)n[a]=t[a].call(this,n[a]);return At(e,this,n)}))})),Ha=Js((function(e,t){var s=hr(t,li(Ha));return ei(e,d,a,t,s)})),Ba=Js((function(e,t){var s=hr(t,li(Ba));return ei(e,h,a,t,s)})),ja=ii((function(e,t){return ei(e,p,a,a,a,t)}));function qa(e,t){return e===t||e!=e&&t!=t}var Ka=$n(Ds),Za=$n((function(e,t){return e>=t})),Wa=Is(function(){return arguments}())?Is:function(e){return so(e)&&Ue.call(e,"callee")&&!Ye.call(e,"callee")},za=n.isArray,Va=bt?tr(bt):function(e){return so(e)&&ks(e)==L};function Ga(e){return null!=e&&to(e.length)&&!Qa(e)}function $a(e){return so(e)&&Ga(e)}var Xa=Et||gc,Ya=St?tr(St):function(e){return so(e)&&ks(e)==b};function Ja(e){if(!so(e))return!1;var t=ks(e);return t==S||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ao(e)}function Qa(e){if(!ro(e))return!1;var t=ks(e);return t==C||t==R||"[object AsyncFunction]"==t||"[object Proxy]"==t}function eo(e){return"number"==typeof e&&e==yo(e)}function to(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=m}function ro(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function so(e){return null!=e&&"object"==typeof e}var no=Ct?tr(Ct):function(e){return so(e)&&yi(e)==k};function io(e){return"number"==typeof e||so(e)&&ks(e)==D}function ao(e){if(!so(e)||ks(e)!=A)return!1;var t=$e(e);if(null===t)return!0;var s=Ue.call(t,"constructor")&&t.constructor;return"function"==typeof s&&s instanceof s&&Fe.call(s)==qe}var oo=Rt?tr(Rt):function(e){return so(e)&&ks(e)==P};var co=kt?tr(kt):function(e){return so(e)&&yi(e)==O};function uo(e){return"string"==typeof e||!za(e)&&so(e)&&ks(e)==I}function lo(e){return"symbol"==typeof e||so(e)&&ks(e)==M}var ho=Dt?tr(Dt):function(e){return so(e)&&to(e.length)&&!!lt[ks(e)]};var _o=$n(Bs),po=$n((function(e,t){return e<=t}));function fo(e){if(!e)return[];if(Ga(e))return uo(e)?mr(e):On(e);if(et&&e[et])return function(e){for(var t,s=[];!(t=e.next()).done;)s.push(t.value);return s}(e[et]());var t=yi(e);return(t==k?lr:t==O?_r:Ko)(e)}function mo(e){return e?(e=go(e))===f||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function yo(e){var t=mo(e),s=t%1;return t==t?s?t-s:t:0}function wo(e){return e?us(yo(e),0,w):0}function go(e){if("number"==typeof e)return e;if(lo(e))return y;if(ro(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ro(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=er(e);var s=ge.test(e);return s||Ee.test(e)?pt(e.slice(2),s?2:8):we.test(e)?y:+e}function vo(e){return In(e,xo(e))}function Eo(e){return null==e?"":hn(e)}var To=xn((function(e,t){if(Ri(t)||Ga(t))In(t,Mo(t),e);else for(var s in t)Ue.call(t,s)&&ss(e,s,t[s])})),bo=xn((function(e,t){In(t,xo(t),e)})),So=xn((function(e,t,s,n){In(t,xo(t),e,n)})),Co=xn((function(e,t,s,n){In(t,Mo(t),e,n)})),Ro=ii(cs);var ko=Js((function(e,t){e=Ae(e);var s=-1,n=t.length,o=n>2?t[2]:a;for(o&&Ti(t[0],t[1],o)&&(n=1);++s<n;)for(var c=t[s],u=xo(c),l=-1,d=u.length;++l<d;){var h=u[l],_=e[h];(_===a||qa(_,xe[h])&&!Ue.call(e,h))&&(e[h]=c[h])}return e})),Do=Js((function(e){return e.push(a,ri),At(Fo,a,e)}));function Ao(e,t,s){var n=null==e?a:Cs(e,t);return n===a?s:n}function No(e,t){return null!=e&&wi(e,t,Ns)}var Po=Zn((function(e,t,s){null!=t&&"function"!=typeof t.toString&&(t=je.call(t)),e[t]=s}),sc(ac)),Oo=Zn((function(e,t,s){null!=t&&"function"!=typeof t.toString&&(t=je.call(t)),Ue.call(e,t)?e[t].push(s):e[t]=[s]}),di),Io=Js(Os);function Mo(e){return Ga(e)?Jr(e):Us(e)}function xo(e){return Ga(e)?Jr(e,!0):Hs(e)}var Lo=xn((function(e,t,s){Zs(e,t,s)})),Fo=xn((function(e,t,s,n){Zs(e,t,s,n)})),Uo=ii((function(e,t){var s={};if(null==e)return s;var n=!1;t=Ft(t,(function(t){return t=Tn(t,e),n||(n=t.length>1),t})),In(e,oi(e),s),n&&(s=ls(s,7,si));for(var a=t.length;a--;)pn(s,t[a]);return s}));var Ho=ii((function(e,t){return null==e?{}:function(e,t){return Vs(e,t,(function(t,s){return No(e,s)}))}(e,t)}));function Bo(e,t){if(null==e)return{};var s=Ft(oi(e),(function(e){return[e]}));return t=di(t),Vs(e,s,(function(e,s){return t(e,s[0])}))}var jo=Qn(Mo),qo=Qn(xo);function Ko(e){return null==e?[]:rr(e,Mo(e))}var Zo=Hn((function(e,t,s){return t=t.toLowerCase(),e+(s?Wo(t):t)}));function Wo(e){return Qo(Eo(e).toLowerCase())}function zo(e){return(e=Eo(e))&&e.replace(be,ar).replace(st,"")}var Vo=Hn((function(e,t,s){return e+(s?"-":"")+t.toLowerCase()})),Go=Hn((function(e,t,s){return e+(s?" ":"")+t.toLowerCase()})),$o=Un("toLowerCase");var Xo=Hn((function(e,t,s){return e+(s?"_":"")+t.toLowerCase()}));var Yo=Hn((function(e,t,s){return e+(s?" ":"")+Qo(t)}));var Jo=Hn((function(e,t,s){return e+(s?" ":"")+t.toUpperCase()})),Qo=Un("toUpperCase");function ec(e,t,s){return e=Eo(e),(t=s?a:t)===a?function(e){return ot.test(e)}(e)?function(e){return e.match(it)||[]}(e):function(e){return e.match(_e)||[]}(e):e.match(t)||[]}var tc=Js((function(e,t){try{return At(e,a,t)}catch(e){return Ja(e)?e:new Re(e)}})),rc=ii((function(e,t){return Pt(t,(function(t){t=Hi(t),os(e,t,Pa(e[t],e))})),e}));function sc(e){return function(){return e}}var nc=qn(),ic=qn(!0);function ac(e){return e}function oc(e){return Fs("function"==typeof e?e:ls(e,1))}var cc=Js((function(e,t){return function(s){return Os(s,e,t)}})),uc=Js((function(e,t){return function(s){return Os(e,s,t)}}));function lc(e,t,s){var n=Mo(t),a=Ss(t,n);null!=s||ro(t)&&(a.length||!n.length)||(s=t,t=e,e=this,a=Ss(t,Mo(t)));var o=!(ro(s)&&"chain"in s&&!s.chain),c=Qa(e);return Pt(a,(function(s){var n=t[s];e[s]=n,c&&(e.prototype[s]=function(){var t=this.__chain__;if(o||t){var s=e(this.__wrapped__);return(s.__actions__=On(this.__actions__)).push({func:n,args:arguments,thisArg:e}),s.__chain__=t,s}return n.apply(e,Ut([this.value()],arguments))})})),e}function dc(){}var hc=zn(Ft),_c=zn(It),pc=zn(jt);function fc(e){return bi(e)?$t(Hi(e)):function(e){return function(t){return Cs(t,e)}}(e)}var mc=Gn(),yc=Gn(!0);function wc(){return[]}function gc(){return!1}var vc=Wn((function(e,t){return e+t}),0),Ec=Yn("ceil"),Tc=Wn((function(e,t){return e/t}),1),bc=Yn("floor");var Sc,Cc=Wn((function(e,t){return e*t}),1),Rc=Yn("round"),kc=Wn((function(e,t){return e-t}),0);return qr.after=function(e,t){if("function"!=typeof t)throw new Oe(o);return e=yo(e),function(){if(--e<1)return t.apply(this,arguments)}},qr.ary=Aa,qr.assign=To,qr.assignIn=bo,qr.assignInWith=So,qr.assignWith=Co,qr.at=Ro,qr.before=Na,qr.bind=Pa,qr.bindAll=rc,qr.bindKey=Oa,qr.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return za(e)?e:[e]},qr.chain=pa,qr.chunk=function(e,t,s){t=(s?Ti(e,t,s):t===a)?1:vr(yo(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var c=0,u=0,l=n(mt(o/t));c<o;)l[u++]=an(e,c,c+=t);return l},qr.compact=function(e){for(var t=-1,s=null==e?0:e.length,n=0,a=[];++t<s;){var o=e[t];o&&(a[n++]=o)}return a},qr.concat=function(){var e=arguments.length;if(!e)return[];for(var t=n(e-1),s=arguments[0],a=e;a--;)t[a-1]=arguments[a];return Ut(za(s)?On(s):[s],gs(t,1))},qr.cond=function(e){var t=null==e?0:e.length,s=di();return e=t?Ft(e,(function(e){if("function"!=typeof e[1])throw new Oe(o);return[s(e[0]),e[1]]})):[],Js((function(s){for(var n=-1;++n<t;){var a=e[n];if(At(a[0],this,s))return At(a[1],this,s)}}))},qr.conforms=function(e){return function(e){var t=Mo(e);return function(s){return ds(s,e,t)}}(ls(e,1))},qr.constant=sc,qr.countBy=ya,qr.create=function(e,t){var s=Kr(e);return null==t?s:as(s,t)},qr.curry=function e(t,s,n){var o=ei(t,8,a,a,a,a,a,s=n?a:s);return o.placeholder=e.placeholder,o},qr.curryRight=function e(t,s,n){var o=ei(t,l,a,a,a,a,a,s=n?a:s);return o.placeholder=e.placeholder,o},qr.debounce=Ia,qr.defaults=ko,qr.defaultsDeep=Do,qr.defer=Ma,qr.delay=xa,qr.difference=qi,qr.differenceBy=Ki,qr.differenceWith=Zi,qr.drop=function(e,t,s){var n=null==e?0:e.length;return n?an(e,(t=s||t===a?1:yo(t))<0?0:t,n):[]},qr.dropRight=function(e,t,s){var n=null==e?0:e.length;return n?an(e,0,(t=n-(t=s||t===a?1:yo(t)))<0?0:t):[]},qr.dropRightWhile=function(e,t){return e&&e.length?mn(e,di(t,3),!0,!0):[]},qr.dropWhile=function(e,t){return e&&e.length?mn(e,di(t,3),!0):[]},qr.fill=function(e,t,s,n){var o=null==e?0:e.length;return o?(s&&"number"!=typeof s&&Ti(e,t,s)&&(s=0,n=o),function(e,t,s,n){var o=e.length;for((s=yo(s))<0&&(s=-s>o?0:o+s),(n=n===a||n>o?o:yo(n))<0&&(n+=o),n=s>n?0:wo(n);s<n;)e[s++]=t;return e}(e,t,s,n)):[]},qr.filter=function(e,t){return(za(e)?Mt:ws)(e,di(t,3))},qr.flatMap=function(e,t){return gs(Ca(e,t),1)},qr.flatMapDeep=function(e,t){return gs(Ca(e,t),f)},qr.flatMapDepth=function(e,t,s){return s=s===a?1:yo(s),gs(Ca(e,t),s)},qr.flatten=Vi,qr.flattenDeep=function(e){return(null==e?0:e.length)?gs(e,f):[]},qr.flattenDepth=function(e,t){return(null==e?0:e.length)?gs(e,t=t===a?1:yo(t)):[]},qr.flip=function(e){return ei(e,512)},qr.flow=nc,qr.flowRight=ic,qr.fromPairs=function(e){for(var t=-1,s=null==e?0:e.length,n={};++t<s;){var a=e[t];n[a[0]]=a[1]}return n},qr.functions=function(e){return null==e?[]:Ss(e,Mo(e))},qr.functionsIn=function(e){return null==e?[]:Ss(e,xo(e))},qr.groupBy=Ta,qr.initial=function(e){return(null==e?0:e.length)?an(e,0,-1):[]},qr.intersection=$i,qr.intersectionBy=Xi,qr.intersectionWith=Yi,qr.invert=Po,qr.invertBy=Oo,qr.invokeMap=ba,qr.iteratee=oc,qr.keyBy=Sa,qr.keys=Mo,qr.keysIn=xo,qr.map=Ca,qr.mapKeys=function(e,t){var s={};return t=di(t,3),Ts(e,(function(e,n,a){os(s,t(e,n,a),e)})),s},qr.mapValues=function(e,t){var s={};return t=di(t,3),Ts(e,(function(e,n,a){os(s,n,t(e,n,a))})),s},qr.matches=function(e){return qs(ls(e,1))},qr.matchesProperty=function(e,t){return Ks(e,ls(t,1))},qr.memoize=La,qr.merge=Lo,qr.mergeWith=Fo,qr.method=cc,qr.methodOf=uc,qr.mixin=lc,qr.negate=Fa,qr.nthArg=function(e){return e=yo(e),Js((function(t){return Ws(t,e)}))},qr.omit=Uo,qr.omitBy=function(e,t){return Bo(e,Fa(di(t)))},qr.once=function(e){return Na(2,e)},qr.orderBy=function(e,t,s,n){return null==e?[]:(za(t)||(t=null==t?[]:[t]),za(s=n?a:s)||(s=null==s?[]:[s]),zs(e,t,s))},qr.over=hc,qr.overArgs=Ua,qr.overEvery=_c,qr.overSome=pc,qr.partial=Ha,qr.partialRight=Ba,qr.partition=Ra,qr.pick=Ho,qr.pickBy=Bo,qr.property=fc,qr.propertyOf=function(e){return function(t){return null==e?a:Cs(e,t)}},qr.pull=Qi,qr.pullAll=ea,qr.pullAllBy=function(e,t,s){return e&&e.length&&t&&t.length?Gs(e,t,di(s,2)):e},qr.pullAllWith=function(e,t,s){return e&&e.length&&t&&t.length?Gs(e,t,a,s):e},qr.pullAt=ta,qr.range=mc,qr.rangeRight=yc,qr.rearg=ja,qr.reject=function(e,t){return(za(e)?Mt:ws)(e,Fa(di(t,3)))},qr.remove=function(e,t){var s=[];if(!e||!e.length)return s;var n=-1,a=[],o=e.length;for(t=di(t,3);++n<o;){var c=e[n];t(c,n,e)&&(s.push(c),a.push(n))}return $s(e,a),s},qr.rest=function(e,t){if("function"!=typeof e)throw new Oe(o);return Js(e,t=t===a?t:yo(t))},qr.reverse=ra,qr.sampleSize=function(e,t,s){return t=(s?Ti(e,t,s):t===a)?1:yo(t),(za(e)?es:en)(e,t)},qr.set=function(e,t,s){return null==e?e:tn(e,t,s)},qr.setWith=function(e,t,s,n){return n="function"==typeof n?n:a,null==e?e:tn(e,t,s,n)},qr.shuffle=function(e){return(za(e)?ts:nn)(e)},qr.slice=function(e,t,s){var n=null==e?0:e.length;return n?(s&&"number"!=typeof s&&Ti(e,t,s)?(t=0,s=n):(t=null==t?0:yo(t),s=s===a?n:yo(s)),an(e,t,s)):[]},qr.sortBy=ka,qr.sortedUniq=function(e){return e&&e.length?ln(e):[]},qr.sortedUniqBy=function(e,t){return e&&e.length?ln(e,di(t,2)):[]},qr.split=function(e,t,s){return s&&"number"!=typeof s&&Ti(e,t,s)&&(t=s=a),(s=s===a?w:s>>>0)?(e=Eo(e))&&("string"==typeof t||null!=t&&!oo(t))&&!(t=hn(t))&&ur(e)?Sn(mr(e),0,s):e.split(t,s):[]},qr.spread=function(e,t){if("function"!=typeof e)throw new Oe(o);return t=null==t?0:vr(yo(t),0),Js((function(s){var n=s[t],a=Sn(s,0,t);return n&&Ut(a,n),At(e,this,a)}))},qr.tail=function(e){var t=null==e?0:e.length;return t?an(e,1,t):[]},qr.take=function(e,t,s){return e&&e.length?an(e,0,(t=s||t===a?1:yo(t))<0?0:t):[]},qr.takeRight=function(e,t,s){var n=null==e?0:e.length;return n?an(e,(t=n-(t=s||t===a?1:yo(t)))<0?0:t,n):[]},qr.takeRightWhile=function(e,t){return e&&e.length?mn(e,di(t,3),!1,!0):[]},qr.takeWhile=function(e,t){return e&&e.length?mn(e,di(t,3)):[]},qr.tap=function(e,t){return t(e),e},qr.throttle=function(e,t,s){var n=!0,a=!0;if("function"!=typeof e)throw new Oe(o);return ro(s)&&(n="leading"in s?!!s.leading:n,a="trailing"in s?!!s.trailing:a),Ia(e,t,{leading:n,maxWait:t,trailing:a})},qr.thru=fa,qr.toArray=fo,qr.toPairs=jo,qr.toPairsIn=qo,qr.toPath=function(e){return za(e)?Ft(e,Hi):lo(e)?[e]:On(Ui(Eo(e)))},qr.toPlainObject=vo,qr.transform=function(e,t,s){var n=za(e),a=n||Xa(e)||ho(e);if(t=di(t,4),null==s){var o=e&&e.constructor;s=a?n?new o:[]:ro(e)&&Qa(o)?Kr($e(e)):{}}return(a?Pt:Ts)(e,(function(e,n,a){return t(s,e,n,a)})),s},qr.unary=function(e){return Aa(e,1)},qr.union=sa,qr.unionBy=na,qr.unionWith=ia,qr.uniq=function(e){return e&&e.length?_n(e):[]},qr.uniqBy=function(e,t){return e&&e.length?_n(e,di(t,2)):[]},qr.uniqWith=function(e,t){return t="function"==typeof t?t:a,e&&e.length?_n(e,a,t):[]},qr.unset=function(e,t){return null==e||pn(e,t)},qr.unzip=aa,qr.unzipWith=oa,qr.update=function(e,t,s){return null==e?e:fn(e,t,En(s))},qr.updateWith=function(e,t,s,n){return n="function"==typeof n?n:a,null==e?e:fn(e,t,En(s),n)},qr.values=Ko,qr.valuesIn=function(e){return null==e?[]:rr(e,xo(e))},qr.without=ca,qr.words=ec,qr.wrap=function(e,t){return Ha(En(t),e)},qr.xor=ua,qr.xorBy=la,qr.xorWith=da,qr.zip=ha,qr.zipObject=function(e,t){return gn(e||[],t||[],ss)},qr.zipObjectDeep=function(e,t){return gn(e||[],t||[],tn)},qr.zipWith=_a,qr.entries=jo,qr.entriesIn=qo,qr.extend=bo,qr.extendWith=So,lc(qr,qr),qr.add=vc,qr.attempt=tc,qr.camelCase=Zo,qr.capitalize=Wo,qr.ceil=Ec,qr.clamp=function(e,t,s){return s===a&&(s=t,t=a),s!==a&&(s=(s=go(s))==s?s:0),t!==a&&(t=(t=go(t))==t?t:0),us(go(e),t,s)},qr.clone=function(e){return ls(e,4)},qr.cloneDeep=function(e){return ls(e,5)},qr.cloneDeepWith=function(e,t){return ls(e,5,t="function"==typeof t?t:a)},qr.cloneWith=function(e,t){return ls(e,4,t="function"==typeof t?t:a)},qr.conformsTo=function(e,t){return null==t||ds(e,t,Mo(t))},qr.deburr=zo,qr.defaultTo=function(e,t){return null==e||e!=e?t:e},qr.divide=Tc,qr.endsWith=function(e,t,s){e=Eo(e),t=hn(t);var n=e.length,o=s=s===a?n:us(yo(s),0,n);return(s-=t.length)>=0&&e.slice(s,o)==t},qr.eq=qa,qr.escape=function(e){return(e=Eo(e))&&Q.test(e)?e.replace(Y,or):e},qr.escapeRegExp=function(e){return(e=Eo(e))&&oe.test(e)?e.replace(ae,"\\$&"):e},qr.every=function(e,t,s){var n=za(e)?It:ms;return s&&Ti(e,t,s)&&(t=a),n(e,di(t,3))},qr.find=wa,qr.findIndex=Wi,qr.findKey=function(e,t){return Kt(e,di(t,3),Ts)},qr.findLast=ga,qr.findLastIndex=zi,qr.findLastKey=function(e,t){return Kt(e,di(t,3),bs)},qr.floor=bc,qr.forEach=va,qr.forEachRight=Ea,qr.forIn=function(e,t){return null==e?e:vs(e,di(t,3),xo)},qr.forInRight=function(e,t){return null==e?e:Es(e,di(t,3),xo)},qr.forOwn=function(e,t){return e&&Ts(e,di(t,3))},qr.forOwnRight=function(e,t){return e&&bs(e,di(t,3))},qr.get=Ao,qr.gt=Ka,qr.gte=Za,qr.has=function(e,t){return null!=e&&wi(e,t,As)},qr.hasIn=No,qr.head=Gi,qr.identity=ac,qr.includes=function(e,t,s,n){e=Ga(e)?e:Ko(e),s=s&&!n?yo(s):0;var a=e.length;return s<0&&(s=vr(a+s,0)),uo(e)?s<=a&&e.indexOf(t,s)>-1:!!a&&Wt(e,t,s)>-1},qr.indexOf=function(e,t,s){var n=null==e?0:e.length;if(!n)return-1;var a=null==s?0:yo(s);return a<0&&(a=vr(n+a,0)),Wt(e,t,a)},qr.inRange=function(e,t,s){return t=mo(t),s===a?(s=t,t=0):s=mo(s),function(e,t,s){return e>=Er(t,s)&&e<vr(t,s)}(e=go(e),t,s)},qr.invoke=Io,qr.isArguments=Wa,qr.isArray=za,qr.isArrayBuffer=Va,qr.isArrayLike=Ga,qr.isArrayLikeObject=$a,qr.isBoolean=function(e){return!0===e||!1===e||so(e)&&ks(e)==T},qr.isBuffer=Xa,qr.isDate=Ya,qr.isElement=function(e){return so(e)&&1===e.nodeType&&!ao(e)},qr.isEmpty=function(e){if(null==e)return!0;if(Ga(e)&&(za(e)||"string"==typeof e||"function"==typeof e.splice||Xa(e)||ho(e)||Wa(e)))return!e.length;var t=yi(e);if(t==k||t==O)return!e.size;if(Ri(e))return!Us(e).length;for(var s in e)if(Ue.call(e,s))return!1;return!0},qr.isEqual=function(e,t){return Ms(e,t)},qr.isEqualWith=function(e,t,s){var n=(s="function"==typeof s?s:a)?s(e,t):a;return n===a?Ms(e,t,a,s):!!n},qr.isError=Ja,qr.isFinite=function(e){return"number"==typeof e&&Tt(e)},qr.isFunction=Qa,qr.isInteger=eo,qr.isLength=to,qr.isMap=no,qr.isMatch=function(e,t){return e===t||xs(e,t,_i(t))},qr.isMatchWith=function(e,t,s){return s="function"==typeof s?s:a,xs(e,t,_i(t),s)},qr.isNaN=function(e){return io(e)&&e!=+e},qr.isNative=function(e){if(Ci(e))throw new Re("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ls(e)},qr.isNil=function(e){return null==e},qr.isNull=function(e){return null===e},qr.isNumber=io,qr.isObject=ro,qr.isObjectLike=so,qr.isPlainObject=ao,qr.isRegExp=oo,qr.isSafeInteger=function(e){return eo(e)&&e>=-9007199254740991&&e<=m},qr.isSet=co,qr.isString=uo,qr.isSymbol=lo,qr.isTypedArray=ho,qr.isUndefined=function(e){return e===a},qr.isWeakMap=function(e){return so(e)&&yi(e)==x},qr.isWeakSet=function(e){return so(e)&&"[object WeakSet]"==ks(e)},qr.join=function(e,t){return null==e?"":qt.call(e,t)},qr.kebabCase=Vo,qr.last=Ji,qr.lastIndexOf=function(e,t,s){var n=null==e?0:e.length;if(!n)return-1;var o=n;return s!==a&&(o=(o=yo(s))<0?vr(n+o,0):Er(o,n-1)),t==t?function(e,t,s){for(var n=s+1;n--;)if(e[n]===t)return n;return n}(e,t,o):Zt(e,Vt,o,!0)},qr.lowerCase=Go,qr.lowerFirst=$o,qr.lt=_o,qr.lte=po,qr.max=function(e){return e&&e.length?ys(e,ac,Ds):a},qr.maxBy=function(e,t){return e&&e.length?ys(e,di(t,2),Ds):a},qr.mean=function(e){return Gt(e,ac)},qr.meanBy=function(e,t){return Gt(e,di(t,2))},qr.min=function(e){return e&&e.length?ys(e,ac,Bs):a},qr.minBy=function(e,t){return e&&e.length?ys(e,di(t,2),Bs):a},qr.stubArray=wc,qr.stubFalse=gc,qr.stubObject=function(){return{}},qr.stubString=function(){return""},qr.stubTrue=function(){return!0},qr.multiply=Cc,qr.nth=function(e,t){return e&&e.length?Ws(e,yo(t)):a},qr.noConflict=function(){return yt._===this&&(yt._=Ke),this},qr.noop=dc,qr.now=Da,qr.pad=function(e,t,s){e=Eo(e);var n=(t=yo(t))?fr(e):0;if(!t||n>=t)return e;var a=(t-n)/2;return Vn(wt(a),s)+e+Vn(mt(a),s)},qr.padEnd=function(e,t,s){e=Eo(e);var n=(t=yo(t))?fr(e):0;return t&&n<t?e+Vn(t-n,s):e},qr.padStart=function(e,t,s){e=Eo(e);var n=(t=yo(t))?fr(e):0;return t&&n<t?Vn(t-n,s)+e:e},qr.parseInt=function(e,t,s){return s||null==t?t=0:t&&(t=+t),br(Eo(e).replace(ce,""),t||0)},qr.random=function(e,t,s){if(s&&"boolean"!=typeof s&&Ti(e,t,s)&&(t=s=a),s===a&&("boolean"==typeof t?(s=t,t=a):"boolean"==typeof e&&(s=e,e=a)),e===a&&t===a?(e=0,t=1):(e=mo(e),t===a?(t=e,e=0):t=mo(t)),e>t){var n=e;e=t,t=n}if(s||e%1||t%1){var o=Sr();return Er(e+o*(t-e+_t("1e-"+((o+"").length-1))),t)}return Xs(e,t)},qr.reduce=function(e,t,s){var n=za(e)?Ht:Yt,a=arguments.length<3;return n(e,di(t,4),s,a,ps)},qr.reduceRight=function(e,t,s){var n=za(e)?Bt:Yt,a=arguments.length<3;return n(e,di(t,4),s,a,fs)},qr.repeat=function(e,t,s){return t=(s?Ti(e,t,s):t===a)?1:yo(t),Ys(Eo(e),t)},qr.replace=function(){var e=arguments,t=Eo(e[0]);return e.length<3?t:t.replace(e[1],e[2])},qr.result=function(e,t,s){var n=-1,o=(t=Tn(t,e)).length;for(o||(o=1,e=a);++n<o;){var c=null==e?a:e[Hi(t[n])];c===a&&(n=o,c=s),e=Qa(c)?c.call(e):c}return e},qr.round=Rc,qr.runInContext=e,qr.sample=function(e){return(za(e)?Qr:Qs)(e)},qr.size=function(e){if(null==e)return 0;if(Ga(e))return uo(e)?fr(e):e.length;var t=yi(e);return t==k||t==O?e.size:Us(e).length},qr.snakeCase=Xo,qr.some=function(e,t,s){var n=za(e)?jt:on;return s&&Ti(e,t,s)&&(t=a),n(e,di(t,3))},qr.sortedIndex=function(e,t){return cn(e,t)},qr.sortedIndexBy=function(e,t,s){return un(e,t,di(s,2))},qr.sortedIndexOf=function(e,t){var s=null==e?0:e.length;if(s){var n=cn(e,t);if(n<s&&qa(e[n],t))return n}return-1},qr.sortedLastIndex=function(e,t){return cn(e,t,!0)},qr.sortedLastIndexBy=function(e,t,s){return un(e,t,di(s,2),!0)},qr.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var s=cn(e,t,!0)-1;if(qa(e[s],t))return s}return-1},qr.startCase=Yo,qr.startsWith=function(e,t,s){return e=Eo(e),s=null==s?0:us(yo(s),0,e.length),t=hn(t),e.slice(s,s+t.length)==t},qr.subtract=kc,qr.sum=function(e){return e&&e.length?Jt(e,ac):0},qr.sumBy=function(e,t){return e&&e.length?Jt(e,di(t,2)):0},qr.template=function(e,t,s){var n=qr.templateSettings;s&&Ti(e,t,s)&&(t=a),e=Eo(e),t=So({},t,n,ti);var o,c,u=So({},t.imports,n.imports,ti),l=Mo(u),d=rr(u,l),h=0,_=t.interpolate||Se,p="__p += '",f=Ne((t.escape||Se).source+"|"+_.source+"|"+(_===re?me:Se).source+"|"+(t.evaluate||Se).source+"|$","g"),m="//# sourceURL="+(Ue.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ut+"]")+"\n";e.replace(f,(function(t,s,n,a,u,l){return n||(n=a),p+=e.slice(h,l).replace(Ce,cr),s&&(o=!0,p+="' +\n__e("+s+") +\n'"),u&&(c=!0,p+="';\n"+u+";\n__p += '"),n&&(p+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),h=l+t.length,t})),p+="';\n";var y=Ue.call(t,"variable")&&t.variable;if(y){if(pe.test(y))throw new Re("Invalid `variable` option passed into `_.template`")}else p="with (obj) {\n"+p+"\n}\n";p=(c?p.replace(V,""):p).replace(G,"$1").replace($,"$1;"),p="function("+(y||"obj")+") {\n"+(y?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(c?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var w=tc((function(){return ke(l,m+"return "+p).apply(a,d)}));if(w.source=p,Ja(w))throw w;return w},qr.times=function(e,t){if((e=yo(e))<1||e>m)return[];var s=w,n=Er(e,w);t=di(t),e-=w;for(var a=Qt(n,t);++s<e;)t(s);return a},qr.toFinite=mo,qr.toInteger=yo,qr.toLength=wo,qr.toLower=function(e){return Eo(e).toLowerCase()},qr.toNumber=go,qr.toSafeInteger=function(e){return e?us(yo(e),-9007199254740991,m):0===e?e:0},qr.toString=Eo,qr.toUpper=function(e){return Eo(e).toUpperCase()},qr.trim=function(e,t,s){if((e=Eo(e))&&(s||t===a))return er(e);if(!e||!(t=hn(t)))return e;var n=mr(e),o=mr(t);return Sn(n,nr(n,o),ir(n,o)+1).join("")},qr.trimEnd=function(e,t,s){if((e=Eo(e))&&(s||t===a))return e.slice(0,yr(e)+1);if(!e||!(t=hn(t)))return e;var n=mr(e);return Sn(n,0,ir(n,mr(t))+1).join("")},qr.trimStart=function(e,t,s){if((e=Eo(e))&&(s||t===a))return e.replace(ce,"");if(!e||!(t=hn(t)))return e;var n=mr(e);return Sn(n,nr(n,mr(t))).join("")},qr.truncate=function(e,t){var s=30,n="...";if(ro(t)){var o="separator"in t?t.separator:o;s="length"in t?yo(t.length):s,n="omission"in t?hn(t.omission):n}var c=(e=Eo(e)).length;if(ur(e)){var u=mr(e);c=u.length}if(s>=c)return e;var l=s-fr(n);if(l<1)return n;var d=u?Sn(u,0,l).join(""):e.slice(0,l);if(o===a)return d+n;if(u&&(l+=d.length-l),oo(o)){if(e.slice(l).search(o)){var h,_=d;for(o.global||(o=Ne(o.source,Eo(ye.exec(o))+"g")),o.lastIndex=0;h=o.exec(_);)var p=h.index;d=d.slice(0,p===a?l:p)}}else if(e.indexOf(hn(o),l)!=l){var f=d.lastIndexOf(o);f>-1&&(d=d.slice(0,f))}return d+n},qr.unescape=function(e){return(e=Eo(e))&&J.test(e)?e.replace(X,wr):e},qr.uniqueId=function(e){var t=++He;return Eo(e)+t},qr.upperCase=Jo,qr.upperFirst=Qo,qr.each=va,qr.eachRight=Ea,qr.first=Gi,lc(qr,(Sc={},Ts(qr,(function(e,t){Ue.call(qr.prototype,t)||(Sc[t]=e)})),Sc),{chain:!1}),qr.VERSION="4.17.21",Pt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){qr[e].placeholder=qr})),Pt(["drop","take"],(function(e,t){zr.prototype[e]=function(s){s=s===a?1:vr(yo(s),0);var n=this.__filtered__&&!t?new zr(this):this.clone();return n.__filtered__?n.__takeCount__=Er(s,n.__takeCount__):n.__views__.push({size:Er(s,w),type:e+(n.__dir__<0?"Right":"")}),n},zr.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Pt(["filter","map","takeWhile"],(function(e,t){var s=t+1,n=1==s||3==s;zr.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:di(e,3),type:s}),t.__filtered__=t.__filtered__||n,t}})),Pt(["head","last"],(function(e,t){var s="take"+(t?"Right":"");zr.prototype[e]=function(){return this[s](1).value()[0]}})),Pt(["initial","tail"],(function(e,t){var s="drop"+(t?"":"Right");zr.prototype[e]=function(){return this.__filtered__?new zr(this):this[s](1)}})),zr.prototype.compact=function(){return this.filter(ac)},zr.prototype.find=function(e){return this.filter(e).head()},zr.prototype.findLast=function(e){return this.reverse().find(e)},zr.prototype.invokeMap=Js((function(e,t){return"function"==typeof e?new zr(this):this.map((function(s){return Os(s,e,t)}))})),zr.prototype.reject=function(e){return this.filter(Fa(di(e)))},zr.prototype.slice=function(e,t){e=yo(e);var s=this;return s.__filtered__&&(e>0||t<0)?new zr(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),t!==a&&(s=(t=yo(t))<0?s.dropRight(-t):s.take(t-e)),s)},zr.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},zr.prototype.toArray=function(){return this.take(w)},Ts(zr.prototype,(function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),n=/^(?:head|last)$/.test(t),o=qr[n?"take"+("last"==t?"Right":""):t],c=n||/^find/.test(t);o&&(qr.prototype[t]=function(){var t=this.__wrapped__,u=n?[1]:arguments,l=t instanceof zr,d=u[0],h=l||za(t),_=function(e){var t=o.apply(qr,Ut([e],u));return n&&p?t[0]:t};h&&s&&"function"==typeof d&&1!=d.length&&(l=h=!1);var p=this.__chain__,f=!!this.__actions__.length,m=c&&!p,y=l&&!f;if(!c&&h){t=y?t:new zr(this);var w=e.apply(t,u);return w.__actions__.push({func:fa,args:[_],thisArg:a}),new Wr(w,p)}return m&&y?e.apply(this,u):(w=this.thru(_),m?n?w.value()[0]:w.value():w)})})),Pt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Ie[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",n=/^(?:pop|shift)$/.test(e);qr.prototype[e]=function(){var e=arguments;if(n&&!this.__chain__){var a=this.value();return t.apply(za(a)?a:[],e)}return this[s]((function(s){return t.apply(za(s)?s:[],e)}))}})),Ts(zr.prototype,(function(e,t){var s=qr[t];if(s){var n=s.name+"";Ue.call(Ir,n)||(Ir[n]=[]),Ir[n].push({name:t,func:s})}})),Ir[Kn(a,2).name]=[{name:"wrapper",func:a}],zr.prototype.clone=function(){var e=new zr(this.__wrapped__);return e.__actions__=On(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=On(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=On(this.__views__),e},zr.prototype.reverse=function(){if(this.__filtered__){var e=new zr(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},zr.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,s=za(e),n=t<0,a=s?e.length:0,o=function(e,t,s){var n=-1,a=s.length;for(;++n<a;){var o=s[n],c=o.size;switch(o.type){case"drop":e+=c;break;case"dropRight":t-=c;break;case"take":t=Er(t,e+c);break;case"takeRight":e=vr(e,t-c)}}return{start:e,end:t}}(0,a,this.__views__),c=o.start,u=o.end,l=u-c,d=n?u:c-1,h=this.__iteratees__,_=h.length,p=0,f=Er(l,this.__takeCount__);if(!s||!n&&a==l&&f==l)return yn(e,this.__actions__);var m=[];e:for(;l--&&p<f;){for(var y=-1,w=e[d+=t];++y<_;){var g=h[y],v=g.iteratee,E=g.type,T=v(w);if(2==E)w=T;else if(!T){if(1==E)continue e;break e}}m[p++]=w}return m},qr.prototype.at=ma,qr.prototype.chain=function(){return pa(this)},qr.prototype.commit=function(){return new Wr(this.value(),this.__chain__)},qr.prototype.next=function(){this.__values__===a&&(this.__values__=fo(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?a:this.__values__[this.__index__++]}},qr.prototype.plant=function(e){for(var t,s=this;s instanceof Zr;){var n=ji(s);n.__index__=0,n.__values__=a,t?o.__wrapped__=n:t=n;var o=n;s=s.__wrapped__}return o.__wrapped__=e,t},qr.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof zr){var t=e;return this.__actions__.length&&(t=new zr(this)),(t=t.reverse()).__actions__.push({func:fa,args:[ra],thisArg:a}),new Wr(t,this.__chain__)}return this.thru(ra)},qr.prototype.toJSON=qr.prototype.valueOf=qr.prototype.value=function(){return yn(this.__wrapped__,this.__actions__)},qr.prototype.first=qr.prototype.head,et&&(qr.prototype[et]=function(){return this}),qr}();yt._=gr,(n=function(){return gr}.call(t,s,t,e))===a||(e.exports=n)}.call(this)},3720:e=>{e.exports=s;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function s(e,t,s){this.low=0|e,this.high=0|t,this.unsigned=!!s}function n(e){return!0===(e&&e.__isLong__)}s.prototype.__isLong__,Object.defineProperty(s.prototype,"__isLong__",{value:!0}),s.isLong=n;var a={},o={};function c(e,t){var s,n,c;return t?(c=0<=(e>>>=0)&&e<256)&&(n=o[e])?n:(s=l(e,(0|e)<0?-1:0,!0),c&&(o[e]=s),s):(c=-128<=(e|=0)&&e<128)&&(n=a[e])?n:(s=l(e,e<0?-1:0,!1),c&&(a[e]=s),s)}function u(e,t){if(isNaN(e))return t?g:w;if(t){if(e<0)return g;if(e>=f)return S}else{if(e<=-m)return C;if(e+1>=m)return b}return e<0?u(-e,t).neg():l(e%p|0,e/p|0,t)}function l(e,t,n){return new s(e,t,n)}s.fromInt=c,s.fromNumber=u,s.fromBits=l;var d=Math.pow;function h(e,t,s){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return w;if("number"==typeof t?(s=t,t=!1):t=!!t,(s=s||10)<2||36<s)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return h(e.substring(1),t,s).neg();for(var a=u(d(s,8)),o=w,c=0;c<e.length;c+=8){var l=Math.min(8,e.length-c),_=parseInt(e.substring(c,c+l),s);if(l<8){var p=u(d(s,l));o=o.mul(p).add(u(_))}else o=(o=o.mul(a)).add(u(_))}return o.unsigned=t,o}function _(e,t){return"number"==typeof e?u(e,t):"string"==typeof e?h(e,t):l(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}s.fromString=h,s.fromValue=_;var p=4294967296,f=p*p,m=f/2,y=c(1<<24),w=c(0);s.ZERO=w;var g=c(0,!0);s.UZERO=g;var v=c(1);s.ONE=v;var E=c(1,!0);s.UONE=E;var T=c(-1);s.NEG_ONE=T;var b=l(-1,2147483647,!1);s.MAX_VALUE=b;var S=l(-1,-1,!0);s.MAX_UNSIGNED_VALUE=S;var C=l(0,-2147483648,!1);s.MIN_VALUE=C;var R=s.prototype;R.toInt=function(){return this.unsigned?this.low>>>0:this.low},R.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},R.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(C)){var t=u(e),s=this.div(t),n=s.mul(t).sub(this);return s.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=u(d(e,6),this.unsigned),o=this,c="";;){var l=o.div(a),h=(o.sub(l.mul(a)).toInt()>>>0).toString(e);if((o=l).isZero())return h+c;for(;h.length<6;)h="0"+h;c=""+h+c}},R.getHighBits=function(){return this.high},R.getHighBitsUnsigned=function(){return this.high>>>0},R.getLowBits=function(){return this.low},R.getLowBitsUnsigned=function(){return this.low>>>0},R.getNumBitsAbs=function(){if(this.isNegative())return this.eq(C)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},R.isZero=function(){return 0===this.high&&0===this.low},R.eqz=R.isZero,R.isNegative=function(){return!this.unsigned&&this.high<0},R.isPositive=function(){return this.unsigned||this.high>=0},R.isOdd=function(){return 1==(1&this.low)},R.isEven=function(){return 0==(1&this.low)},R.equals=function(e){return n(e)||(e=_(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},R.eq=R.equals,R.notEquals=function(e){return!this.eq(e)},R.neq=R.notEquals,R.ne=R.notEquals,R.lessThan=function(e){return this.comp(e)<0},R.lt=R.lessThan,R.lessThanOrEqual=function(e){return this.comp(e)<=0},R.lte=R.lessThanOrEqual,R.le=R.lessThanOrEqual,R.greaterThan=function(e){return this.comp(e)>0},R.gt=R.greaterThan,R.greaterThanOrEqual=function(e){return this.comp(e)>=0},R.gte=R.greaterThanOrEqual,R.ge=R.greaterThanOrEqual,R.compare=function(e){if(n(e)||(e=_(e)),this.eq(e))return 0;var t=this.isNegative(),s=e.isNegative();return t&&!s?-1:!t&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},R.comp=R.compare,R.negate=function(){return!this.unsigned&&this.eq(C)?C:this.not().add(v)},R.neg=R.negate,R.add=function(e){n(e)||(e=_(e));var t=this.high>>>16,s=65535&this.high,a=this.low>>>16,o=65535&this.low,c=e.high>>>16,u=65535&e.high,d=e.low>>>16,h=0,p=0,f=0,m=0;return f+=(m+=o+(65535&e.low))>>>16,p+=(f+=a+d)>>>16,h+=(p+=s+u)>>>16,h+=t+c,l((f&=65535)<<16|(m&=65535),(h&=65535)<<16|(p&=65535),this.unsigned)},R.subtract=function(e){return n(e)||(e=_(e)),this.add(e.neg())},R.sub=R.subtract,R.multiply=function(e){if(this.isZero())return w;if(n(e)||(e=_(e)),t)return l(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return w;if(this.eq(C))return e.isOdd()?C:w;if(e.eq(C))return this.isOdd()?C:w;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(y)&&e.lt(y))return u(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,a=65535&this.high,o=this.low>>>16,c=65535&this.low,d=e.high>>>16,h=65535&e.high,p=e.low>>>16,f=65535&e.low,m=0,g=0,v=0,E=0;return v+=(E+=c*f)>>>16,g+=(v+=o*f)>>>16,v&=65535,g+=(v+=c*p)>>>16,m+=(g+=a*f)>>>16,g&=65535,m+=(g+=o*p)>>>16,g&=65535,m+=(g+=c*h)>>>16,m+=s*f+a*p+o*h+c*d,l((v&=65535)<<16|(E&=65535),(m&=65535)<<16|(g&=65535),this.unsigned)},R.mul=R.multiply,R.divide=function(e){if(n(e)||(e=_(e)),e.isZero())throw Error("division by zero");var s,a,o;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?g:w;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return g;if(e.gt(this.shru(1)))return E;o=g}else{if(this.eq(C))return e.eq(v)||e.eq(T)?C:e.eq(C)?v:(s=this.shr(1).div(e).shl(1)).eq(w)?e.isNegative()?v:T:(a=this.sub(e.mul(s)),o=s.add(a.div(e)));if(e.eq(C))return this.unsigned?g:w;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=w}for(a=this;a.gte(e);){s=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var c=Math.ceil(Math.log(s)/Math.LN2),h=c<=48?1:d(2,c-48),p=u(s),f=p.mul(e);f.isNegative()||f.gt(a);)f=(p=u(s-=h,this.unsigned)).mul(e);p.isZero()&&(p=v),o=o.add(p),a=a.sub(f)}return o},R.div=R.divide,R.modulo=function(e){return n(e)||(e=_(e)),t?l((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},R.mod=R.modulo,R.rem=R.modulo,R.not=function(){return l(~this.low,~this.high,this.unsigned)},R.and=function(e){return n(e)||(e=_(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},R.or=function(e){return n(e)||(e=_(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},R.xor=function(e){return n(e)||(e=_(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},R.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},R.shl=R.shiftLeft,R.shiftRight=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},R.shr=R.shiftRight,R.shiftRightUnsigned=function(e){if(n(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?l(this.low>>>e|t<<32-e,t>>>e,this.unsigned):l(32===e?t:t>>>e-32,0,this.unsigned)},R.shru=R.shiftRightUnsigned,R.shr_u=R.shiftRightUnsigned,R.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},R.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},R.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},R.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},R.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},s.fromBytes=function(e,t,n){return n?s.fromBytesLE(e,t):s.fromBytesBE(e,t)},s.fromBytesLE=function(e,t){return new s(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},s.fromBytesBE=function(e,t){return new s(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},1682:(e,t,s)=>{"use strict";s.r(t),s.d(t,{LineStream:()=>LineStream,ParseStream:()=>ParseStream,Parser:()=>Parser});var n=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var s=this.listeners[e].indexOf(t);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(s,1),s>-1},t.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var s=t.length,n=0;n<s;++n)t[n].call(this,arguments[1]);else for(var a=Array.prototype.slice.call(arguments,1),o=t.length,c=0;c<o;++c)t[c].apply(this,a)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}();function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},a.apply(this,arguments)}var o=s(8908),c=s.n(o);function u(e){for(var t,s=(t=e,c().atob?c().atob(t):Buffer.from(t,"base64").toString("binary")),n=new Uint8Array(s.length),a=0;a<s.length;a++)n[a]=s.charCodeAt(a);return n}class LineStream extends n{constructor(){super(),this.buffer=""}push(e){let t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}const l=String.fromCharCode(9),d=function(e){const t=/([0-9.]*)?@?([0-9.]*)?/.exec(e||""),s={};return t[1]&&(s.length=parseInt(t[1],10)),t[2]&&(s.offset=parseInt(t[2],10)),s},h=function(e){const t={};if(!e)return t;const s=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))'));let n,a=s.length;for(;a--;)""!==s[a]&&(n=/([^=]*)=(.*)/.exec(s[a]).slice(1),n[0]=n[0].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^['"](.*)['"]$/g,"$1"),t[n[0]]=n[1]);return t};class ParseStream extends n{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){let t,s;if(0===(e=e.trim()).length)return;if("#"!==e[0])return void this.trigger("data",{type:"uri",uri:e});this.tagMappers.reduce(((t,s)=>{const n=s(e);return n===e?t:t.concat([n])}),[e]).forEach((e=>{for(let t=0;t<this.customParsers.length;t++)if(this.customParsers[t].call(this,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e),t)this.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(e),t)return s={type:"tag",tagType:"inf"},t[1]&&(s.duration=parseFloat(t[1])),t[2]&&(s.title=t[2]),void this.trigger("data",s);if(t=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(e),t)return s={type:"tag",tagType:"targetduration"},t[1]&&(s.duration=parseInt(t[1],10)),void this.trigger("data",s);if(t=/^#EXT-X-VERSION:([0-9.]*)?/.exec(e),t)return s={type:"tag",tagType:"version"},t[1]&&(s.version=parseInt(t[1],10)),void this.trigger("data",s);if(t=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(e),t)return s={type:"tag",tagType:"media-sequence"},t[1]&&(s.number=parseInt(t[1],10)),void this.trigger("data",s);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(e),t)return s={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(s.number=parseInt(t[1],10)),void this.trigger("data",s);if(t=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(e),t)return s={type:"tag",tagType:"playlist-type"},t[1]&&(s.playlistType=t[1]),void this.trigger("data",s);if(t=/^#EXT-X-BYTERANGE:(.*)?$/.exec(e),t)return s=a(d(t[1]),{type:"tag",tagType:"byterange"}),void this.trigger("data",s);if(t=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(e),t)return s={type:"tag",tagType:"allow-cache"},t[1]&&(s.allowed=!/NO/.test(t[1])),void this.trigger("data",s);if(t=/^#EXT-X-MAP:(.*)$/.exec(e),t){if(s={type:"tag",tagType:"map"},t[1]){const e=h(t[1]);e.URI&&(s.uri=e.URI),e.BYTERANGE&&(s.byterange=d(e.BYTERANGE))}this.trigger("data",s)}else if(t=/^#EXT-X-STREAM-INF:(.*)$/.exec(e),t){if(s={type:"tag",tagType:"stream-inf"},t[1]){if(s.attributes=h(t[1]),s.attributes.RESOLUTION){const e=s.attributes.RESOLUTION.split("x"),t={};e[0]&&(t.width=parseInt(e[0],10)),e[1]&&(t.height=parseInt(e[1],10)),s.attributes.RESOLUTION=t}s.attributes.BANDWIDTH&&(s.attributes.BANDWIDTH=parseInt(s.attributes.BANDWIDTH,10)),s.attributes["FRAME-RATE"]&&(s.attributes["FRAME-RATE"]=parseFloat(s.attributes["FRAME-RATE"])),s.attributes["PROGRAM-ID"]&&(s.attributes["PROGRAM-ID"]=parseInt(s.attributes["PROGRAM-ID"],10))}this.trigger("data",s)}else{if(t=/^#EXT-X-MEDIA:(.*)$/.exec(e),t)return s={type:"tag",tagType:"media"},t[1]&&(s.attributes=h(t[1])),void this.trigger("data",s);if(t=/^#EXT-X-ENDLIST/.exec(e),t)this.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e),t)this.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(e),t)return s={type:"tag",tagType:"program-date-time"},t[1]&&(s.dateTimeString=t[1],s.dateTimeObject=new Date(t[1])),void this.trigger("data",s);if(t=/^#EXT-X-KEY:(.*)$/.exec(e),t)return s={type:"tag",tagType:"key"},t[1]&&(s.attributes=h(t[1]),s.attributes.IV&&("0x"===s.attributes.IV.substring(0,2).toLowerCase()&&(s.attributes.IV=s.attributes.IV.substring(2)),s.attributes.IV=s.attributes.IV.match(/.{8}/g),s.attributes.IV[0]=parseInt(s.attributes.IV[0],16),s.attributes.IV[1]=parseInt(s.attributes.IV[1],16),s.attributes.IV[2]=parseInt(s.attributes.IV[2],16),s.attributes.IV[3]=parseInt(s.attributes.IV[3],16),s.attributes.IV=new Uint32Array(s.attributes.IV))),void this.trigger("data",s);if(t=/^#EXT-X-START:(.*)$/.exec(e),t)return s={type:"tag",tagType:"start"},t[1]&&(s.attributes=h(t[1]),s.attributes["TIME-OFFSET"]=parseFloat(s.attributes["TIME-OFFSET"]),s.attributes.PRECISE=/YES/.test(s.attributes.PRECISE)),void this.trigger("data",s);if(t=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(e),t)return s={type:"tag",tagType:"cue-out-cont"},t[1]?s.data=t[1]:s.data="",void this.trigger("data",s);if(t=/^#EXT-X-CUE-OUT:(.*)?$/.exec(e),t)return s={type:"tag",tagType:"cue-out"},t[1]?s.data=t[1]:s.data="",void this.trigger("data",s);if(t=/^#EXT-X-CUE-IN:(.*)?$/.exec(e),t)return s={type:"tag",tagType:"cue-in"},t[1]?s.data=t[1]:s.data="",void this.trigger("data",s);if(t=/^#EXT-X-SKIP:(.*)$/.exec(e),t&&t[1])return s={type:"tag",tagType:"skip"},s.attributes=h(t[1]),s.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(s.attributes["SKIPPED-SEGMENTS"]=parseInt(s.attributes["SKIPPED-SEGMENTS"],10)),s.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(s.attributes["RECENTLY-REMOVED-DATERANGES"]=s.attributes["RECENTLY-REMOVED-DATERANGES"].split(l)),void this.trigger("data",s);if(t=/^#EXT-X-PART:(.*)$/.exec(e),t&&t[1])return s={type:"tag",tagType:"part"},s.attributes=h(t[1]),["DURATION"].forEach((function(e){s.attributes.hasOwnProperty(e)&&(s.attributes[e]=parseFloat(s.attributes[e]))})),["INDEPENDENT","GAP"].forEach((function(e){s.attributes.hasOwnProperty(e)&&(s.attributes[e]=/YES/.test(s.attributes[e]))})),s.attributes.hasOwnProperty("BYTERANGE")&&(s.attributes.byterange=d(s.attributes.BYTERANGE)),void this.trigger("data",s);if(t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(e),t&&t[1])return s={type:"tag",tagType:"server-control"},s.attributes=h(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach((function(e){s.attributes.hasOwnProperty(e)&&(s.attributes[e]=parseFloat(s.attributes[e]))})),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach((function(e){s.attributes.hasOwnProperty(e)&&(s.attributes[e]=/YES/.test(s.attributes[e]))})),void this.trigger("data",s);if(t=/^#EXT-X-PART-INF:(.*)$/.exec(e),t&&t[1])return s={type:"tag",tagType:"part-inf"},s.attributes=h(t[1]),["PART-TARGET"].forEach((function(e){s.attributes.hasOwnProperty(e)&&(s.attributes[e]=parseFloat(s.attributes[e]))})),void this.trigger("data",s);if(t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(e),t&&t[1])return s={type:"tag",tagType:"preload-hint"},s.attributes=h(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach((function(e){if(s.attributes.hasOwnProperty(e)){s.attributes[e]=parseInt(s.attributes[e],10);const t="BYTERANGE-LENGTH"===e?"length":"offset";s.attributes.byterange=s.attributes.byterange||{},s.attributes.byterange[t]=s.attributes[e],delete s.attributes[e]}})),void this.trigger("data",s);if(t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(e),t&&t[1])return s={type:"tag",tagType:"rendition-report"},s.attributes=h(t[1]),["LAST-MSN","LAST-PART"].forEach((function(e){s.attributes.hasOwnProperty(e)&&(s.attributes[e]=parseInt(s.attributes[e],10))})),void this.trigger("data",s);if(t=/^#EXT-X-DATERANGE:(.*)$/.exec(e),t&&t[1]){s={type:"tag",tagType:"daterange"},s.attributes=h(t[1]),["ID","CLASS"].forEach((function(e){s.attributes.hasOwnProperty(e)&&(s.attributes[e]=String(s.attributes[e]))})),["START-DATE","END-DATE"].forEach((function(e){s.attributes.hasOwnProperty(e)&&(s.attributes[e]=new Date(s.attributes[e]))})),["DURATION","PLANNED-DURATION"].forEach((function(e){s.attributes.hasOwnProperty(e)&&(s.attributes[e]=parseFloat(s.attributes[e]))})),["END-ON-NEXT"].forEach((function(e){s.attributes.hasOwnProperty(e)&&(s.attributes[e]=/YES/i.test(s.attributes[e]))})),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach((function(e){s.attributes.hasOwnProperty(e)&&(s.attributes[e]=s.attributes[e].toString(16))}));const e=/^X-([A-Z]+-)+[A-Z]+$/;for(const t in s.attributes){if(!e.test(t))continue;const n=/[0-9A-Fa-f]{6}/g.test(s.attributes[t]),a=/^\d+(\.\d+)?$/.test(s.attributes[t]);s.attributes[t]=n?s.attributes[t].toString(16):a?parseFloat(s.attributes[t]):String(s.attributes[t])}this.trigger("data",s)}else t=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(e),t?this.trigger("data",{type:"tag",tagType:"independent-segments"}):this.trigger("data",{type:"tag",data:e.slice(4)})}}}else this.trigger("data",{type:"comment",text:e.slice(1)})}))}addParser({expression:e,customType:t,dataParser:s,segment:n}){"function"!=typeof s&&(s=e=>e),this.customParsers.push((a=>{if(e.exec(a))return this.trigger("data",{type:"custom",data:s(a),customType:t,segment:n}),!0}))}addTagMapper({expression:e,map:t}){this.tagMappers.push((s=>e.test(s)?t(s):s))}}const _=function(e){const t={};return Object.keys(e).forEach((function(s){var n;t[(n=s,n.toLowerCase().replace(/-(\w)/g,(e=>e[1].toUpperCase())))]=e[s]})),t},p=function(e){const{serverControl:t,targetDuration:s,partTargetDuration:n}=e;if(!t)return;const a="#EXT-X-SERVER-CONTROL",o="holdBack",c="partHoldBack",u=s&&3*s,l=n&&2*n;s&&!t.hasOwnProperty(o)&&(t[o]=u,this.trigger("info",{message:`${a} defaulting HOLD-BACK to targetDuration * 3 (${u}).`})),u&&t[o]<u&&(this.trigger("warn",{message:`${a} clamping HOLD-BACK (${t[o]}) to targetDuration * 3 (${u})`}),t[o]=u),n&&!t.hasOwnProperty(c)&&(t[c]=3*n,this.trigger("info",{message:`${a} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${t[c]}).`})),n&&t[c]<l&&(this.trigger("warn",{message:`${a} clamping PART-HOLD-BACK (${t[c]}) to partTargetDuration * 2 (${l}).`}),t[c]=l)};class Parser extends n{constructor(){super(),this.lineStream=new LineStream,this.parseStream=new ParseStream,this.lineStream.pipe(this.parseStream);const e=this,t=[];let s,n,o={},c=!1;const l=function(){},d={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}};let h=0;this.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};let f=0,m=0;const y={};this.on("end",(()=>{o.uri||!o.parts&&!o.preloadHints||(!o.map&&s&&(o.map=s),!o.key&&n&&(o.key=n),o.timeline||"number"!=typeof h||(o.timeline=h),this.manifest.preloadSegment=o)})),this.parseStream.on("data",(function(w){let g,v;({tag(){({version(){w.version&&(this.manifest.version=w.version)},"allow-cache"(){this.manifest.allowCache=w.allowed,"allowed"in w||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const e={};"length"in w&&(o.byterange=e,e.length=w.length,"offset"in w||(w.offset=f)),"offset"in w&&(o.byterange=e,e.offset=w.offset),f=e.offset+e.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),w.duration>0&&(o.duration=w.duration),0===w.duration&&(o.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=t},key(){if(w.attributes)if("NONE"!==w.attributes.METHOD)if(w.attributes.URI){if("com.apple.streamingkeydelivery"===w.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:w.attributes});if("com.microsoft.playready"===w.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.microsoft.playready"]={uri:w.attributes.URI});if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===w.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(w.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===w.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==w.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):w.attributes.KEYID&&"0x"===w.attributes.KEYID.substring(0,2)?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:w.attributes.KEYFORMAT,keyId:w.attributes.KEYID.substring(2)},pssh:u(w.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}))}w.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),n={method:w.attributes.METHOD||"AES-128",uri:w.attributes.URI},void 0!==w.attributes.IV&&(n.iv=w.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else n=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence"(){isFinite(w.number)?this.manifest.mediaSequence=w.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+w.number})},"discontinuity-sequence"(){isFinite(w.number)?(this.manifest.discontinuitySequence=w.number,h=w.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+w.number})},"playlist-type"(){/VOD|EVENT/.test(w.playlistType)?this.manifest.playlistType=w.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+w.playlist})},map(){s={},w.uri&&(s.uri=w.uri),w.byterange&&(s.byterange=w.byterange),n&&(s.key=n)},"stream-inf"(){this.manifest.playlists=t,this.manifest.mediaGroups=this.manifest.mediaGroups||d,w.attributes?(o.attributes||(o.attributes={}),a(o.attributes,w.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||d,!(w.attributes&&w.attributes.TYPE&&w.attributes["GROUP-ID"]&&w.attributes.NAME))return void this.trigger("warn",{message:"ignoring incomplete or missing media group"});const e=this.manifest.mediaGroups[w.attributes.TYPE];e[w.attributes["GROUP-ID"]]=e[w.attributes["GROUP-ID"]]||{},g=e[w.attributes["GROUP-ID"]],v={default:/yes/i.test(w.attributes.DEFAULT)},v.default?v.autoselect=!0:v.autoselect=/yes/i.test(w.attributes.AUTOSELECT),w.attributes.LANGUAGE&&(v.language=w.attributes.LANGUAGE),w.attributes.URI&&(v.uri=w.attributes.URI),w.attributes["INSTREAM-ID"]&&(v.instreamId=w.attributes["INSTREAM-ID"]),w.attributes.CHARACTERISTICS&&(v.characteristics=w.attributes.CHARACTERISTICS),w.attributes.FORCED&&(v.forced=/yes/i.test(w.attributes.FORCED)),g[w.attributes.NAME]=v},discontinuity(){h+=1,o.discontinuity=!0,this.manifest.discontinuityStarts.push(t.length)},"program-date-time"(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=w.dateTimeString,this.manifest.dateTimeObject=w.dateTimeObject),o.dateTimeString=w.dateTimeString,o.dateTimeObject=w.dateTimeObject},targetduration(){!isFinite(w.duration)||w.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+w.duration}):(this.manifest.targetDuration=w.duration,p.call(this,this.manifest))},start(){w.attributes&&!isNaN(w.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:w.attributes["TIME-OFFSET"],precise:w.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out"(){o.cueOut=w.data},"cue-out-cont"(){o.cueOutCont=w.data},"cue-in"(){o.cueIn=w.data},skip(){this.manifest.skip=_(w.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",w.attributes,["SKIPPED-SEGMENTS"])},part(){c=!0;const e=this.manifest.segments.length,t=_(w.attributes);o.parts=o.parts||[],o.parts.push(t),t.byterange&&(t.byterange.hasOwnProperty("offset")||(t.byterange.offset=m),m=t.byterange.offset+t.byterange.length);const s=o.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${s} for segment #${e}`,w.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach(((e,t)=>{e.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${t} lacks required attribute(s): LAST-PART`})}))},"server-control"(){const e=this.manifest.serverControl=_(w.attributes);e.hasOwnProperty("canBlockReload")||(e.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),p.call(this,this.manifest),e.canSkipDateranges&&!e.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const e=this.manifest.segments.length,t=_(w.attributes),s=t.type&&"PART"===t.type;o.preloadHints=o.preloadHints||[],o.preloadHints.push(t),t.byterange&&(t.byterange.hasOwnProperty("offset")||(t.byterange.offset=s?m:0,s&&(m=t.byterange.offset+t.byterange.length)));const n=o.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${n} for segment #${e}`,w.attributes,["TYPE","URI"]),t.type)for(let s=0;s<o.preloadHints.length-1;s++){const a=o.preloadHints[s];a.type&&(a.type===t.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${n} for segment #${e} has the same TYPE ${t.type} as preload hint #${s}`}))}},"rendition-report"(){const e=_(w.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(e);const t=this.manifest.renditionReports.length-1,s=["LAST-MSN","URI"];c&&s.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${t}`,w.attributes,s)},"part-inf"(){this.manifest.partInf=_(w.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",w.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),p.call(this,this.manifest)},daterange(){this.manifest.daterange=this.manifest.daterange||[],this.manifest.daterange.push(_(w.attributes));const e=this.manifest.daterange.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${e}`,w.attributes,["ID","START-DATE"]);const t=this.manifest.daterange[e];t.endDate&&t.startDate&&new Date(t.endDate)<new Date(t.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),t.duration&&t.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),t.plannedDuration&&t.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const s=!!t.endOnNext;if(s&&!t.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),s&&(t.duration||t.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),t.duration&&t.endDate){const s=t.startDate,n=s.setSeconds(s.getSeconds()+t.duration);this.manifest.daterange[e].endDate=new Date(n)}if(t&&!this.manifest.dateTimeString&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),y[t.id]){for(const e in y[t.id])if(y[t.id][e]!==t[e]){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes and same attribute values"});break}}else y[t.id]=t},"independent-segments"(){this.manifest.independentSegments=!0}}[w.tagType]||l).call(e)},uri(){o.uri=w.uri,t.push(o),this.manifest.targetDuration&&!("duration"in o)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),o.duration=this.manifest.targetDuration),n&&(o.key=n),o.timeline=h,s&&(o.map=s),m=0,o={}},comment(){},custom(){w.segment?(o.custom=o.custom||{},o.custom[w.customType]=w.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[w.customType]=w.data)}})[w.type].call(e)}))}warnOnMissingAttributes_(e,t,s){const n=[];s.forEach((function(e){t.hasOwnProperty(e)||n.push(e)})),n.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${n.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push("\n"),this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}},6470:e=>{"use strict";function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function s(e,t){for(var s,n="",a=0,o=-1,c=0,u=0;u<=e.length;++u){if(u<e.length)s=e.charCodeAt(u);else{if(47===s)break;s=47}if(47===s){if(o===u-1||1===c);else if(o!==u-1&&2===c){if(n.length<2||2!==a||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2))if(n.length>2){var l=n.lastIndexOf("/");if(l!==n.length-1){-1===l?(n="",a=0):a=(n=n.slice(0,l)).length-1-n.lastIndexOf("/"),o=u,c=0;continue}}else if(2===n.length||1===n.length){n="",a=0,o=u,c=0;continue}t&&(n.length>0?n+="/..":n="..",a=2)}else n.length>0?n+="/"+e.slice(o+1,u):n=e.slice(o+1,u),a=u-o-1;o=u,c=0}else 46===s&&-1!==c?++c:c=-1}return n}var n={resolve:function(){for(var e,n="",a=!1,o=arguments.length-1;o>=-1&&!a;o--){var c;o>=0?c=arguments[o]:(void 0===e&&(e=process.cwd()),c=e),t(c),0!==c.length&&(n=c+"/"+n,a=47===c.charCodeAt(0))}return n=s(n,!a),a?n.length>0?"/"+n:"/":n.length>0?n:"."},normalize:function(e){if(t(e),0===e.length)return".";var n=47===e.charCodeAt(0),a=47===e.charCodeAt(e.length-1);return 0!==(e=s(e,!n)).length||n||(e="."),e.length>0&&a&&(e+="/"),n?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,s=0;s<arguments.length;++s){var a=arguments[s];t(a),a.length>0&&(void 0===e?e=a:e+="/"+a)}return void 0===e?".":n.normalize(e)},relative:function(e,s){if(t(e),t(s),e===s)return"";if((e=n.resolve(e))===(s=n.resolve(s)))return"";for(var a=1;a<e.length&&47===e.charCodeAt(a);++a);for(var o=e.length,c=o-a,u=1;u<s.length&&47===s.charCodeAt(u);++u);for(var l=s.length-u,d=c<l?c:l,h=-1,_=0;_<=d;++_){if(_===d){if(l>d){if(47===s.charCodeAt(u+_))return s.slice(u+_+1);if(0===_)return s.slice(u+_)}else c>d&&(47===e.charCodeAt(a+_)?h=_:0===_&&(h=0));break}var p=e.charCodeAt(a+_);if(p!==s.charCodeAt(u+_))break;47===p&&(h=_)}var f="";for(_=a+h+1;_<=o;++_)_!==o&&47!==e.charCodeAt(_)||(0===f.length?f+="..":f+="/..");return f.length>0?f+s.slice(u+h):(u+=h,47===s.charCodeAt(u)&&++u,s.slice(u))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var s=e.charCodeAt(0),n=47===s,a=-1,o=!0,c=e.length-1;c>=1;--c)if(47===(s=e.charCodeAt(c))){if(!o){a=c;break}}else o=!1;return-1===a?n?"/":".":n&&1===a?"//":e.slice(0,a)},basename:function(e,s){if(void 0!==s&&"string"!=typeof s)throw new TypeError('"ext" argument must be a string');t(e);var n,a=0,o=-1,c=!0;if(void 0!==s&&s.length>0&&s.length<=e.length){if(s.length===e.length&&s===e)return"";var u=s.length-1,l=-1;for(n=e.length-1;n>=0;--n){var d=e.charCodeAt(n);if(47===d){if(!c){a=n+1;break}}else-1===l&&(c=!1,l=n+1),u>=0&&(d===s.charCodeAt(u)?-1==--u&&(o=n):(u=-1,o=l))}return a===o?o=l:-1===o&&(o=e.length),e.slice(a,o)}for(n=e.length-1;n>=0;--n)if(47===e.charCodeAt(n)){if(!c){a=n+1;break}}else-1===o&&(c=!1,o=n+1);return-1===o?"":e.slice(a,o)},extname:function(e){t(e);for(var s=-1,n=0,a=-1,o=!0,c=0,u=e.length-1;u>=0;--u){var l=e.charCodeAt(u);if(47!==l)-1===a&&(o=!1,a=u+1),46===l?-1===s?s=u:1!==c&&(c=1):-1!==s&&(c=-1);else if(!o){n=u+1;break}}return-1===s||-1===a||0===c||1===c&&s===a-1&&s===n+1?"":e.slice(s,a)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var s=t.dir||t.root,n=t.base||(t.name||"")+(t.ext||"");return s?s===t.root?s+n:s+e+n:n}("/",e)},parse:function(e){t(e);var s={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return s;var n,a=e.charCodeAt(0),o=47===a;o?(s.root="/",n=1):n=0;for(var c=-1,u=0,l=-1,d=!0,h=e.length-1,_=0;h>=n;--h)if(47!==(a=e.charCodeAt(h)))-1===l&&(d=!1,l=h+1),46===a?-1===c?c=h:1!==_&&(_=1):-1!==c&&(_=-1);else if(!d){u=h+1;break}return-1===c||-1===l||0===_||1===_&&c===l-1&&c===u+1?-1!==l&&(s.base=s.name=0===u&&o?e.slice(1,l):e.slice(u,l)):(0===u&&o?(s.name=e.slice(1,c),s.base=e.slice(1,l)):(s.name=e.slice(u,c),s.base=e.slice(u,l)),s.ext=e.slice(c,l)),u>0?s.dir=e.slice(0,u-1):o&&(s.dir="/"),s},sep:"/",delimiter:":",win32:null,posix:null};n.posix=n,e.exports=n},4492:(e,t,s)=>{"use strict";e.exports=s(8836)},2100:(e,t,s)=>{"use strict";e.exports=s(9482)},3996:(e,t,s)=>{"use strict";var n=t,a=s(7025),o=s(9935);function c(e,t,s,n){if(t.resolvedType)if(t.resolvedType instanceof a){e("switch(d%s){",n);for(var o=t.resolvedType.values,c=Object.keys(o),u=0;u<c.length;++u)t.repeated&&o[c[u]]===t.typeDefault&&e("default:"),e("case%j:",c[u])("case %i:",o[c[u]])("m%s=%j",n,o[c[u]])("break");e("}")}else e('if(typeof d%s!=="object")',n)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,s,n);else{var l=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",n,n);break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,l)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,l?"true":"");break;case"bytes":e('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length)",n)("m%s=d%s",n,n);break;case"string":e("m%s=String(d%s)",n,n);break;case"bool":e("m%s=Boolean(d%s)",n,n)}}return e}function u(e,t,s,n){if(t.resolvedType)t.resolvedType instanceof a?e("d%s=o.enums===String?types[%i].values[m%s]:m%s",n,s,n,n):e("d%s=types[%i].toObject(m%s,o)",n,s,n);else{var o=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":o=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,o?"true":"",n);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:e("d%s=m%s",n,n)}}return e}n.fromObject=function(e){var t=e.fieldsArray,s=o.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return s("return new this.ctor");s("var m=new this.ctor");for(var n=0;n<t.length;++n){var u=t[n].resolve(),l=o.safeProp(u.name);u.map?(s("if(d%s){",l)('if(typeof d%s!=="object")',l)("throw TypeError(%j)",u.fullName+": object expected")("m%s={}",l)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",l),c(s,u,n,l+"[ks[i]]")("}")("}")):u.repeated?(s("if(d%s){",l)("if(!Array.isArray(d%s))",l)("throw TypeError(%j)",u.fullName+": array expected")("m%s=[]",l)("for(var i=0;i<d%s.length;++i){",l),c(s,u,n,l+"[i]")("}")("}")):(u.resolvedType instanceof a||s("if(d%s!=null){",l),c(s,u,n,l),u.resolvedType instanceof a||s("}"))}return s("return m")},n.toObject=function(e){var t=e.fieldsArray.slice().sort(o.compareFieldsById);if(!t.length)return o.codegen()("return {}");for(var s=o.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),n=[],c=[],l=[],d=0;d<t.length;++d)t[d].partOf||(t[d].resolve().repeated?n:t[d].map?c:l).push(t[d]);if(n.length){for(s("if(o.arrays||o.defaults){"),d=0;d<n.length;++d)s("d%s=[]",o.safeProp(n[d].name));s("}")}if(c.length){for(s("if(o.objects||o.defaults){"),d=0;d<c.length;++d)s("d%s={}",o.safeProp(c[d].name));s("}")}if(l.length){for(s("if(o.defaults){"),d=0;d<l.length;++d){var h=l[d],_=o.safeProp(h.name);if(h.resolvedType instanceof a)s("d%s=o.enums===String?%j:%j",_,h.resolvedType.valuesById[h.typeDefault],h.typeDefault);else if(h.long)s("if(util.Long){")("var n=new util.Long(%i,%i,%j)",h.typeDefault.low,h.typeDefault.high,h.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",_)("}else")("d%s=o.longs===String?%j:%i",_,h.typeDefault.toString(),h.typeDefault.toNumber());else if(h.bytes){var p="["+Array.prototype.slice.call(h.typeDefault).join(",")+"]";s("if(o.bytes===String)d%s=%j",_,String.fromCharCode.apply(String,h.typeDefault))("else{")("d%s=%s",_,p)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",_,_)("}")}else s("d%s=%j",_,h.typeDefault)}s("}")}var f=!1;for(d=0;d<t.length;++d){h=t[d];var m=e._fieldsArray.indexOf(h);_=o.safeProp(h.name);h.map?(f||(f=!0,s("var ks2")),s("if(m%s&&(ks2=Object.keys(m%s)).length){",_,_)("d%s={}",_)("for(var j=0;j<ks2.length;++j){"),u(s,h,m,_+"[ks2[j]]")("}")):h.repeated?(s("if(m%s&&m%s.length){",_,_)("d%s=[]",_)("for(var j=0;j<m%s.length;++j){",_),u(s,h,m,_+"[j]")("}")):(s("if(m%s!=null&&m.hasOwnProperty(%j)){",_,h.name),u(s,h,m,_),h.partOf&&s("if(o.oneofs)")("d%s=%j",o.safeProp(h.partOf.name),h.name)),s("}")}return s("return d")}},5305:(e,t,s)=>{"use strict";e.exports=function(e){var t=o.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break");t("switch(t>>>3){");for(var s=0;s<e.fieldsArray.length;++s){var u=e._fieldsArray[s].resolve(),l=u.resolvedType instanceof n?"int32":u.type,d="m"+o.safeProp(u.name);t("case %i:",u.id),u.map?(t("if(%s===util.emptyObject)",d)("%s={}",d)("var c2 = r.uint32()+r.pos"),void 0!==a.defaults[u.keyType]?t("k=%j",a.defaults[u.keyType]):t("k=null"),void 0!==a.defaults[l]?t("value=%j",a.defaults[l]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",u.keyType)("case 2:"),void 0===a.basic[l]?t("value=types[%i].decode(r,r.uint32())",s):t("value=r.%s()",l),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==a.long[u.keyType]?t('%s[typeof k==="object"?util.longToHash(k):k]=value',d):t("%s[k]=value",d)):u.repeated?(t("if(!(%s&&%s.length))",d,d)("%s=[]",d),void 0!==a.packed[l]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",d,l)("}else"),void 0===a.basic[l]?t(u.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",d,s):t("%s.push(r.%s())",d,l)):void 0===a.basic[l]?t(u.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",d,s):t("%s=r.%s()",d,l),t("break")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),s=0;s<e._fieldsArray.length;++s){var h=e._fieldsArray[s];h.required&&t("if(!m.hasOwnProperty(%j))",h.name)("throw util.ProtocolError(%j,{instance:m})",c(h))}return t("return m")};var n=s(7025),a=s(7063),o=s(9935);function c(e){return"missing required '"+e.name+"'"}},4928:(e,t,s)=>{"use strict";e.exports=function(e){for(var t,s=o.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),u=e.fieldsArray.slice().sort(o.compareFieldsById),l=0;l<u.length;++l){var d=u[l].resolve(),h=e._fieldsArray.indexOf(d),_=d.resolvedType instanceof n?"int32":d.type,p=a.basic[_];t="m"+o.safeProp(d.name),d.map?(s("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",t,d.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(d.id<<3|2)>>>0,8|a.mapKey[d.keyType],d.keyType),void 0===p?s("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",h,t):s(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|p,_,t),s("}")("}")):d.repeated?(s("if(%s!=null&&%s.length){",t,t),d.packed&&void 0!==a.packed[_]?s("w.uint32(%i).fork()",(d.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",_,t)("w.ldelim()"):(s("for(var i=0;i<%s.length;++i)",t),void 0===p?c(s,d,h,t+"[i]"):s("w.uint32(%i).%s(%s[i])",(d.id<<3|p)>>>0,_,t)),s("}")):(d.optional&&s("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",t,d.name),void 0===p?c(s,d,h,t):s("w.uint32(%i).%s(%s)",(d.id<<3|p)>>>0,_,t))}return s("return w")};var n=s(7025),a=s(7063),o=s(9935);function c(e,t,s,n){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",s,n,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",s,n,(t.id<<3|2)>>>0)}},7025:(e,t,s)=>{"use strict";e.exports=c;var n=s(3243);((c.prototype=Object.create(n.prototype)).constructor=c).className="Enum";var a=s(9313),o=s(9935);function c(e,t,s,a,o){if(n.call(this,e,s),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=a,this.comments=o||{},this.reserved=void 0,t)for(var c=Object.keys(t),u=0;u<c.length;++u)"number"==typeof t[c[u]]&&(this.valuesById[this.values[c[u]]=t[c[u]]]=c[u])}c.fromJSON=function(e,t){var s=new c(e,t.values,t.options,t.comment,t.comments);return s.reserved=t.reserved,s},c.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},c.prototype.add=function(e,t,s){if(!o.isString(e))throw TypeError("name must be a string");if(!o.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=s||null,this},c.prototype.remove=function(e){if(!o.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this},c.prototype.isReservedId=function(e){return a.isReservedId(this.reserved,e)},c.prototype.isReservedName=function(e){return a.isReservedName(this.reserved,e)}},3548:(e,t,s)=>{"use strict";e.exports=d;var n=s(3243);((d.prototype=Object.create(n.prototype)).constructor=d).className="Field";var a,o=s(7025),c=s(7063),u=s(9935),l=/^required|optional|repeated$/;function d(e,t,s,a,o,d,h){if(u.isObject(a)?(h=o,d=a,a=o=void 0):u.isObject(o)&&(h=d,d=o,o=void 0),n.call(this,e,d),!u.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!u.isString(s))throw TypeError("type must be a string");if(void 0!==a&&!l.test(a=a.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==o&&!u.isString(o))throw TypeError("extend must be a string");"proto3_optional"===a&&(a="optional"),this.rule=a&&"optional"!==a?a:void 0,this.type=s,this.id=t,this.extend=o||void 0,this.required="required"===a,this.optional=!this.required,this.repeated="repeated"===a,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!u.Long&&void 0!==c.long[s],this.bytes="bytes"===s,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=h}d.fromJSON=function(e,t){return new d(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(d.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),d.prototype.setOption=function(e,t,s){return"packed"===e&&(this._packed=null),n.prototype.setOption.call(this,e,t,s)},d.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return u.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},d.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=c.defaults[this.type])&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof a?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof o&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof o)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=u.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;u.base64.test(this.typeDefault)?u.base64.decode(this.typeDefault,e=u.newBuffer(u.base64.length(this.typeDefault)),0):u.utf8.write(this.typeDefault,e=u.newBuffer(u.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=u.emptyObject:this.repeated?this.defaultValue=u.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof a&&(this.parent.ctor.prototype[this.name]=this.defaultValue),n.prototype.resolve.call(this)},d.d=function(e,t,s,n){return"function"==typeof t?t=u.decorateType(t).name:t&&"object"==typeof t&&(t=u.decorateEnum(t).name),function(a,o){u.decorateType(a.constructor).add(new d(o,e,t,s,{default:n}))}},d._configure=function(e){a=e}},8836:(e,t,s)=>{"use strict";var n=e.exports=s(9482);n.build="light",n.load=function(e,t,s){return"function"==typeof t?(s=t,t=new n.Root):t||(t=new n.Root),t.load(e,s)},n.loadSync=function(e,t){return t||(t=new n.Root),t.loadSync(e)},n.encoder=s(4928),n.decoder=s(5305),n.verifier=s(4497),n.converter=s(3996),n.ReflectionObject=s(3243),n.Namespace=s(9313),n.Root=s(9424),n.Enum=s(7025),n.Type=s(7645),n.Field=s(3548),n.OneOf=s(7598),n.MapField=s(6039),n.Service=s(7513),n.Method=s(4429),n.Message=s(8368),n.wrappers=s(1667),n.types=s(7063),n.util=s(9935),n.ReflectionObject._configure(n.Root),n.Namespace._configure(n.Type,n.Service,n.Enum),n.Root._configure(n.Type),n.Field._configure(n.Type)},9482:(e,t,s)=>{"use strict";var n=t;function a(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=s(1173),n.BufferWriter=s(3155),n.Reader=s(1408),n.BufferReader=s(593),n.util=s(9693),n.rpc=s(5994),n.roots=s(5054),n.configure=a,a()},6039:(e,t,s)=>{"use strict";e.exports=c;var n=s(3548);((c.prototype=Object.create(n.prototype)).constructor=c).className="MapField";var a=s(7063),o=s(9935);function c(e,t,s,a,c,u){if(n.call(this,e,t,a,void 0,void 0,c,u),!o.isString(s))throw TypeError("keyType must be a string");this.keyType=s,this.resolvedKeyType=null,this.map=!0}c.fromJSON=function(e,t){return new c(e,t.id,t.keyType,t.type,t.options,t.comment)},c.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},c.prototype.resolve=function(){if(this.resolved)return this;if(void 0===a.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return n.prototype.resolve.call(this)},c.d=function(e,t,s){return"function"==typeof s?s=o.decorateType(s).name:s&&"object"==typeof s&&(s=o.decorateEnum(s).name),function(n,a){o.decorateType(n.constructor).add(new c(a,e,t,s))}}},8368:(e,t,s)=>{"use strict";e.exports=a;var n=s(9693);function a(e){if(e)for(var t=Object.keys(e),s=0;s<t.length;++s)this[t[s]]=e[t[s]]}a.create=function(e){return this.$type.create(e)},a.encode=function(e,t){return this.$type.encode(e,t)},a.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},a.decode=function(e){return this.$type.decode(e)},a.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},a.verify=function(e){return this.$type.verify(e)},a.fromObject=function(e){return this.$type.fromObject(e)},a.toObject=function(e,t){return this.$type.toObject(e,t)},a.prototype.toJSON=function(){return this.$type.toObject(this,n.toJSONOptions)}},4429:(e,t,s)=>{"use strict";e.exports=o;var n=s(3243);((o.prototype=Object.create(n.prototype)).constructor=o).className="Method";var a=s(9935);function o(e,t,s,o,c,u,l,d,h){if(a.isObject(c)?(l=c,c=u=void 0):a.isObject(u)&&(l=u,u=void 0),void 0!==t&&!a.isString(t))throw TypeError("type must be a string");if(!a.isString(s))throw TypeError("requestType must be a string");if(!a.isString(o))throw TypeError("responseType must be a string");n.call(this,e,l),this.type=t||"rpc",this.requestType=s,this.requestStream=!!c||void 0,this.responseType=o,this.responseStream=!!u||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=d,this.parsedOptions=h}o.fromJSON=function(e,t){return new o(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return a.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])},o.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),n.prototype.resolve.call(this))}},9313:(e,t,s)=>{"use strict";e.exports=_;var n=s(3243);((_.prototype=Object.create(n.prototype)).constructor=_).className="Namespace";var a,o,c,u=s(3548),l=s(7598),d=s(9935);function h(e,t){if(e&&e.length){for(var s={},n=0;n<e.length;++n)s[e[n].name]=e[n].toJSON(t);return s}}function _(e,t){n.call(this,e,t),this.nested=void 0,this._nestedArray=null}function p(e){return e._nestedArray=null,e}_.fromJSON=function(e,t){return new _(e,t.options).addJSON(t.nested)},_.arrayToJSON=h,_.isReservedId=function(e,t){if(e)for(var s=0;s<e.length;++s)if("string"!=typeof e[s]&&e[s][0]<=t&&e[s][1]>t)return!0;return!1},_.isReservedName=function(e,t){if(e)for(var s=0;s<e.length;++s)if(e[s]===t)return!0;return!1},Object.defineProperty(_.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=d.toArray(this.nested))}}),_.prototype.toJSON=function(e){return d.toObject(["options",this.options,"nested",h(this.nestedArray,e)])},_.prototype.addJSON=function(e){if(e)for(var t,s=Object.keys(e),n=0;n<s.length;++n)t=e[s[n]],this.add((void 0!==t.fields?a.fromJSON:void 0!==t.values?c.fromJSON:void 0!==t.methods?o.fromJSON:void 0!==t.id?u.fromJSON:_.fromJSON)(s[n],t));return this},_.prototype.get=function(e){return this.nested&&this.nested[e]||null},_.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof c)return this.nested[e].values;throw Error("no such enum: "+e)},_.prototype.add=function(e){if(!(e instanceof u&&void 0!==e.extend||e instanceof a||e instanceof c||e instanceof o||e instanceof _||e instanceof l))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof _&&e instanceof _)||t instanceof a||t instanceof o)throw Error("duplicate name '"+e.name+"' in "+this);for(var s=t.nestedArray,n=0;n<s.length;++n)e.add(s[n]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),p(this)},_.prototype.remove=function(e){if(!(e instanceof n))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),p(this)},_.prototype.define=function(e,t){if(d.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var s=this;e.length>0;){var n=e.shift();if(s.nested&&s.nested[n]){if(!((s=s.nested[n])instanceof _))throw Error("path conflicts with non-namespace objects")}else s.add(s=new _(n))}return t&&s.addJSON(t),s},_.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof _?e[t++].resolveAll():e[t++].resolve();return this.resolve()},_.prototype.lookup=function(e,t,s){if("boolean"==typeof t?(s=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),d.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var n=this.get(e[0]);if(n){if(1===e.length){if(!t||t.indexOf(n.constructor)>-1)return n}else if(n instanceof _&&(n=n.lookup(e.slice(1),t,!0)))return n}else for(var a=0;a<this.nestedArray.length;++a)if(this._nestedArray[a]instanceof _&&(n=this._nestedArray[a].lookup(e,t,!0)))return n;return null===this.parent||s?null:this.parent.lookup(e,t)},_.prototype.lookupType=function(e){var t=this.lookup(e,[a]);if(!t)throw Error("no such type: "+e);return t},_.prototype.lookupEnum=function(e){var t=this.lookup(e,[c]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},_.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[a,c]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},_.prototype.lookupService=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},_._configure=function(e,t,s){a=e,o=t,c=s}},3243:(e,t,s)=>{"use strict";e.exports=o,o.className="ReflectionObject";var n,a=s(9935);function o(e,t){if(!a.isString(e))throw TypeError("name must be a string");if(t&&!a.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(o.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),o.prototype.toJSON=function(){throw Error()},o.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof n&&t._handleAdd(this)},o.prototype.onRemove=function(e){var t=e.root;t instanceof n&&t._handleRemove(this),this.parent=null,this.resolved=!1},o.prototype.resolve=function(){return this.resolved||this.root instanceof n&&(this.resolved=!0),this},o.prototype.getOption=function(e){if(this.options)return this.options[e]},o.prototype.setOption=function(e,t,s){return s&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},o.prototype.setParsedOption=function(e,t,s){this.parsedOptions||(this.parsedOptions=[]);var n=this.parsedOptions;if(s){var o=n.find((function(t){return Object.prototype.hasOwnProperty.call(t,e)}));if(o){var c=o[e];a.setProperty(c,s,t)}else(o={})[e]=a.setProperty({},s,t),n.push(o)}else{var u={};u[e]=t,n.push(u)}return this},o.prototype.setOptions=function(e,t){if(e)for(var s=Object.keys(e),n=0;n<s.length;++n)this.setOption(s[n],e[s[n]],t);return this},o.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},o._configure=function(e){n=e}},7598:(e,t,s)=>{"use strict";e.exports=c;var n=s(3243);((c.prototype=Object.create(n.prototype)).constructor=c).className="OneOf";var a=s(3548),o=s(9935);function c(e,t,s,a){if(Array.isArray(t)||(s=t,t=void 0),n.call(this,e,s),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=a}function u(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}c.fromJSON=function(e,t){return new c(e,t.oneof,t.options,t.comment)},c.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},c.prototype.add=function(e){if(!(e instanceof a))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,u(this),this},c.prototype.remove=function(e){if(!(e instanceof a))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},c.prototype.onAdd=function(e){n.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var s=e.get(this.oneof[t]);s&&!s.partOf&&(s.partOf=this,this.fieldsArray.push(s))}u(this)},c.prototype.onRemove=function(e){for(var t,s=0;s<this.fieldsArray.length;++s)(t=this.fieldsArray[s]).parent&&t.parent.remove(t);n.prototype.onRemove.call(this,e)},c.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,s){o.decorateType(t.constructor).add(new c(s,e)),Object.defineProperty(t,s,{get:o.oneOfGetter(e),set:o.oneOfSetter(e)})}}},1408:(e,t,s)=>{"use strict";e.exports=l;var n,a=s(9693),o=a.LongBits,c=a.utf8;function u(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var d,h="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},_=function(){return a.Buffer?function(e){return(l.create=function(e){return a.Buffer.isBuffer(e)?new n(e):h(e)})(e)}:h};function p(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw u(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw u(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function m(){if(this.pos+8>this.len)throw u(this,8);return new o(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}l.create=_(),l.prototype._slice=a.Array.prototype.subarray||a.Array.prototype.slice,l.prototype.uint32=(d=4294967295,function(){if(d=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return d;if(d=(d|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return d;if(d=(d|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return d;if(d=(d|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return d;if(d=(d|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return d;if((this.pos+=5)>this.len)throw this.pos=this.len,u(this,10);return d}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw u(this,4);return f(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw u(this,4);return 0|f(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw u(this,4);var e=a.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw u(this,4);var e=a.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,s=this.pos+e;if(s>this.len)throw u(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,s):t===s?new this.buf.constructor(0):this._slice.call(this.buf,t,s)},l.prototype.string=function(){var e=this.bytes();return c.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw u(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw u(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){n=e,l.create=_(),n._configure();var t=a.Long?"toLong":"toNumber";a.merge(l.prototype,{int64:function(){return p.call(this)[t](!1)},uint64:function(){return p.call(this)[t](!0)},sint64:function(){return p.call(this).zzDecode()[t](!1)},fixed64:function(){return m.call(this)[t](!0)},sfixed64:function(){return m.call(this)[t](!1)}})}},593:(e,t,s)=>{"use strict";e.exports=o;var n=s(1408);(o.prototype=Object.create(n.prototype)).constructor=o;var a=s(9693);function o(e){n.call(this,e)}o._configure=function(){a.Buffer&&(o.prototype._slice=a.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},9424:(e,t,s)=>{"use strict";e.exports=_;var n=s(9313);((_.prototype=Object.create(n.prototype)).constructor=_).className="Root";var a,o,c,u=s(3548),l=s(7025),d=s(7598),h=s(9935);function _(e){n.call(this,"",e),this.deferred=[],this.files=[]}function p(){}_.fromJSON=function(e,t){return t||(t=new _),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},_.prototype.resolvePath=h.path.resolve,_.prototype.fetch=h.fetch,_.prototype.load=function e(t,s,n){"function"==typeof s&&(n=s,s=void 0);var a=this;if(!n)return h.asPromise(e,a,t,s);var u=n===p;function l(e,t){if(n){var s=n;if(n=null,u)throw e;s(e,t)}}function d(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var s=e.substring(t);if(s in c)return s}return null}function _(e,t){try{if(h.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),h.isString(t)){o.filename=e;var n,c=o(t,a,s),_=0;if(c.imports)for(;_<c.imports.length;++_)(n=d(c.imports[_])||a.resolvePath(e,c.imports[_]))&&f(n);if(c.weakImports)for(_=0;_<c.weakImports.length;++_)(n=d(c.weakImports[_])||a.resolvePath(e,c.weakImports[_]))&&f(n,!0)}else a.setOptions(t.options).addJSON(t.nested)}catch(e){l(e)}u||m||l(null,a)}function f(e,t){if(!(a.files.indexOf(e)>-1))if(a.files.push(e),e in c)u?_(e,c[e]):(++m,setTimeout((function(){--m,_(e,c[e])})));else if(u){var s;try{s=h.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||l(e))}_(e,s)}else++m,a.fetch(e,(function(s,o){--m,n&&(s?t?m||l(null,a):l(s):_(e,o))}))}var m=0;h.isString(t)&&(t=[t]);for(var y,w=0;w<t.length;++w)(y=a.resolvePath("",t[w]))&&f(y);if(u)return a;m||l(null,a)},_.prototype.loadSync=function(e,t){if(!h.isNode)throw Error("not supported");return this.load(e,t,p)},_.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return n.prototype.resolveAll.call(this)};var f=/^[A-Z]/;function m(e,t){var s=t.parent.lookup(t.extend);if(s){var n=new u(t.fullName,t.id,t.type,t.rule,void 0,t.options);return n.declaringField=t,t.extensionField=n,s.add(n),!0}return!1}_.prototype._handleAdd=function(e){if(e instanceof u)void 0===e.extend||e.extensionField||m(0,e)||this.deferred.push(e);else if(e instanceof l)f.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof d)){if(e instanceof a)for(var t=0;t<this.deferred.length;)m(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var s=0;s<e.nestedArray.length;++s)this._handleAdd(e._nestedArray[s]);f.test(e.name)&&(e.parent[e.name]=e)}},_.prototype._handleRemove=function(e){if(e instanceof u){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof l)f.test(e.name)&&delete e.parent[e.name];else if(e instanceof n){for(var s=0;s<e.nestedArray.length;++s)this._handleRemove(e._nestedArray[s]);f.test(e.name)&&delete e.parent[e.name]}},_._configure=function(e,t,s){a=e,o=t,c=s}},5054:e=>{"use strict";e.exports={}},5994:(e,t,s)=>{"use strict";t.Service=s(7948)},7948:(e,t,s)=>{"use strict";e.exports=a;var n=s(9693);function a(e,t,s){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(s)}(a.prototype=Object.create(n.EventEmitter.prototype)).constructor=a,a.prototype.rpcCall=function e(t,s,a,o,c){if(!o)throw TypeError("request must be specified");var u=this;if(!c)return n.asPromise(e,u,t,s,a,o);if(u.rpcImpl)try{return u.rpcImpl(t,s[u.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,s){if(e)return u.emit("error",e,t),c(e);if(null!==s){if(!(s instanceof a))try{s=a[u.responseDelimited?"decodeDelimited":"decode"](s)}catch(e){return u.emit("error",e,t),c(e)}return u.emit("data",s,t),c(null,s)}u.end(!0)}))}catch(e){return u.emit("error",e,t),void setTimeout((function(){c(e)}),0)}else setTimeout((function(){c(Error("already ended"))}),0)},a.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},7513:(e,t,s)=>{"use strict";e.exports=u;var n=s(9313);((u.prototype=Object.create(n.prototype)).constructor=u).className="Service";var a=s(4429),o=s(9935),c=s(5994);function u(e,t){n.call(this,e,t),this.methods={},this._methodsArray=null}function l(e){return e._methodsArray=null,e}u.fromJSON=function(e,t){var s=new u(e,t.options);if(t.methods)for(var n=Object.keys(t.methods),o=0;o<n.length;++o)s.add(a.fromJSON(n[o],t.methods[n[o]]));return t.nested&&s.addJSON(t.nested),s.comment=t.comment,s},u.prototype.toJSON=function(e){var t=n.prototype.toJSON.call(this,e),s=!!e&&Boolean(e.keepComments);return o.toObject(["options",t&&t.options||void 0,"methods",n.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",s?this.comment:void 0])},Object.defineProperty(u.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=o.toArray(this.methods))}}),u.prototype.get=function(e){return this.methods[e]||n.prototype.get.call(this,e)},u.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return n.prototype.resolve.call(this)},u.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof a?(this.methods[e.name]=e,e.parent=this,l(this)):n.prototype.add.call(this,e)},u.prototype.remove=function(e){if(e instanceof a){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,l(this)}return n.prototype.remove.call(this,e)},u.prototype.create=function(e,t,s){for(var n,a=new c.Service(e,t,s),u=0;u<this.methodsArray.length;++u){var l=o.lcFirst((n=this._methodsArray[u]).resolve().name).replace(/[^$\w_]/g,"");a[l]=o.codegen(["r","c"],o.isReserved(l)?l+"_":l)("return this.rpcCall(m,q,s,r,c)")({m:n,q:n.resolvedRequestType.ctor,s:n.resolvedResponseType.ctor})}return a}},7645:(e,t,s)=>{"use strict";e.exports=v;var n=s(9313);((v.prototype=Object.create(n.prototype)).constructor=v).className="Type";var a=s(7025),o=s(7598),c=s(3548),u=s(6039),l=s(7513),d=s(8368),h=s(1408),_=s(1173),p=s(9935),f=s(4928),m=s(5305),y=s(4497),w=s(3996),g=s(1667);function v(e,t){n.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function E(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(v.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var s=this.fields[e[t]],n=s.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=s}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=p.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=p.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=v.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof d||((e.prototype=new d).constructor=e,p.merge(e.prototype,t)),e.$type=e.prototype.$type=this,p.merge(e,d,!0),this._ctor=e;for(var s=0;s<this.fieldsArray.length;++s)this._fieldsArray[s].resolve();var n={};for(s=0;s<this.oneofsArray.length;++s)n[this._oneofsArray[s].resolve().name]={get:p.oneOfGetter(this._oneofsArray[s].oneof),set:p.oneOfSetter(this._oneofsArray[s].oneof)};s&&Object.defineProperties(e.prototype,n)}}}),v.generateConstructor=function(e){for(var t,s=p.codegen(["p"],e.name),n=0;n<e.fieldsArray.length;++n)(t=e._fieldsArray[n]).map?s("this%s={}",p.safeProp(t.name)):t.repeated&&s("this%s=[]",p.safeProp(t.name));return s("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},v.fromJSON=function(e,t){var s=new v(e,t.options);s.extensions=t.extensions,s.reserved=t.reserved;for(var d=Object.keys(t.fields),h=0;h<d.length;++h)s.add((void 0!==t.fields[d[h]].keyType?u.fromJSON:c.fromJSON)(d[h],t.fields[d[h]]));if(t.oneofs)for(d=Object.keys(t.oneofs),h=0;h<d.length;++h)s.add(o.fromJSON(d[h],t.oneofs[d[h]]));if(t.nested)for(d=Object.keys(t.nested),h=0;h<d.length;++h){var _=t.nested[d[h]];s.add((void 0!==_.id?c.fromJSON:void 0!==_.fields?v.fromJSON:void 0!==_.values?a.fromJSON:void 0!==_.methods?l.fromJSON:n.fromJSON)(d[h],_))}return t.extensions&&t.extensions.length&&(s.extensions=t.extensions),t.reserved&&t.reserved.length&&(s.reserved=t.reserved),t.group&&(s.group=!0),t.comment&&(s.comment=t.comment),s},v.prototype.toJSON=function(e){var t=n.prototype.toJSON.call(this,e),s=!!e&&Boolean(e.keepComments);return p.toObject(["options",t&&t.options||void 0,"oneofs",n.arrayToJSON(this.oneofsArray,e),"fields",n.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",s?this.comment:void 0])},v.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var s=this.oneofsArray;for(t=0;t<s.length;)s[t++].resolve();return n.prototype.resolveAll.call(this)},v.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},v.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof c&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),E(this)}return e instanceof o?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),E(this)):n.prototype.add.call(this,e)},v.prototype.remove=function(e){if(e instanceof c&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),E(this)}if(e instanceof o){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),E(this)}return n.prototype.remove.call(this,e)},v.prototype.isReservedId=function(e){return n.isReservedId(this.reserved,e)},v.prototype.isReservedName=function(e){return n.isReservedName(this.reserved,e)},v.prototype.create=function(e){return new this.ctor(e)},v.prototype.setup=function(){for(var e=this.fullName,t=[],s=0;s<this.fieldsArray.length;++s)t.push(this._fieldsArray[s].resolve().resolvedType);this.encode=f(this)({Writer:_,types:t,util:p}),this.decode=m(this)({Reader:h,types:t,util:p}),this.verify=y(this)({types:t,util:p}),this.fromObject=w.fromObject(this)({types:t,util:p}),this.toObject=w.toObject(this)({types:t,util:p});var n=g[e];if(n){var a=Object.create(this);a.fromObject=this.fromObject,this.fromObject=n.fromObject.bind(a),a.toObject=this.toObject,this.toObject=n.toObject.bind(a)}return this},v.prototype.encode=function(e,t){return this.setup().encode(e,t)},v.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},v.prototype.decode=function(e,t){return this.setup().decode(e,t)},v.prototype.decodeDelimited=function(e){return e instanceof h||(e=h.create(e)),this.decode(e,e.uint32())},v.prototype.verify=function(e){return this.setup().verify(e)},v.prototype.fromObject=function(e){return this.setup().fromObject(e)},v.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},v.d=function(e){return function(t){p.decorateType(t,e)}}},7063:(e,t,s)=>{"use strict";var n=t,a=s(9935),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function c(e,t){var s=0,n={};for(t|=0;s<e.length;)n[o[s+t]]=e[s++];return n}n.basic=c([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),n.defaults=c([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",a.emptyArray,null]),n.long=c([0,0,0,1,1],7),n.mapKey=c([0,0,0,5,5,0,0,0,1,1,0,2],2),n.packed=c([1,5,0,0,0,5,5,0,0,0,1,1,0])},9935:(e,t,s)=>{"use strict";var n,a,o=e.exports=s(9693),c=s(5054);o.codegen=s(5124),o.fetch=s(9054),o.path=s(8626),o.fs=o.inquire("fs"),o.toArray=function(e){if(e){for(var t=Object.keys(e),s=new Array(t.length),n=0;n<t.length;)s[n]=e[t[n++]];return s}return[]},o.toObject=function(e){for(var t={},s=0;s<e.length;){var n=e[s++],a=e[s++];void 0!==a&&(t[n]=a)}return t};var u=/\\/g,l=/"/g;o.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},o.safeProp=function(e){return!/^[$\w_]+$/.test(e)||o.isReserved(e)?'["'+e.replace(u,"\\\\").replace(l,'\\"')+'"]':"."+e},o.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var d=/_([a-z])/g;o.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(d,(function(e,t){return t.toUpperCase()}))},o.compareFieldsById=function(e,t){return e.id-t.id},o.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(o.decorateRoot.remove(e.$type),e.$type.name=t,o.decorateRoot.add(e.$type)),e.$type;n||(n=s(7645));var a=new n(t||e.name);return o.decorateRoot.add(a),a.ctor=e,Object.defineProperty(e,"$type",{value:a,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:a,enumerable:!1}),a};var h=0;o.decorateEnum=function(e){if(e.$type)return e.$type;a||(a=s(7025));var t=new a("Enum"+h++,e);return o.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},o.setProperty=function(e,t,s){if("object"!=typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return function e(t,s,n){var a=s.shift();if("__proto__"===a)return t;if(s.length>0)t[a]=e(t[a]||{},s,n);else{var o=t[a];o&&(n=[].concat(o).concat(n)),t[a]=n}return t}(e,t=t.split("."),s)},Object.defineProperty(o,"decorateRoot",{get:function(){return c.decorated||(c.decorated=new(s(9424)))}})},1945:(e,t,s)=>{"use strict";e.exports=a;var n=s(9693);function a(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=a.zero=new a(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var c=a.zeroHash="\0\0\0\0\0\0\0\0";a.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var s=e>>>0,n=(e-s)/4294967296>>>0;return t&&(n=~n>>>0,s=~s>>>0,++s>4294967295&&(s=0,++n>4294967295&&(n=0))),new a(s,n)},a.from=function(e){if("number"==typeof e)return a.fromNumber(e);if(n.isString(e)){if(!n.Long)return a.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new a(e.low>>>0,e.high>>>0):o},a.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,s=~this.hi>>>0;return t||(s=s+1>>>0),-(t+4294967296*s)}return this.lo+4294967296*this.hi},a.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var u=String.prototype.charCodeAt;a.fromHash=function(e){return e===c?o:new a((u.call(e,0)|u.call(e,1)<<8|u.call(e,2)<<16|u.call(e,3)<<24)>>>0,(u.call(e,4)|u.call(e,5)<<8|u.call(e,6)<<16|u.call(e,7)<<24)>>>0)},a.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},a.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},a.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},a.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,s=this.hi>>>24;return 0===s?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:s<128?9:10}},9693:function(e,t,s){"use strict";var n=t;function a(e,t,s){for(var n=Object.keys(t),a=0;a<n.length;++a)void 0!==e[n[a]]&&s||(e[n[a]]=t[n[a]]);return e}function o(e){function t(e,s){if(!(this instanceof t))return new t(e,s);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),s&&a(this,s)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=s(4537),n.base64=s(7419),n.EventEmitter=s(9211),n.float=s(945),n.inquire=s(7199),n.utf8=s(4997),n.pool=s(6662),n.LongBits=s(1945),n.isNode=Boolean(void 0!==s.g&&s.g&&s.g.process&&s.g.process.versions&&s.g.process.versions.node),n.global=n.isNode&&s.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var s=e[t];return!(null==s||!e.hasOwnProperty(t))&&("object"!=typeof s||(Array.isArray(s)?s.length:Object.keys(s).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var s=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(s.lo,s.hi,t):s.toNumber(Boolean(t))},n.merge=a,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=o,n.ProtocolError=o("ProtocolError"),n.oneOfGetter=function(e){for(var t={},s=0;s<e.length;++s)t[e[s]]=1;return function(){for(var e=Object.keys(this),s=e.length-1;s>-1;--s)if(1===t[e[s]]&&void 0!==this[e[s]]&&null!==this[e[s]])return e[s]}},n.oneOfSetter=function(e){return function(t){for(var s=0;s<e.length;++s)e[s]!==t&&delete this[e[s]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,s){return new e(t,s)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},4497:(e,t,s)=>{"use strict";e.exports=function(e){var t=a.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),s=e.oneofsArray,n={};s.length&&t("var p={}");for(var l=0;l<e.fieldsArray.length;++l){var d=e._fieldsArray[l].resolve(),h="m"+a.safeProp(d.name);if(d.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",h,d.name),d.map)t("if(!util.isObject(%s))",h)("return%j",o(d,"object"))("var k=Object.keys(%s)",h)("for(var i=0;i<k.length;++i){"),u(t,d,"k[i]"),c(t,d,l,h+"[k[i]]")("}");else if(d.repeated)t("if(!Array.isArray(%s))",h)("return%j",o(d,"array"))("for(var i=0;i<%s.length;++i){",h),c(t,d,l,h+"[i]")("}");else{if(d.partOf){var _=a.safeProp(d.partOf.name);1===n[d.partOf.name]&&t("if(p%s===1)",_)("return%j",d.partOf.name+": multiple values"),n[d.partOf.name]=1,t("p%s=1",_)}c(t,d,l,h)}d.optional&&t("}")}return t("return null")};var n=s(7025),a=s(9935);function o(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function c(e,t,s,a){if(t.resolvedType)if(t.resolvedType instanceof n){e("switch(%s){",a)("default:")("return%j",o(t,"enum value"));for(var c=Object.keys(t.resolvedType.values),u=0;u<c.length;++u)e("case %i:",t.resolvedType.values[c[u]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",s,a)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",a)("return%j",o(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",a,a,a,a)("return%j",o(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',a)("return%j",o(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',a)("return%j",o(t,"boolean"));break;case"string":e("if(!util.isString(%s))",a)("return%j",o(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',a,a,a)("return%j",o(t,"buffer"))}return e}function u(e,t,s){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",s)("return%j",o(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",s)("return%j",o(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",s)("return%j",o(t,"boolean key"))}return e}},1667:(e,t,s)=>{"use strict";var n=t,a=s(8368);n[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),s=this.lookup(t);if(s){var n="."===e["@type"].charAt(0)?e["@type"].substr(1):e["@type"];return-1===n.indexOf("/")&&(n="/"+n),this.create({type_url:n,value:s.encode(s.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var s="",n="";if(t&&t.json&&e.type_url&&e.value){n=e.type_url.substring(e.type_url.lastIndexOf("/")+1),s=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var o=this.lookup(n);o&&(e=o.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof a){var c=e.$type.toObject(e,t);return""===s&&(s="type.googleapis.com/"),n=s+("."===e.$type.fullName[0]?e.$type.fullName.substr(1):e.$type.fullName),c["@type"]=n,c}return this.toObject(e,t)}}},1173:(e,t,s)=>{"use strict";e.exports=_;var n,a=s(9693),o=a.LongBits,c=a.base64,u=a.utf8;function l(e,t,s){this.fn=e,this.len=t,this.next=void 0,this.val=s}function d(){}function h(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function _(){this.len=0,this.head=new l(d,0,0),this.tail=this.head,this.states=null}var p=function(){return a.Buffer?function(){return(_.create=function(){return new n})()}:function(){return new _}};function f(e,t,s){t[s]=255&e}function m(e,t){this.len=e,this.next=void 0,this.val=t}function y(e,t,s){for(;e.hi;)t[s++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[s++]=127&e.lo|128,e.lo=e.lo>>>7;t[s++]=e.lo}function w(e,t,s){t[s]=255&e,t[s+1]=e>>>8&255,t[s+2]=e>>>16&255,t[s+3]=e>>>24}_.create=p(),_.alloc=function(e){return new a.Array(e)},a.Array!==Array&&(_.alloc=a.pool(_.alloc,a.Array.prototype.subarray)),_.prototype._push=function(e,t,s){return this.tail=this.tail.next=new l(e,t,s),this.len+=t,this},m.prototype=Object.create(l.prototype),m.prototype.fn=function(e,t,s){for(;e>127;)t[s++]=127&e|128,e>>>=7;t[s]=e},_.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new m((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},_.prototype.int32=function(e){return e<0?this._push(y,10,o.fromNumber(e)):this.uint32(e)},_.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},_.prototype.uint64=function(e){var t=o.from(e);return this._push(y,t.length(),t)},_.prototype.int64=_.prototype.uint64,_.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(y,t.length(),t)},_.prototype.bool=function(e){return this._push(f,1,e?1:0)},_.prototype.fixed32=function(e){return this._push(w,4,e>>>0)},_.prototype.sfixed32=_.prototype.fixed32,_.prototype.fixed64=function(e){var t=o.from(e);return this._push(w,4,t.lo)._push(w,4,t.hi)},_.prototype.sfixed64=_.prototype.fixed64,_.prototype.float=function(e){return this._push(a.float.writeFloatLE,4,e)},_.prototype.double=function(e){return this._push(a.float.writeDoubleLE,8,e)};var g=a.Array.prototype.set?function(e,t,s){t.set(e,s)}:function(e,t,s){for(var n=0;n<e.length;++n)t[s+n]=e[n]};_.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(a.isString(e)){var s=_.alloc(t=c.length(e));c.decode(e,s,0),e=s}return this.uint32(t)._push(g,t,e)},_.prototype.string=function(e){var t=u.length(e);return t?this.uint32(t)._push(u.write,t,e):this._push(f,1,0)},_.prototype.fork=function(){return this.states=new h(this),this.head=this.tail=new l(d,0,0),this.len=0,this},_.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(d,0,0),this.len=0),this},_.prototype.ldelim=function(){var e=this.head,t=this.tail,s=this.len;return this.reset().uint32(s),s&&(this.tail.next=e.next,this.tail=t,this.len+=s),this},_.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),s=0;e;)e.fn(e.val,t,s),s+=e.len,e=e.next;return t},_._configure=function(e){n=e,_.create=p(),n._configure()}},3155:(e,t,s)=>{"use strict";e.exports=o;var n=s(1173);(o.prototype=Object.create(n.prototype)).constructor=o;var a=s(9693);function o(){n.call(this)}function c(e,t,s){e.length<40?a.utf8.write(e,t,s):t.utf8Write?t.utf8Write(e,s):t.write(e,s)}o._configure=function(){o.alloc=a._Buffer_allocUnsafe,o.writeBytesBuffer=a.Buffer&&a.Buffer.prototype instanceof Uint8Array&&"set"===a.Buffer.prototype.set.name?function(e,t,s){t.set(e,s)}:function(e,t,s){if(e.copy)e.copy(t,s,0,e.length);else for(var n=0;n<e.length;)t[s++]=e[n++]}},o.prototype.bytes=function(e){a.isString(e)&&(e=a._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=a.Buffer.byteLength(e);return this.uint32(t),t&&this._push(c,t,e),this},o._configure()},9911:(e,t)=>{"use strict";function s(e,t,s){var n;if(void 0===s&&(s={}),!t.codes){t.codes={};for(var a=0;a<t.chars.length;++a)t.codes[t.chars[a]]=a}if(!s.loose&&e.length*t.bits&7)throw new SyntaxError("Invalid padding");for(var o=e.length;"="===e[o-1];)if(--o,!(s.loose||(e.length-o)*t.bits&7))throw new SyntaxError("Invalid padding");for(var c=new(null!=(n=s.out)?n:Uint8Array)(o*t.bits/8|0),u=0,l=0,d=0,h=0;h<o;++h){var _=t.codes[e[h]];if(void 0===_)throw new SyntaxError("Invalid character "+e[h]);l=l<<t.bits|_,(u+=t.bits)>=8&&(u-=8,c[d++]=255&l>>u)}if(u>=t.bits||255&l<<8-u)throw new SyntaxError("Unexpected end of data");return c}function n(e,t,s){void 0===s&&(s={});for(var n=s.pad,a=void 0===n||n,o=(1<<t.bits)-1,c="",u=0,l=0,d=0;d<e.length;++d)for(l=l<<8|255&e[d],u+=8;u>t.bits;)u-=t.bits,c+=t.chars[o&l>>u];if(u&&(c+=t.chars[o&l<<t.bits-u]),a)for(;c.length*t.bits&7;)c+="=";return c}Object.defineProperty(t,"__esModule",{value:!0});var a={chars:"0123456789ABCDEF",bits:4},o={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bits:5},c={chars:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bits:5},u={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bits:6},l={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bits:6},d={parse:function(e,t){return s(e.toUpperCase(),a,t)},stringify:function(e,t){return n(e,a,t)}},h={parse:function(e,t){return void 0===t&&(t={}),s(t.loose?e.toUpperCase().replace(/0/g,"O").replace(/1/g,"L").replace(/8/g,"B"):e,o,t)},stringify:function(e,t){return n(e,o,t)}},_={parse:function(e,t){return s(e,c,t)},stringify:function(e,t){return n(e,c,t)}},p={parse:function(e,t){return s(e,u,t)},stringify:function(e,t){return n(e,u,t)}},f={parse:function(e,t){return s(e,l,t)},stringify:function(e,t){return n(e,l,t)}},m={parse:s,stringify:n};t.base16=d,t.base32=h,t.base32hex=_,t.base64=p,t.base64url=f,t.codec=m},8280:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZodError=t.quotelessJson=t.ZodIssueCode=void 0;const n=s(9110);t.ZodIssueCode=n.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);t.quotelessJson=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class ZodError extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},s={_errors:[]},n=e=>{for(const a of e.issues)if("invalid_union"===a.code)a.unionErrors.map(n);else if("invalid_return_type"===a.code)n(a.returnTypeError);else if("invalid_arguments"===a.code)n(a.argumentsError);else if(0===a.path.length)s._errors.push(t(a));else{let e=s,n=0;for(;n<a.path.length;){const s=a.path[n];n===a.path.length-1?(e[s]=e[s]||{_errors:[]},e[s]._errors.push(t(a))):e[s]=e[s]||{_errors:[]},e=e[s],n++}}};return n(this),s}toString(){return this.message}get message(){return JSON.stringify(this.issues,n.util.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=(e=>e.message)){const t={},s=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:t}}get formErrors(){return this.flatten()}}t.ZodError=ZodError,ZodError.create=e=>new ZodError(e)},6996:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorMap=t.setErrorMap=t.defaultErrorMap=void 0;const a=n(s(9349));t.defaultErrorMap=a.default;let o=a.default;t.setErrorMap=function(e){o=e},t.getErrorMap=function(){return o}},6349:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,n){void 0===n&&(n=s),e[n]=t[s]}),a=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),a(s(6996),t),a(s(3187),t),a(s(116),t),a(s(9110),t),a(s(5433),t),a(s(8280),t)},8762:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorUtil=void 0,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(t.errorUtil||(t.errorUtil={}))},3187:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isAsync=t.isValid=t.isDirty=t.isAborted=t.OK=t.DIRTY=t.INVALID=t.ParseStatus=t.addIssueToContext=t.EMPTY_PATH=t.makeIssue=void 0;const a=s(6996),o=n(s(9349));t.makeIssue=e=>{const{data:t,path:s,errorMaps:n,issueData:a}=e,o=[...s,...a.path||[]],c={...a,path:o};let u="";const l=n.filter((e=>!!e)).slice().reverse();for(const e of l)u=e(c,{data:t,defaultError:u}).message;return{...a,path:o,message:a.message||u}},t.EMPTY_PATH=[],t.addIssueToContext=function(e,s){const n=(0,t.makeIssue)({issueData:s,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,(0,a.getErrorMap)(),o.default].filter((e=>!!e))});e.common.issues.push(n)};class ParseStatus{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,s){const n=[];for(const a of s){if("aborted"===a.status)return t.INVALID;"dirty"===a.status&&e.dirty(),n.push(a.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const s=[];for(const e of t)s.push({key:await e.key,value:await e.value});return ParseStatus.mergeObjectSync(e,s)}static mergeObjectSync(e,s){const n={};for(const a of s){const{key:s,value:o}=a;if("aborted"===s.status)return t.INVALID;if("aborted"===o.status)return t.INVALID;"dirty"===s.status&&e.dirty(),"dirty"===o.status&&e.dirty(),(void 0!==o.value||a.alwaysSet)&&(n[s.value]=o.value)}return{status:e.value,value:n}}}t.ParseStatus=ParseStatus,t.INVALID=Object.freeze({status:"aborted"});t.DIRTY=e=>({status:"dirty",value:e});t.OK=e=>({status:"valid",value:e});t.isAborted=e=>"aborted"===e.status;t.isDirty=e=>"dirty"===e.status;t.isValid=e=>"valid"===e.status;t.isAsync=e=>"undefined"!=typeof Promise&&e instanceof Promise},116:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9110:(e,t)=>{"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.getParsedType=t.ZodParsedType=t.objectUtil=t.util=void 0,function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const s of e)t[s]=s;return t},e.getValidEnumValues=t=>{const s=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),n={};for(const e of s)n[e]=t[e];return e.objectValues(n)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.push(s);return t},e.find=(e,t)=>{for(const s of e)if(t(s))return s},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(s=t.util||(t.util={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(t.objectUtil||(t.objectUtil={})),t.ZodParsedType=s.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]);t.getParsedType=e=>{switch(typeof e){case"undefined":return t.ZodParsedType.undefined;case"string":return t.ZodParsedType.string;case"number":return isNaN(e)?t.ZodParsedType.nan:t.ZodParsedType.number;case"boolean":return t.ZodParsedType.boolean;case"function":return t.ZodParsedType.function;case"bigint":return t.ZodParsedType.bigint;case"symbol":return t.ZodParsedType.symbol;case"object":return Array.isArray(e)?t.ZodParsedType.array:null===e?t.ZodParsedType.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?t.ZodParsedType.promise:"undefined"!=typeof Map&&e instanceof Map?t.ZodParsedType.map:"undefined"!=typeof Set&&e instanceof Set?t.ZodParsedType.set:"undefined"!=typeof Date&&e instanceof Date?t.ZodParsedType.date:t.ZodParsedType.object;default:return t.ZodParsedType.unknown}}},8754:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,n){void 0===n&&(n=s),e[n]=t[s]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&n(t,e,s);return a(t,e),t},c=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.z=void 0;const u=o(s(6349));t.z=u,c(s(6349),t),t.default=u},9349:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(9110),a=s(8280);t.default=(e,t)=>{let s;switch(e.code){case a.ZodIssueCode.invalid_type:s=e.received===n.ZodParsedType.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case a.ZodIssueCode.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(e.expected,n.util.jsonStringifyReplacer)}`;break;case a.ZodIssueCode.unrecognized_keys:s=`Unrecognized key(s) in object: ${n.util.joinValues(e.keys,", ")}`;break;case a.ZodIssueCode.invalid_union:s="Invalid input";break;case a.ZodIssueCode.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${n.util.joinValues(e.options)}`;break;case a.ZodIssueCode.invalid_enum_value:s=`Invalid enum value. Expected ${n.util.joinValues(e.options)}, received '${e.received}'`;break;case a.ZodIssueCode.invalid_arguments:s="Invalid function arguments";break;case a.ZodIssueCode.invalid_return_type:s="Invalid function return type";break;case a.ZodIssueCode.invalid_date:s="Invalid date";break;case a.ZodIssueCode.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(s=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(s=`${s} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?s=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?s=`Invalid input: must end with "${e.validation.endsWith}"`:n.util.assertNever(e.validation):s="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case a.ZodIssueCode.too_small:s="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case a.ZodIssueCode.too_big:s="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case a.ZodIssueCode.custom:s="Invalid input";break;case a.ZodIssueCode.invalid_intersection_types:s="Intersection results could not be merged";break;case a.ZodIssueCode.not_multiple_of:s=`Number must be a multiple of ${e.multipleOf}`;break;case a.ZodIssueCode.not_finite:s="Number must be finite";break;default:s=t.defaultError,n.util.assertNever(e)}return{message:s}}},5433:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.discriminatedUnion=t.date=t.boolean=t.bigint=t.array=t.any=t.coerce=t.ZodFirstPartyTypeKind=t.late=t.ZodSchema=t.Schema=t.custom=t.ZodPipeline=t.ZodBranded=t.BRAND=t.ZodNaN=t.ZodCatch=t.ZodDefault=t.ZodNullable=t.ZodOptional=t.ZodTransformer=t.ZodEffects=t.ZodPromise=t.ZodNativeEnum=t.ZodEnum=t.ZodLiteral=t.ZodLazy=t.ZodFunction=t.ZodSet=t.ZodMap=t.ZodRecord=t.ZodTuple=t.ZodIntersection=t.ZodDiscriminatedUnion=t.ZodUnion=t.ZodObject=t.ZodArray=t.ZodVoid=t.ZodNever=t.ZodUnknown=t.ZodAny=t.ZodNull=t.ZodUndefined=t.ZodSymbol=t.ZodDate=t.ZodBoolean=t.ZodBigInt=t.ZodNumber=t.ZodString=t.ZodType=void 0,t.NEVER=t.void=t.unknown=t.union=t.undefined=t.tuple=t.transformer=t.symbol=t.string=t.strictObject=t.set=t.record=t.promise=t.preprocess=t.pipeline=t.ostring=t.optional=t.onumber=t.oboolean=t.object=t.number=t.nullable=t.null=t.never=t.nativeEnum=t.nan=t.map=t.literal=t.lazy=t.intersection=t.instanceof=t.function=t.enum=t.effect=void 0;const n=s(6996),a=s(8762),o=s(3187),c=s(9110),u=s(8280);class ParseInputLazyPath{constructor(e,t,s,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const l=(e,t)=>{if((0,o.isValid)(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new u.ZodError(e.common.issues);return this._error=t,this._error}}};function d(e){if(!e)return{};const{errorMap:t,invalid_type_error:s,required_error:n,description:a}=e;if(t&&(s||n))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:a};return{errorMap:(e,t)=>"invalid_type"!==e.code?{message:t.defaultError}:void 0===t.data?{message:null!=n?n:t.defaultError}:{message:null!=s?s:t.defaultError},description:a}}class ZodType{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return(0,c.getParsedType)(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:(0,c.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new o.ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:(0,c.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if((0,o.isAsync)(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const s=this.safeParse(e,t);if(s.success)return s.data;throw s.error}safeParse(e,t){var s;const n={common:{issues:[],async:null!==(s=null==t?void 0:t.async)&&void 0!==s&&s,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,c.getParsedType)(e)},a=this._parseSync({data:e,path:n.path,parent:n});return l(n,a)}async parseAsync(e,t){const s=await this.safeParseAsync(e,t);if(s.success)return s.data;throw s.error}async safeParseAsync(e,t){const s={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,c.getParsedType)(e)},n=this._parse({data:e,path:s.path,parent:s}),a=await((0,o.isAsync)(n)?n:Promise.resolve(n));return l(s,a)}refine(e,t){const s=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,n)=>{const a=e(t),o=()=>n.addIssue({code:u.ZodIssueCode.custom,...s(t)});return"undefined"!=typeof Promise&&a instanceof Promise?a.then((e=>!!e||(o(),!1))):!!a||(o(),!1)}))}refinement(e,t){return this._refinement(((s,n)=>!!e(s)||(n.addIssue("function"==typeof t?t(s,n):t),!1)))}_refinement(e){return new ZodEffects({schema:this,typeName:C.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this,this._def)}promise(){return ZodPromise.create(this,this._def)}or(e){return ZodUnion.create([this,e],this._def)}and(e){return ZodIntersection.create(this,e,this._def)}transform(e){return new ZodEffects({...d(this._def),schema:this,typeName:C.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new ZodDefault({...d(this._def),innerType:this,defaultValue:t,typeName:C.ZodDefault})}brand(){return new ZodBranded({typeName:C.ZodBranded,type:this,...d(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new ZodCatch({...d(this._def),innerType:this,catchValue:t,typeName:C.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return ZodPipeline.create(this,e)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}t.ZodType=ZodType,t.Schema=ZodType,t.ZodSchema=ZodType;const h=/^c[^\s-]{8,}$/i,_=/^[a-z][a-z0-9]*$/,p=/[0-9A-HJKMNP-TV-Z]{26}/,f=/^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i,m=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\])|(\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\.[A-Za-z]{2,})+))$/,y=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,w=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,g=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;class ZodString extends ZodType{constructor(){super(...arguments),this._regex=(e,t,s)=>this.refinement((t=>e.test(t)),{validation:t,code:u.ZodIssueCode.invalid_string,...a.errorUtil.errToObj(s)}),this.nonempty=e=>this.min(1,a.errorUtil.errToObj(e)),this.trim=()=>new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==c.ZodParsedType.string){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.string,received:t.parsedType}),o.INVALID}const t=new o.ParseStatus;let s;for(const d of this._def.checks)if("min"===d.kind)e.data.length<d.value&&(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.too_small,minimum:d.value,type:"string",inclusive:!0,exact:!1,message:d.message}),t.dirty());else if("max"===d.kind)e.data.length>d.value&&(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.too_big,maximum:d.value,type:"string",inclusive:!0,exact:!1,message:d.message}),t.dirty());else if("length"===d.kind){const n=e.data.length>d.value,a=e.data.length<d.value;(n||a)&&(s=this._getOrReturnCtx(e,s),n?(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.too_big,maximum:d.value,type:"string",inclusive:!0,exact:!0,message:d.message}):a&&(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.too_small,minimum:d.value,type:"string",inclusive:!0,exact:!0,message:d.message}),t.dirty())}else if("email"===d.kind)m.test(e.data)||(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{validation:"email",code:u.ZodIssueCode.invalid_string,message:d.message}),t.dirty());else if("emoji"===d.kind)y.test(e.data)||(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{validation:"emoji",code:u.ZodIssueCode.invalid_string,message:d.message}),t.dirty());else if("uuid"===d.kind)f.test(e.data)||(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{validation:"uuid",code:u.ZodIssueCode.invalid_string,message:d.message}),t.dirty());else if("cuid"===d.kind)h.test(e.data)||(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{validation:"cuid",code:u.ZodIssueCode.invalid_string,message:d.message}),t.dirty());else if("cuid2"===d.kind)_.test(e.data)||(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{validation:"cuid2",code:u.ZodIssueCode.invalid_string,message:d.message}),t.dirty());else if("ulid"===d.kind)p.test(e.data)||(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{validation:"ulid",code:u.ZodIssueCode.invalid_string,message:d.message}),t.dirty());else if("url"===d.kind)try{new URL(e.data)}catch(n){s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{validation:"url",code:u.ZodIssueCode.invalid_string,message:d.message}),t.dirty()}else if("regex"===d.kind){d.regex.lastIndex=0;d.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{validation:"regex",code:u.ZodIssueCode.invalid_string,message:d.message}),t.dirty())}else if("trim"===d.kind)e.data=e.data.trim();else if("includes"===d.kind)e.data.includes(d.value,d.position)||(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.invalid_string,validation:{includes:d.value,position:d.position},message:d.message}),t.dirty());else if("toLowerCase"===d.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===d.kind)e.data=e.data.toUpperCase();else if("startsWith"===d.kind)e.data.startsWith(d.value)||(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.invalid_string,validation:{startsWith:d.value},message:d.message}),t.dirty());else if("endsWith"===d.kind)e.data.endsWith(d.value)||(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.invalid_string,validation:{endsWith:d.value},message:d.message}),t.dirty());else if("datetime"===d.kind){((l=d).precision?l.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${l.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${l.precision}}Z$`):0===l.precision?l.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):l.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$")).test(e.data)||(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.invalid_string,validation:"datetime",message:d.message}),t.dirty())}else"ip"===d.kind?(n=e.data,("v4"!==(a=d.version)&&a||!w.test(n))&&("v6"!==a&&a||!g.test(n))&&(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{validation:"ip",code:u.ZodIssueCode.invalid_string,message:d.message}),t.dirty())):c.util.assertNever(d);var n,a,l;return{status:t.value,value:e.data}}_addCheck(e){return new ZodString({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...a.errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...a.errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...a.errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...a.errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...a.errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...a.errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...a.errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...a.errorUtil.errToObj(e)})}datetime(e){var t;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,...a.errorUtil.errToObj(null==e?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...a.errorUtil.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...a.errorUtil.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...a.errorUtil.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...a.errorUtil.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...a.errorUtil.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...a.errorUtil.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...a.errorUtil.errToObj(t)})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function v(e,t){const s=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=s>n?s:n;return parseInt(e.toFixed(a).replace(".",""))%parseInt(t.toFixed(a).replace(".",""))/Math.pow(10,a)}t.ZodString=ZodString,ZodString.create=e=>{var t;return new ZodString({checks:[],typeName:C.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...d(e)})};class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==c.ZodParsedType.number){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.number,received:t.parsedType}),o.INVALID}let t;const s=new o.ParseStatus;for(const n of this._def.checks)if("int"===n.kind)c.util.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty());else if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty())}else"multipleOf"===n.kind?0!==v(e.data,n.value)&&(t=this._getOrReturnCtx(e,t),(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.not_finite,message:n.message}),s.dirty()):c.util.assertNever(n);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,a.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,a.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,a.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,a.errorUtil.toString(t))}setLimit(e,t,s,n){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:a.errorUtil.toString(n)}]})}_addCheck(e){return new ZodNumber({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:a.errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:a.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:a.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:a.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:a.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:a.errorUtil.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:a.errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:a.errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:a.errorUtil.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&c.util.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const s of this._def.checks){if("finite"===s.kind||"int"===s.kind||"multipleOf"===s.kind)return!0;"min"===s.kind?(null===t||s.value>t)&&(t=s.value):"max"===s.kind&&(null===e||s.value<e)&&(e=s.value)}return Number.isFinite(t)&&Number.isFinite(e)}}t.ZodNumber=ZodNumber,ZodNumber.create=e=>new ZodNumber({checks:[],typeName:C.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...d(e)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){this._def.coerce&&(e.data=BigInt(e.data));if(this._getType(e)!==c.ZodParsedType.bigint){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.bigint,received:t.parsedType}),o.INVALID}let t;const s=new o.ParseStatus;for(const n of this._def.checks)if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty())}else"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):c.util.assertNever(n);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,a.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,a.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,a.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,a.errorUtil.toString(t))}setLimit(e,t,s,n){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:a.errorUtil.toString(n)}]})}_addCheck(e){return new ZodBigInt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:a.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:a.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:a.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:a.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:a.errorUtil.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}t.ZodBigInt=ZodBigInt,ZodBigInt.create=e=>{var t;return new ZodBigInt({checks:[],typeName:C.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...d(e)})};class ZodBoolean extends ZodType{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==c.ZodParsedType.boolean){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.boolean,received:t.parsedType}),o.INVALID}return(0,o.OK)(e.data)}}t.ZodBoolean=ZodBoolean,ZodBoolean.create=e=>new ZodBoolean({typeName:C.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...d(e)});class ZodDate extends ZodType{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==c.ZodParsedType.date){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.date,received:t.parsedType}),o.INVALID}if(isNaN(e.data.getTime())){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_date}),o.INVALID}const t=new o.ParseStatus;let s;for(const n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),t.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),t.dirty()):c.util.assertNever(n);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ZodDate({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:a.errorUtil.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:a.errorUtil.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}t.ZodDate=ZodDate,ZodDate.create=e=>new ZodDate({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:C.ZodDate,...d(e)});class ZodSymbol extends ZodType{_parse(e){if(this._getType(e)!==c.ZodParsedType.symbol){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.symbol,received:t.parsedType}),o.INVALID}return(0,o.OK)(e.data)}}t.ZodSymbol=ZodSymbol,ZodSymbol.create=e=>new ZodSymbol({typeName:C.ZodSymbol,...d(e)});class ZodUndefined extends ZodType{_parse(e){if(this._getType(e)!==c.ZodParsedType.undefined){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.undefined,received:t.parsedType}),o.INVALID}return(0,o.OK)(e.data)}}t.ZodUndefined=ZodUndefined,ZodUndefined.create=e=>new ZodUndefined({typeName:C.ZodUndefined,...d(e)});class ZodNull extends ZodType{_parse(e){if(this._getType(e)!==c.ZodParsedType.null){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.null,received:t.parsedType}),o.INVALID}return(0,o.OK)(e.data)}}t.ZodNull=ZodNull,ZodNull.create=e=>new ZodNull({typeName:C.ZodNull,...d(e)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(e){return(0,o.OK)(e.data)}}t.ZodAny=ZodAny,ZodAny.create=e=>new ZodAny({typeName:C.ZodAny,...d(e)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(e){return(0,o.OK)(e.data)}}t.ZodUnknown=ZodUnknown,ZodUnknown.create=e=>new ZodUnknown({typeName:C.ZodUnknown,...d(e)});class ZodNever extends ZodType{_parse(e){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.never,received:t.parsedType}),o.INVALID}}t.ZodNever=ZodNever,ZodNever.create=e=>new ZodNever({typeName:C.ZodNever,...d(e)});class ZodVoid extends ZodType{_parse(e){if(this._getType(e)!==c.ZodParsedType.undefined){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.void,received:t.parsedType}),o.INVALID}return(0,o.OK)(e.data)}}t.ZodVoid=ZodVoid,ZodVoid.create=e=>new ZodVoid({typeName:C.ZodVoid,...d(e)});class ZodArray extends ZodType{_parse(e){const{ctx:t,status:s}=this._processInputParams(e),n=this._def;if(t.parsedType!==c.ZodParsedType.array)return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.array,received:t.parsedType}),o.INVALID;if(null!==n.exactLength){const e=t.data.length>n.exactLength.value,a=t.data.length<n.exactLength.value;(e||a)&&((0,o.addIssueToContext)(t,{code:e?u.ZodIssueCode.too_big:u.ZodIssueCode.too_small,minimum:a?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&((0,o.addIssueToContext)(t,{code:u.ZodIssueCode.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&((0,o.addIssueToContext)(t,{code:u.ZodIssueCode.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),t.common.async)return Promise.all([...t.data].map(((e,s)=>n.type._parseAsync(new ParseInputLazyPath(t,e,t.path,s))))).then((e=>o.ParseStatus.mergeArray(s,e)));const a=[...t.data].map(((e,s)=>n.type._parseSync(new ParseInputLazyPath(t,e,t.path,s))));return o.ParseStatus.mergeArray(s,a)}get element(){return this._def.type}min(e,t){return new ZodArray({...this._def,minLength:{value:e,message:a.errorUtil.toString(t)}})}max(e,t){return new ZodArray({...this._def,maxLength:{value:e,message:a.errorUtil.toString(t)}})}length(e,t){return new ZodArray({...this._def,exactLength:{value:e,message:a.errorUtil.toString(t)}})}nonempty(e){return this.min(1,e)}}function E(e){if(e instanceof ZodObject){const t={};for(const s in e.shape){const n=e.shape[s];t[s]=ZodOptional.create(E(n))}return new ZodObject({...e._def,shape:()=>t})}return e instanceof ZodArray?new ZodArray({...e._def,type:E(e.element)}):e instanceof ZodOptional?ZodOptional.create(E(e.unwrap())):e instanceof ZodNullable?ZodNullable.create(E(e.unwrap())):e instanceof ZodTuple?ZodTuple.create(e.items.map((e=>E(e)))):e}t.ZodArray=ZodArray,ZodArray.create=(e,t)=>new ZodArray({type:e,minLength:null,maxLength:null,exactLength:null,typeName:C.ZodArray,...d(t)});class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=c.util.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==c.ZodParsedType.object){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.object,received:t.parsedType}),o.INVALID}const{status:t,ctx:s}=this._processInputParams(e),{shape:n,keys:a}=this._getCached(),l=[];if(!(this._def.catchall instanceof ZodNever&&"strip"===this._def.unknownKeys))for(const e in s.data)a.includes(e)||l.push(e);const d=[];for(const e of a){const t=n[e],a=s.data[e];d.push({key:{status:"valid",value:e},value:t._parse(new ParseInputLazyPath(s,a,s.path,e)),alwaysSet:e in s.data})}if(this._def.catchall instanceof ZodNever){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of l)d.push({key:{status:"valid",value:e},value:{status:"valid",value:s.data[e]}});else if("strict"===e)l.length>0&&((0,o.addIssueToContext)(s,{code:u.ZodIssueCode.unrecognized_keys,keys:l}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of l){const n=s.data[t];d.push({key:{status:"valid",value:t},value:e._parse(new ParseInputLazyPath(s,n,s.path,t)),alwaysSet:t in s.data})}}return s.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of d){const s=await t.key;e.push({key:s,value:await t.value,alwaysSet:t.alwaysSet})}return e})).then((e=>o.ParseStatus.mergeObjectSync(t,e))):o.ParseStatus.mergeObjectSync(t,d)}get shape(){return this._def.shape()}strict(e){return a.errorUtil.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,s)=>{var n,o,c,u;const l=null!==(c=null===(o=(n=this._def).errorMap)||void 0===o?void 0:o.call(n,t,s).message)&&void 0!==c?c:s.defaultError;return"unrecognized_keys"===t.code?{message:null!==(u=a.errorUtil.errToObj(e).message)&&void 0!==u?u:l}:{message:l}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(e){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ZodObject({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:C.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ZodObject({...this._def,catchall:e})}pick(e){const t={};return c.util.objectKeys(e).forEach((s=>{e[s]&&this.shape[s]&&(t[s]=this.shape[s])})),new ZodObject({...this._def,shape:()=>t})}omit(e){const t={};return c.util.objectKeys(this.shape).forEach((s=>{e[s]||(t[s]=this.shape[s])})),new ZodObject({...this._def,shape:()=>t})}deepPartial(){return E(this)}partial(e){const t={};return c.util.objectKeys(this.shape).forEach((s=>{const n=this.shape[s];e&&!e[s]?t[s]=n:t[s]=n.optional()})),new ZodObject({...this._def,shape:()=>t})}required(e){const t={};return c.util.objectKeys(this.shape).forEach((s=>{if(e&&!e[s])t[s]=this.shape[s];else{let e=this.shape[s];for(;e instanceof ZodOptional;)e=e._def.innerType;t[s]=e}})),new ZodObject({...this._def,shape:()=>t})}keyof(){return S(c.util.objectKeys(this.shape))}}t.ZodObject=ZodObject,ZodObject.create=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:C.ZodObject,...d(t)}),ZodObject.strictCreate=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strict",catchall:ZodNever.create(),typeName:C.ZodObject,...d(t)}),ZodObject.lazycreate=(e,t)=>new ZodObject({shape:e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:C.ZodObject,...d(t)});class ZodUnion extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),s=this._def.options;if(t.common.async)return Promise.all(s.map((async e=>{const s={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:s}),ctx:s}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const s of e)if("dirty"===s.result.status)return t.common.issues.push(...s.ctx.common.issues),s.result;const s=e.map((e=>new u.ZodError(e.ctx.common.issues)));return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_union,unionErrors:s}),o.INVALID}));{let e;const n=[];for(const a of s){const s={...t,common:{...t.common,issues:[]},parent:null},o=a._parseSync({data:t.data,path:t.path,parent:s});if("valid"===o.status)return o;"dirty"!==o.status||e||(e={result:o,ctx:s}),s.common.issues.length&&n.push(s.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const a=n.map((e=>new u.ZodError(e)));return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_union,unionErrors:a}),o.INVALID}}get options(){return this._def.options}}t.ZodUnion=ZodUnion,ZodUnion.create=(e,t)=>new ZodUnion({options:e,typeName:C.ZodUnion,...d(t)});const T=e=>e instanceof ZodLazy?T(e.schema):e instanceof ZodEffects?T(e.innerType()):e instanceof ZodLiteral?[e.value]:e instanceof ZodEnum?e.options:e instanceof ZodNativeEnum?Object.keys(e.enum):e instanceof ZodDefault?T(e._def.innerType):e instanceof ZodUndefined?[void 0]:e instanceof ZodNull?[null]:null;class ZodDiscriminatedUnion extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==c.ZodParsedType.object)return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.object,received:t.parsedType}),o.INVALID;const s=this.discriminator,n=t.data[s],a=this.optionsMap.get(n);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):((0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),o.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,s){const n=new Map;for(const s of t){const t=T(s.shape[e]);if(!t)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of t){if(n.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);n.set(a,s)}}return new ZodDiscriminatedUnion({typeName:C.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...d(s)})}}function b(e,t){const s=(0,c.getParsedType)(e),n=(0,c.getParsedType)(t);if(e===t)return{valid:!0,data:e};if(s===c.ZodParsedType.object&&n===c.ZodParsedType.object){const s=c.util.objectKeys(t),n=c.util.objectKeys(e).filter((e=>-1!==s.indexOf(e))),a={...e,...t};for(const s of n){const n=b(e[s],t[s]);if(!n.valid)return{valid:!1};a[s]=n.data}return{valid:!0,data:a}}if(s===c.ZodParsedType.array&&n===c.ZodParsedType.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let n=0;n<e.length;n++){const a=b(e[n],t[n]);if(!a.valid)return{valid:!1};s.push(a.data)}return{valid:!0,data:s}}return s===c.ZodParsedType.date&&n===c.ZodParsedType.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}t.ZodDiscriminatedUnion=ZodDiscriminatedUnion;class ZodIntersection extends ZodType{_parse(e){const{status:t,ctx:s}=this._processInputParams(e),n=(e,n)=>{if((0,o.isAborted)(e)||(0,o.isAborted)(n))return o.INVALID;const a=b(e.value,n.value);return a.valid?(((0,o.isDirty)(e)||(0,o.isDirty)(n))&&t.dirty(),{status:t.value,value:a.data}):((0,o.addIssueToContext)(s,{code:u.ZodIssueCode.invalid_intersection_types}),o.INVALID)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then((([e,t])=>n(e,t))):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}t.ZodIntersection=ZodIntersection,ZodIntersection.create=(e,t,s)=>new ZodIntersection({left:e,right:t,typeName:C.ZodIntersection,...d(s)});class ZodTuple extends ZodType{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==c.ZodParsedType.array)return(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.array,received:s.parsedType}),o.INVALID;if(s.data.length<this._def.items.length)return(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),o.INVALID;!this._def.rest&&s.data.length>this._def.items.length&&((0,o.addIssueToContext)(s,{code:u.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const n=[...s.data].map(((e,t)=>{const n=this._def.items[t]||this._def.rest;return n?n._parse(new ParseInputLazyPath(s,e,s.path,t)):null})).filter((e=>!!e));return s.common.async?Promise.all(n).then((e=>o.ParseStatus.mergeArray(t,e))):o.ParseStatus.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new ZodTuple({...this._def,rest:e})}}t.ZodTuple=ZodTuple,ZodTuple.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:e,typeName:C.ZodTuple,rest:null,...d(t)})};class ZodRecord extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==c.ZodParsedType.object)return(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.object,received:s.parsedType}),o.INVALID;const n=[],a=this._def.keyType,l=this._def.valueType;for(const e in s.data)n.push({key:a._parse(new ParseInputLazyPath(s,e,s.path,e)),value:l._parse(new ParseInputLazyPath(s,s.data[e],s.path,e))});return s.common.async?o.ParseStatus.mergeObjectAsync(t,n):o.ParseStatus.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,s){return new ZodRecord(t instanceof ZodType?{keyType:e,valueType:t,typeName:C.ZodRecord,...d(s)}:{keyType:ZodString.create(),valueType:e,typeName:C.ZodRecord,...d(t)})}}t.ZodRecord=ZodRecord;class ZodMap extends ZodType{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==c.ZodParsedType.map)return(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.map,received:s.parsedType}),o.INVALID;const n=this._def.keyType,a=this._def.valueType,l=[...s.data.entries()].map((([e,t],o)=>({key:n._parse(new ParseInputLazyPath(s,e,s.path,[o,"key"])),value:a._parse(new ParseInputLazyPath(s,t,s.path,[o,"value"]))})));if(s.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const s of l){const n=await s.key,a=await s.value;if("aborted"===n.status||"aborted"===a.status)return o.INVALID;"dirty"!==n.status&&"dirty"!==a.status||t.dirty(),e.set(n.value,a.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const s of l){const n=s.key,a=s.value;if("aborted"===n.status||"aborted"===a.status)return o.INVALID;"dirty"!==n.status&&"dirty"!==a.status||t.dirty(),e.set(n.value,a.value)}return{status:t.value,value:e}}}}t.ZodMap=ZodMap,ZodMap.create=(e,t,s)=>new ZodMap({valueType:t,keyType:e,typeName:C.ZodMap,...d(s)});class ZodSet extends ZodType{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==c.ZodParsedType.set)return(0,o.addIssueToContext)(s,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.set,received:s.parsedType}),o.INVALID;const n=this._def;null!==n.minSize&&s.data.size<n.minSize.value&&((0,o.addIssueToContext)(s,{code:u.ZodIssueCode.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&s.data.size>n.maxSize.value&&((0,o.addIssueToContext)(s,{code:u.ZodIssueCode.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const a=this._def.valueType;function l(e){const s=new Set;for(const n of e){if("aborted"===n.status)return o.INVALID;"dirty"===n.status&&t.dirty(),s.add(n.value)}return{status:t.value,value:s}}const d=[...s.data.values()].map(((e,t)=>a._parse(new ParseInputLazyPath(s,e,s.path,t))));return s.common.async?Promise.all(d).then((e=>l(e))):l(d)}min(e,t){return new ZodSet({...this._def,minSize:{value:e,message:a.errorUtil.toString(t)}})}max(e,t){return new ZodSet({...this._def,maxSize:{value:e,message:a.errorUtil.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}t.ZodSet=ZodSet,ZodSet.create=(e,t)=>new ZodSet({valueType:e,minSize:null,maxSize:null,typeName:C.ZodSet,...d(t)});class ZodFunction extends ZodType{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==c.ZodParsedType.function)return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.function,received:t.parsedType}),o.INVALID;function s(e,s){return(0,o.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter((e=>!!e)),issueData:{code:u.ZodIssueCode.invalid_arguments,argumentsError:s}})}function a(e,s){return(0,o.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter((e=>!!e)),issueData:{code:u.ZodIssueCode.invalid_return_type,returnTypeError:s}})}const l={errorMap:t.common.contextualErrorMap},d=t.data;return this._def.returns instanceof ZodPromise?(0,o.OK)((async(...e)=>{const t=new u.ZodError([]),n=await this._def.args.parseAsync(e,l).catch((n=>{throw t.addIssue(s(e,n)),t})),o=await d(...n);return await this._def.returns._def.type.parseAsync(o,l).catch((e=>{throw t.addIssue(a(o,e)),t}))})):(0,o.OK)(((...e)=>{const t=this._def.args.safeParse(e,l);if(!t.success)throw new u.ZodError([s(e,t.error)]);const n=d(...t.data),o=this._def.returns.safeParse(n,l);if(!o.success)throw new u.ZodError([a(n,o.error)]);return o.data}))}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ZodFunction({...this._def,args:ZodTuple.create(e).rest(ZodUnknown.create())})}returns(e){return new ZodFunction({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,s){return new ZodFunction({args:e||ZodTuple.create([]).rest(ZodUnknown.create()),returns:t||ZodUnknown.create(),typeName:C.ZodFunction,...d(s)})}}t.ZodFunction=ZodFunction;class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}t.ZodLazy=ZodLazy,ZodLazy.create=(e,t)=>new ZodLazy({getter:e,typeName:C.ZodLazy,...d(t)});class ZodLiteral extends ZodType{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{received:t.data,code:u.ZodIssueCode.invalid_literal,expected:this._def.value}),o.INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}}function S(e,t){return new ZodEnum({values:e,typeName:C.ZodEnum,...d(t)})}t.ZodLiteral=ZodLiteral,ZodLiteral.create=(e,t)=>new ZodLiteral({value:e,typeName:C.ZodLiteral,...d(t)});class ZodEnum extends ZodType{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),s=this._def.values;return(0,o.addIssueToContext)(t,{expected:c.util.joinValues(s),received:t.parsedType,code:u.ZodIssueCode.invalid_type}),o.INVALID}if(-1===this._def.values.indexOf(e.data)){const t=this._getOrReturnCtx(e),s=this._def.values;return(0,o.addIssueToContext)(t,{received:t.data,code:u.ZodIssueCode.invalid_enum_value,options:s}),o.INVALID}return(0,o.OK)(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return ZodEnum.create(e)}exclude(e){return ZodEnum.create(this.options.filter((t=>!e.includes(t))))}}t.ZodEnum=ZodEnum,ZodEnum.create=S;class ZodNativeEnum extends ZodType{_parse(e){const t=c.util.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==c.ZodParsedType.string&&s.parsedType!==c.ZodParsedType.number){const e=c.util.objectValues(t);return(0,o.addIssueToContext)(s,{expected:c.util.joinValues(e),received:s.parsedType,code:u.ZodIssueCode.invalid_type}),o.INVALID}if(-1===t.indexOf(e.data)){const e=c.util.objectValues(t);return(0,o.addIssueToContext)(s,{received:s.data,code:u.ZodIssueCode.invalid_enum_value,options:e}),o.INVALID}return(0,o.OK)(e.data)}get enum(){return this._def.values}}t.ZodNativeEnum=ZodNativeEnum,ZodNativeEnum.create=(e,t)=>new ZodNativeEnum({values:e,typeName:C.ZodNativeEnum,...d(t)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==c.ZodParsedType.promise&&!1===t.common.async)return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.promise,received:t.parsedType}),o.INVALID;const s=t.parsedType===c.ZodParsedType.promise?t.data:Promise.resolve(t.data);return(0,o.OK)(s.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}t.ZodPromise=ZodPromise,ZodPromise.create=(e,t)=>new ZodPromise({type:e,typeName:C.ZodPromise,...d(t)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===C.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:s}=this._processInputParams(e),n=this._def.effect||null;if("preprocess"===n.type){const e=n.transform(s.data);return s.common.async?Promise.resolve(e).then((e=>this._def.schema._parseAsync({data:e,path:s.path,parent:s}))):this._def.schema._parseSync({data:e,path:s.path,parent:s})}const a={addIssue:e=>{(0,o.addIssueToContext)(s,e),e.fatal?t.abort():t.dirty()},get path(){return s.path}};if(a.addIssue=a.addIssue.bind(a),"refinement"===n.type){const e=e=>{const t=n.refinement(e,a);if(s.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===s.common.async){const n=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return"aborted"===n.status?o.INVALID:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then((s=>"aborted"===s.status?o.INVALID:("dirty"===s.status&&t.dirty(),e(s.value).then((()=>({status:t.value,value:s.value}))))))}if("transform"===n.type){if(!1===s.common.async){const e=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!(0,o.isValid)(e))return e;const c=n.transform(e.value,a);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:c}}return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then((e=>(0,o.isValid)(e)?Promise.resolve(n.transform(e.value,a)).then((e=>({status:t.value,value:e}))):e))}c.util.assertNever(n)}}t.ZodEffects=ZodEffects,t.ZodTransformer=ZodEffects,ZodEffects.create=(e,t,s)=>new ZodEffects({schema:e,typeName:C.ZodEffects,effect:t,...d(s)}),ZodEffects.createWithPreprocess=(e,t,s)=>new ZodEffects({schema:t,effect:{type:"preprocess",transform:e},typeName:C.ZodEffects,...d(s)});class ZodOptional extends ZodType{_parse(e){return this._getType(e)===c.ZodParsedType.undefined?(0,o.OK)(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodOptional=ZodOptional,ZodOptional.create=(e,t)=>new ZodOptional({innerType:e,typeName:C.ZodOptional,...d(t)});class ZodNullable extends ZodType{_parse(e){return this._getType(e)===c.ZodParsedType.null?(0,o.OK)(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodNullable=ZodNullable,ZodNullable.create=(e,t)=>new ZodNullable({innerType:e,typeName:C.ZodNullable,...d(t)});class ZodDefault extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e);let s=t.data;return t.parsedType===c.ZodParsedType.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}t.ZodDefault=ZodDefault,ZodDefault.create=(e,t)=>new ZodDefault({innerType:e,typeName:C.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...d(t)});class ZodCatch extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),s={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return(0,o.isAsync)(n)?n.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new u.ZodError(s.common.issues)},input:s.data})}))):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new u.ZodError(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}t.ZodCatch=ZodCatch,ZodCatch.create=(e,t)=>new ZodCatch({innerType:e,typeName:C.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...d(t)});class ZodNaN extends ZodType{_parse(e){if(this._getType(e)!==c.ZodParsedType.nan){const t=this._getOrReturnCtx(e);return(0,o.addIssueToContext)(t,{code:u.ZodIssueCode.invalid_type,expected:c.ZodParsedType.nan,received:t.parsedType}),o.INVALID}return{status:"valid",value:e.data}}}t.ZodNaN=ZodNaN,ZodNaN.create=e=>new ZodNaN({typeName:C.ZodNaN,...d(e)}),t.BRAND=Symbol("zod_brand");class ZodBranded extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),s=t.data;return this._def.type._parse({data:s,path:t.path,parent:t})}unwrap(){return this._def.type}}t.ZodBranded=ZodBranded;class ZodPipeline extends ZodType{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return"aborted"===e.status?o.INVALID:"dirty"===e.status?(t.dirty(),(0,o.DIRTY)(e.value)):this._def.out._parseAsync({data:e.value,path:s.path,parent:s})})()}{const e=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return"aborted"===e.status?o.INVALID:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:s.path,parent:s})}}static create(e,t){return new ZodPipeline({in:e,out:t,typeName:C.ZodPipeline})}}t.ZodPipeline=ZodPipeline;var C;t.custom=(e,t={},s)=>e?ZodAny.create().superRefine(((n,a)=>{var o,c;if(!e(n)){const e="function"==typeof t?t(n):"string"==typeof t?{message:t}:t,u=null===(c=null!==(o=e.fatal)&&void 0!==o?o:s)||void 0===c||c,l="string"==typeof e?{message:e}:e;a.addIssue({code:"custom",...l,fatal:u})}})):ZodAny.create(),t.late={object:ZodObject.lazycreate},function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline"}(C=t.ZodFirstPartyTypeKind||(t.ZodFirstPartyTypeKind={}));t.instanceof=(e,s={message:`Input not instance of ${e.name}`})=>(0,t.custom)((t=>t instanceof e),s);const R=ZodString.create;t.string=R;const k=ZodNumber.create;t.number=k;const D=ZodNaN.create;t.nan=D;const A=ZodBigInt.create;t.bigint=A;const N=ZodBoolean.create;t.boolean=N;const P=ZodDate.create;t.date=P;const O=ZodSymbol.create;t.symbol=O;const I=ZodUndefined.create;t.undefined=I;const M=ZodNull.create;t.null=M;const x=ZodAny.create;t.any=x;const L=ZodUnknown.create;t.unknown=L;const F=ZodNever.create;t.never=F;const U=ZodVoid.create;t.void=U;const H=ZodArray.create;t.array=H;const B=ZodObject.create;t.object=B;const j=ZodObject.strictCreate;t.strictObject=j;const q=ZodUnion.create;t.union=q;const K=ZodDiscriminatedUnion.create;t.discriminatedUnion=K;const Z=ZodIntersection.create;t.intersection=Z;const W=ZodTuple.create;t.tuple=W;const z=ZodRecord.create;t.record=z;const V=ZodMap.create;t.map=V;const G=ZodSet.create;t.set=G;const $=ZodFunction.create;t.function=$;const X=ZodLazy.create;t.lazy=X;const Y=ZodLiteral.create;t.literal=Y;const J=ZodEnum.create;t.enum=J;const Q=ZodNativeEnum.create;t.nativeEnum=Q;const ee=ZodPromise.create;t.promise=ee;const te=ZodEffects.create;t.effect=te,t.transformer=te;const re=ZodOptional.create;t.optional=re;const se=ZodNullable.create;t.nullable=se;const ne=ZodEffects.createWithPreprocess;t.preprocess=ne;const ie=ZodPipeline.create;t.pipeline=ie;t.ostring=()=>R().optional();t.onumber=()=>k().optional();t.oboolean=()=>N().optional(),t.coerce={string:e=>ZodString.create({...e,coerce:!0}),number:e=>ZodNumber.create({...e,coerce:!0}),boolean:e=>ZodBoolean.create({...e,coerce:!0}),bigint:e=>ZodBigInt.create({...e,coerce:!0}),date:e=>ZodDate.create({...e,coerce:!0})},t.NEVER=o.INVALID},8426:()=>{},4850:()=>{},5865:()=>{},1503:()=>{},9917:()=>{},9298:()=>{},7349:()=>{},2480:()=>{},7064:function(e,t,s){"use strict";const n=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(s(4456));e.exports=Object.assign(n.default,{default:n.default,LRUCache:n.default})},4456:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=void 0;const s="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,n=new Set,a=(Symbol("type"),e=>e&&e===Math.floor(e)&&e>0&&isFinite(e)),o=e=>a(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?ZeroArray:null:null;class ZeroArray extends Array{constructor(e){super(e),this.fill(0)}}class Stack{heap;length;static#e=!1;static create(e){const t=o(e);if(!t)return[];Stack.#e=!0;const s=new Stack(e,t);return Stack.#e=!1,s}constructor(e,t){if(!Stack.#e)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class LRUCache{#t;#r;#s;#n;#i;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#a;#o;#c;#u;#l;#d;#h;#_;#p;#f;#m;#y;#w;#g;#v;#E;#T;static unsafeExposeInternals(e){return{starts:e.#w,ttls:e.#g,sizes:e.#y,keyMap:e.#c,keyList:e.#u,valList:e.#l,next:e.#d,prev:e.#h,get head(){return e.#_},get tail(){return e.#p},free:e.#f,isBackgroundFetch:t=>e.#b(t),backgroundFetch:(t,s,n,a)=>e.#S(t,s,n,a),moveToTail:t=>e.#C(t),indexes:t=>e.#R(t),rindexes:t=>e.#k(t),isStale:t=>e.#D(t)}}get max(){return this.#t}get maxSize(){return this.#r}get calculatedSize(){return this.#o}get size(){return this.#a}get fetchMethod(){return this.#i}get dispose(){return this.#s}get disposeAfter(){return this.#n}constructor(e){const{max:t=0,ttl:s,ttlResolution:c=1,ttlAutopurge:u,updateAgeOnGet:l,updateAgeOnHas:d,allowStale:h,dispose:_,disposeAfter:p,noDisposeOnSet:f,noUpdateTTL:m,maxSize:y=0,maxEntrySize:w=0,sizeCalculation:g,fetchMethod:v,noDeleteOnFetchRejection:E,noDeleteOnStaleGet:T,allowStaleOnFetchRejection:b,allowStaleOnFetchAbort:S,ignoreFetchAbort:C}=e;if(0!==t&&!a(t))throw new TypeError("max option must be a nonnegative integer");const R=t?o(t):Array;if(!R)throw new Error("invalid max value: "+t);if(this.#t=t,this.#r=y,this.maxEntrySize=w||this.#r,this.sizeCalculation=g,this.sizeCalculation){if(!this.#r&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(void 0!==v&&"function"!=typeof v)throw new TypeError("fetchMethod must be a function if specified");if(this.#i=v,this.#E=!!v,this.#c=new Map,this.#u=new Array(t).fill(void 0),this.#l=new Array(t).fill(void 0),this.#d=new R(t),this.#h=new R(t),this.#_=0,this.#p=0,this.#f=Stack.create(t),this.#a=0,this.#o=0,"function"==typeof _&&(this.#s=_),"function"==typeof p?(this.#n=p,this.#m=[]):(this.#n=void 0,this.#m=void 0),this.#v=!!this.#s,this.#T=!!this.#n,this.noDisposeOnSet=!!f,this.noUpdateTTL=!!m,this.noDeleteOnFetchRejection=!!E,this.allowStaleOnFetchRejection=!!b,this.allowStaleOnFetchAbort=!!S,this.ignoreFetchAbort=!!C,0!==this.maxEntrySize){if(0!==this.#r&&!a(this.#r))throw new TypeError("maxSize must be a positive integer if specified");if(!a(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#A()}if(this.allowStale=!!h,this.noDeleteOnStaleGet=!!T,this.updateAgeOnGet=!!l,this.updateAgeOnHas=!!d,this.ttlResolution=a(c)||0===c?c:1,this.ttlAutopurge=!!u,this.ttl=s||0,this.ttl){if(!a(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#N()}if(0===this.#t&&0===this.ttl&&0===this.#r)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#t&&!this.#r){const e="LRU_CACHE_UNBOUNDED";if((e=>!n.has(e))(e)){n.add(e);((e,t,s,n)=>{"object"==typeof process&&process&&"function"==typeof process.emitWarning?process.emitWarning(e,t,s,n):console.error(`[${s}] ${t}: ${e}`)})("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",e,LRUCache)}}}getRemainingTTL(e){return this.#c.has(e)?1/0:0}#N(){const e=new ZeroArray(this.#t),t=new ZeroArray(this.#t);this.#g=e,this.#w=t,this.#P=(n,a,o=s.now())=>{if(t[n]=0!==a?o:0,e[n]=a,0!==a&&this.ttlAutopurge){const e=setTimeout((()=>{this.#D(n)&&this.delete(this.#u[n])}),a+1);e.unref&&e.unref()}},this.#O=n=>{t[n]=0!==e[n]?s.now():0},this.#I=(s,o)=>{if(e[o]){const c=e[o],u=t[o];s.ttl=c,s.start=u,s.now=n||a(),s.remainingTTL=s.now+c-u}};let n=0;const a=()=>{const e=s.now();if(this.ttlResolution>0){n=e;const t=setTimeout((()=>n=0),this.ttlResolution);t.unref&&t.unref()}return e};this.getRemainingTTL=s=>{const o=this.#c.get(s);return void 0===o?0:0===e[o]||0===t[o]?1/0:t[o]+e[o]-(n||a())},this.#D=s=>0!==e[s]&&0!==t[s]&&(n||a())-t[s]>e[s]}#O=()=>{};#I=()=>{};#P=()=>{};#D=()=>!1;#A(){const e=new ZeroArray(this.#t);this.#o=0,this.#y=e,this.#M=t=>{this.#o-=e[t],e[t]=0},this.#x=(e,t,s,n)=>{if(this.#b(t))return 0;if(!a(s)){if(!n)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if("function"!=typeof n)throw new TypeError("sizeCalculation must be a function");if(s=n(t,e),!a(s))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return s},this.#L=(t,s,n)=>{if(e[t]=s,this.#r){const s=this.#r-e[t];for(;this.#o>s;)this.#F(!0)}this.#o+=e[t],n&&(n.entrySize=s,n.totalCalculatedSize=this.#o)}}#M=e=>{};#L=(e,t,s)=>{};#x=(e,t,s,n)=>{if(s||n)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#R({allowStale:e=this.allowStale}={}){if(this.#a)for(let t=this.#p;this.#U(t)&&(!e&&this.#D(t)||(yield t),t!==this.#_);)t=this.#h[t]}*#k({allowStale:e=this.allowStale}={}){if(this.#a)for(let t=this.#_;this.#U(t)&&(!e&&this.#D(t)||(yield t),t!==this.#p);)t=this.#d[t]}#U(e){return void 0!==e&&this.#c.get(this.#u[e])===e}*entries(){for(const e of this.#R())void 0===this.#l[e]||void 0===this.#u[e]||this.#b(this.#l[e])||(yield[this.#u[e],this.#l[e]])}*rentries(){for(const e of this.#k())void 0===this.#l[e]||void 0===this.#u[e]||this.#b(this.#l[e])||(yield[this.#u[e],this.#l[e]])}*keys(){for(const e of this.#R()){const t=this.#u[e];void 0===t||this.#b(this.#l[e])||(yield t)}}*rkeys(){for(const e of this.#k()){const t=this.#u[e];void 0===t||this.#b(this.#l[e])||(yield t)}}*values(){for(const e of this.#R()){void 0===this.#l[e]||this.#b(this.#l[e])||(yield this.#l[e])}}*rvalues(){for(const e of this.#k()){void 0===this.#l[e]||this.#b(this.#l[e])||(yield this.#l[e])}}[Symbol.iterator](){return this.entries()}find(e,t={}){for(const s of this.#R()){const n=this.#l[s],a=this.#b(n)?n.__staleWhileFetching:n;if(void 0!==a&&e(a,this.#u[s],this))return this.get(this.#u[s],t)}}forEach(e,t=this){for(const s of this.#R()){const n=this.#l[s],a=this.#b(n)?n.__staleWhileFetching:n;void 0!==a&&e.call(t,a,this.#u[s],this)}}rforEach(e,t=this){for(const s of this.#k()){const n=this.#l[s],a=this.#b(n)?n.__staleWhileFetching:n;void 0!==a&&e.call(t,a,this.#u[s],this)}}purgeStale(){let e=!1;for(const t of this.#k({allowStale:!0}))this.#D(t)&&(this.delete(this.#u[t]),e=!0);return e}dump(){const e=[];for(const t of this.#R({allowStale:!0})){const n=this.#u[t],a=this.#l[t],o=this.#b(a)?a.__staleWhileFetching:a;if(void 0===o||void 0===n)continue;const c={value:o};if(this.#g&&this.#w){c.ttl=this.#g[t];const e=s.now()-this.#w[t];c.start=Math.floor(Date.now()-e)}this.#y&&(c.size=this.#y[t]),e.unshift([n,c])}return e}load(e){this.clear();for(const[t,n]of e){if(n.start){const e=Date.now()-n.start;n.start=s.now()-e}this.set(t,n.value,n)}}set(e,t,s={}){const{ttl:n=this.ttl,start:a,noDisposeOnSet:o=this.noDisposeOnSet,sizeCalculation:c=this.sizeCalculation,status:u}=s;let{noUpdateTTL:l=this.noUpdateTTL}=s;const d=this.#x(e,t,s.size||0,c);if(this.maxEntrySize&&d>this.maxEntrySize)return u&&(u.set="miss",u.maxEntrySizeExceeded=!0),this.delete(e),this;let h=0===this.#a?void 0:this.#c.get(e);if(void 0===h)h=0===this.#a?this.#p:0!==this.#f.length?this.#f.pop():this.#a===this.#t?this.#F(!1):this.#a,this.#u[h]=e,this.#l[h]=t,this.#c.set(e,h),this.#d[this.#p]=h,this.#h[h]=this.#p,this.#p=h,this.#a++,this.#L(h,d,u),u&&(u.set="add"),l=!1;else{this.#C(h);const s=this.#l[h];if(t!==s){if(this.#E&&this.#b(s)?s.__abortController.abort(new Error("replaced")):o||(this.#v&&this.#s?.(s,e,"set"),this.#T&&this.#m?.push([s,e,"set"])),this.#M(h),this.#L(h,d,u),this.#l[h]=t,u){u.set="replace";const e=s&&this.#b(s)?s.__staleWhileFetching:s;void 0!==e&&(u.oldValue=e)}}else u&&(u.set="update")}if(0===n||this.#g||this.#N(),this.#g&&(l||this.#P(h,n,a),u&&this.#I(u,h)),!o&&this.#T&&this.#m){const e=this.#m;let t;for(;t=e?.shift();)this.#n?.(...t)}return this}pop(){try{for(;this.#a;){const e=this.#l[this.#_];if(this.#F(!0),this.#b(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(void 0!==e)return e}}finally{if(this.#T&&this.#m){const e=this.#m;let t;for(;t=e?.shift();)this.#n?.(...t)}}}#F(e){const t=this.#_,s=this.#u[t],n=this.#l[t];return this.#E&&this.#b(n)?n.__abortController.abort(new Error("evicted")):(this.#v||this.#T)&&(this.#v&&this.#s?.(n,s,"evict"),this.#T&&this.#m?.push([n,s,"evict"])),this.#M(t),e&&(this.#u[t]=void 0,this.#l[t]=void 0,this.#f.push(t)),1===this.#a?(this.#_=this.#p=0,this.#f.length=0):this.#_=this.#d[t],this.#c.delete(s),this.#a--,t}has(e,t={}){const{updateAgeOnHas:s=this.updateAgeOnHas,status:n}=t,a=this.#c.get(e);if(void 0!==a){const e=this.#l[a];if(this.#b(e)&&void 0===e.__staleWhileFetching)return!1;if(!this.#D(a))return s&&this.#O(a),n&&(n.has="hit",this.#I(n,a)),!0;n&&(n.has="stale",this.#I(n,a))}else n&&(n.has="miss");return!1}peek(e,t={}){const{allowStale:s=this.allowStale}=t,n=this.#c.get(e);if(void 0!==n&&(s||!this.#D(n))){const e=this.#l[n];return this.#b(e)?e.__staleWhileFetching:e}}#S(e,t,s,n){const a=void 0===t?void 0:this.#l[t];if(this.#b(a))return a;const o=new AbortController,{signal:c}=s;c?.addEventListener("abort",(()=>o.abort(c.reason)),{signal:o.signal});const u={signal:o.signal,options:s,context:n},l=(n,a=!1)=>{const{aborted:c}=o.signal,l=s.ignoreFetchAbort&&void 0!==n;if(s.status&&(c&&!a?(s.status.fetchAborted=!0,s.status.fetchError=o.signal.reason,l&&(s.status.fetchAbortIgnored=!0)):s.status.fetchResolved=!0),c&&!l&&!a)return d(o.signal.reason);const _=h;return this.#l[t]===h&&(void 0===n?_.__staleWhileFetching?this.#l[t]=_.__staleWhileFetching:this.delete(e):(s.status&&(s.status.fetchUpdated=!0),this.set(e,n,u.options))),n},d=n=>{const{aborted:a}=o.signal,c=a&&s.allowStaleOnFetchAbort,u=c||s.allowStaleOnFetchRejection,l=u||s.noDeleteOnFetchRejection,d=h;if(this.#l[t]===h){!l||void 0===d.__staleWhileFetching?this.delete(e):c||(this.#l[t]=d.__staleWhileFetching)}if(u)return s.status&&void 0!==d.__staleWhileFetching&&(s.status.returnedStale=!0),d.__staleWhileFetching;if(d.__returned===d)throw n};s.status&&(s.status.fetchDispatched=!0);const h=new Promise(((t,n)=>{const c=this.#i?.(e,a,u);c&&c instanceof Promise&&c.then((e=>t(e)),n),o.signal.addEventListener("abort",(()=>{s.ignoreFetchAbort&&!s.allowStaleOnFetchAbort||(t(),s.allowStaleOnFetchAbort&&(t=e=>l(e,!0)))}))})).then(l,(e=>(s.status&&(s.status.fetchRejected=!0,s.status.fetchError=e),d(e)))),_=Object.assign(h,{__abortController:o,__staleWhileFetching:a,__returned:void 0});return void 0===t?(this.set(e,_,{...u.options,status:void 0}),t=this.#c.get(e)):this.#l[t]=_,_}#b(e){if(!this.#E)return!1;const t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof AbortController}async fetch(e,t={}){const{allowStale:s=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:a=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:c=this.noDisposeOnSet,size:u=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:d=this.noUpdateTTL,noDeleteOnFetchRejection:h=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:_=this.allowStaleOnFetchRejection,ignoreFetchAbort:p=this.ignoreFetchAbort,allowStaleOnFetchAbort:f=this.allowStaleOnFetchAbort,context:m,forceRefresh:y=!1,status:w,signal:g}=t;if(!this.#E)return w&&(w.fetch="get"),this.get(e,{allowStale:s,updateAgeOnGet:n,noDeleteOnStaleGet:a,status:w});const v={allowStale:s,updateAgeOnGet:n,noDeleteOnStaleGet:a,ttl:o,noDisposeOnSet:c,size:u,sizeCalculation:l,noUpdateTTL:d,noDeleteOnFetchRejection:h,allowStaleOnFetchRejection:_,allowStaleOnFetchAbort:f,ignoreFetchAbort:p,status:w,signal:g};let E=this.#c.get(e);if(void 0===E){w&&(w.fetch="miss");const t=this.#S(e,E,v,m);return t.__returned=t}{const t=this.#l[E];if(this.#b(t)){const e=s&&void 0!==t.__staleWhileFetching;return w&&(w.fetch="inflight",e&&(w.returnedStale=!0)),e?t.__staleWhileFetching:t.__returned=t}const a=this.#D(E);if(!y&&!a)return w&&(w.fetch="hit"),this.#C(E),n&&this.#O(E),w&&this.#I(w,E),t;const o=this.#S(e,E,v,m),c=void 0!==o.__staleWhileFetching&&s;return w&&(w.fetch=a?"stale":"refresh",c&&a&&(w.returnedStale=!0)),c?o.__staleWhileFetching:o.__returned=o}}get(e,t={}){const{allowStale:s=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:a=this.noDeleteOnStaleGet,status:o}=t,c=this.#c.get(e);if(void 0!==c){const t=this.#l[c],u=this.#b(t);return o&&this.#I(o,c),this.#D(c)?(o&&(o.get="stale"),u?(o&&s&&void 0!==t.__staleWhileFetching&&(o.returnedStale=!0),s?t.__staleWhileFetching:void 0):(a||this.delete(e),o&&s&&(o.returnedStale=!0),s?t:void 0)):(o&&(o.get="hit"),u?t.__staleWhileFetching:(this.#C(c),n&&this.#O(c),t))}o&&(o.get="miss")}#H(e,t){this.#h[t]=e,this.#d[e]=t}#C(e){e!==this.#p&&(e===this.#_?this.#_=this.#d[e]:this.#H(this.#h[e],this.#d[e]),this.#H(this.#p,e),this.#p=e)}delete(e){let t=!1;if(0!==this.#a){const s=this.#c.get(e);if(void 0!==s)if(t=!0,1===this.#a)this.clear();else{this.#M(s);const t=this.#l[s];this.#b(t)?t.__abortController.abort(new Error("deleted")):(this.#v||this.#T)&&(this.#v&&this.#s?.(t,e,"delete"),this.#T&&this.#m?.push([t,e,"delete"])),this.#c.delete(e),this.#u[s]=void 0,this.#l[s]=void 0,s===this.#p?this.#p=this.#h[s]:s===this.#_?this.#_=this.#d[s]:(this.#d[this.#h[s]]=this.#d[s],this.#h[this.#d[s]]=this.#h[s]),this.#a--,this.#f.push(s)}}if(this.#T&&this.#m?.length){const e=this.#m;let t;for(;t=e?.shift();)this.#n?.(...t)}return t}clear(){for(const e of this.#k({allowStale:!0})){const t=this.#l[e];if(this.#b(t))t.__abortController.abort(new Error("deleted"));else{const s=this.#u[e];this.#v&&this.#s?.(t,s,"delete"),this.#T&&this.#m?.push([t,s,"delete"])}}if(this.#c.clear(),this.#l.fill(void 0),this.#u.fill(void 0),this.#g&&this.#w&&(this.#g.fill(0),this.#w.fill(0)),this.#y&&this.#y.fill(0),this.#_=0,this.#p=0,this.#f.length=0,this.#o=0,this.#a=0,this.#T&&this.#m){const e=this.#m;let t;for(;t=e?.shift();)this.#n?.(...t)}}}t.LRUCache=LRUCache,t.default=LRUCache},7725:e=>{"use strict";e.exports=JSON.parse('{"nested":{"centrifugal":{"nested":{"centrifuge":{"nested":{"protocol":{"options":{"go_package":"./;protocol"},"nested":{"Error":{"fields":{"code":{"type":"uint32","id":1},"message":{"type":"string","id":2},"temporary":{"type":"bool","id":3}}},"EmulationRequest":{"fields":{"node":{"type":"string","id":1},"session":{"type":"string","id":2},"data":{"type":"bytes","id":3}}},"Command":{"fields":{"id":{"type":"uint32","id":1},"method":{"type":"MethodType","id":2},"params":{"type":"bytes","id":3},"connect":{"type":"ConnectRequest","id":4},"subscribe":{"type":"SubscribeRequest","id":5},"unsubscribe":{"type":"UnsubscribeRequest","id":6},"publish":{"type":"PublishRequest","id":7},"presence":{"type":"PresenceRequest","id":8},"presence_stats":{"type":"PresenceStatsRequest","id":9},"history":{"type":"HistoryRequest","id":10},"ping":{"type":"PingRequest","id":11},"send":{"type":"SendRequest","id":12},"rpc":{"type":"RPCRequest","id":13},"refresh":{"type":"RefreshRequest","id":14},"sub_refresh":{"type":"SubRefreshRequest","id":15}},"nested":{"MethodType":{"values":{"CONNECT":0,"SUBSCRIBE":1,"UNSUBSCRIBE":2,"PUBLISH":3,"PRESENCE":4,"PRESENCE_STATS":5,"HISTORY":6,"PING":7,"SEND":8,"RPC":9,"REFRESH":10,"SUB_REFRESH":11}}}},"Reply":{"fields":{"id":{"type":"uint32","id":1},"error":{"type":"Error","id":2},"result":{"type":"bytes","id":3},"push":{"type":"Push","id":4},"connect":{"type":"ConnectResult","id":5},"subscribe":{"type":"SubscribeResult","id":6},"unsubscribe":{"type":"UnsubscribeResult","id":7},"publish":{"type":"PublishResult","id":8},"presence":{"type":"PresenceResult","id":9},"presence_stats":{"type":"PresenceStatsResult","id":10},"history":{"type":"HistoryResult","id":11},"ping":{"type":"PingResult","id":12},"rpc":{"type":"RPCResult","id":13},"refresh":{"type":"RefreshResult","id":14},"sub_refresh":{"type":"SubRefreshResult","id":15}}},"Push":{"fields":{"type":{"type":"PushType","id":1},"channel":{"type":"string","id":2},"data":{"type":"bytes","id":3},"pub":{"type":"Publication","id":4},"join":{"type":"Join","id":5},"leave":{"type":"Leave","id":6},"unsubscribe":{"type":"Unsubscribe","id":7},"message":{"type":"Message","id":8},"subscribe":{"type":"Subscribe","id":9},"connect":{"type":"Connect","id":10},"disconnect":{"type":"Disconnect","id":11},"refresh":{"type":"Refresh","id":12}},"nested":{"PushType":{"values":{"PUBLICATION":0,"JOIN":1,"LEAVE":2,"UNSUBSCRIBE":3,"MESSAGE":4,"SUBSCRIBE":5,"CONNECT":6,"DISCONNECT":7,"REFRESH":8}}}},"ClientInfo":{"fields":{"user":{"type":"string","id":1},"client":{"type":"string","id":2},"conn_info":{"type":"bytes","id":3},"chan_info":{"type":"bytes","id":4}}},"Publication":{"fields":{"data":{"type":"bytes","id":4},"info":{"type":"ClientInfo","id":5},"offset":{"type":"uint64","id":6},"tags":{"keyType":"string","type":"string","id":7}}},"Join":{"fields":{"info":{"type":"ClientInfo","id":1}}},"Leave":{"fields":{"info":{"type":"ClientInfo","id":1}}},"Unsubscribe":{"fields":{"code":{"type":"uint32","id":2},"reason":{"type":"string","id":3}}},"Subscribe":{"fields":{"recoverable":{"type":"bool","id":1},"epoch":{"type":"string","id":4},"offset":{"type":"uint64","id":5},"positioned":{"type":"bool","id":6},"data":{"type":"bytes","id":7}}},"Message":{"fields":{"data":{"type":"bytes","id":1}}},"Connect":{"fields":{"client":{"type":"string","id":1},"version":{"type":"string","id":2},"data":{"type":"bytes","id":3},"subs":{"keyType":"string","type":"SubscribeResult","id":4},"expires":{"type":"bool","id":5},"ttl":{"type":"uint32","id":6},"ping":{"type":"uint32","id":7},"pong":{"type":"bool","id":8},"session":{"type":"string","id":9},"node":{"type":"string","id":10}}},"Disconnect":{"fields":{"code":{"type":"uint32","id":1},"reason":{"type":"string","id":2},"reconnect":{"type":"bool","id":3}}},"Refresh":{"fields":{"expires":{"type":"bool","id":1},"ttl":{"type":"uint32","id":2}}},"ConnectRequest":{"fields":{"token":{"type":"string","id":1},"data":{"type":"bytes","id":2},"subs":{"keyType":"string","type":"SubscribeRequest","id":3},"name":{"type":"string","id":4},"version":{"type":"string","id":5}}},"ConnectResult":{"fields":{"client":{"type":"string","id":1},"version":{"type":"string","id":2},"expires":{"type":"bool","id":3},"ttl":{"type":"uint32","id":4},"data":{"type":"bytes","id":5},"subs":{"keyType":"string","type":"SubscribeResult","id":6},"ping":{"type":"uint32","id":7},"pong":{"type":"bool","id":8},"session":{"type":"string","id":9},"node":{"type":"string","id":10}}},"RefreshRequest":{"fields":{"token":{"type":"string","id":1}}},"RefreshResult":{"fields":{"client":{"type":"string","id":1},"version":{"type":"string","id":2},"expires":{"type":"bool","id":3},"ttl":{"type":"uint32","id":4}}},"SubscribeRequest":{"fields":{"channel":{"type":"string","id":1},"token":{"type":"string","id":2},"recover":{"type":"bool","id":3},"epoch":{"type":"string","id":6},"offset":{"type":"uint64","id":7},"data":{"type":"bytes","id":8},"positioned":{"type":"bool","id":9},"recoverable":{"type":"bool","id":10},"join_leave":{"type":"bool","id":11}}},"SubscribeResult":{"fields":{"expires":{"type":"bool","id":1},"ttl":{"type":"uint32","id":2},"recoverable":{"type":"bool","id":3},"epoch":{"type":"string","id":6},"publications":{"rule":"repeated","type":"Publication","id":7},"recovered":{"type":"bool","id":8},"offset":{"type":"uint64","id":9},"positioned":{"type":"bool","id":10},"data":{"type":"bytes","id":11},"was_recovering":{"type":"bool","id":12}}},"SubRefreshRequest":{"fields":{"channel":{"type":"string","id":1},"token":{"type":"string","id":2}}},"SubRefreshResult":{"fields":{"expires":{"type":"bool","id":1},"ttl":{"type":"uint32","id":2}}},"UnsubscribeRequest":{"fields":{"channel":{"type":"string","id":1}}},"UnsubscribeResult":{"fields":{}},"PublishRequest":{"fields":{"channel":{"type":"string","id":1},"data":{"type":"bytes","id":2}}},"PublishResult":{"fields":{}},"PresenceRequest":{"fields":{"channel":{"type":"string","id":1}}},"PresenceResult":{"fields":{"presence":{"keyType":"string","type":"ClientInfo","id":1}}},"PresenceStatsRequest":{"fields":{"channel":{"type":"string","id":1}}},"PresenceStatsResult":{"fields":{"num_clients":{"type":"uint32","id":1},"num_users":{"type":"uint32","id":2}}},"StreamPosition":{"fields":{"offset":{"type":"uint64","id":1},"epoch":{"type":"string","id":2}}},"HistoryRequest":{"fields":{"channel":{"type":"string","id":1},"limit":{"type":"int32","id":7},"since":{"type":"StreamPosition","id":8},"reverse":{"type":"bool","id":9}}},"HistoryResult":{"fields":{"publications":{"rule":"repeated","type":"Publication","id":1},"epoch":{"type":"string","id":2},"offset":{"type":"uint64","id":3}}},"PingRequest":{"fields":{}},"PingResult":{"fields":{}},"RPCRequest":{"fields":{"data":{"type":"bytes","id":1},"method":{"type":"string","id":2}}},"RPCResult":{"fields":{"data":{"type":"bytes","id":1}}},"SendRequest":{"fields":{"data":{"type":"bytes","id":1}}}}}}}}}}}')}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var s=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(s.exports,s,s.exports,__webpack_require__),s.loaded=!0,s.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var s in t)__webpack_require__.o(t,s)&&!__webpack_require__.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__=__webpack_require__(3023),__webpack_export_target__=mlysdk="undefined"==typeof mlysdk?{}:mlysdk;for(var i in __webpack_exports__)__webpack_export_target__[i]=__webpack_exports__[i];__webpack_exports__.__esModule&&Object.defineProperty(__webpack_export_target__,"__esModule",{value:!0})})();